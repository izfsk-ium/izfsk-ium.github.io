<?xml version='1.0' encoding='UTF-8'?>
<rss xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/" version="2.0">
  <channel>
    <title>白漠流霜</title>
    <link>http://blog.izfsk.top/rss.xml</link>
    <description>Izfsk's blog</description>
    <atom:link href="http://blog.izfsk.top/rss.xml" rel="self"/>
    <docs>http://www.rssboard.org/rss-specification</docs>
    <generator>python-feedgen</generator>
    <image>
      <url>http://blog.izfsk.top/favicon.ico</url>
      <title>白漠流霜</title>
      <link>http://blog.izfsk.top/rss.xml</link>
    </image>
    <language>zh_CN</language>
    <lastBuildDate>Fri, 11 Aug 2023 13:58:51 +0000</lastBuildDate>
    <item>
      <title>模版功能简介</title>
      <link>https://blog.izfsk.top/articles/README.html</link>
      <description>模版功能简介</description>
      <content:encoded>&lt;body&gt;
&lt;progress id="content_progress" value="0"&gt;&lt;/progress&gt;
&lt;button id="back-to-top"&gt;
    回页顶
  &lt;/button&gt;
&lt;header&gt;
&lt;small id="article-uuid" style="display: none !important;"&gt;87b181b2-202e-11ee-b1e5-84a93896bec6&lt;/small&gt;
&lt;h1 class="title"&gt;模版功能简介&lt;/h1&gt;
&lt;!-- Subtitle --&gt;
&lt;h3 class="subtitle"&gt;好好利用本主题吧~&lt;/h3&gt;
&lt;/header&gt;
&lt;nav id="TOC" role="doc-toc"&gt;
&lt;strong&gt;文章归类: &lt;a href="/pages/category.html#测试"&gt;测试&lt;/a&gt; &lt;/strong&gt;
&lt;input id="contents" type="checkbox"/&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#encryptes-sections" id="toc-encryptes-sections"&gt;Encryptes Sections&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#document-metadata" id="toc-document-metadata"&gt;Document metadata&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#assorted-prose-elements" id="toc-assorted-prose-elements"&gt;Assorted prose elements&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#side-notes-and-margin-notes" id="toc-side-notes-and-margin-notes"&gt;Side notes and margin notes&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#choosing-a-side-note-anchor-spot" id="toc-choosing-a-side-note-anchor-spot"&gt;Choosing a side note anchor spot&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#code-blocks" id="toc-code-blocks"&gt;Code blocks&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#numbered-and-highlighted-lines" id="toc-numbered-and-highlighted-lines"&gt;Numbered and highlighted lines&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#line-highlight-limit" id="toc-line-highlight-limit"&gt;Line highlight limit&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#tight-code-blocks" id="toc-tight-code-blocks"&gt;Tight code blocks&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#math" id="toc-math"&gt;Math&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#images-tables-and-captioned-code-blocks" id="toc-images-tables-and-captioned-code-blocks"&gt;Images, tables, and captioned code blocks&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#wide-extra-wide-and-full-width" id="toc-wide-extra-wide-and-full-width"&gt;Wide, extra-wide, and full-width&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#colored-note-callouts" id="toc-colored-note-callouts"&gt;Colored note callouts&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#table-of-contents" id="toc-table-of-contents"&gt;Table of contents&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#tweaking-the-css-variables" id="toc-tweaking-the-css-variables"&gt;Tweaking the CSS variables&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#automatic-light-and-dark-theme" id="toc-automatic-light-and-dark-theme"&gt;Automatic light and dark theme&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#print-styles" id="toc-print-styles"&gt;Print styles&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#reference"&gt;参考链接&lt;/a&gt;&lt;/li&gt;
&lt;li&gt; &lt;/li&gt;
&lt;li class="tools"&gt;
&lt;span id="backtomain"&gt;
&lt;svg class="bi bi-house" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M8.707 1.5a1 1 0 0 0-1.414 0L.646 8.146a.5.5 0 0 0 .708.708L2 8.207V13.5A1.5 1.5 0 0 0 3.5 15h9a1.5 1.5 0 0 0 1.5-1.5V8.207l.646.647a.5.5 0 0 0 .708-.708L13 5.793V2.5a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v1.293L8.707 1.5ZM13 7.207V13.5a.5.5 0 0 1-.5.5h-9a.5.5 0 0 1-.5-.5V7.207l5-5 5 5Z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="readingmode"&gt;
&lt;svg class="bi bi-book" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M1 2.828c.885-.37 2.154-.769 3.388-.893 1.33-.134 2.458.063 3.112.752v9.746c-.935-.53-2.12-.603-3.213-.493-1.18.12-2.37.461-3.287.811V2.828zm7.5-.141c.654-.689 1.782-.886 3.112-.752 1.234.124 2.503.523 3.388.893v9.923c-.918-.35-2.107-.692-3.287-.81-1.094-.111-2.278-.039-3.213.492V2.687zM8 1.783C7.015.936 5.587.81 4.287.94c-1.514.153-3.042.672-3.994 1.105A.5.5 0 0 0 0 2.5v11a.5.5 0 0 0 .707.455c.882-.4 2.303-.881 3.68-1.02 1.409-.142 2.59.087 3.223.877a.5.5 0 0 0 .78 0c.633-.79 1.814-1.019 3.222-.877 1.378.139 2.8.62 3.681 1.02A.5.5 0 0 0 16 13.5v-11a.5.5 0 0 0-.293-.455c-.952-.433-2.48-.952-3.994-1.105C10.413.809 8.985.936 8 1.783z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="larger"&gt; &lt;/span&gt;
&lt;span id="smaller"&gt;&lt;/span&gt;
&lt;span id="switchfont"&gt;
&lt;svg class="bi bi-fonts" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M12.258 3h-8.51l-.083 2.46h.479c.26-1.544.758-1.783 2.693-1.845l.424-.013v7.827c0 .663-.144.82-1.3.923v.52h4.082v-.52c-1.162-.103-1.306-.26-1.306-.923V3.602l.431.013c1.934.062 2.434.301 2.693 1.846h.479L12.258 3z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="backtotop"&gt;
&lt;svg class="bi bi-arrow-bar-up" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M8 10a.5.5 0 0 0 .5-.5V3.707l2.146 2.147a.5.5 0 0 0 .708-.708l-3-3a.5.5 0 0 0-.708 0l-3 3a.5.5 0 1 0 .708.708L7.5 3.707V9.5a.5.5 0 0 0 .5.5zm-7 2.5a.5.5 0 0 1 .5-.5h13a.5.5 0 0 1 0 1h-13a.5.5 0 0 1-.5-.5z" fill-rule="evenodd"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/nav&gt;
&lt;main&gt;
&lt;aside class="warning-outdated"&gt;
&lt;span&gt;⚠️&lt;/span&gt;注意：本文章被标记为过期！请谨慎对待其内容。 &lt;span&gt;⚠️&lt;/span&gt;
&lt;/aside&gt;
&lt;aside class="warning-draft"&gt;
&lt;span&gt;⚠️&lt;/span&gt;注意：本文章被标记为草稿！请谨慎对待其内容。 &lt;span&gt;⚠️&lt;/span&gt;
&lt;/aside&gt;
&lt;h1 id="encryptes-sections"&gt;Encryptes Sections&lt;/h1&gt;
&lt;p&gt;use &lt;code&gt;echo -n "YOUR_TEXT_TO_ENCRYPT" | gpg --symmetric --cipher-algo AES256 --armor&lt;/code&gt; to encrypt text, then put here like:&lt;/p&gt;
&lt;div class="sourceCode" id="cb1"&gt;&lt;pre class="sourceCode js"&gt;&lt;code class="sourceCode javascript"&gt;&lt;span id="cb1-1"&gt;&lt;a aria-hidden="true" href="#cb1-1" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb1-2"&gt;&lt;a aria-hidden="true" href="#cb1-2" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="vs"&gt;```{.gpg}&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-3"&gt;&lt;a aria-hidden="true" href="#cb1-3" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="vs"&gt;-----BEGIN PGP MESSAGE-----&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-4"&gt;&lt;a aria-hidden="true" href="#cb1-4" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb1-5"&gt;&lt;a aria-hidden="true" href="#cb1-5" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="vs"&gt;jA0ECQMCB49M3yRPGh7/0kkB5Cb5CBsZ/fKB6KC3BWh5BPrFAMnjZPwHm9kuW3k8&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-6"&gt;&lt;a aria-hidden="true" href="#cb1-6" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="vs"&gt;s0A+4QO/lyv7tvRfh7x65AfqqgdYPdhcXtdRfMD7ldKyIFFx8vQDklSS&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-7"&gt;&lt;a aria-hidden="true" href="#cb1-7" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="vs"&gt;=necK&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-8"&gt;&lt;a aria-hidden="true" href="#cb1-8" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="vs"&gt;-----END PGP MESSAGE-----&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;pre class="gpg"&gt;&lt;code&gt;-----BEGIN PGP MESSAGE-----

jA0ECQMCB49M3yRPGh7/0kkB5Cb5CBsZ/fKB6KC3BWh5BPrFAMnjZPwHm9kuW3k8
s0A+4QO/lyv7tvRfh7x65AfqqgdYPdhcXtdRfMD7ldKyIFFx8vQDklSS
=necK
-----END PGP MESSAGE-----&lt;/code&gt;&lt;/pre&gt;
&lt;h1 id="document-metadata"&gt;Document metadata&lt;/h1&gt;
&lt;p&gt;Pandoc allows setting &lt;a href="https://pandoc.org/MANUAL.html#variables"&gt;variables&lt;/a&gt; in the preamble of a Markdown document with a YAML metadata block, like this:&lt;/p&gt;
&lt;div class="sourceCode" id="cb3"&gt;&lt;pre class="sourceCode numberSource yaml numberLines"&gt;&lt;code class="sourceCode yaml"&gt;&lt;span id="cb3-1"&gt;&lt;a href="#cb3-1"&gt;&lt;/a&gt;&lt;span class="pp"&gt;---&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb3-2"&gt;&lt;a href="#cb3-2"&gt;&lt;/a&gt;&lt;span class="fu"&gt;uuid&lt;/span&gt;&lt;span class="kw"&gt;:&lt;/span&gt;&lt;span class="at"&gt; &lt;/span&gt;&lt;span class="st"&gt;"87b181b2-202e-11ee-b1e5-84a93896bec6"&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb3-3"&gt;&lt;a href="#cb3-3"&gt;&lt;/a&gt;&lt;span class="fu"&gt;title&lt;/span&gt;&lt;span class="kw"&gt;:&lt;/span&gt;&lt;span class="at"&gt; &lt;/span&gt;&lt;span class="st"&gt;"模版功能简介"&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb3-4"&gt;&lt;a href="#cb3-4"&gt;&lt;/a&gt;&lt;span class="fu"&gt;subtitle&lt;/span&gt;&lt;span class="kw"&gt;:&lt;/span&gt;&lt;span class="at"&gt; &lt;/span&gt;&lt;span class="st"&gt;"好好利用本主题吧~"&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb3-5"&gt;&lt;a href="#cb3-5"&gt;&lt;/a&gt;&lt;span class="fu"&gt;english&lt;/span&gt;&lt;span class="kw"&gt;:&lt;/span&gt;&lt;span class="at"&gt; &lt;/span&gt;&lt;span class="st"&gt;"README"&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb3-6"&gt;&lt;a href="#cb3-6"&gt;&lt;/a&gt;&lt;span class="fu"&gt;date&lt;/span&gt;&lt;span class="kw"&gt;:&lt;/span&gt;&lt;span class="at"&gt; &lt;/span&gt;&lt;span class="st"&gt;"1980-01-01"&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb3-7"&gt;&lt;a href="#cb3-7"&gt;&lt;/a&gt;&lt;span class="fu"&gt;category&lt;/span&gt;&lt;span class="kw"&gt;:&lt;/span&gt;&lt;span class="at"&gt; &lt;/span&gt;&lt;span class="st"&gt;"测试"&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb3-8"&gt;&lt;a href="#cb3-8"&gt;&lt;/a&gt;&lt;span class="fu"&gt;project&lt;/span&gt;&lt;span class="kw"&gt;:&lt;/span&gt;&lt;span class="at"&gt; &lt;/span&gt;&lt;span class="st"&gt;"测试"&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb3-9"&gt;&lt;a href="#cb3-9"&gt;&lt;/a&gt;&lt;span class="fu"&gt;outdated&lt;/span&gt;&lt;span class="kw"&gt;:&lt;/span&gt;&lt;span class="at"&gt; &lt;/span&gt;&lt;span class="ch"&gt;true&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb3-10"&gt;&lt;a href="#cb3-10"&gt;&lt;/a&gt;&lt;span class="fu"&gt;draft&lt;/span&gt;&lt;span class="kw"&gt;:&lt;/span&gt;&lt;span class="at"&gt; &lt;/span&gt;&lt;span class="ch"&gt;true&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb3-11"&gt;&lt;a href="#cb3-11"&gt;&lt;/a&gt;&lt;span class="fu"&gt;ref&lt;/span&gt;&lt;span class="kw"&gt;:&lt;/span&gt;&lt;span class="at"&gt; &lt;/span&gt;&lt;/span&gt;
&lt;span id="cb3-12"&gt;&lt;a href="#cb3-12"&gt;&lt;/a&gt;&lt;span class="at"&gt;  &lt;/span&gt;&lt;span class="kw"&gt;-&lt;/span&gt;&lt;span class="at"&gt; &lt;/span&gt;&lt;span class="fu"&gt;name&lt;/span&gt;&lt;span class="kw"&gt;:&lt;/span&gt;&lt;span class="at"&gt; &lt;/span&gt;&lt;span class="st"&gt;"第一个参考链接"&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb3-13"&gt;&lt;a href="#cb3-13"&gt;&lt;/a&gt;&lt;span class="at"&gt;    &lt;/span&gt;&lt;span class="fu"&gt;url&lt;/span&gt;&lt;span class="kw"&gt;:&lt;/span&gt;&lt;span class="at"&gt; &lt;/span&gt;&lt;span class="st"&gt;"www.example_1.com"&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb3-14"&gt;&lt;a href="#cb3-14"&gt;&lt;/a&gt;&lt;span class="at"&gt;  &lt;/span&gt;&lt;span class="kw"&gt;-&lt;/span&gt;&lt;span class="at"&gt; &lt;/span&gt;&lt;span class="fu"&gt;name&lt;/span&gt;&lt;span class="kw"&gt;:&lt;/span&gt;&lt;span class="at"&gt; &lt;/span&gt;&lt;span class="st"&gt;"第二个参考链接"&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb3-15"&gt;&lt;a href="#cb3-15"&gt;&lt;/a&gt;&lt;span class="at"&gt;    &lt;/span&gt;&lt;span class="fu"&gt;url&lt;/span&gt;&lt;span class="kw"&gt;:&lt;/span&gt;&lt;span class="at"&gt; &lt;/span&gt;&lt;span class="st"&gt;"www.example_2.com"&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb3-16"&gt;&lt;a href="#cb3-16"&gt;&lt;/a&gt;&lt;span class="pp"&gt;---&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb3-17"&gt;&lt;a href="#cb3-17"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb3-18"&gt;&lt;a href="#cb3-18"&gt;&lt;/a&gt;&lt;span class="at"&gt;... markdown content ...&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This theme’s HTML template allows setting some, but not all, of the variables that Pandoc supports, including:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;title&lt;/code&gt;
&lt;ul&gt;
&lt;li&gt;Required&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;author&lt;/code&gt;, &lt;code&gt;date&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;pagetitle&lt;/code&gt;, &lt;code&gt;author-meta&lt;/code&gt;, &lt;code&gt;date-meta&lt;/code&gt;
&lt;ul&gt;
&lt;li&gt;Optional, set automatically from &lt;code&gt;title&lt;/code&gt;, &lt;code&gt;author&lt;/code&gt;, and &lt;code&gt;date&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;subtitle&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;keywords&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;lang&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;dir&lt;/code&gt;
&lt;ul&gt;
&lt;li&gt;Optional (text direction, like &lt;code&gt;ltr&lt;/code&gt; or &lt;code&gt;rtl&lt;/code&gt;)&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;description-meta&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;title-prefix&lt;/code&gt;
&lt;ul&gt;
&lt;li&gt;Optional, only affects &lt;code&gt;&amp;lt;title&amp;gt;&lt;/code&gt; tag&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;header-includes&lt;/code&gt;
&lt;ul&gt;
&lt;li&gt;Optional. A list of strings to inject at the end of the &lt;code&gt;&amp;lt;head&amp;gt;&lt;/code&gt; tag&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;include-before&lt;/code&gt;, &lt;code&gt;include-after&lt;/code&gt;
&lt;ul&gt;
&lt;li&gt;Optional. A list of strings to inject at the start or end (respectively) of the &lt;code&gt;&amp;lt;body&amp;gt;&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;It also supports some extra variables:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;author-url&lt;/code&gt;
&lt;ul&gt;
&lt;li&gt;Optional. Will render &lt;code&gt;author&lt;/code&gt; wrapped in a link with this target if present.&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;return-url&lt;/code&gt;
&lt;ul&gt;
&lt;li&gt;Optional. Will render a “return” link at the top of the table of contents if present.&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;return-text&lt;/code&gt;
&lt;ul&gt;
&lt;li&gt;Optional. Text to use for the “return” link. Defaults to &lt;code&gt;← Return&lt;/code&gt;.&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;You can see all of these settings in action at the top of this page. For more information, refer to the &lt;a href="https://pandoc.org/MANUAL.html#variables"&gt;Pandoc manual section for variables&lt;/a&gt;.&lt;/p&gt;
&lt;h1 id="assorted-prose-elements"&gt;Assorted prose elements&lt;/h1&gt;
&lt;p&gt;This theme of course supports the standard Markdown prose elements you’d expect, like paragraphs, &lt;strong&gt;bold text&lt;/strong&gt;, &lt;em&gt;italic text&lt;/em&gt;, and &lt;a href="#"&gt;links&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Pandoc Markdown has special syntax for some some non-standard prose elements, including &lt;span class="smallcaps"&gt;smallcaps&lt;/span&gt;, &lt;u&gt;underline&lt;/u&gt;, and &lt;del&gt;strikethrough&lt;/del&gt;. Refer to the Pandoc manual for more information, but the basic syntax looks like&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;This text is [smallcaps]{.smallcaps}.
This text is [underline]{.underline}.
This text is ~~strikethrough~~.&lt;/code&gt;&lt;/pre&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;em&gt;This text is &lt;span class="smallcaps"&gt;smallcaps&lt;/span&gt;.&lt;/em&gt;&lt;br/&gt;
&lt;em&gt;This text is &lt;u&gt;underline&lt;/u&gt;.&lt;/em&gt;&lt;br/&gt;
&lt;em&gt;This text is &lt;del&gt;strikethrough&lt;/del&gt;.&lt;/em&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Pandoc Markdown also supports bulleted and numbered lists, as expected:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Bullet item&lt;/li&gt;
&lt;li&gt;Another bullet&lt;/li&gt;
&lt;/ul&gt;
&lt;ol type="1"&gt;
&lt;li&gt;First bullet&lt;/li&gt;
&lt;li&gt;Second bullet&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;But it also supports non-standard task lists:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;- [x] Already done
- [ ] Not done yet&lt;/code&gt;&lt;/pre&gt;
&lt;blockquote&gt;
&lt;ul class="task-list"&gt;
&lt;li&gt;&lt;label&gt;&lt;input checked="" type="checkbox"&gt;&lt;em&gt;Already done&lt;/em&gt;&lt;/input&gt;&lt;/label&gt;&lt;/li&gt;
&lt;li&gt;&lt;label&gt;&lt;input type="checkbox"/&gt;&lt;em&gt;Not done yet&lt;/em&gt;&lt;/label&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;p&gt;Pandoc renders task list checkboxes as disabled, so they can’t be clicked. This theme inserts a few lines of JavaScript to make them enabled in HTML but disabled with JavaScript because it is the easiest way to apply custom styles to checkboxes. If you prefer the &lt;code&gt;disabled&lt;/code&gt; appearance or don’t want JavaScript, feel free to remove the &lt;code&gt;&amp;lt;script&amp;gt;&lt;/code&gt; tag at the end of the theme template.&lt;/p&gt;
&lt;h1 id="side-notes-and-margin-notes"&gt;Side notes and margin notes&lt;/h1&gt;
&lt;p&gt;Side notes and margin notes work very similarly to how they work in &lt;a href="https://edwardtufte.github.io/tufte-css/"&gt;Tufte CSS&lt;/a&gt;, but made easier to use in Markdown with the &lt;a href="https://github.com/jez/pandoc-sidenote"&gt;&lt;code&gt;pandoc-sidenote&lt;/code&gt;&lt;/a&gt; Pandoc filter.&lt;/p&gt;
&lt;p&gt;To get started, install &lt;code&gt;pandoc-sidenote&lt;/code&gt; and pass &lt;code&gt;--filter pandoc-sidenote&lt;/code&gt; when invoking Pandoc, like the &lt;a href="https://github.com/jez/pandoc-markdown-css-theme/blob/27d0aa58bfc6eafe296e2cef1900a39c9c2507a7/tools/build.sh#L57"&gt;Makefile&lt;/a&gt; for this project does:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;pandoc --filter pandoc-sidenote [...]&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;With this filter active, the syntax for footnotes becomes the syntax for side notes and margin notes (specifically, it is no longer possible for the document to use footnotes).&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;For example this is a side note[^example-side-note]. Side notes
are numbered, and the number shows at the anchor point in the
body text at all screen widths.

[^example-side-note]:
  This is the text in the side note. It is smaller and only
  supports inline elements, like **bold** or [links](#),
  but not lists or code blocks.&lt;/code&gt;&lt;/pre&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;em&gt;For example this is a side note&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-0"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-0" type="checkbox"/&gt;&lt;span class="sidenote"&gt;This is the text in the side note. It is smaller and only supports inline elements, like &lt;strong&gt;bold&lt;/strong&gt; or &lt;a href="#"&gt;links&lt;/a&gt;, but not lists or code blocks.&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;. Side notes are numbered, and the number shows at the anchor point in the body text at all screen widths.&lt;/em&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;pre&gt;&lt;code&gt;On the other hand, margin notes are not numbered. Instead,
they hang to the left and are only vaguely connected to the
text, like this.[^example-margin-note]

[^example-margin-note]:
  {-} `pandoc-sidenote` detects margin notes when the note
  starts with the text `{-}`. This is inspired by the syntax
  Pandoc uses for unnumbered headings.&lt;/code&gt;&lt;/pre&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;em&gt;On the other hand, margin notes are not numbered. Instead, they hang to the left and are only vaguely connected to the text, like this.&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle" for="sn-1"&gt;⊕&lt;/label&gt;&lt;input class="margin-toggle" id="sn-1" type="checkbox"/&gt;&lt;span class="marginnote"&gt;&lt;code&gt;pandoc-sidenote&lt;/code&gt; detects margin notes when the note starts with the text &lt;code&gt;{-}&lt;/code&gt;. This is inspired by the syntax Pandoc uses for unnumbered headings.&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/em&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Side notes and margin notes are fully responsive. When there is no space to render the notes in the margin, they will be hidden by default, and the anchor point will leave a clickable link to expand the side note inline. Try viewing this page on a phone to see how that looks.&lt;/p&gt;
&lt;h2 id="choosing-a-side-note-anchor-spot"&gt;Choosing a side note anchor spot&lt;/h2&gt;
&lt;p&gt;Side notes and margin notes look best when they anchor to text within the first ~500px of the text (this is where the first line will break on tablets). This ensures that the baseline of the sidenote and the baseline of the body text will align on the first line.&lt;/p&gt;
&lt;p&gt;For example, note the difference between the side note and margin note exaple above. The side note anchors to the first line of the paragraph, while the margin note anchors to the last line. This makes the side note even with its corresponding paragraph, but makes the margin note look like it’s hanging.&lt;/p&gt;
&lt;p&gt;Sometimes the prose dictates where the margin note must attach, making the problem unavoidable. But when there’s a choice of where to attach it, use this as a guide.&lt;/p&gt;
&lt;h1 id="code-blocks"&gt;Code blocks&lt;/h1&gt;
&lt;p&gt;Pandoc Markdown supports a number of code block features. First, plain delimited code blocks with no syntax highlighting:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;```
This is a code block.
```&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;This is a code block.&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;As well as delimited code blocks with syntax highlighting:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;```ruby
def greet; "Hello, world!"; end
```&lt;/code&gt;&lt;/pre&gt;
&lt;div class="sourceCode" id="cb12"&gt;&lt;pre class="sourceCode ruby"&gt;&lt;code class="sourceCode ruby"&gt;&lt;span id="cb12-1"&gt;&lt;a aria-hidden="true" href="#cb12-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="cf"&gt;def&lt;/span&gt; greet; &lt;span class="st"&gt;"Hello, world!"&lt;/span&gt;; &lt;span class="cf"&gt;end&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id="numbered-and-highlighted-lines"&gt;Numbered and highlighted lines&lt;/h2&gt;
&lt;p&gt;Pandoc Markdown also supports attaching line numbers to a code block, plain or with syntax highlighting using the &lt;code&gt;.numberLines&lt;/code&gt; CSS class:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;```{.ruby .numberLines}
def greet; "Hello, world!"; end
```&lt;/code&gt;&lt;/pre&gt;
&lt;div class="sourceCode" id="cb14"&gt;&lt;pre class="sourceCode numberSource ruby numberLines"&gt;&lt;code class="sourceCode ruby"&gt;&lt;span id="cb14-1"&gt;&lt;a href="#cb14-1"&gt;&lt;/a&gt;&lt;span class="cf"&gt;def&lt;/span&gt; greet; &lt;span class="st"&gt;"Hello, world!"&lt;/span&gt;; &lt;span class="cf"&gt;end&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The line numbers are clickable and all have HTML IDs attached to them, making them linkable.&lt;/p&gt;
&lt;p&gt;This theme extends Pandoc’s code blocks with line numbers by allowing individual lines to be highlighted. Emphasize specific lines in a code block by adding various &lt;code&gt;.hl-*&lt;/code&gt; classes for the lines you’d like to highlight, like this:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;```{.numberLines .hl-2 .hl-3}
This is the first line.
This line is highlighted.
This line is also highlighted.
This is another line.
```&lt;/code&gt;&lt;/pre&gt;
&lt;div class="sourceCode" id="cb16"&gt;&lt;pre class="sourceCode numberSource numberLines hl-2 hl-3"&gt;&lt;code class="sourceCode"&gt;&lt;span id="cb16-1"&gt;&lt;a href="#cb16-1"&gt;&lt;/a&gt;This is the first line.&lt;/span&gt;
&lt;span id="cb16-2"&gt;&lt;a href="#cb16-2"&gt;&lt;/a&gt;This line is highlighted.&lt;/span&gt;
&lt;span id="cb16-3"&gt;&lt;a href="#cb16-3"&gt;&lt;/a&gt;This line is also highlighted.&lt;/span&gt;
&lt;span id="cb16-4"&gt;&lt;a href="#cb16-4"&gt;&lt;/a&gt;This is another line.&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The &lt;code&gt;.numberLines&lt;/code&gt; class is required for these line highlights to render correctly.&lt;/p&gt;
&lt;h3 id="line-highlight-limit"&gt;Line highlight limit&lt;/h3&gt;
&lt;p&gt;A quick note on line highlights: this feature is implemented in CSS, and is currently limited to a max line highlight of the 40&lt;sup&gt;th&lt;/sup&gt; line. More lines can always be specified by adding &lt;a href="https://github.com/jez/pandoc-markdown-css-theme/blob/27d0aa58bfc6eafe296e2cef1900a39c9c2507a7/public/css/theme.css#L539-L578"&gt;more lines like this&lt;/a&gt; using the &lt;code&gt;header-includes&lt;/code&gt; variable:&lt;/p&gt;
&lt;div class="sourceCode" id="cb17"&gt;&lt;pre class="sourceCode yaml"&gt;&lt;code class="sourceCode yaml"&gt;&lt;span id="cb17-1"&gt;&lt;a aria-hidden="true" href="#cb17-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="pp"&gt;---&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb17-2"&gt;&lt;a aria-hidden="true" href="#cb17-2" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="co"&gt;# ...&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb17-3"&gt;&lt;a aria-hidden="true" href="#cb17-3" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="fu"&gt;header-includes&lt;/span&gt;&lt;span class="kw"&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb17-4"&gt;&lt;a aria-hidden="true" href="#cb17-4" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;-&lt;/span&gt;&lt;span class="at"&gt; &lt;/span&gt;&lt;span class="st"&gt;'&amp;lt;style&amp;gt;pre.hl-41 &amp;gt; code.sourceCode &amp;gt; span:nth-of-type(41)::after { content: ""; }&amp;lt;/style&amp;gt;'&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb17-5"&gt;&lt;a aria-hidden="true" href="#cb17-5" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="pp"&gt;---&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id="tight-code-blocks"&gt;Tight code blocks&lt;/h2&gt;
&lt;p&gt;Another feature unique to this theme is is &lt;code&gt;.tight-code&lt;/code&gt;. Sometimes for drawing ASCII art it’s important that there be no gaps between lines, so that things like unicode box drawing characters attach:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;```{.tight-code}
One line of text
Another line of text
┌──┬──┐
├──┼──┤
└──┴──┘
```&lt;/code&gt;&lt;/pre&gt;
&lt;pre class="tight-code"&gt;&lt;code&gt;One line of text
Another line of text
┌──┬──┐
├──┼──┤
└──┴──┘&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;As you can see, the difference is striking. Text ends up looking crammed together, instead of following the normal rhythem of the rest of the document, but sometimes this can be a worthy tradeoff when it matters that code lines touch.&lt;/p&gt;
&lt;h1 id="math"&gt;Math&lt;/h1&gt;
&lt;p&gt;Pandoc Markdown supports &lt;a href="https://pandoc.org/MANUAL.html#math-input"&gt;a number of ways&lt;/a&gt; to specify LaTeX math. This project’s &lt;code&gt;Makefile&lt;/code&gt; defaults to &lt;code&gt;tex_math_single_backslash&lt;/code&gt;, which allows multiple forms of math input:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;This is inline: $a^2 + b^2 = c^2$.\
So is this: \(F = ma\).\
This is display math:

$$x = \frac{ - b \pm \sqrt {b^2 - 4ac} }{2a}$$

And so is this:

\[\frac{
  \Delta \, \Gamma, e : \forall (u :: \kappa). \tau \qquad \Delta \vdash c :: \kappa
}{
  \Delta \, \Gamma \vdash e[c] : [c/u]\tau
}\]&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;This is inline: &lt;span class="math inline"&gt;a^2 + b^2 = c^2&lt;/span&gt;.&lt;br/&gt;
    So is this: &lt;span class="math inline"&gt;F = ma&lt;/span&gt;.&lt;/p&gt;
&lt;p&gt;This is display math:&lt;/p&gt;
&lt;p&gt;&lt;span class="math display"&gt;x = \frac{ - b \pm \sqrt {b^2 - 4ac} }{2a}&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;And so is this:&lt;/p&gt;
&lt;p&gt;&lt;span class="math display"&gt;\frac{
      \Delta \, \Gamma, e : \forall (u :: \kappa). \tau \qquad \Delta \vdash c :: \kappa
    }{
      \Delta \, \Gamma \vdash e[c] : [c/u]\tau
    }&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;The math is rendered with &lt;a href="https://katex.org/"&gt;&lt;span class="math inline"&gt;\KaTeX&lt;/span&gt;&lt;/a&gt;. If a page uses math, Pandoc will automatically include the necessary CSS and JavaScript files to render the math.&lt;/p&gt;
&lt;h1 id="images-tables-and-captioned-code-blocks"&gt;Images, tables, and captioned code blocks&lt;/h1&gt;
&lt;p&gt;Pandoc Markdown has special syntax for images and tables, and their captions. For example:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;![Sugarloaf Hill, San Mateo, CA, April 2021](https://kric.cc/img/Untitled.png)&lt;/code&gt;&lt;/pre&gt;
&lt;figure&gt;
&lt;img alt="Sugarloaf Hill, San Mateo, CA, April 2021" src="https://kric.cc/img/Untitled.png"/&gt;
&lt;figcaption aria-hidden="true"&gt;Sugarloaf Hill, San Mateo, CA, April 2021&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;Note how the image’s &lt;code&gt;alt&lt;/code&gt; text became the caption. With tables, the syntax is slightly different:&lt;/p&gt;
&lt;table&gt;
&lt;caption&gt;This is the caption.&lt;/caption&gt;
&lt;thead&gt;
&lt;tr class="header"&gt;
&lt;th&gt;&lt;strong&gt;Column 1&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;Column 2&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class="odd"&gt;
&lt;td&gt;This is some text.&lt;/td&gt;
&lt;td&gt;This is some text.&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="even"&gt;
&lt;td&gt;This is some text.&lt;/td&gt;
&lt;td&gt;This is some text.&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;On top of the syntax Pandoc Markdown provides, this theme supports attaching captions to code blocks by wrapping the code block in a &lt;code&gt;&amp;lt;figure&amp;gt;&lt;/code&gt; tag.&lt;/p&gt;
&lt;div class="sourceCode" id="cb22"&gt;&lt;pre class="sourceCode numberSource html numberLines hl-1 hl-8 hl-9"&gt;&lt;code class="sourceCode html"&gt;&lt;span id="cb22-1"&gt;&lt;a href="#cb22-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;&amp;lt;figure&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb22-2"&gt;&lt;a href="#cb22-2"&gt;&lt;/a&gt;```ruby&lt;/span&gt;
&lt;span id="cb22-3"&gt;&lt;a href="#cb22-3"&gt;&lt;/a&gt;source 'https://rubygems.org'&lt;/span&gt;
&lt;span id="cb22-4"&gt;&lt;a href="#cb22-4"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb22-5"&gt;&lt;a href="#cb22-5"&gt;&lt;/a&gt;gem 'sorbet'&lt;/span&gt;
&lt;span id="cb22-6"&gt;&lt;a href="#cb22-6"&gt;&lt;/a&gt;gem 'sorbet-runtime'&lt;/span&gt;
&lt;span id="cb22-7"&gt;&lt;a href="#cb22-7"&gt;&lt;/a&gt;```&lt;/span&gt;
&lt;span id="cb22-8"&gt;&lt;a href="#cb22-8"&gt;&lt;/a&gt;&lt;span class="kw"&gt;&amp;lt;figcaption&amp;gt;&lt;/span&gt;An example Gemfile&lt;span class="kw"&gt;&amp;lt;/figcaption&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb22-9"&gt;&lt;a href="#cb22-9"&gt;&lt;/a&gt;&lt;span class="kw"&gt;&amp;lt;/figure&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;figure&gt;
&lt;div class="sourceCode" id="cb23"&gt;&lt;pre class="sourceCode ruby"&gt;&lt;code class="sourceCode ruby"&gt;&lt;span id="cb23-1"&gt;&lt;a aria-hidden="true" href="#cb23-1" tabindex="-1"&gt;&lt;/a&gt;source &lt;span class="vs"&gt;'https://rubygems.org'&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb23-2"&gt;&lt;a aria-hidden="true" href="#cb23-2" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb23-3"&gt;&lt;a aria-hidden="true" href="#cb23-3" tabindex="-1"&gt;&lt;/a&gt;gem &lt;span class="vs"&gt;'sorbet'&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb23-4"&gt;&lt;a aria-hidden="true" href="#cb23-4" tabindex="-1"&gt;&lt;/a&gt;gem &lt;span class="vs"&gt;'sorbet-runtime'&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;figcaption&gt;
    An example Gemfile
    &lt;/figcaption&gt;
&lt;/figure&gt;
&lt;h1 id="wide-extra-wide-and-full-width"&gt;Wide, extra-wide, and full-width&lt;/h1&gt;
&lt;p&gt;As mentioned when discussing side notes, this theme aims to be fully responsive. Responsive means more than just making it work on mobile—it means making the most of the available space on both small and large screens.&lt;/p&gt;
&lt;p&gt;To help you make the most of the available space, this theme provides three utility classes to declare how much extra space to use up when available:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;.wide&lt;/code&gt;
&lt;ul&gt;
&lt;li&gt;On smaller screens, sets &lt;code&gt;overflow-x: scroll&lt;/code&gt;.&lt;/li&gt;
&lt;li&gt;Takes up to &lt;code&gt;--main-width&lt;/code&gt; space,&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle" for="sn-2"&gt;⊕&lt;/label&gt;&lt;input class="margin-toggle" id="sn-2" type="checkbox"/&gt;&lt;span class="marginnote"&gt;The &lt;code&gt;--main-width&lt;/code&gt; CSS variable defaults to 745px.&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt; potentially expanding into the margin to do so. For example: when the browser takes up half of a 1920x1080 screen.&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;.wide.extra-wide&lt;/code&gt;
&lt;ul&gt;
&lt;li&gt;From &lt;code&gt;.wide&lt;/code&gt;: on smaller screens, sets &lt;code&gt;overflow-x: scroll&lt;/code&gt;.&lt;/li&gt;
&lt;li&gt;Takes up to &lt;code&gt;1.5 * --main-width&lt;/code&gt; space,&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle" for="sn-3"&gt;⊕&lt;/label&gt;&lt;input class="margin-toggle" id="sn-3" type="checkbox"/&gt;&lt;span class="marginnote"&gt;This multiple is configurable with &lt;code&gt;--extra-wide-scale-factor&lt;/code&gt;.&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt; potentially expanding into the margin to do so.&lt;/li&gt;
&lt;li&gt;If the right margin is not collapsed, the content will expand equally into both margins and be centered.&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;.wide.full-width&lt;/code&gt;
&lt;ul&gt;
&lt;li&gt;From &lt;code&gt;.wide&lt;/code&gt;: on smaller screens, sets &lt;code&gt;overflow-x: scroll&lt;/code&gt;.&lt;/li&gt;
&lt;li&gt;Take up all available space, expanding into all margins.&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;(Note that &lt;code&gt;extra-wide&lt;/code&gt; and &lt;code&gt;full-width&lt;/code&gt; only work in conjunction with &lt;code&gt;.wide&lt;/code&gt;.)&lt;/p&gt;
&lt;p&gt;These classes work with images, tables, code blocks, and math. Here are some examples:&lt;/p&gt;
&lt;div class="wide extra-wide"&gt;
&lt;table&gt;
&lt;colgroup&gt;
&lt;col style="width: 12%"/&gt;
&lt;col style="width: 12%"/&gt;
&lt;col style="width: 12%"/&gt;
&lt;col style="width: 12%"/&gt;
&lt;col style="width: 12%"/&gt;
&lt;col style="width: 12%"/&gt;
&lt;col style="width: 12%"/&gt;
&lt;col style="width: 12%"/&gt;
&lt;/colgroup&gt;
&lt;thead&gt;
&lt;tr class="header"&gt;
&lt;th&gt;&lt;strong&gt;Column 1&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;Column 2&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;Column 3&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;Column 4&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;Column 5&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;Column 6&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;Column 7&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;Column 8&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class="odd"&gt;
&lt;td&gt;This is some text.&lt;/td&gt;
&lt;td&gt;This is some text.&lt;/td&gt;
&lt;td&gt;This is some text.&lt;/td&gt;
&lt;td&gt;This is some text.&lt;/td&gt;
&lt;td&gt;This is some text.&lt;/td&gt;
&lt;td&gt;This is some text.&lt;/td&gt;
&lt;td&gt;This is some text.&lt;/td&gt;
&lt;td&gt;This is some text.&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="even"&gt;
&lt;td&gt;This is some text.&lt;/td&gt;
&lt;td&gt;This is some text.&lt;/td&gt;
&lt;td&gt;This is some text.&lt;/td&gt;
&lt;td&gt;This is some text.&lt;/td&gt;
&lt;td&gt;This is some text.&lt;/td&gt;
&lt;td&gt;This is some text.&lt;/td&gt;
&lt;td&gt;This is some text.&lt;/td&gt;
&lt;td&gt;This is some text.&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;div class="wide full-width left-align-caption"&gt;
&lt;figure&gt;
&lt;img alt="Upper Crystal Springs Reservoir, near Belmont, CA" src="https://docs.github.com/assets/cb-22366/mw-1440/images/help/discussions/public-repo-settings.webp"/&gt;
&lt;figcaption aria-hidden="true"&gt;Upper Crystal Springs Reservoir, near Belmont, CA&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;/div&gt;
&lt;figure class="wide extra-wide"&gt;
&lt;span class="math display"&gt;
      \frac{\quad}{\Delta \, \Gamma , x \, : \, \tau \vdash x \, : \, \tau} \;
      (16.2a)
      \quad \frac{\Delta \vdash \tau_1 \, \textsf{type} \quad \Delta \, \Gamma , x \, : \, \tau_1 \vdash e \, : \, \tau_2}{\Delta \, \Gamma \vdash \texttt{lam}\{\tau_1\}(x.e) \, : \, \texttt{arr}(\tau_1; \tau_2)} \; (16.2b)
      \quad \frac{\Delta \, \Gamma \vdash e_1 \, : \, \texttt{arr}(\tau_2 ; \tau) \quad \Delta \, \Gamma \vdash e_2 \, : \, \tau_2}{\Delta \, \Gamma \vdash \texttt{ap}(e_1 ; e_2) \, : \, \tau} \; (16.2c) \\
       \, \\
      \quad \frac{\Delta, t \, \textsf{type} \, \Gamma \vdash e \, : \, \tau}{\Delta \, \Gamma \vdash \texttt{Lam}(t.e) \, : \, \texttt{all}(t.\tau)} \; (16.2d)
      \quad \frac{\Delta \, \Gamma \vdash e \, : \, \texttt{all}(t.\tau') \quad \Delta \vdash \tau \, \textsf{type}}{\Delta \, \Gamma \vdash \texttt{App}\{\tau\}(e) \, : \, [\tau / t]\tau'} \; (16.2e)
    &lt;/span&gt;
&lt;figcaption&gt;
    Typing rules for System F, From PFPL Chapter 16
    &lt;/figcaption&gt;
&lt;/figure&gt;
&lt;div class="wide"&gt;
&lt;div class="sourceCode" id="cb24"&gt;&lt;pre class="sourceCode numberSource yaml numberLines hl-4"&gt;&lt;code class="sourceCode yaml"&gt;&lt;span id="cb24-1"&gt;&lt;a href="#cb24-1"&gt;&lt;/a&gt;&lt;span class="pp"&gt;---&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb24-2"&gt;&lt;a href="#cb24-2"&gt;&lt;/a&gt;&lt;span class="co"&gt;# ...&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb24-3"&gt;&lt;a href="#cb24-3"&gt;&lt;/a&gt;&lt;span class="fu"&gt;header-includes&lt;/span&gt;&lt;span class="kw"&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb24-4"&gt;&lt;a href="#cb24-4"&gt;&lt;/a&gt;&lt;span class="kw"&gt;-&lt;/span&gt;&lt;span class="at"&gt; &lt;/span&gt;&lt;span class="st"&gt;'&amp;lt;style&amp;gt;pre.hl-41 &amp;gt; code.sourceCode &amp;gt; span:nth-of-type(41)::after { content: ""; }&amp;lt;/style&amp;gt;'&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb24-5"&gt;&lt;a href="#cb24-5"&gt;&lt;/a&gt;&lt;span class="pp"&gt;---&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;(There is currently a bug where using &lt;code&gt;.wide&lt;/code&gt; with &lt;code&gt;.numberLines&lt;/code&gt; code blocks causes the line numbers to be hidden. They are still highlightable and linkable.)&lt;/p&gt;
&lt;p&gt;There are two supported syntaxes for marking things wide:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Using Pandoc’s &lt;code&gt;fenced_divs&lt;/code&gt; feature.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;:::{.wide}
&amp;lt;!-- ... content ... --&amp;gt;
:::&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;This is convenient when not using captions, or when using the special-purpose caption syntax for images and tables.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Using a raw &lt;code&gt;&amp;lt;figure&amp;gt;&lt;/code&gt; tag.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;figure class="wide"&amp;gt;
&amp;lt;!-- ... content ... --&amp;gt;
&amp;lt;figcaption&amp;gt; ... &amp;lt;/figcaption&amp;gt;
&amp;lt;/figure&amp;gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Code blocks and display-mode math don’t have special syntax for adding captions, so this is the only option then.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;On large screens, the captions will generally be center aligned. This can look strange, especially for captions whose text wraps onto multiple lines. To avoid centering captions, add the &lt;code&gt;.left-align-caption&lt;/code&gt;.&lt;/p&gt;
&lt;div class="note blue"&gt;
&lt;table&gt;
&lt;colgroup&gt;
&lt;col style="width: 100%"/&gt;
&lt;/colgroup&gt;
&lt;tbody&gt;
&lt;tr class="odd"&gt;
&lt;td&gt;ℹ️ You probably want to wrap all math and tables in &lt;code&gt;.wide&lt;/code&gt; unless they’re less than ~300px. It will never display wider than the main body, but the &lt;code&gt;overflow-x&lt;/code&gt; property on &lt;code&gt;.wide&lt;/code&gt; ensures that it scrolls just the figure, not the whole page body.&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;h1 id="colored-note-callouts"&gt;Colored note callouts&lt;/h1&gt;
&lt;p&gt;As you just saw, an extra feature of this theme is colored note callouts. The syntax takes advantage of Pandoc’s &lt;code&gt;fenced_divs&lt;/code&gt; feature:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;:::{.note .blue}
|     |
| --- |
| ℹ️ This is a note. |
:::&lt;/code&gt;&lt;/pre&gt;
&lt;div class="note blue"&gt;
&lt;table&gt;
&lt;tbody&gt;
&lt;tr class="odd"&gt;
&lt;td&gt;ℹ️ This is a note.&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;p&gt;Right now, notes are implemented in terms of HTML tables. This may change in the future.&lt;/p&gt;
&lt;p&gt;There are five colors total. The other colors:&lt;/p&gt;
&lt;div class="note red"&gt;
&lt;table&gt;
&lt;tbody&gt;
&lt;tr class="odd"&gt;
&lt;td&gt;🛑 Don’t do it!&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;div class="note yellow"&gt;
&lt;table&gt;
&lt;tbody&gt;
&lt;tr class="odd"&gt;
&lt;td&gt;☢️ Warning!&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;div class="note green"&gt;
&lt;table&gt;
&lt;tbody&gt;
&lt;tr class="odd"&gt;
&lt;td&gt;✅ Nice job!&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;div class="note purple"&gt;
&lt;table&gt;
&lt;tbody&gt;
&lt;tr class="odd"&gt;
&lt;td&gt;🔮 Can you see the future?&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;p&gt;In addition to full-width block callouts, there are also inline highlights, in the same colors: &lt;mark class="red"&gt;red&lt;/mark&gt;, &lt;mark class="yellow"&gt;yellow&lt;/mark&gt;, &lt;mark class="green"&gt;green&lt;/mark&gt;, &lt;mark class="blue"&gt;blue&lt;/mark&gt;, &lt;mark class="purple"&gt;purple&lt;/mark&gt;.&lt;/p&gt;
&lt;p&gt;These accent colors are configurable with CSS variables.&lt;/p&gt;
&lt;h1 id="table-of-contents"&gt;Table of contents&lt;/h1&gt;
&lt;p&gt;As you might have noticed, there’s an autogenerated table of contents! On large screens, it floats to the right margin. On narrower screens, it collapses into the document header.&lt;/p&gt;
&lt;p&gt;This is powered by Pandoc’s built in &lt;code&gt;--toc&lt;/code&gt; flag. See where this project passes it to the &lt;code&gt;pandoc&lt;/code&gt; invocation &lt;a href="https://github.com/jez/pandoc-markdown-css-theme/blob/27d0aa58bfc6eafe296e2cef1900a39c9c2507a7/tools/build.sh#L62"&gt;here&lt;/a&gt;.&lt;/p&gt;
&lt;h1 id="tweaking-the-css-variables"&gt;Tweaking the CSS variables&lt;/h1&gt;
&lt;p&gt;As mentioned multiple times above, this theme is very configurable. See &lt;a href="https://github.com/jez/pandoc-markdown-css-theme/blob/27d0aa58bfc6eafe296e2cef1900a39c9c2507a7/public/css/theme.css#L2"&gt;theme.css&lt;/a&gt; for the full list of CSS variables. They control things like&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Font colors&lt;/li&gt;
&lt;li&gt;Accent colors&lt;/li&gt;
&lt;li&gt;Table borders and header colors&lt;/li&gt;
&lt;li&gt;Font family&lt;/li&gt;
&lt;li&gt;Font sizes, including body copy, code, and headings&lt;/li&gt;
&lt;li&gt;Side note text sizes and alignment&lt;/li&gt;
&lt;li&gt;The main width, including at narrow screen sizes.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;As an example, see the &lt;a href="../tufte/"&gt;Kitchen Sink Tufte&lt;/a&gt; page, which tweaks these CSS variables to approximate the look of &lt;a href="https://edwardtufte.github.io/tufte-css/"&gt;Tufte CSS&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;It’s also easy to change the syntax theme used for code highlights, because it lives in a separate file. The default theme is Solarized Light, which can be found in &lt;a href="https://github.com/jez/pandoc-markdown-css-theme/blob/27d0aa58bfc6eafe296e2cef1900a39c9c2507a7/public/css/skylighting-solarized-theme.css#L1"&gt;skylighting-solarized-theme.css&lt;/a&gt;.&lt;/p&gt;
&lt;h1 id="automatic-light-and-dark-theme"&gt;Automatic light and dark theme&lt;/h1&gt;
&lt;p&gt;Pages will automatically choose light mode or dark mode styles based on the user’s preferences, detected via CSS &lt;code&gt;@media&lt;/code&gt; queries.&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-4"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-4" type="checkbox"/&gt;&lt;span class="sidenote"&gt;At the moment, this means there is no way to programmatically toggle between light and dark mode except by toggling the OS or browser’s setting.&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;You can also use the &lt;code&gt;.only-light-mode&lt;/code&gt; and &lt;code&gt;.only-dark-mode&lt;/code&gt; CSS classes to make something appear only in light or dark mode. One use case for this is with images. For example, here’s some Pandoc markdown using &lt;a href="https://pandoc.org/MANUAL.html#extension-fenced_divs"&gt;&lt;code&gt;fenced_divs&lt;/code&gt;&lt;/a&gt; that shows a light or dark mode version of an image:&lt;/p&gt;
&lt;div class="sourceCode" id="cb28"&gt;&lt;pre class="sourceCode numberSource markdown numberLines hl-1 hl-5"&gt;&lt;code class="sourceCode markdown"&gt;&lt;span id="cb28-1"&gt;&lt;a href="#cb28-1"&gt;&lt;/a&gt;:::{.only-light-mode}&lt;/span&gt;
&lt;span id="cb28-2"&gt;&lt;a href="#cb28-2"&gt;&lt;/a&gt;&lt;span class="al"&gt;![The light-mode version of the image](../img/light-desktop.png)&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb28-3"&gt;&lt;a href="#cb28-3"&gt;&lt;/a&gt;:::&lt;/span&gt;
&lt;span id="cb28-4"&gt;&lt;a href="#cb28-4"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb28-5"&gt;&lt;a href="#cb28-5"&gt;&lt;/a&gt;:::{.only-dark-mode}&lt;/span&gt;
&lt;span id="cb28-6"&gt;&lt;a href="#cb28-6"&gt;&lt;/a&gt;&lt;span class="al"&gt;![The dark-mode version of the image](../img/dark-desktop.png)&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb28-7"&gt;&lt;a href="#cb28-7"&gt;&lt;/a&gt;:::&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Only one of those divs will be rendered, depending on which theme is active. You can see the result below, and you can toggle your light or dark mode theme to see how the image updates:&lt;/p&gt;
&lt;div class="only-light-mode"&gt;
&lt;figure&gt;
&lt;img alt="The light-mode version of the image" src="../img/light-desktop.png"/&gt;
&lt;figcaption aria-hidden="true"&gt;The light-mode version of the image&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;/div&gt;
&lt;div class="only-dark-mode"&gt;
&lt;figure&gt;
&lt;img alt="The dark-mode version of the image" src="../img/dark-desktop.png"/&gt;
&lt;figcaption aria-hidden="true"&gt;The dark-mode version of the image&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;/div&gt;
&lt;pre class="gpg"&gt;&lt;code&gt;-----BEGIN PGP MESSAGE-----

jA0ECQMCPqkzW25xRi7/0ukBiR+8M1Q2/xMKMRY3abKJMvNEdu5ltkUDOdldDr6H
GpOGL5/zQZcimxyRZ9EbN4QjXHSomxPuaNyTzNzTSYTCfQbqd4dAZRpa3Hw91PnQ
8P13AGBKc+8ta0H3PJ0Mffk6gVgFxkvN+ZEFbhCJ0nWTGkW0E/vXFAC0PrUOZvwf
EUpZnrnmaTDDZvDg4ZKNP4IMpCP1gIQcdtjxfqrENy3+qE7mxun8Q1UrlfuNwyub
ln9NIS/8xpYdy1EuGh/Kv6n2fCuTSWJhUkMuse3LfF3pg0EINEfWxZ8QYsJ8uN15
E0hjKZuy5DT2D/z+MVVdjXwk8FxrkuWYKm8Sik940LmRIY6xMMaKdAK0OubQTzUl
8CqJS1SoeQS3S4Osd/M2/RTjccR4ZbmrrFQgwLwUwVPdwv6LhYqfxcwB8RO1GGN2
LopgEwSeELRUJQiitThq5JpIoiaCrQz40fpYD6EKcWEbE2RW2nCy7JuLXUfM0LVJ
SSVnJ+6s4PQ+0CvmCS2frpdhZfnBRlLVReW69Mmy/sg661bBVV9uh8xwqcTkSJJ1
tzayiEpi3JvBWiBvnaI5asKz52vAyfdJBt0soDeAXsovge2wLoSECCYXSajmSjSB
RR5P/Mngv3wIxWomL7rqa2JggLCI8rJQWi75nkSExexsqO2Fh4cQIKmG4uiqgW/o
E1cYREuQLTTL5fZ04VL7KSh9WMCcCnXiUU+8ipUVCAZy1aBXl9hQ4/fmRVgUo2Ks
VfLEnGuZ3yDtNjCsuGReKNNx4OCjKbp/UobOuO+NHhqJfoe6wRHOIbw=
=6dpw
-----END PGP MESSAGE-----&lt;/code&gt;&lt;/pre&gt;
&lt;h1 id="print-styles"&gt;Print styles&lt;/h1&gt;
&lt;p&gt;As a reminder, this theme has custom print styles for U.S. Letter size paper. The print styles look similar to a somewhat narrow desktop screen, with enough room for a right margin with sidenotes, but not quite enough width to support the full 745px that the main body would normally take up. There is no large left margin, so the table of contents is shown at the top of the page (expanded).&lt;/p&gt;
&lt;p&gt;If print styles matter to you, take care to make sure that things don’t wrap. Some things like tables or math that would normally overflow and scroll on a screen will be clipped when printed. Always test your content before publishing.&lt;/p&gt;
&lt;p&gt;Feel free to test on this page. The tables and math are wide enough to demonstrate the problems.&lt;/p&gt;
&lt;p&gt;Most browsers will offer the user a choice of whether to include background colors or not. Things like code block backgrounds and table header backgrounds won’t show up unless the browser’s “Print backgrounds” option (or equivalent) is checked.&lt;/p&gt;
&lt;br/&gt;
&lt;h2&gt;参考链接&lt;/h2&gt;
&lt;ul id="reference"&gt;
&lt;li&gt;&lt;a href="www.example_1.com" target="_blank"&gt;&lt;strong&gt;第一个参考链接&lt;/strong&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="www.example_2.com" target="_blank"&gt;&lt;strong&gt;第二个参考链接&lt;/strong&gt;&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;br/&gt;
&lt;script async="" crossorigin="anonymous" data-category="Announcements" data-category-id="DIC_kwDOJ7Ymy84CX4eg" data-emit-metadata="0" data-input-position="top" data-lang="zh-CN" data-loading="lazy" data-mapping="title" data-reactions-enabled="1" data-repo="izfsk-ium/izfsk-ium.github.io" data-repo-id="R_kgDOJ7Ymyw" data-strict="0" data-theme="preferred_color_scheme" src="https://giscus.app/client.js"&gt;
&lt;/script&gt;
&lt;/main&gt;
&lt;footer&gt;
&lt;p class="signoff"&gt;
&lt;div class="metadata"&gt;
&lt;p class="date"&gt;&lt;time datetime="1980-01-01"&gt;创建日期：1980-01-01&lt;/time&gt;&lt;/p&gt;
&lt;p class="lastmodify"&gt;&lt;time&gt;最后编译：2023-08-10&lt;/time&gt;&lt;/p&gt;
&lt;p class="lastmodify" id="counter-span"&gt;访问次数：&lt;/p&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;/footer&gt;
&lt;script&gt;
    /* These script should run after page load */
    document.querySelectorAll('code.sourceCode').forEach(
      i =&gt; i.insertAdjacentHTML('beforeend', '&lt;div class="copy"&gt;复制&lt;/div&gt;')
    );
    document.querySelectorAll('div.copy').forEach(
      i =&gt; i.addEventListener(
        'click',
        () =&gt; {
          navigator.clipboard.writeText(i.parentElement.innerText.replace('复制', ''));
          i.innerText = '成功';
          setTimeout(() =&gt; {
            i.innerText = '复制';
          }, 1000);
        }
      )
    );

    if (location.href.includes("127.0.0.1:8080")) {
      document.getElementById("counter-span").innerHTML = "[[development mode]]";
    } else {
      const uuid = document.getElementById("article-uuid").innerText;
      const target = document.getElementById("counter-span");
      const last = localStorage.getItem("lastVisit-" + uuid);
      const shouldIncrease = last === null || new Date().getTime() - parseInt(last) &gt;= (1000 * 60 * 15);

      fetch(shouldIncrease ? ("https://counter.izfsk.top/counter/" + uuid) : ("https://counter.izfsk.top/readOnly/" + uuid))
        .then(r =&gt; r.text())
        .then(d =&gt; {
          if (!d.startsWith("Too"))
            document.getElementById("counter-span").innerText = "访问次数：" + d.toString();
          else
            document.getElementById("counter-span").innerHTML = "";
        });

      localStorage.setItem("lastVisit-" + uuid, new Date().getTime());
    }
  &lt;/script&gt;
&lt;script async="" data-website-id="2a1146ab-fa82-4a84-a04f-30e5967357c3" src="https://analytics.umami.is/script.js"&gt;&lt;/script&gt;
&lt;/body&gt;</content:encoded>
      <guid isPermaLink="false">87b181b2-202e-11ee-b1e5-84a93896bec6</guid>
      <pubDate>Tue, 01 Jan 1980 00:00:00 +0800</pubDate>
    </item>
    <item>
      <title>经典数据结构・单向链表</title>
      <link>https://blog.izfsk.top/articles/经典数据结构・单向链表.html</link>
      <description>经典数据结构・单向链表</description>
      <content:encoded>&lt;body&gt;
&lt;progress id="content_progress" value="0"&gt;&lt;/progress&gt;
&lt;button id="back-to-top"&gt;
    回页顶
  &lt;/button&gt;
&lt;header&gt;
&lt;small id="article-uuid" style="display: none !important;"&gt;5d2a083c-a623-460a-9cfc-77666376e598&lt;/small&gt;
&lt;h1 class="title"&gt;经典数据结构・单向链表&lt;/h1&gt;
&lt;!-- Subtitle --&gt;
&lt;h3 class="subtitle"&gt; &lt;/h3&gt;
&lt;/header&gt;
&lt;nav id="TOC" role="doc-toc"&gt;
&lt;strong&gt;文章归类: &lt;a href="/pages/category.html#学习"&gt;学习&lt;/a&gt; &lt;/strong&gt;
&lt;input id="contents" type="checkbox"/&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#定义" id="toc-定义"&gt;定义&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#实现" id="toc-实现"&gt;实现&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#检测链表是否为空" id="toc-检测链表是否为空"&gt;检测链表是否为空&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#检验是否是最后一个元素" id="toc-检验是否是最后一个元素"&gt;检验是否是最后一个元素&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#寻找元素" id="toc-寻找元素"&gt;寻找元素&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#删除元素" id="toc-删除元素"&gt;删除元素&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#插入元素" id="toc-插入元素"&gt;插入元素&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#清空链表" id="toc-清空链表"&gt;清空链表&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#创建链表头" id="toc-创建链表头"&gt;创建链表头&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#测试例" id="toc-测试例"&gt;测试例&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#reference"&gt;参考链接&lt;/a&gt;&lt;/li&gt;
&lt;li&gt; &lt;/li&gt;
&lt;li class="tools"&gt;
&lt;span id="backtomain"&gt;
&lt;svg class="bi bi-house" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M8.707 1.5a1 1 0 0 0-1.414 0L.646 8.146a.5.5 0 0 0 .708.708L2 8.207V13.5A1.5 1.5 0 0 0 3.5 15h9a1.5 1.5 0 0 0 1.5-1.5V8.207l.646.647a.5.5 0 0 0 .708-.708L13 5.793V2.5a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v1.293L8.707 1.5ZM13 7.207V13.5a.5.5 0 0 1-.5.5h-9a.5.5 0 0 1-.5-.5V7.207l5-5 5 5Z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="readingmode"&gt;
&lt;svg class="bi bi-book" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M1 2.828c.885-.37 2.154-.769 3.388-.893 1.33-.134 2.458.063 3.112.752v9.746c-.935-.53-2.12-.603-3.213-.493-1.18.12-2.37.461-3.287.811V2.828zm7.5-.141c.654-.689 1.782-.886 3.112-.752 1.234.124 2.503.523 3.388.893v9.923c-.918-.35-2.107-.692-3.287-.81-1.094-.111-2.278-.039-3.213.492V2.687zM8 1.783C7.015.936 5.587.81 4.287.94c-1.514.153-3.042.672-3.994 1.105A.5.5 0 0 0 0 2.5v11a.5.5 0 0 0 .707.455c.882-.4 2.303-.881 3.68-1.02 1.409-.142 2.59.087 3.223.877a.5.5 0 0 0 .78 0c.633-.79 1.814-1.019 3.222-.877 1.378.139 2.8.62 3.681 1.02A.5.5 0 0 0 16 13.5v-11a.5.5 0 0 0-.293-.455c-.952-.433-2.48-.952-3.994-1.105C10.413.809 8.985.936 8 1.783z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="larger"&gt; &lt;/span&gt;
&lt;span id="smaller"&gt;&lt;/span&gt;
&lt;span id="switchfont"&gt;
&lt;svg class="bi bi-fonts" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M12.258 3h-8.51l-.083 2.46h.479c.26-1.544.758-1.783 2.693-1.845l.424-.013v7.827c0 .663-.144.82-1.3.923v.52h4.082v-.52c-1.162-.103-1.306-.26-1.306-.923V3.602l.431.013c1.934.062 2.434.301 2.693 1.846h.479L12.258 3z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="backtotop"&gt;
&lt;svg class="bi bi-arrow-bar-up" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M8 10a.5.5 0 0 0 .5-.5V3.707l2.146 2.147a.5.5 0 0 0 .708-.708l-3-3a.5.5 0 0 0-.708 0l-3 3a.5.5 0 1 0 .708.708L7.5 3.707V9.5a.5.5 0 0 0 .5.5zm-7 2.5a.5.5 0 0 1 .5-.5h13a.5.5 0 0 1 0 1h-13a.5.5 0 0 1-.5-.5z" fill-rule="evenodd"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/nav&gt;
&lt;main&gt;
&lt;h1 id="定义"&gt;定义&lt;/h1&gt;
&lt;p&gt;In order to avoid the linear cost of insertion and deletion, we need to ensure that the list is not stored contiguously.&lt;/p&gt;
&lt;p&gt;The linked list consists of a series of structures, each of them contains the element and a pointer to a structure containing its successor.&lt;/p&gt;
&lt;p&gt;头文件：&lt;/p&gt;
&lt;div class="sourceCode" id="cb1"&gt;&lt;pre class="sourceCode c"&gt;&lt;code class="sourceCode c"&gt;&lt;span id="cb1-1"&gt;&lt;a aria-hidden="true" href="#cb1-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="pp"&gt;#ifndef _LINKED_LIST_H&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-2"&gt;&lt;a aria-hidden="true" href="#cb1-2" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="pp"&gt;#define _LINKED_LIST_H&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-3"&gt;&lt;a aria-hidden="true" href="#cb1-3" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb1-4"&gt;&lt;a aria-hidden="true" href="#cb1-4" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="pp"&gt;#include &lt;/span&gt;&lt;span class="im"&gt;&amp;lt;assert.h&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-5"&gt;&lt;a aria-hidden="true" href="#cb1-5" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="pp"&gt;#include &lt;/span&gt;&lt;span class="im"&gt;&amp;lt;inttypes.h&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-6"&gt;&lt;a aria-hidden="true" href="#cb1-6" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="pp"&gt;#include &lt;/span&gt;&lt;span class="im"&gt;&amp;lt;stdio.h&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-7"&gt;&lt;a aria-hidden="true" href="#cb1-7" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="pp"&gt;#include &lt;/span&gt;&lt;span class="im"&gt;&amp;lt;stdlib.h&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-8"&gt;&lt;a aria-hidden="true" href="#cb1-8" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb1-9"&gt;&lt;a aria-hidden="true" href="#cb1-9" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="pp"&gt;#define element_type &lt;/span&gt;&lt;span class="dt"&gt;int64_t&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-10"&gt;&lt;a aria-hidden="true" href="#cb1-10" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb1-11"&gt;&lt;a aria-hidden="true" href="#cb1-11" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;struct&lt;/span&gt; node&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-12"&gt;&lt;a aria-hidden="true" href="#cb1-12" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;typedef&lt;/span&gt; &lt;span class="kw"&gt;struct&lt;/span&gt; node &lt;span class="op"&gt;*&lt;/span&gt;list&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-13"&gt;&lt;a aria-hidden="true" href="#cb1-13" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;typedef&lt;/span&gt; &lt;span class="kw"&gt;struct&lt;/span&gt; node &lt;span class="op"&gt;*&lt;/span&gt;position&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-14"&gt;&lt;a aria-hidden="true" href="#cb1-14" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb1-15"&gt;&lt;a aria-hidden="true" href="#cb1-15" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;typedef&lt;/span&gt; &lt;span class="kw"&gt;struct&lt;/span&gt; node &lt;span class="op"&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-16"&gt;&lt;a aria-hidden="true" href="#cb1-16" tabindex="-1"&gt;&lt;/a&gt;  element_type element&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-17"&gt;&lt;a aria-hidden="true" href="#cb1-17" tabindex="-1"&gt;&lt;/a&gt;  &lt;span class="kw"&gt;struct&lt;/span&gt; node &lt;span class="op"&gt;*&lt;/span&gt;next&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-18"&gt;&lt;a aria-hidden="true" href="#cb1-18" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="op"&gt;}&lt;/span&gt; node&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-19"&gt;&lt;a aria-hidden="true" href="#cb1-19" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb1-20"&gt;&lt;a aria-hidden="true" href="#cb1-20" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="dt"&gt;int&lt;/span&gt; is_empty&lt;span class="op"&gt;(&lt;/span&gt;list&lt;span class="op"&gt;);&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-21"&gt;&lt;a aria-hidden="true" href="#cb1-21" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="dt"&gt;int&lt;/span&gt; is_last&lt;span class="op"&gt;(&lt;/span&gt;position&lt;span class="op"&gt;,&lt;/span&gt; list&lt;span class="op"&gt;);&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-22"&gt;&lt;a aria-hidden="true" href="#cb1-22" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb1-23"&gt;&lt;a aria-hidden="true" href="#cb1-23" tabindex="-1"&gt;&lt;/a&gt;position find_element&lt;span class="op"&gt;(&lt;/span&gt;element_type&lt;span class="op"&gt;,&lt;/span&gt; list&lt;span class="op"&gt;);&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-24"&gt;&lt;a aria-hidden="true" href="#cb1-24" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="dt"&gt;void&lt;/span&gt; delete_element&lt;span class="op"&gt;(&lt;/span&gt;element_type&lt;span class="op"&gt;,&lt;/span&gt; list&lt;span class="op"&gt;);&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-25"&gt;&lt;a aria-hidden="true" href="#cb1-25" tabindex="-1"&gt;&lt;/a&gt;position insert_element&lt;span class="op"&gt;(&lt;/span&gt;element_type&lt;span class="op"&gt;,&lt;/span&gt; position&lt;span class="op"&gt;);&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-26"&gt;&lt;a aria-hidden="true" href="#cb1-26" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb1-27"&gt;&lt;a aria-hidden="true" href="#cb1-27" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="dt"&gt;size_t&lt;/span&gt; delete_list&lt;span class="op"&gt;(&lt;/span&gt;list&lt;span class="op"&gt;);&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-28"&gt;&lt;a aria-hidden="true" href="#cb1-28" tabindex="-1"&gt;&lt;/a&gt;list init_list&lt;span class="op"&gt;(&lt;/span&gt;element_type&lt;span class="op"&gt;);&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-29"&gt;&lt;a aria-hidden="true" href="#cb1-29" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb1-30"&gt;&lt;a aria-hidden="true" href="#cb1-30" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="pp"&gt;#endif&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h1 id="实现"&gt;实现&lt;/h1&gt;
&lt;h2 id="检测链表是否为空"&gt;检测链表是否为空&lt;/h2&gt;
&lt;div class="sourceCode" id="cb2"&gt;&lt;pre class="sourceCode c"&gt;&lt;code class="sourceCode c"&gt;&lt;span id="cb2-1"&gt;&lt;a aria-hidden="true" href="#cb2-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="co"&gt;/* return 1 if list l is empty */&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-2"&gt;&lt;a aria-hidden="true" href="#cb2-2" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="dt"&gt;int&lt;/span&gt; is_empty&lt;span class="op"&gt;(&lt;/span&gt;list l&lt;span class="op"&gt;)&lt;/span&gt; &lt;span class="op"&gt;{&lt;/span&gt; &lt;span class="cf"&gt;return&lt;/span&gt; l&lt;span class="op"&gt;-&amp;gt;&lt;/span&gt;next &lt;span class="op"&gt;==&lt;/span&gt; NULL&lt;span class="op"&gt;;&lt;/span&gt; &lt;span class="op"&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id="检验是否是最后一个元素"&gt;检验是否是最后一个元素&lt;/h2&gt;
&lt;div class="sourceCode" id="cb3"&gt;&lt;pre class="sourceCode c"&gt;&lt;code class="sourceCode c"&gt;&lt;span id="cb3-1"&gt;&lt;a aria-hidden="true" href="#cb3-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="co"&gt;/* return 1 if position p is the last element in list */&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb3-2"&gt;&lt;a aria-hidden="true" href="#cb3-2" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="dt"&gt;int&lt;/span&gt; is_last&lt;span class="op"&gt;(&lt;/span&gt;position p&lt;span class="op"&gt;,&lt;/span&gt; list l&lt;span class="op"&gt;)&lt;/span&gt; &lt;span class="op"&gt;{&lt;/span&gt; &lt;span class="cf"&gt;return&lt;/span&gt; p&lt;span class="op"&gt;-&amp;gt;&lt;/span&gt;next &lt;span class="op"&gt;==&lt;/span&gt; NULL&lt;span class="op"&gt;;&lt;/span&gt; &lt;span class="op"&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id="寻找元素"&gt;寻找元素&lt;/h2&gt;
&lt;p&gt;寻找第一个匹配元素的位置，返回 &lt;code&gt;NULL&lt;/code&gt; 如果没有找到。&lt;/p&gt;
&lt;div class="sourceCode" id="cb4"&gt;&lt;pre class="sourceCode c"&gt;&lt;code class="sourceCode c"&gt;&lt;span id="cb4-1"&gt;&lt;a aria-hidden="true" href="#cb4-1" tabindex="-1"&gt;&lt;/a&gt;position find_element&lt;span class="op"&gt;(&lt;/span&gt;element_type element&lt;span class="op"&gt;,&lt;/span&gt; list l&lt;span class="op"&gt;)&lt;/span&gt; &lt;span class="op"&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb4-2"&gt;&lt;a aria-hidden="true" href="#cb4-2" tabindex="-1"&gt;&lt;/a&gt;  position p &lt;span class="op"&gt;=&lt;/span&gt; l&lt;span class="op"&gt;-&amp;gt;&lt;/span&gt;next&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb4-3"&gt;&lt;a aria-hidden="true" href="#cb4-3" tabindex="-1"&gt;&lt;/a&gt;  &lt;span class="cf"&gt;while&lt;/span&gt; &lt;span class="op"&gt;(&lt;/span&gt;p &lt;span class="op"&gt;!=&lt;/span&gt; NULL &lt;span class="op"&gt;&amp;amp;&amp;amp;&lt;/span&gt; p&lt;span class="op"&gt;-&amp;gt;&lt;/span&gt;element &lt;span class="op"&gt;!=&lt;/span&gt; element&lt;span class="op"&gt;)&lt;/span&gt; &lt;span class="op"&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb4-4"&gt;&lt;a aria-hidden="true" href="#cb4-4" tabindex="-1"&gt;&lt;/a&gt;    p &lt;span class="op"&gt;=&lt;/span&gt; p&lt;span class="op"&gt;-&amp;gt;&lt;/span&gt;next&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb4-5"&gt;&lt;a aria-hidden="true" href="#cb4-5" tabindex="-1"&gt;&lt;/a&gt;  &lt;span class="op"&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb4-6"&gt;&lt;a aria-hidden="true" href="#cb4-6" tabindex="-1"&gt;&lt;/a&gt;  &lt;span class="cf"&gt;return&lt;/span&gt; p&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb4-7"&gt;&lt;a aria-hidden="true" href="#cb4-7" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="op"&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id="删除元素"&gt;删除元素&lt;/h2&gt;
&lt;p&gt;删除第一个匹配的元素，需要首先寻找到这个元素的前一个元素。&lt;/p&gt;
&lt;div class="sourceCode" id="cb5"&gt;&lt;pre class="sourceCode c"&gt;&lt;code class="sourceCode c"&gt;&lt;span id="cb5-1"&gt;&lt;a aria-hidden="true" href="#cb5-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="dt"&gt;void&lt;/span&gt; delete_element&lt;span class="op"&gt;(&lt;/span&gt;element_type element&lt;span class="op"&gt;,&lt;/span&gt; list l&lt;span class="op"&gt;)&lt;/span&gt; &lt;span class="op"&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb5-2"&gt;&lt;a aria-hidden="true" href="#cb5-2" tabindex="-1"&gt;&lt;/a&gt;  position p &lt;span class="op"&gt;=&lt;/span&gt; l&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb5-3"&gt;&lt;a aria-hidden="true" href="#cb5-3" tabindex="-1"&gt;&lt;/a&gt;  &lt;span class="cf"&gt;while&lt;/span&gt; &lt;span class="op"&gt;(&lt;/span&gt;p&lt;span class="op"&gt;-&amp;gt;&lt;/span&gt;next &lt;span class="op"&gt;!=&lt;/span&gt; NULL &lt;span class="op"&gt;&amp;amp;&amp;amp;&lt;/span&gt; p&lt;span class="op"&gt;-&amp;gt;&lt;/span&gt;next&lt;span class="op"&gt;-&amp;gt;&lt;/span&gt;element &lt;span class="op"&gt;!=&lt;/span&gt; element&lt;span class="op"&gt;)&lt;/span&gt; &lt;span class="op"&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb5-4"&gt;&lt;a aria-hidden="true" href="#cb5-4" tabindex="-1"&gt;&lt;/a&gt;    p &lt;span class="op"&gt;=&lt;/span&gt; p&lt;span class="op"&gt;-&amp;gt;&lt;/span&gt;next&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb5-5"&gt;&lt;a aria-hidden="true" href="#cb5-5" tabindex="-1"&gt;&lt;/a&gt;  &lt;span class="op"&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb5-6"&gt;&lt;a aria-hidden="true" href="#cb5-6" tabindex="-1"&gt;&lt;/a&gt;  &lt;span class="cf"&gt;if&lt;/span&gt; &lt;span class="op"&gt;(!&lt;/span&gt;is_last&lt;span class="op"&gt;(&lt;/span&gt;p&lt;span class="op"&gt;,&lt;/span&gt; l&lt;span class="op"&gt;))&lt;/span&gt; &lt;span class="op"&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb5-7"&gt;&lt;a aria-hidden="true" href="#cb5-7" tabindex="-1"&gt;&lt;/a&gt;    position tmp &lt;span class="op"&gt;=&lt;/span&gt; p&lt;span class="op"&gt;-&amp;gt;&lt;/span&gt;next&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb5-8"&gt;&lt;a aria-hidden="true" href="#cb5-8" tabindex="-1"&gt;&lt;/a&gt;    p&lt;span class="op"&gt;-&amp;gt;&lt;/span&gt;next &lt;span class="op"&gt;=&lt;/span&gt; tmp&lt;span class="op"&gt;-&amp;gt;&lt;/span&gt;next&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb5-9"&gt;&lt;a aria-hidden="true" href="#cb5-9" tabindex="-1"&gt;&lt;/a&gt;    free&lt;span class="op"&gt;(&lt;/span&gt;tmp&lt;span class="op"&gt;);&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb5-10"&gt;&lt;a aria-hidden="true" href="#cb5-10" tabindex="-1"&gt;&lt;/a&gt;  &lt;span class="op"&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb5-11"&gt;&lt;a aria-hidden="true" href="#cb5-11" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="op"&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id="插入元素"&gt;插入元素&lt;/h2&gt;
&lt;p&gt;在指定的位置插入元素&lt;/p&gt;
&lt;div class="sourceCode" id="cb6"&gt;&lt;pre class="sourceCode c"&gt;&lt;code class="sourceCode c"&gt;&lt;span id="cb6-1"&gt;&lt;a aria-hidden="true" href="#cb6-1" tabindex="-1"&gt;&lt;/a&gt;position insert_element&lt;span class="op"&gt;(&lt;/span&gt;element_type element&lt;span class="op"&gt;,&lt;/span&gt; position p&lt;span class="op"&gt;)&lt;/span&gt; &lt;span class="op"&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb6-2"&gt;&lt;a aria-hidden="true" href="#cb6-2" tabindex="-1"&gt;&lt;/a&gt;  position tmp &lt;span class="op"&gt;=&lt;/span&gt; malloc&lt;span class="op"&gt;(&lt;/span&gt;&lt;span class="kw"&gt;sizeof&lt;/span&gt;&lt;span class="op"&gt;(&lt;/span&gt;&lt;span class="kw"&gt;struct&lt;/span&gt; node&lt;span class="op"&gt;));&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb6-3"&gt;&lt;a aria-hidden="true" href="#cb6-3" tabindex="-1"&gt;&lt;/a&gt;  assert&lt;span class="op"&gt;(&lt;/span&gt;tmp &lt;span class="op"&gt;!=&lt;/span&gt; NULL&lt;span class="op"&gt;);&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb6-4"&gt;&lt;a aria-hidden="true" href="#cb6-4" tabindex="-1"&gt;&lt;/a&gt;  tmp&lt;span class="op"&gt;-&amp;gt;&lt;/span&gt;next &lt;span class="op"&gt;=&lt;/span&gt; p&lt;span class="op"&gt;-&amp;gt;&lt;/span&gt;next&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb6-5"&gt;&lt;a aria-hidden="true" href="#cb6-5" tabindex="-1"&gt;&lt;/a&gt;  tmp&lt;span class="op"&gt;-&amp;gt;&lt;/span&gt;element &lt;span class="op"&gt;=&lt;/span&gt; element&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb6-6"&gt;&lt;a aria-hidden="true" href="#cb6-6" tabindex="-1"&gt;&lt;/a&gt;  p&lt;span class="op"&gt;-&amp;gt;&lt;/span&gt;next &lt;span class="op"&gt;=&lt;/span&gt; tmp&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb6-7"&gt;&lt;a aria-hidden="true" href="#cb6-7" tabindex="-1"&gt;&lt;/a&gt;  &lt;span class="cf"&gt;return&lt;/span&gt; tmp&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb6-8"&gt;&lt;a aria-hidden="true" href="#cb6-8" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="op"&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id="清空链表"&gt;清空链表&lt;/h2&gt;
&lt;div class="sourceCode" id="cb7"&gt;&lt;pre class="sourceCode c"&gt;&lt;code class="sourceCode c"&gt;&lt;span id="cb7-1"&gt;&lt;a aria-hidden="true" href="#cb7-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="dt"&gt;size_t&lt;/span&gt; delete_list&lt;span class="op"&gt;(&lt;/span&gt;list l&lt;span class="op"&gt;)&lt;/span&gt; &lt;span class="op"&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb7-2"&gt;&lt;a aria-hidden="true" href="#cb7-2" tabindex="-1"&gt;&lt;/a&gt;  &lt;span class="dt"&gt;size_t&lt;/span&gt; total &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="dv"&gt;1&lt;/span&gt;&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb7-3"&gt;&lt;a aria-hidden="true" href="#cb7-3" tabindex="-1"&gt;&lt;/a&gt;  position p&lt;span class="op"&gt;,&lt;/span&gt; tmp&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb7-4"&gt;&lt;a aria-hidden="true" href="#cb7-4" tabindex="-1"&gt;&lt;/a&gt;  p &lt;span class="op"&gt;=&lt;/span&gt; l&lt;span class="op"&gt;-&amp;gt;&lt;/span&gt;next&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb7-5"&gt;&lt;a aria-hidden="true" href="#cb7-5" tabindex="-1"&gt;&lt;/a&gt;  l&lt;span class="op"&gt;-&amp;gt;&lt;/span&gt;next &lt;span class="op"&gt;=&lt;/span&gt; NULL&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb7-6"&gt;&lt;a aria-hidden="true" href="#cb7-6" tabindex="-1"&gt;&lt;/a&gt;  &lt;span class="cf"&gt;while&lt;/span&gt; &lt;span class="op"&gt;(&lt;/span&gt;p &lt;span class="op"&gt;!=&lt;/span&gt; NULL&lt;span class="op"&gt;)&lt;/span&gt; &lt;span class="op"&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb7-7"&gt;&lt;a aria-hidden="true" href="#cb7-7" tabindex="-1"&gt;&lt;/a&gt;    tmp &lt;span class="op"&gt;=&lt;/span&gt; p&lt;span class="op"&gt;-&amp;gt;&lt;/span&gt;next&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb7-8"&gt;&lt;a aria-hidden="true" href="#cb7-8" tabindex="-1"&gt;&lt;/a&gt;    free&lt;span class="op"&gt;(&lt;/span&gt;p&lt;span class="op"&gt;);&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb7-9"&gt;&lt;a aria-hidden="true" href="#cb7-9" tabindex="-1"&gt;&lt;/a&gt;    p &lt;span class="op"&gt;=&lt;/span&gt; tmp&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb7-10"&gt;&lt;a aria-hidden="true" href="#cb7-10" tabindex="-1"&gt;&lt;/a&gt;    total&lt;span class="op"&gt;++;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb7-11"&gt;&lt;a aria-hidden="true" href="#cb7-11" tabindex="-1"&gt;&lt;/a&gt;  &lt;span class="op"&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb7-12"&gt;&lt;a aria-hidden="true" href="#cb7-12" tabindex="-1"&gt;&lt;/a&gt;  &lt;span class="cf"&gt;return&lt;/span&gt; total&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb7-13"&gt;&lt;a aria-hidden="true" href="#cb7-13" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="op"&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id="创建链表头"&gt;创建链表头&lt;/h2&gt;
&lt;div class="sourceCode" id="cb8"&gt;&lt;pre class="sourceCode c"&gt;&lt;code class="sourceCode c"&gt;&lt;span id="cb8-1"&gt;&lt;a aria-hidden="true" href="#cb8-1" tabindex="-1"&gt;&lt;/a&gt;list init_list&lt;span class="op"&gt;(&lt;/span&gt;element_type element&lt;span class="op"&gt;)&lt;/span&gt; &lt;span class="op"&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb8-2"&gt;&lt;a aria-hidden="true" href="#cb8-2" tabindex="-1"&gt;&lt;/a&gt;  position cell &lt;span class="op"&gt;=&lt;/span&gt; malloc&lt;span class="op"&gt;(&lt;/span&gt;&lt;span class="kw"&gt;sizeof&lt;/span&gt;&lt;span class="op"&gt;(&lt;/span&gt;&lt;span class="kw"&gt;struct&lt;/span&gt; node&lt;span class="op"&gt;));&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb8-3"&gt;&lt;a aria-hidden="true" href="#cb8-3" tabindex="-1"&gt;&lt;/a&gt;  assert&lt;span class="op"&gt;(&lt;/span&gt;cell &lt;span class="op"&gt;!=&lt;/span&gt; NULL&lt;span class="op"&gt;);&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb8-4"&gt;&lt;a aria-hidden="true" href="#cb8-4" tabindex="-1"&gt;&lt;/a&gt;  cell&lt;span class="op"&gt;-&amp;gt;&lt;/span&gt;next &lt;span class="op"&gt;=&lt;/span&gt; NULL&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb8-5"&gt;&lt;a aria-hidden="true" href="#cb8-5" tabindex="-1"&gt;&lt;/a&gt;  cell&lt;span class="op"&gt;-&amp;gt;&lt;/span&gt;element &lt;span class="op"&gt;=&lt;/span&gt; element&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb8-6"&gt;&lt;a aria-hidden="true" href="#cb8-6" tabindex="-1"&gt;&lt;/a&gt;  &lt;span class="cf"&gt;return&lt;/span&gt; cell&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb8-7"&gt;&lt;a aria-hidden="true" href="#cb8-7" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="op"&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h1 id="测试例"&gt;测试例&lt;/h1&gt;
&lt;p&gt;编译命令：&lt;code&gt;clang -Og linked_list.c test.c&lt;/code&gt;&lt;/p&gt;
&lt;div class="sourceCode" id="cb9"&gt;&lt;pre class="sourceCode c"&gt;&lt;code class="sourceCode c"&gt;&lt;span id="cb9-1"&gt;&lt;a aria-hidden="true" href="#cb9-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="pp"&gt;#include &lt;/span&gt;&lt;span class="im"&gt;"linked_list.h"&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb9-2"&gt;&lt;a aria-hidden="true" href="#cb9-2" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb9-3"&gt;&lt;a aria-hidden="true" href="#cb9-3" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="dt"&gt;void&lt;/span&gt; use_list&lt;span class="op"&gt;(&lt;/span&gt;list l&lt;span class="op"&gt;)&lt;/span&gt; &lt;span class="op"&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb9-4"&gt;&lt;a aria-hidden="true" href="#cb9-4" tabindex="-1"&gt;&lt;/a&gt;  &lt;span class="dt"&gt;size_t&lt;/span&gt; count &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="dv"&gt;0&lt;/span&gt;&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb9-5"&gt;&lt;a aria-hidden="true" href="#cb9-5" tabindex="-1"&gt;&lt;/a&gt;  &lt;span class="cf"&gt;while&lt;/span&gt; &lt;span class="op"&gt;(&lt;/span&gt;l&lt;span class="op"&gt;-&amp;gt;&lt;/span&gt;next &lt;span class="op"&gt;!=&lt;/span&gt; NULL&lt;span class="op"&gt;)&lt;/span&gt; &lt;span class="op"&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb9-6"&gt;&lt;a aria-hidden="true" href="#cb9-6" tabindex="-1"&gt;&lt;/a&gt;    l &lt;span class="op"&gt;=&lt;/span&gt; l&lt;span class="op"&gt;-&amp;gt;&lt;/span&gt;next&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb9-7"&gt;&lt;a aria-hidden="true" href="#cb9-7" tabindex="-1"&gt;&lt;/a&gt;    count&lt;span class="op"&gt;++;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb9-8"&gt;&lt;a aria-hidden="true" href="#cb9-8" tabindex="-1"&gt;&lt;/a&gt;  &lt;span class="op"&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb9-9"&gt;&lt;a aria-hidden="true" href="#cb9-9" tabindex="-1"&gt;&lt;/a&gt;  find_element&lt;span class="op"&gt;(&lt;/span&gt;&lt;span class="dv"&gt;114514&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt; l&lt;span class="op"&gt;);&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb9-10"&gt;&lt;a aria-hidden="true" href="#cb9-10" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="op"&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb9-11"&gt;&lt;a aria-hidden="true" href="#cb9-11" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb9-12"&gt;&lt;a aria-hidden="true" href="#cb9-12" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="dt"&gt;int&lt;/span&gt; main&lt;span class="op"&gt;()&lt;/span&gt; &lt;span class="op"&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb9-13"&gt;&lt;a aria-hidden="true" href="#cb9-13" tabindex="-1"&gt;&lt;/a&gt;  list numbers &lt;span class="op"&gt;=&lt;/span&gt; init_list&lt;span class="op"&gt;(&lt;/span&gt;&lt;span class="dv"&gt;1024&lt;/span&gt;&lt;span class="op"&gt;);&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb9-14"&gt;&lt;a aria-hidden="true" href="#cb9-14" tabindex="-1"&gt;&lt;/a&gt;  position pos &lt;span class="op"&gt;=&lt;/span&gt; numbers&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb9-15"&gt;&lt;a aria-hidden="true" href="#cb9-15" tabindex="-1"&gt;&lt;/a&gt;  &lt;span class="cf"&gt;for&lt;/span&gt; &lt;span class="op"&gt;(&lt;/span&gt;&lt;span class="dt"&gt;size_t&lt;/span&gt; i &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="dv"&gt;0&lt;/span&gt;&lt;span class="op"&gt;;&lt;/span&gt; i &lt;span class="op"&gt;&amp;lt;&lt;/span&gt; &lt;span class="dv"&gt;51200000&lt;/span&gt;&lt;span class="op"&gt;;&lt;/span&gt; i&lt;span class="op"&gt;++)&lt;/span&gt; &lt;/span&gt;
&lt;span id="cb9-16"&gt;&lt;a aria-hidden="true" href="#cb9-16" tabindex="-1"&gt;&lt;/a&gt;    pos &lt;span class="op"&gt;=&lt;/span&gt; insert_element&lt;span class="op"&gt;(&lt;/span&gt;i &lt;span class="op"&gt;*&lt;/span&gt; &lt;span class="dv"&gt;10&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt; pos&lt;span class="op"&gt;);&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb9-17"&gt;&lt;a aria-hidden="true" href="#cb9-17" tabindex="-1"&gt;&lt;/a&gt;  use_list&lt;span class="op"&gt;(&lt;/span&gt;numbers&lt;span class="op"&gt;);&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb9-18"&gt;&lt;a aria-hidden="true" href="#cb9-18" tabindex="-1"&gt;&lt;/a&gt;  delete_list&lt;span class="op"&gt;(&lt;/span&gt;numbers&lt;span class="op"&gt;);&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb9-19"&gt;&lt;a aria-hidden="true" href="#cb9-19" tabindex="-1"&gt;&lt;/a&gt;  &lt;span class="cf"&gt;return&lt;/span&gt; &lt;span class="dv"&gt;0&lt;/span&gt;&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb9-20"&gt;&lt;a aria-hidden="true" href="#cb9-20" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="op"&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;a href="./assets/linked_list.tar.gz"&gt;下载源码&lt;/a&gt;&lt;/p&gt;
&lt;br/&gt;
&lt;!--%%REF%%--&gt;
&lt;br/&gt;
&lt;script async="" crossorigin="anonymous" data-category="Announcements" data-category-id="DIC_kwDOJ7Ymy84CX4eg" data-emit-metadata="0" data-input-position="top" data-lang="zh-CN" data-loading="lazy" data-mapping="title" data-reactions-enabled="1" data-repo="izfsk-ium/izfsk-ium.github.io" data-repo-id="R_kgDOJ7Ymyw" data-strict="0" data-theme="preferred_color_scheme" src="https://giscus.app/client.js"&gt;
&lt;/script&gt;
&lt;/main&gt;
&lt;footer&gt;
&lt;p class="signoff"&gt;
&lt;div class="metadata"&gt;
&lt;p class="date"&gt;&lt;time datetime="2021-07-11"&gt;创建日期：2021-07-11&lt;/time&gt;&lt;/p&gt;
&lt;p class="lastmodify"&gt;&lt;time&gt;最后编译：2023-08-10&lt;/time&gt;&lt;/p&gt;
&lt;p class="lastmodify" id="counter-span"&gt;访问次数：&lt;/p&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;/footer&gt;
&lt;script&gt;
    /* These script should run after page load */
    document.querySelectorAll('code.sourceCode').forEach(
      i =&gt; i.insertAdjacentHTML('beforeend', '&lt;div class="copy"&gt;复制&lt;/div&gt;')
    );
    document.querySelectorAll('div.copy').forEach(
      i =&gt; i.addEventListener(
        'click',
        () =&gt; {
          navigator.clipboard.writeText(i.parentElement.innerText.replace('复制', ''));
          i.innerText = '成功';
          setTimeout(() =&gt; {
            i.innerText = '复制';
          }, 1000);
        }
      )
    );

    if (location.href.includes("127.0.0.1:8080")) {
      document.getElementById("counter-span").innerHTML = "[[development mode]]";
    } else {
      const uuid = document.getElementById("article-uuid").innerText;
      const target = document.getElementById("counter-span");
      const last = localStorage.getItem("lastVisit-" + uuid);
      const shouldIncrease = last === null || new Date().getTime() - parseInt(last) &gt;= (1000 * 60 * 15);

      fetch(shouldIncrease ? ("https://counter.izfsk.top/counter/" + uuid) : ("https://counter.izfsk.top/readOnly/" + uuid))
        .then(r =&gt; r.text())
        .then(d =&gt; {
          if (!d.startsWith("Too"))
            document.getElementById("counter-span").innerText = "访问次数：" + d.toString();
          else
            document.getElementById("counter-span").innerHTML = "";
        });

      localStorage.setItem("lastVisit-" + uuid, new Date().getTime());
    }
  &lt;/script&gt;
&lt;script async="" data-website-id="2a1146ab-fa82-4a84-a04f-30e5967357c3" src="https://analytics.umami.is/script.js"&gt;&lt;/script&gt;
&lt;/body&gt;</content:encoded>
      <guid isPermaLink="false">5d2a083c-a623-460a-9cfc-77666376e598</guid>
      <pubDate>Sun, 11 Jul 2021 00:00:00 +0800</pubDate>
    </item>
    <item>
      <title>交换类排序</title>
      <link>https://blog.izfsk.top/articles/交换类排序.html</link>
      <description>交换类排序</description>
      <content:encoded>&lt;body&gt;
&lt;progress id="content_progress" value="0"&gt;&lt;/progress&gt;
&lt;button id="back-to-top"&gt;
    回页顶
  &lt;/button&gt;
&lt;header&gt;
&lt;small id="article-uuid" style="display: none !important;"&gt;3fff20fc-0bcc-497f-a3e2-79c5ca797426&lt;/small&gt;
&lt;h1 class="title"&gt;交换类排序&lt;/h1&gt;
&lt;!-- Subtitle --&gt;
&lt;h3 class="subtitle"&gt; &lt;/h3&gt;
&lt;/header&gt;
&lt;nav id="TOC" role="doc-toc"&gt;
&lt;strong&gt;文章归类: &lt;a href="/pages/category.html#学习"&gt;学习&lt;/a&gt; &lt;/strong&gt;
&lt;input id="contents" type="checkbox"/&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#冒泡排序" id="toc-冒泡排序"&gt;冒泡排序&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#双向冒泡排序" id="toc-双向冒泡排序"&gt;双向冒泡排序&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#奇偶排序" id="toc-奇偶排序"&gt;奇偶排序&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#皮匠排序" id="toc-皮匠排序"&gt;皮匠排序&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#快速排序" id="toc-快速排序"&gt;快速排序&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#测试" id="toc-测试"&gt;测试&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#reference"&gt;参考链接&lt;/a&gt;&lt;/li&gt;
&lt;li&gt; &lt;/li&gt;
&lt;li class="tools"&gt;
&lt;span id="backtomain"&gt;
&lt;svg class="bi bi-house" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M8.707 1.5a1 1 0 0 0-1.414 0L.646 8.146a.5.5 0 0 0 .708.708L2 8.207V13.5A1.5 1.5 0 0 0 3.5 15h9a1.5 1.5 0 0 0 1.5-1.5V8.207l.646.647a.5.5 0 0 0 .708-.708L13 5.793V2.5a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v1.293L8.707 1.5ZM13 7.207V13.5a.5.5 0 0 1-.5.5h-9a.5.5 0 0 1-.5-.5V7.207l5-5 5 5Z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="readingmode"&gt;
&lt;svg class="bi bi-book" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M1 2.828c.885-.37 2.154-.769 3.388-.893 1.33-.134 2.458.063 3.112.752v9.746c-.935-.53-2.12-.603-3.213-.493-1.18.12-2.37.461-3.287.811V2.828zm7.5-.141c.654-.689 1.782-.886 3.112-.752 1.234.124 2.503.523 3.388.893v9.923c-.918-.35-2.107-.692-3.287-.81-1.094-.111-2.278-.039-3.213.492V2.687zM8 1.783C7.015.936 5.587.81 4.287.94c-1.514.153-3.042.672-3.994 1.105A.5.5 0 0 0 0 2.5v11a.5.5 0 0 0 .707.455c.882-.4 2.303-.881 3.68-1.02 1.409-.142 2.59.087 3.223.877a.5.5 0 0 0 .78 0c.633-.79 1.814-1.019 3.222-.877 1.378.139 2.8.62 3.681 1.02A.5.5 0 0 0 16 13.5v-11a.5.5 0 0 0-.293-.455c-.952-.433-2.48-.952-3.994-1.105C10.413.809 8.985.936 8 1.783z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="larger"&gt; &lt;/span&gt;
&lt;span id="smaller"&gt;&lt;/span&gt;
&lt;span id="switchfont"&gt;
&lt;svg class="bi bi-fonts" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M12.258 3h-8.51l-.083 2.46h.479c.26-1.544.758-1.783 2.693-1.845l.424-.013v7.827c0 .663-.144.82-1.3.923v.52h4.082v-.52c-1.162-.103-1.306-.26-1.306-.923V3.602l.431.013c1.934.062 2.434.301 2.693 1.846h.479L12.258 3z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="backtotop"&gt;
&lt;svg class="bi bi-arrow-bar-up" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M8 10a.5.5 0 0 0 .5-.5V3.707l2.146 2.147a.5.5 0 0 0 .708-.708l-3-3a.5.5 0 0 0-.708 0l-3 3a.5.5 0 1 0 .708.708L7.5 3.707V9.5a.5.5 0 0 0 .5.5zm-7 2.5a.5.5 0 0 1 .5-.5h13a.5.5 0 0 1 0 1h-13a.5.5 0 0 1-.5-.5z" fill-rule="evenodd"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/nav&gt;
&lt;main&gt;
&lt;p&gt;在交换类排序算法中，已知最好的选择算法是快速排序。&lt;/p&gt;
&lt;h1 id="冒泡排序"&gt;冒泡排序&lt;/h1&gt;
&lt;p&gt;很简单的排序算法，效率很低，但是简单易懂。初中就学过。具体的来讲，就是一遍一遍的扫描数组，碰见顺序不对的把他俩调换一下位置。最后还需要额外扫描一遍确保排序好了。这是一个&lt;em&gt;原地&lt;/em&gt;的排序算法。&lt;/p&gt;
&lt;div class="sourceCode" id="cb1"&gt;&lt;pre class="sourceCode python"&gt;&lt;code class="sourceCode python"&gt;&lt;span id="cb1-1"&gt;&lt;a aria-hidden="true" href="#cb1-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;def&lt;/span&gt; bubble_sort(array: &lt;span class="bu"&gt;list&lt;/span&gt;[&lt;span class="bu"&gt;int&lt;/span&gt;]) &lt;span class="op"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="va"&gt;None&lt;/span&gt;:&lt;/span&gt;
&lt;span id="cb1-2"&gt;&lt;a aria-hidden="true" href="#cb1-2" tabindex="-1"&gt;&lt;/a&gt;    swapped: &lt;span class="bu"&gt;bool&lt;/span&gt; &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="va"&gt;True&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-3"&gt;&lt;a aria-hidden="true" href="#cb1-3" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="cf"&gt;while&lt;/span&gt; swapped:&lt;/span&gt;
&lt;span id="cb1-4"&gt;&lt;a aria-hidden="true" href="#cb1-4" tabindex="-1"&gt;&lt;/a&gt;        swapped &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="va"&gt;False&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-5"&gt;&lt;a aria-hidden="true" href="#cb1-5" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="cf"&gt;for&lt;/span&gt; index &lt;span class="kw"&gt;in&lt;/span&gt; &lt;span class="bu"&gt;range&lt;/span&gt;(&lt;span class="bu"&gt;len&lt;/span&gt;(array) &lt;span class="op"&gt;-&lt;/span&gt; &lt;span class="dv"&gt;1&lt;/span&gt;):&lt;/span&gt;
&lt;span id="cb1-6"&gt;&lt;a aria-hidden="true" href="#cb1-6" tabindex="-1"&gt;&lt;/a&gt;            &lt;span class="cf"&gt;if&lt;/span&gt; array[index] &lt;span class="op"&gt;&amp;gt;&lt;/span&gt; array[index &lt;span class="op"&gt;+&lt;/span&gt; &lt;span class="dv"&gt;1&lt;/span&gt;]:&lt;/span&gt;
&lt;span id="cb1-7"&gt;&lt;a aria-hidden="true" href="#cb1-7" tabindex="-1"&gt;&lt;/a&gt;                array[index], array[index &lt;span class="op"&gt;+&lt;/span&gt; &lt;span class="dv"&gt;1&lt;/span&gt;] &lt;span class="op"&gt;=&lt;/span&gt; array[index &lt;span class="op"&gt;+&lt;/span&gt; &lt;span class="dv"&gt;1&lt;/span&gt;], array[index]&lt;/span&gt;
&lt;span id="cb1-8"&gt;&lt;a aria-hidden="true" href="#cb1-8" tabindex="-1"&gt;&lt;/a&gt;                swapped &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="va"&gt;True&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h1 id="双向冒泡排序"&gt;双向冒泡排序&lt;/h1&gt;
&lt;p&gt;和冒泡排序类似，但是每次扫描过后不是从头再来，而是从反方向扫描，减少总的扫描次数。同样是&lt;em&gt;原地&lt;/em&gt;排序。&lt;/p&gt;
&lt;div class="sourceCode" id="cb2"&gt;&lt;pre class="sourceCode python"&gt;&lt;code class="sourceCode python"&gt;&lt;span id="cb2-1"&gt;&lt;a aria-hidden="true" href="#cb2-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;def&lt;/span&gt; bbs(array: &lt;span class="bu"&gt;list&lt;/span&gt;[&lt;span class="bu"&gt;int&lt;/span&gt;]) &lt;span class="op"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="va"&gt;None&lt;/span&gt;:&lt;/span&gt;
&lt;span id="cb2-2"&gt;&lt;a aria-hidden="true" href="#cb2-2" tabindex="-1"&gt;&lt;/a&gt;    swapped: &lt;span class="bu"&gt;bool&lt;/span&gt; &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="va"&gt;True&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-3"&gt;&lt;a aria-hidden="true" href="#cb2-3" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="cf"&gt;while&lt;/span&gt; swapped:&lt;/span&gt;
&lt;span id="cb2-4"&gt;&lt;a aria-hidden="true" href="#cb2-4" tabindex="-1"&gt;&lt;/a&gt;        swapped &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="va"&gt;False&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-5"&gt;&lt;a aria-hidden="true" href="#cb2-5" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="cf"&gt;for&lt;/span&gt; index &lt;span class="kw"&gt;in&lt;/span&gt; &lt;span class="bu"&gt;range&lt;/span&gt;(&lt;span class="bu"&gt;len&lt;/span&gt;(array) &lt;span class="op"&gt;-&lt;/span&gt; &lt;span class="dv"&gt;1&lt;/span&gt;):&lt;/span&gt;
&lt;span id="cb2-6"&gt;&lt;a aria-hidden="true" href="#cb2-6" tabindex="-1"&gt;&lt;/a&gt;            &lt;span class="cf"&gt;if&lt;/span&gt; array[index] &lt;span class="op"&gt;&amp;gt;&lt;/span&gt; array[index &lt;span class="op"&gt;+&lt;/span&gt; &lt;span class="dv"&gt;1&lt;/span&gt;]:&lt;/span&gt;
&lt;span id="cb2-7"&gt;&lt;a aria-hidden="true" href="#cb2-7" tabindex="-1"&gt;&lt;/a&gt;                array[index &lt;span class="op"&gt;+&lt;/span&gt; &lt;span class="dv"&gt;1&lt;/span&gt;], array[index] &lt;span class="op"&gt;=&lt;/span&gt; array[index], array[index &lt;span class="op"&gt;+&lt;/span&gt; &lt;span class="dv"&gt;1&lt;/span&gt;]&lt;/span&gt;
&lt;span id="cb2-8"&gt;&lt;a aria-hidden="true" href="#cb2-8" tabindex="-1"&gt;&lt;/a&gt;                swapped &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="va"&gt;True&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-9"&gt;&lt;a aria-hidden="true" href="#cb2-9" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="cf"&gt;for&lt;/span&gt; index &lt;span class="kw"&gt;in&lt;/span&gt; &lt;span class="bu"&gt;range&lt;/span&gt;(&lt;span class="bu"&gt;len&lt;/span&gt;(array) &lt;span class="op"&gt;-&lt;/span&gt; &lt;span class="dv"&gt;2&lt;/span&gt;, &lt;span class="dv"&gt;0&lt;/span&gt;, &lt;span class="op"&gt;-&lt;/span&gt;&lt;span class="dv"&gt;1&lt;/span&gt;):&lt;/span&gt;
&lt;span id="cb2-10"&gt;&lt;a aria-hidden="true" href="#cb2-10" tabindex="-1"&gt;&lt;/a&gt;            &lt;span class="cf"&gt;if&lt;/span&gt; array[index] &lt;span class="op"&gt;&amp;lt;&lt;/span&gt; array[index &lt;span class="op"&gt;-&lt;/span&gt; &lt;span class="dv"&gt;1&lt;/span&gt;]:&lt;/span&gt;
&lt;span id="cb2-11"&gt;&lt;a aria-hidden="true" href="#cb2-11" tabindex="-1"&gt;&lt;/a&gt;                array[index &lt;span class="op"&gt;-&lt;/span&gt; &lt;span class="dv"&gt;1&lt;/span&gt;], array[index] &lt;span class="op"&gt;=&lt;/span&gt; array[index], array[index &lt;span class="op"&gt;-&lt;/span&gt; &lt;span class="dv"&gt;1&lt;/span&gt;]&lt;/span&gt;
&lt;span id="cb2-12"&gt;&lt;a aria-hidden="true" href="#cb2-12" tabindex="-1"&gt;&lt;/a&gt;                swapped &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="va"&gt;True&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h1 id="奇偶排序"&gt;奇偶排序&lt;/h1&gt;
&lt;p&gt;和冒泡排序类似，但是步长为 2 。先是比较数组中相邻的（奇-偶）位置数字对，下一次再（偶-奇）比较位置数字对，如果该奇偶对是错误的顺序（第一个大于第二个），则交换。同样是&lt;em&gt;原地&lt;/em&gt;算法。&lt;/p&gt;
&lt;div class="sourceCode" id="cb3"&gt;&lt;pre class="sourceCode python"&gt;&lt;code class="sourceCode python"&gt;&lt;span id="cb3-1"&gt;&lt;a aria-hidden="true" href="#cb3-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;def&lt;/span&gt; odd_even_sort(array: &lt;span class="bu"&gt;list&lt;/span&gt;[&lt;span class="bu"&gt;int&lt;/span&gt;]) &lt;span class="op"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="va"&gt;None&lt;/span&gt;:&lt;/span&gt;
&lt;span id="cb3-2"&gt;&lt;a aria-hidden="true" href="#cb3-2" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="bu"&gt;sorted&lt;/span&gt;: &lt;span class="bu"&gt;bool&lt;/span&gt; &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="va"&gt;False&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb3-3"&gt;&lt;a aria-hidden="true" href="#cb3-3" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="cf"&gt;while&lt;/span&gt; &lt;span class="kw"&gt;not&lt;/span&gt; &lt;span class="bu"&gt;sorted&lt;/span&gt;:&lt;/span&gt;
&lt;span id="cb3-4"&gt;&lt;a aria-hidden="true" href="#cb3-4" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="bu"&gt;sorted&lt;/span&gt; &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="va"&gt;True&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb3-5"&gt;&lt;a aria-hidden="true" href="#cb3-5" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="cf"&gt;for&lt;/span&gt; i &lt;span class="kw"&gt;in&lt;/span&gt; &lt;span class="bu"&gt;range&lt;/span&gt;(&lt;span class="dv"&gt;1&lt;/span&gt;, &lt;span class="bu"&gt;len&lt;/span&gt;(array) &lt;span class="op"&gt;-&lt;/span&gt; &lt;span class="dv"&gt;1&lt;/span&gt;, &lt;span class="dv"&gt;2&lt;/span&gt;):&lt;/span&gt;
&lt;span id="cb3-6"&gt;&lt;a aria-hidden="true" href="#cb3-6" tabindex="-1"&gt;&lt;/a&gt;            &lt;span class="cf"&gt;if&lt;/span&gt; array[i] &lt;span class="op"&gt;&amp;gt;&lt;/span&gt; array[i &lt;span class="op"&gt;+&lt;/span&gt; &lt;span class="dv"&gt;1&lt;/span&gt;]:&lt;/span&gt;
&lt;span id="cb3-7"&gt;&lt;a aria-hidden="true" href="#cb3-7" tabindex="-1"&gt;&lt;/a&gt;                array[i], array[i &lt;span class="op"&gt;+&lt;/span&gt; &lt;span class="dv"&gt;1&lt;/span&gt;] &lt;span class="op"&gt;=&lt;/span&gt; array[i &lt;span class="op"&gt;+&lt;/span&gt; &lt;span class="dv"&gt;1&lt;/span&gt;], array[i]&lt;/span&gt;
&lt;span id="cb3-8"&gt;&lt;a aria-hidden="true" href="#cb3-8" tabindex="-1"&gt;&lt;/a&gt;                &lt;span class="bu"&gt;sorted&lt;/span&gt; &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="va"&gt;False&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb3-9"&gt;&lt;a aria-hidden="true" href="#cb3-9" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="cf"&gt;for&lt;/span&gt; i &lt;span class="kw"&gt;in&lt;/span&gt; &lt;span class="bu"&gt;range&lt;/span&gt;(&lt;span class="dv"&gt;0&lt;/span&gt;, &lt;span class="bu"&gt;len&lt;/span&gt;(array) &lt;span class="op"&gt;-&lt;/span&gt; &lt;span class="dv"&gt;1&lt;/span&gt;, &lt;span class="dv"&gt;2&lt;/span&gt;):&lt;/span&gt;
&lt;span id="cb3-10"&gt;&lt;a aria-hidden="true" href="#cb3-10" tabindex="-1"&gt;&lt;/a&gt;            &lt;span class="cf"&gt;if&lt;/span&gt; array[i] &lt;span class="op"&gt;&amp;gt;&lt;/span&gt; array[i &lt;span class="op"&gt;+&lt;/span&gt; &lt;span class="dv"&gt;1&lt;/span&gt;]:&lt;/span&gt;
&lt;span id="cb3-11"&gt;&lt;a aria-hidden="true" href="#cb3-11" tabindex="-1"&gt;&lt;/a&gt;                array[i], array[i &lt;span class="op"&gt;+&lt;/span&gt; &lt;span class="dv"&gt;1&lt;/span&gt;] &lt;span class="op"&gt;=&lt;/span&gt; array[i &lt;span class="op"&gt;+&lt;/span&gt; &lt;span class="dv"&gt;1&lt;/span&gt;], array[i]&lt;/span&gt;
&lt;span id="cb3-12"&gt;&lt;a aria-hidden="true" href="#cb3-12" tabindex="-1"&gt;&lt;/a&gt;                &lt;span class="bu"&gt;sorted&lt;/span&gt; &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="va"&gt;False&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h1 id="皮匠排序"&gt;皮匠排序&lt;/h1&gt;
&lt;del&gt;
    很奇怪的名字
    &lt;/del&gt;
&lt;p&gt;，来源是算法导论 7.3 练习题。不过第三版已经改成 &lt;code&gt;Alternative quicksort analysis&lt;/code&gt; 了（&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;如果最后一个值小于第一个值，则交换&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;如果当前集合元素数量大于等于3：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;使用皮匠法排序前2/3的元素&lt;/li&gt;
&lt;li&gt;使用皮匠法排序后2/3的元素&lt;/li&gt;
&lt;li&gt;再次使用皮匠法排序前2/3的元素&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;很慢很慢。&lt;/strong&gt;&lt;/p&gt;
&lt;div class="sourceCode" id="cb4"&gt;&lt;pre class="sourceCode python"&gt;&lt;code class="sourceCode python"&gt;&lt;span id="cb4-1"&gt;&lt;a aria-hidden="true" href="#cb4-1" tabindex="-1"&gt;&lt;/a&gt;  &lt;span class="kw"&gt;def&lt;/span&gt; stooge_sort(array: &lt;span class="bu"&gt;list&lt;/span&gt;[&lt;span class="bu"&gt;int&lt;/span&gt;], start&lt;span class="op"&gt;=&lt;/span&gt;&lt;span class="dv"&gt;0&lt;/span&gt;, end&lt;span class="op"&gt;=&lt;/span&gt;&lt;span class="va"&gt;None&lt;/span&gt;) &lt;span class="op"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="va"&gt;None&lt;/span&gt;:&lt;/span&gt;
&lt;span id="cb4-2"&gt;&lt;a aria-hidden="true" href="#cb4-2" tabindex="-1"&gt;&lt;/a&gt;      &lt;span class="cf"&gt;if&lt;/span&gt; end &lt;span class="op"&gt;==&lt;/span&gt; &lt;span class="va"&gt;None&lt;/span&gt;:&lt;/span&gt;
&lt;span id="cb4-3"&gt;&lt;a aria-hidden="true" href="#cb4-3" tabindex="-1"&gt;&lt;/a&gt;          end &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="bu"&gt;len&lt;/span&gt;(array) &lt;span class="op"&gt;-&lt;/span&gt; &lt;span class="dv"&gt;1&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb4-4"&gt;&lt;a aria-hidden="true" href="#cb4-4" tabindex="-1"&gt;&lt;/a&gt;      &lt;span class="cf"&gt;if&lt;/span&gt; array[start] &lt;span class="op"&gt;&amp;gt;&lt;/span&gt; array[end]:&lt;/span&gt;
&lt;span id="cb4-5"&gt;&lt;a aria-hidden="true" href="#cb4-5" tabindex="-1"&gt;&lt;/a&gt;          array[start], array[end] &lt;span class="op"&gt;=&lt;/span&gt; array[end], array[start]&lt;/span&gt;
&lt;span id="cb4-6"&gt;&lt;a aria-hidden="true" href="#cb4-6" tabindex="-1"&gt;&lt;/a&gt;      &lt;span class="cf"&gt;if&lt;/span&gt; end &lt;span class="op"&gt;-&lt;/span&gt; start &lt;span class="op"&gt;+&lt;/span&gt; &lt;span class="dv"&gt;1&lt;/span&gt; &lt;span class="op"&gt;&amp;gt;&lt;/span&gt; &lt;span class="dv"&gt;2&lt;/span&gt;:&lt;/span&gt;
&lt;span id="cb4-7"&gt;&lt;a aria-hidden="true" href="#cb4-7" tabindex="-1"&gt;&lt;/a&gt;          divide &lt;span class="op"&gt;=&lt;/span&gt; floor((end &lt;span class="op"&gt;-&lt;/span&gt; start &lt;span class="op"&gt;+&lt;/span&gt; &lt;span class="dv"&gt;1&lt;/span&gt;) &lt;span class="op"&gt;/&lt;/span&gt; &lt;span class="dv"&gt;3&lt;/span&gt;)&lt;/span&gt;
&lt;span id="cb4-8"&gt;&lt;a aria-hidden="true" href="#cb4-8" tabindex="-1"&gt;&lt;/a&gt;          StoogeSort.stooge_sort(array, start, end &lt;span class="op"&gt;-&lt;/span&gt; divide)&lt;/span&gt;
&lt;span id="cb4-9"&gt;&lt;a aria-hidden="true" href="#cb4-9" tabindex="-1"&gt;&lt;/a&gt;          StoogeSort.stooge_sort(array, start &lt;span class="op"&gt;+&lt;/span&gt; divide, end)&lt;/span&gt;
&lt;span id="cb4-10"&gt;&lt;a aria-hidden="true" href="#cb4-10" tabindex="-1"&gt;&lt;/a&gt;          StoogeSort.stooge_sort(array, start, end &lt;span class="op"&gt;-&lt;/span&gt; divide)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h1 id="快速排序"&gt;快速排序&lt;/h1&gt;
&lt;p&gt;快速排序就是，选择一个基准元素，通常是中间那个，把大于它的放在一边，小于它的放在另外一边，再对两边的分别继续这样操作。最后就能得到排序好的序列了。&lt;/p&gt;
&lt;p&gt;最容易理解的「标准版本」如下：&lt;/p&gt;
&lt;div class="sourceCode" id="cb5"&gt;&lt;pre class="sourceCode python"&gt;&lt;code class="sourceCode python"&gt;&lt;span id="cb5-1"&gt;&lt;a aria-hidden="true" href="#cb5-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;def&lt;/span&gt; quicksort(array: &lt;span class="bu"&gt;list&lt;/span&gt;[&lt;span class="bu"&gt;int&lt;/span&gt;]) &lt;span class="op"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="bu"&gt;list&lt;/span&gt;[&lt;span class="bu"&gt;int&lt;/span&gt;]:&lt;/span&gt;
&lt;span id="cb5-2"&gt;&lt;a aria-hidden="true" href="#cb5-2" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="co"&gt;# 如果只有一个元素，直接返回&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb5-3"&gt;&lt;a aria-hidden="true" href="#cb5-3" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="cf"&gt;if&lt;/span&gt; &lt;span class="bu"&gt;len&lt;/span&gt;(array) &lt;span class="op"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="dv"&gt;1&lt;/span&gt;:&lt;/span&gt;
&lt;span id="cb5-4"&gt;&lt;a aria-hidden="true" href="#cb5-4" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="cf"&gt;return&lt;/span&gt; array&lt;/span&gt;
&lt;span id="cb5-5"&gt;&lt;a aria-hidden="true" href="#cb5-5" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb5-6"&gt;&lt;a aria-hidden="true" href="#cb5-6" tabindex="-1"&gt;&lt;/a&gt;    left: &lt;span class="bu"&gt;list&lt;/span&gt;[&lt;span class="bu"&gt;int&lt;/span&gt;] &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="bu"&gt;list&lt;/span&gt;()&lt;/span&gt;
&lt;span id="cb5-7"&gt;&lt;a aria-hidden="true" href="#cb5-7" tabindex="-1"&gt;&lt;/a&gt;    right: &lt;span class="bu"&gt;list&lt;/span&gt;[&lt;span class="bu"&gt;int&lt;/span&gt;] &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="bu"&gt;list&lt;/span&gt;()&lt;/span&gt;
&lt;span id="cb5-8"&gt;&lt;a aria-hidden="true" href="#cb5-8" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="co"&gt;# mid 是 pivot 元素的索引&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb5-9"&gt;&lt;a aria-hidden="true" href="#cb5-9" tabindex="-1"&gt;&lt;/a&gt;    mid: &lt;span class="bu"&gt;int&lt;/span&gt; &lt;span class="op"&gt;=&lt;/span&gt; (&lt;span class="bu"&gt;len&lt;/span&gt;(array) &lt;span class="op"&gt;-&lt;/span&gt; &lt;span class="dv"&gt;1&lt;/span&gt;) &lt;span class="op"&gt;//&lt;/span&gt; &lt;span class="dv"&gt;2&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb5-10"&gt;&lt;a aria-hidden="true" href="#cb5-10" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb5-11"&gt;&lt;a aria-hidden="true" href="#cb5-11" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="cf"&gt;for&lt;/span&gt; index, element &lt;span class="kw"&gt;in&lt;/span&gt; &lt;span class="bu"&gt;enumerate&lt;/span&gt;(array):&lt;/span&gt;
&lt;span id="cb5-12"&gt;&lt;a aria-hidden="true" href="#cb5-12" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="co"&gt;# 对于每一个元素，大于 pivot 的放在右边，否则放在左边&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb5-13"&gt;&lt;a aria-hidden="true" href="#cb5-13" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="cf"&gt;if&lt;/span&gt; index &lt;span class="op"&gt;==&lt;/span&gt; mid:&lt;/span&gt;
&lt;span id="cb5-14"&gt;&lt;a aria-hidden="true" href="#cb5-14" tabindex="-1"&gt;&lt;/a&gt;            &lt;span class="cf"&gt;continue&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb5-15"&gt;&lt;a aria-hidden="true" href="#cb5-15" tabindex="-1"&gt;&lt;/a&gt;        right.append(element) &lt;span class="cf"&gt;if&lt;/span&gt; element &lt;span class="op"&gt;&amp;gt;&lt;/span&gt; array[mid] &lt;span class="cf"&gt;else&lt;/span&gt; left.append(element)&lt;/span&gt;
&lt;span id="cb5-16"&gt;&lt;a aria-hidden="true" href="#cb5-16" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb5-17"&gt;&lt;a aria-hidden="true" href="#cb5-17" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="co"&gt;# 不要忘记中间的 pivot 元素&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb5-18"&gt;&lt;a aria-hidden="true" href="#cb5-18" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="co"&gt;# 它必须单独列出来，不能放在左边或者右边&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb5-19"&gt;&lt;a aria-hidden="true" href="#cb5-19" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="cf"&gt;return&lt;/span&gt; quicksort(left) &lt;span class="op"&gt;+&lt;/span&gt; [array[mid]] &lt;span class="op"&gt;+&lt;/span&gt; quicksort(right)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;使用 &lt;code&gt;quicksort(original_array)&lt;/code&gt; 来对数组排序。&lt;/p&gt;
&lt;p&gt;除此以外还有一个原地排序的版本。常见于 &lt;code&gt;C&lt;/code&gt; 等的实现。&lt;/p&gt;
&lt;div class="sourceCode" id="cb6"&gt;&lt;pre class="sourceCode python"&gt;&lt;code class="sourceCode python"&gt;&lt;span id="cb6-1"&gt;&lt;a aria-hidden="true" href="#cb6-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;def&lt;/span&gt; partition(array: &lt;span class="bu"&gt;list&lt;/span&gt;[&lt;span class="bu"&gt;int&lt;/span&gt;], low: &lt;span class="bu"&gt;int&lt;/span&gt;, high: &lt;span class="bu"&gt;int&lt;/span&gt;) &lt;span class="op"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="bu"&gt;int&lt;/span&gt;:&lt;/span&gt;
&lt;span id="cb6-2"&gt;&lt;a aria-hidden="true" href="#cb6-2" tabindex="-1"&gt;&lt;/a&gt;    pivotElement &lt;span class="op"&gt;=&lt;/span&gt; array[(low &lt;span class="op"&gt;+&lt;/span&gt; high) &lt;span class="op"&gt;//&lt;/span&gt; &lt;span class="dv"&gt;2&lt;/span&gt;]&lt;/span&gt;
&lt;span id="cb6-3"&gt;&lt;a aria-hidden="true" href="#cb6-3" tabindex="-1"&gt;&lt;/a&gt;    left, right &lt;span class="op"&gt;=&lt;/span&gt; low &lt;span class="op"&gt;-&lt;/span&gt; &lt;span class="dv"&gt;1&lt;/span&gt;, high &lt;span class="op"&gt;+&lt;/span&gt; &lt;span class="dv"&gt;1&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb6-4"&gt;&lt;a aria-hidden="true" href="#cb6-4" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb6-5"&gt;&lt;a aria-hidden="true" href="#cb6-5" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="cf"&gt;while&lt;/span&gt; &lt;span class="va"&gt;True&lt;/span&gt;:&lt;/span&gt;
&lt;span id="cb6-6"&gt;&lt;a aria-hidden="true" href="#cb6-6" tabindex="-1"&gt;&lt;/a&gt;        left, right &lt;span class="op"&gt;=&lt;/span&gt; left &lt;span class="op"&gt;+&lt;/span&gt; &lt;span class="dv"&gt;1&lt;/span&gt;, right &lt;span class="op"&gt;-&lt;/span&gt; &lt;span class="dv"&gt;1&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb6-7"&gt;&lt;a aria-hidden="true" href="#cb6-7" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="cf"&gt;while&lt;/span&gt; array[left] &lt;span class="op"&gt;&amp;lt;&lt;/span&gt; pivotElement:&lt;/span&gt;
&lt;span id="cb6-8"&gt;&lt;a aria-hidden="true" href="#cb6-8" tabindex="-1"&gt;&lt;/a&gt;            left &lt;span class="op"&gt;+=&lt;/span&gt; &lt;span class="dv"&gt;1&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb6-9"&gt;&lt;a aria-hidden="true" href="#cb6-9" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="cf"&gt;while&lt;/span&gt; array[right] &lt;span class="op"&gt;&amp;gt;&lt;/span&gt; pivotElement:&lt;/span&gt;
&lt;span id="cb6-10"&gt;&lt;a aria-hidden="true" href="#cb6-10" tabindex="-1"&gt;&lt;/a&gt;            right &lt;span class="op"&gt;-=&lt;/span&gt; &lt;span class="dv"&gt;1&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb6-11"&gt;&lt;a aria-hidden="true" href="#cb6-11" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="cf"&gt;if&lt;/span&gt; left &lt;span class="op"&gt;&amp;gt;=&lt;/span&gt; right:&lt;/span&gt;
&lt;span id="cb6-12"&gt;&lt;a aria-hidden="true" href="#cb6-12" tabindex="-1"&gt;&lt;/a&gt;            &lt;span class="cf"&gt;return&lt;/span&gt; right&lt;/span&gt;
&lt;span id="cb6-13"&gt;&lt;a aria-hidden="true" href="#cb6-13" tabindex="-1"&gt;&lt;/a&gt;        array[left], array[right] &lt;span class="op"&gt;=&lt;/span&gt; array[right], array[left]&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;使用 &lt;code&gt;quicksort(numbers, 0, len(numbers) - 1)&lt;/code&gt; 来进行排序。&lt;/p&gt;
&lt;p&gt;参考：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://en.wikipedia.org/wiki/Quicksort"&gt;维基百科 Quicksort&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://jdhao.github.io/2021/07/10/quick_sort_impl/"&gt;快排(quick sort) C++ 实现&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;另附：&lt;code&gt;Javascript&lt;/code&gt; 写的简短版本（&lt;a href="https://tsejx.github.io/data-structure-and-algorithms-guidebook/algorithms/sorting/quick-sort"&gt;来源&lt;/a&gt;）：&lt;/p&gt;
&lt;div class="sourceCode" id="cb7"&gt;&lt;pre class="sourceCode javascript"&gt;&lt;code class="sourceCode javascript"&gt;&lt;span id="cb7-1"&gt;&lt;a aria-hidden="true" href="#cb7-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;const&lt;/span&gt; quickSort &lt;span class="op"&gt;=&lt;/span&gt; (arr) &lt;span class="kw"&gt;=&amp;gt;&lt;/span&gt; {&lt;/span&gt;
&lt;span id="cb7-2"&gt;&lt;a aria-hidden="true" href="#cb7-2" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="cf"&gt;return&lt;/span&gt; arr&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="at"&gt;length&lt;/span&gt; &lt;span class="op"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="dv"&gt;1&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb7-3"&gt;&lt;a aria-hidden="true" href="#cb7-3" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="op"&gt;?&lt;/span&gt; arr&lt;/span&gt;
&lt;span id="cb7-4"&gt;&lt;a aria-hidden="true" href="#cb7-4" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="op"&gt;:&lt;/span&gt; &lt;span class="fu"&gt;quickSort&lt;/span&gt;(arr&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;slice&lt;/span&gt;(&lt;span class="dv"&gt;1&lt;/span&gt;)&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;filter&lt;/span&gt;(item &lt;span class="kw"&gt;=&amp;gt;&lt;/span&gt; item &lt;span class="op"&gt;&amp;lt;=&lt;/span&gt; arr[&lt;span class="dv"&gt;0&lt;/span&gt;]))&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;concat&lt;/span&gt;(&lt;/span&gt;
&lt;span id="cb7-5"&gt;&lt;a aria-hidden="true" href="#cb7-5" tabindex="-1"&gt;&lt;/a&gt;            arr[&lt;span class="dv"&gt;0&lt;/span&gt;]&lt;span class="op"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb7-6"&gt;&lt;a aria-hidden="true" href="#cb7-6" tabindex="-1"&gt;&lt;/a&gt;            &lt;span class="fu"&gt;quickSort&lt;/span&gt;(arr&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;slice&lt;/span&gt;(&lt;span class="dv"&gt;1&lt;/span&gt;)&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;filter&lt;/span&gt;(item &lt;span class="kw"&gt;=&amp;gt;&lt;/span&gt; item &lt;span class="op"&gt;&amp;gt;&lt;/span&gt; arr[&lt;span class="dv"&gt;0&lt;/span&gt;]))&lt;/span&gt;
&lt;span id="cb7-7"&gt;&lt;a aria-hidden="true" href="#cb7-7" tabindex="-1"&gt;&lt;/a&gt;        )&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb7-8"&gt;&lt;a aria-hidden="true" href="#cb7-8" tabindex="-1"&gt;&lt;/a&gt;}&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h1 id="测试"&gt;测试&lt;/h1&gt;
&lt;p&gt;对上述排序算法进行测试，使用一个装饰器进行计时。&lt;/p&gt;
&lt;div class="sourceCode" id="cb8"&gt;&lt;pre class="sourceCode python"&gt;&lt;code class="sourceCode python"&gt;&lt;span id="cb8-1"&gt;&lt;a aria-hidden="true" href="#cb8-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="im"&gt;from&lt;/span&gt; random &lt;span class="im"&gt;import&lt;/span&gt; randint&lt;/span&gt;
&lt;span id="cb8-2"&gt;&lt;a aria-hidden="true" href="#cb8-2" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="im"&gt;import&lt;/span&gt; time&lt;/span&gt;
&lt;span id="cb8-3"&gt;&lt;a aria-hidden="true" href="#cb8-3" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb8-4"&gt;&lt;a aria-hidden="true" href="#cb8-4" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;def&lt;/span&gt; timeit(function):&lt;/span&gt;
&lt;span id="cb8-5"&gt;&lt;a aria-hidden="true" href="#cb8-5" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="kw"&gt;def&lt;/span&gt; func(&lt;span class="op"&gt;*&lt;/span&gt;args, &lt;span class="op"&gt;**&lt;/span&gt;kwargs):&lt;/span&gt;
&lt;span id="cb8-6"&gt;&lt;a aria-hidden="true" href="#cb8-6" tabindex="-1"&gt;&lt;/a&gt;        time_start &lt;span class="op"&gt;=&lt;/span&gt; time.perf_counter()&lt;/span&gt;
&lt;span id="cb8-7"&gt;&lt;a aria-hidden="true" href="#cb8-7" tabindex="-1"&gt;&lt;/a&gt;        result &lt;span class="op"&gt;=&lt;/span&gt; function(&lt;span class="op"&gt;*&lt;/span&gt;args, &lt;span class="op"&gt;**&lt;/span&gt;kwargs)&lt;/span&gt;
&lt;span id="cb8-8"&gt;&lt;a aria-hidden="true" href="#cb8-8" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="bu"&gt;print&lt;/span&gt;(&lt;span class="ss"&gt;f"&lt;/span&gt;&lt;span class="sc"&gt;{&lt;/span&gt;function&lt;span class="sc"&gt;.&lt;/span&gt;&lt;span class="va"&gt;__name__&lt;/span&gt;&lt;span class="sc"&gt;}&lt;/span&gt;&lt;span class="ss"&gt; used &lt;/span&gt;&lt;span class="sc"&gt;{&lt;/span&gt;time&lt;span class="sc"&gt;.&lt;/span&gt;perf_counter()&lt;span class="op"&gt;-&lt;/span&gt;time_start&lt;span class="sc"&gt;:.5f}&lt;/span&gt;&lt;span class="ss"&gt; seconds."&lt;/span&gt;)&lt;/span&gt;
&lt;span id="cb8-9"&gt;&lt;a aria-hidden="true" href="#cb8-9" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="cf"&gt;return&lt;/span&gt; result&lt;/span&gt;
&lt;span id="cb8-10"&gt;&lt;a aria-hidden="true" href="#cb8-10" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb8-11"&gt;&lt;a aria-hidden="true" href="#cb8-11" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="cf"&gt;return&lt;/span&gt; func&lt;/span&gt;
&lt;span id="cb8-12"&gt;&lt;a aria-hidden="true" href="#cb8-12" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb8-13"&gt;&lt;a aria-hidden="true" href="#cb8-13" tabindex="-1"&gt;&lt;/a&gt;RANDOM_ARRAY &lt;span class="op"&gt;=&lt;/span&gt; [randint(&lt;span class="op"&gt;-&lt;/span&gt;&lt;span class="dv"&gt;32768&lt;/span&gt;, &lt;span class="dv"&gt;32768&lt;/span&gt;) &lt;span class="cf"&gt;for&lt;/span&gt; i &lt;span class="kw"&gt;in&lt;/span&gt; &lt;span class="bu"&gt;range&lt;/span&gt;(&lt;span class="dv"&gt;10000&lt;/span&gt;)]&lt;/span&gt;
&lt;span id="cb8-14"&gt;&lt;a aria-hidden="true" href="#cb8-14" tabindex="-1"&gt;&lt;/a&gt;ANSWER &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="bu"&gt;sorted&lt;/span&gt;(RANDOM_ARRAY)&lt;/span&gt;
&lt;span id="cb8-15"&gt;&lt;a aria-hidden="true" href="#cb8-15" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb8-16"&gt;&lt;a aria-hidden="true" href="#cb8-16" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="cf"&gt;if&lt;/span&gt; &lt;span class="va"&gt;__name__&lt;/span&gt; &lt;span class="op"&gt;==&lt;/span&gt; &lt;span class="st"&gt;"__main__"&lt;/span&gt;:&lt;/span&gt;
&lt;span id="cb8-17"&gt;&lt;a aria-hidden="true" href="#cb8-17" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="co"&gt;# 各个测试代码&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;结果如下：&lt;/p&gt;
&lt;p&gt;&lt;img src="./assets/result.webp"/&gt;&lt;/p&gt;
&lt;p&gt;可以在&lt;a href="assets/main.py"&gt;这里&lt;/a&gt;下载测试代码。&lt;/p&gt;
&lt;p&gt;除此以外，&lt;a href="https://cglab.ca/~morin/misc/sortalg/"&gt;这个站点&lt;/a&gt;描述了很多经典排序算法，均为 &lt;code&gt;Java&lt;/code&gt; 实现：&lt;/p&gt;
&lt;br/&gt;
&lt;!--%%REF%%--&gt;
&lt;br/&gt;
&lt;script async="" crossorigin="anonymous" data-category="Announcements" data-category-id="DIC_kwDOJ7Ymy84CX4eg" data-emit-metadata="0" data-input-position="top" data-lang="zh-CN" data-loading="lazy" data-mapping="title" data-reactions-enabled="1" data-repo="izfsk-ium/izfsk-ium.github.io" data-repo-id="R_kgDOJ7Ymyw" data-strict="0" data-theme="preferred_color_scheme" src="https://giscus.app/client.js"&gt;
&lt;/script&gt;
&lt;/main&gt;
&lt;footer&gt;
&lt;p class="signoff"&gt;
&lt;div class="metadata"&gt;
&lt;p class="date"&gt;&lt;time datetime="2021-07-28"&gt;创建日期：2021-07-28&lt;/time&gt;&lt;/p&gt;
&lt;p class="lastmodify"&gt;&lt;time&gt;最后编译：2023-08-10&lt;/time&gt;&lt;/p&gt;
&lt;p class="lastmodify" id="counter-span"&gt;访问次数：&lt;/p&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;/footer&gt;
&lt;script&gt;
    /* These script should run after page load */
    document.querySelectorAll('code.sourceCode').forEach(
      i =&gt; i.insertAdjacentHTML('beforeend', '&lt;div class="copy"&gt;复制&lt;/div&gt;')
    );
    document.querySelectorAll('div.copy').forEach(
      i =&gt; i.addEventListener(
        'click',
        () =&gt; {
          navigator.clipboard.writeText(i.parentElement.innerText.replace('复制', ''));
          i.innerText = '成功';
          setTimeout(() =&gt; {
            i.innerText = '复制';
          }, 1000);
        }
      )
    );

    if (location.href.includes("127.0.0.1:8080")) {
      document.getElementById("counter-span").innerHTML = "[[development mode]]";
    } else {
      const uuid = document.getElementById("article-uuid").innerText;
      const target = document.getElementById("counter-span");
      const last = localStorage.getItem("lastVisit-" + uuid);
      const shouldIncrease = last === null || new Date().getTime() - parseInt(last) &gt;= (1000 * 60 * 15);

      fetch(shouldIncrease ? ("https://counter.izfsk.top/counter/" + uuid) : ("https://counter.izfsk.top/readOnly/" + uuid))
        .then(r =&gt; r.text())
        .then(d =&gt; {
          if (!d.startsWith("Too"))
            document.getElementById("counter-span").innerText = "访问次数：" + d.toString();
          else
            document.getElementById("counter-span").innerHTML = "";
        });

      localStorage.setItem("lastVisit-" + uuid, new Date().getTime());
    }
  &lt;/script&gt;
&lt;script async="" data-website-id="2a1146ab-fa82-4a84-a04f-30e5967357c3" src="https://analytics.umami.is/script.js"&gt;&lt;/script&gt;
&lt;/body&gt;</content:encoded>
      <guid isPermaLink="false">3fff20fc-0bcc-497f-a3e2-79c5ca797426</guid>
      <pubDate>Wed, 28 Jul 2021 00:00:00 +0800</pubDate>
    </item>
    <item>
      <title>Lenovo Legion R7000 安装 openSUSE</title>
      <link>https://blog.izfsk.top/articles/Lenovo-Legion-R7000+openSUSE.html</link>
      <description>Lenovo Legion R7000 安装 openSUSE</description>
      <content:encoded>&lt;body&gt;
&lt;progress id="content_progress" value="0"&gt;&lt;/progress&gt;
&lt;button id="back-to-top"&gt;
    回页顶
  &lt;/button&gt;
&lt;header&gt;
&lt;small id="article-uuid" style="display: none !important;"&gt;27229a58-7f89-47b6-b217-54f35d638fb1&lt;/small&gt;
&lt;h1 class="title"&gt;Lenovo Legion R7000 安装 openSUSE&lt;/h1&gt;
&lt;!-- Subtitle --&gt;
&lt;h3 class="subtitle"&gt; &lt;/h3&gt;
&lt;/header&gt;
&lt;nav id="TOC" role="doc-toc"&gt;
&lt;strong&gt;文章归类: &lt;a href="/pages/category.html#杂项"&gt;杂项&lt;/a&gt; &lt;/strong&gt;
&lt;input id="contents" type="checkbox"/&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#lenovo-legion-r7000-2021-opensuse-i3wm-配置" id="toc-lenovo-legion-r7000-2021-opensuse-i3wm-配置"&gt;Lenovo Legion R7000 2021 + openSUSE + i3wm 配置&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#操作系统安装" id="toc-操作系统安装"&gt;1. 操作系统安装&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#nvidia驱动安装" id="toc-nvidia驱动安装"&gt;2. Nvidia驱动安装&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#窗口管理器安装" id="toc-窗口管理器安装"&gt;3. 窗口管理器安装&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#多媒体解码器安装" id="toc-多媒体解码器安装"&gt;4. 多媒体解码器安装&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#下拉终端" id="toc-下拉终端"&gt;5. 下拉终端&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#终端模拟器" id="toc-终端模拟器"&gt;6. 终端模拟器&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#壁纸" id="toc-壁纸"&gt;7. 壁纸&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#状态栏" id="toc-状态栏"&gt;8. 状态栏&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#混成器" id="toc-混成器"&gt;9. 混成器&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#网络管理" id="toc-网络管理"&gt;10. 网络管理&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#输入法" id="toc-输入法"&gt;11. 输入法&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#锁屏" id="toc-锁屏"&gt;12. 锁屏&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#背光调节" id="toc-背光调节"&gt;13. 背光调节&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#通知管理" id="toc-通知管理"&gt;14. 通知管理&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#u盘自动挂载" id="toc-u盘自动挂载"&gt;15. U盘自动挂载&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#reference"&gt;参考链接&lt;/a&gt;&lt;/li&gt;
&lt;li&gt; &lt;/li&gt;
&lt;li class="tools"&gt;
&lt;span id="backtomain"&gt;
&lt;svg class="bi bi-house" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M8.707 1.5a1 1 0 0 0-1.414 0L.646 8.146a.5.5 0 0 0 .708.708L2 8.207V13.5A1.5 1.5 0 0 0 3.5 15h9a1.5 1.5 0 0 0 1.5-1.5V8.207l.646.647a.5.5 0 0 0 .708-.708L13 5.793V2.5a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v1.293L8.707 1.5ZM13 7.207V13.5a.5.5 0 0 1-.5.5h-9a.5.5 0 0 1-.5-.5V7.207l5-5 5 5Z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="readingmode"&gt;
&lt;svg class="bi bi-book" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M1 2.828c.885-.37 2.154-.769 3.388-.893 1.33-.134 2.458.063 3.112.752v9.746c-.935-.53-2.12-.603-3.213-.493-1.18.12-2.37.461-3.287.811V2.828zm7.5-.141c.654-.689 1.782-.886 3.112-.752 1.234.124 2.503.523 3.388.893v9.923c-.918-.35-2.107-.692-3.287-.81-1.094-.111-2.278-.039-3.213.492V2.687zM8 1.783C7.015.936 5.587.81 4.287.94c-1.514.153-3.042.672-3.994 1.105A.5.5 0 0 0 0 2.5v11a.5.5 0 0 0 .707.455c.882-.4 2.303-.881 3.68-1.02 1.409-.142 2.59.087 3.223.877a.5.5 0 0 0 .78 0c.633-.79 1.814-1.019 3.222-.877 1.378.139 2.8.62 3.681 1.02A.5.5 0 0 0 16 13.5v-11a.5.5 0 0 0-.293-.455c-.952-.433-2.48-.952-3.994-1.105C10.413.809 8.985.936 8 1.783z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="larger"&gt; &lt;/span&gt;
&lt;span id="smaller"&gt;&lt;/span&gt;
&lt;span id="switchfont"&gt;
&lt;svg class="bi bi-fonts" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M12.258 3h-8.51l-.083 2.46h.479c.26-1.544.758-1.783 2.693-1.845l.424-.013v7.827c0 .663-.144.82-1.3.923v.52h4.082v-.52c-1.162-.103-1.306-.26-1.306-.923V3.602l.431.013c1.934.062 2.434.301 2.693 1.846h.479L12.258 3z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="backtotop"&gt;
&lt;svg class="bi bi-arrow-bar-up" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M8 10a.5.5 0 0 0 .5-.5V3.707l2.146 2.147a.5.5 0 0 0 .708-.708l-3-3a.5.5 0 0 0-.708 0l-3 3a.5.5 0 1 0 .708.708L7.5 3.707V9.5a.5.5 0 0 0 .5.5zm-7 2.5a.5.5 0 0 1 .5-.5h13a.5.5 0 0 1 0 1h-13a.5.5 0 0 1-.5-.5z" fill-rule="evenodd"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/nav&gt;
&lt;main&gt;
&lt;h1 id="lenovo-legion-r7000-2021-opensuse-i3wm-配置"&gt;Lenovo Legion R7000 2021 + openSUSE + i3wm 配置&lt;/h1&gt;
&lt;ol type="1"&gt;
&lt;li&gt;&lt;p&gt;不要使用openSUSE Leap，目前的Leap(15.3)无法识别无线网卡驱动。Tumbleweed可以识别。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;在BIOS设置里将输出设置从”集显输出”改为”混合输出”，否则在suspend后无法苏醒。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;如果使用KDE，避免使用Wayland模式，否则CPU占用会暴涨导致无法使用。&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id="操作系统安装"&gt;1. 操作系统安装&lt;/h2&gt;
&lt;p&gt;我原本使用的是KDE Neon系统，它在我的老电脑上运作的很好，但我打算在新的电脑上使用非基于Ubuntu和dpkg的系统。Arch太复杂了，最后选择了openSUSE。&lt;/p&gt;
&lt;p&gt;openSUSE有Leap和Tumbleweed两个分发，由于滚动更新曾经搞坏过我的系统，我首先选择了Leap。但是安装出现了两个问题：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;无线网卡没法显示出来。安装以后也识别不出来。可能是因为Leap的内核版本太老了。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Xorg无法正常启动。虽然我安装的时候选择的默认启动模式是图像界面，但进去还是tty，并且没法&lt;code&gt;startx&lt;/code&gt;启动Xorg。不知道是什么问题。&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;所以我最后安装了Tumbleweed。滚动更新那就两个星期滚一次。而且之后我了解到SUSE使用的btrfs有快照功能，就不用怕滚坏掉系统了。&lt;/p&gt;
&lt;p&gt;安装的过程很顺利，Tumbleweed可以识别所以的硬件，并且安装以后(保险起见我还是安装了KDE全家桶)也可以正常的启动。&lt;/p&gt;
&lt;h2 id="nvidia驱动安装"&gt;2. Nvidia驱动安装&lt;/h2&gt;
&lt;p&gt;这台电脑用的是RTX 3050显卡，我不懂这些型号而且也不玩游戏。不过有一个超棒的显卡似乎也不错，那我就觉得要安装一下Nvidia的私有驱动。我按照指南上的成功安装了。&lt;/p&gt;
&lt;pre class="shell"&gt;&lt;code&gt;sudo zypper addrepo --refresh https://download.nvidia.com/opensuse/tumbleweed NVIDIA
sudo zypper in x11-video-nvidiaG05&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;不过注意安装要在tty模式进行不然可能会出现什么幺蛾子(&lt;/p&gt;
&lt;p&gt;安装完毕以后就可以打开&lt;code&gt;nvidia-settings&lt;/code&gt;调控显卡啦！&lt;/p&gt;
&lt;h2 id="窗口管理器安装"&gt;3. 窗口管理器安装&lt;/h2&gt;
&lt;p&gt;我以前一直使用KDE全家桶，不过一来我想尝尝鲜，二来买这台电脑没有送我鼠标，最重要的是这个电脑左右两侧的USB口只有一个，导致我根本不够用，所以我打算使用平铺式窗口管理器。&lt;/p&gt;
&lt;p&gt;我参考了一些最后选择使用i3-gap，因为它不只是只有平铺一种模式，也可以切换为浮动模式，这样要是我愿意也可以换回去。而且比起原版的i3，它多一个gap，所以不同的窗口之间可以有空隙，更加好看！软件源里面就有i3-gap所以只需要&lt;/p&gt;
&lt;div class="sourceCode" id="cb2"&gt;&lt;pre class="sourceCode bash"&gt;&lt;code class="sourceCode bash"&gt;&lt;span id="cb2-1"&gt;&lt;a aria-hidden="true" href="#cb2-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="fu"&gt;sudo&lt;/span&gt; zypper install i3-gap &lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;就可以了。然后众所周知平铺式窗口管理器强烈依赖于键盘(好在Fn+Space切换键盘灯依旧可以用)，所以需要大量的配置。我把大量的快捷键重新map了一遍，&lt;del&gt; 这样其他人就没法用我的电脑啦！&lt;/del&gt; 这其实蛮困难的因为总是有好多矛盾的键。我使用了Mod1(Alt)和$Mod(Super)这两个功能键。我打算以后配置完整了上传github备份一下免得丢了。&lt;/p&gt;
&lt;h2 id="多媒体解码器安装"&gt;4. 多媒体解码器安装&lt;/h2&gt;
&lt;p&gt;openSUSE没法直接播放mp3之类的格式，据说是因为版权原因巴拉巴拉的什么，总之，要想正常播放多媒体，直接安装vlc肯定是不行啦。所以需要一个叫做&lt;code&gt;packman&lt;/code&gt;的第三方源来安装&lt;del&gt;甩锅&lt;/del&gt;这些解码器。具体的来讲就是：&lt;/p&gt;
&lt;div class="sourceCode" id="cb3"&gt;&lt;pre class="sourceCode bash"&gt;&lt;code class="sourceCode bash"&gt;&lt;span id="cb3-1"&gt;&lt;a aria-hidden="true" href="#cb3-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="fu"&gt;sudo&lt;/span&gt; zypper ar &lt;span class="at"&gt;-cfp&lt;/span&gt; 90 https://ftp.gwdg.de/pub/linux/misc/packman/suse/openSUSE_Tumbleweed packman&lt;/span&gt;
&lt;span id="cb3-2"&gt;&lt;a aria-hidden="true" href="#cb3-2" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="fu"&gt;sudo&lt;/span&gt; zypper dup &lt;span class="at"&gt;--from&lt;/span&gt; packman &lt;span class="at"&gt;--allow-vendor-change&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb3-3"&gt;&lt;a aria-hidden="true" href="#cb3-3" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="fu"&gt;sudo&lt;/span&gt; zypper install &lt;span class="at"&gt;--from&lt;/span&gt; packman ffmpeg mpv libavcodec-full vlc-codecs&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;三条指令执行下来就可以播放电影和音乐啦！&lt;/p&gt;
&lt;h2 id="下拉终端"&gt;5. 下拉终端&lt;/h2&gt;
&lt;p&gt;这个对我来说很重要，就像对一个人讲话一样，时不时对电脑讲一两句，专门打开一个shell再关掉就太麻烦了。所以需要下拉终端。&lt;/p&gt;
&lt;p&gt;我考虑了我以前使用的KDE的&lt;code&gt;Yakuake&lt;/code&gt;，但是它有一些问题，首先是没法正确的混成。导致只有一半的窗口被渲染；其次是它没法正确的被对待为一个”下拉窗口”，总是被i3当作普通的窗口，一下子就占满整个屏幕；最后kde系列软件需要的软件包好多啊。所以我选择了另外一个下拉终端&lt;code&gt;guake&lt;/code&gt;，虽然我真的很不喜欢它的名字”挂科”……&lt;/p&gt;
&lt;h2 id="终端模拟器"&gt;6. 终端模拟器&lt;/h2&gt;
&lt;p&gt;默认的终端模拟器(就是$mod+Shift+Enter启动的那个)是很丑很丑的&lt;code&gt;uxterm&lt;/code&gt;。虽然配置一下也可以很好看，但是我决定使用其他的模拟器。我选择了&lt;code&gt;alacritty&lt;/code&gt;。本来是想用&lt;code&gt;kitty&lt;/code&gt;的，但是它对于中文输入法似乎支持不够友好，所以即使有很多好功能，比如标签页功能(可以用&lt;code&gt;termux&lt;/code&gt;替代)，也没有选择它。&lt;/p&gt;
&lt;h2 id="壁纸"&gt;7. 壁纸&lt;/h2&gt;
&lt;p&gt;壁纸当然是使用&lt;code&gt;feh&lt;/code&gt;来设置。我本来想使用&lt;code&gt;mpv&lt;/code&gt;搞一个动态的视频壁纸，但好像和混成器起了冲突。&lt;/p&gt;
&lt;div class="sourceCode" id="cb4"&gt;&lt;pre class="sourceCode bash"&gt;&lt;code class="sourceCode bash"&gt;&lt;span id="cb4-1"&gt;&lt;a aria-hidden="true" href="#cb4-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="ex"&gt;feh&lt;/span&gt; &lt;span class="at"&gt;--bg-scale&lt;/span&gt; wallpaper_file.jpg&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;记得加在i3的配置文件里面自启动。&lt;/p&gt;
&lt;h2 id="状态栏"&gt;8. 状态栏&lt;/h2&gt;
&lt;p&gt;当然是使用&lt;code&gt;polybar&lt;/code&gt;啦！我在github上下载了著名的&lt;code&gt;adi1090x/polybar-themes&lt;/code&gt;里面的主题。不过要注意，里面的东西&lt;strong&gt;不能直接用&lt;/strong&gt;而是要按照自己电脑的实际情况改动。比如里面关于显示wifi状态的网络接口名称每一台电脑都不一样，又比如显卡的亮度读取amd和intel也不一样。&lt;/p&gt;
&lt;p&gt;这些东西，包括栏的显示的内容都可以直接改它的主题文件。具体的就是&lt;code&gt;~/.config/polybar/主题名字/config.ini&lt;/code&gt;里面的&lt;code&gt;modules-left&lt;/code&gt;,&lt;code&gt;modules-center&lt;/code&gt;和&lt;code&gt;modules-right&lt;/code&gt;这些内容。可用的模块可以在同目录里面的&lt;code&gt;modules.ini&lt;/code&gt;和&lt;code&gt;user_modules.ini&lt;/code&gt;    里面找到和更改。最后启动&lt;code&gt;polybar&lt;/code&gt;只需要在i3 config里面exec 主题文件夹里面的&lt;code&gt;launch.sh&lt;/code&gt;就可以了。&lt;/p&gt;
&lt;p&gt;另外，原版的&lt;code&gt;i3-status&lt;/code&gt;也可以保留。我是默认隐藏，只有按特殊键才会显示。里面的内容是一些诸如IP地址之类的不常用的信息。&lt;/p&gt;
&lt;h2 id="混成器"&gt;9. 混成器&lt;/h2&gt;
&lt;p&gt;混成器我使用的是&lt;code&gt;picom&lt;/code&gt;，还有一个&lt;code&gt;compton&lt;/code&gt;可以选择，但是两个软件似乎是矛盾的，安装一个就会自动卸载另外一个。不管怎么说其实都很好啦！&lt;/p&gt;
&lt;p&gt;不管需要注意的是，zypper安装的&lt;code&gt;picom&lt;/code&gt;只有&lt;code&gt;kernel&lt;/code&gt;这一个模糊方式，如果需要其他的实验性模糊后端必须自己编译github上的源码。&lt;/p&gt;
&lt;h2 id="网络管理"&gt;10. 网络管理&lt;/h2&gt;
&lt;del&gt;
    其实也不是是不能用&lt;code&gt;nmtui&lt;/code&gt;
&lt;/del&gt;
&lt;p&gt;使用&lt;code&gt;nm-applet&lt;/code&gt;就解决了。&lt;/p&gt;
&lt;p&gt;但还是有问题：总是扫描不出wifi网络。不知道是驱动的问题还是&lt;code&gt;NetworkManager&lt;/code&gt;的问题了。总之思考一下以后我使用另外一个方法上网，使用手机的USB tethering功能，即插即用完全不用密码什么的。&lt;/p&gt;
&lt;h2 id="输入法"&gt;11. 输入法&lt;/h2&gt;
&lt;p&gt;如果在安装时候选择中文，或者安装以后在yast2里面更改语言为中文，那么中文输入法，词库，字体都会一股脑自动安装上来直接就可以使用，但是，一旦把语言改回英文，yast2就会自作聪明的把这一切都删光光……&lt;/p&gt;
&lt;p&gt;所以，最好的方法就是自己手动安装一下了。我安装的是&lt;code&gt;ibus&lt;/code&gt;和&lt;code&gt;rime&lt;/code&gt;输入法。&lt;/p&gt;
&lt;div class="sourceCode" id="cb5"&gt;&lt;pre class="sourceCode bash"&gt;&lt;code class="sourceCode bash"&gt;&lt;span id="cb5-1"&gt;&lt;a aria-hidden="true" href="#cb5-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="fu"&gt;sudo&lt;/span&gt; zypper install ibus ibus-rime&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;安装成功以后，还需要在&lt;code&gt;ibus-setup&lt;/code&gt;里面启用安装的输入法才可以使用。最后不要忘记把守护进程添加到i3的自启动里面。&lt;/p&gt;
&lt;div class="sourceCode" id="cb6"&gt;&lt;pre class="sourceCode bash"&gt;&lt;code class="sourceCode bash"&gt;&lt;span id="cb6-1"&gt;&lt;a aria-hidden="true" href="#cb6-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="ex"&gt;exec-always&lt;/span&gt; &lt;span class="at"&gt;--no-startup-id&lt;/span&gt; ibus-daemon &lt;span class="at"&gt;-drx&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id="锁屏"&gt;12. 锁屏&lt;/h2&gt;
&lt;p&gt;锁屏是很必要的。然而i3lock实在是太简陋了，所以有很多加强版的快捷锁屏。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;i3lock-fancy&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;仓库地址是 https://github.com/meskarune/i3lock-fancy.git&lt;/p&gt;
&lt;p&gt;这其实是一个shell脚本，用来调用原来的i3lock，可以设置截图背景模糊灰度之类的。其实和自己写一个脚本调用convert和scort差不多但是别人写的更方便通用一些。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;i3lock-color&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;仓库地址是 https://github.com/Raymo111/i3lock-color&lt;/p&gt;
&lt;p&gt;这个是fork的原来的i3lock并且加入了许多高级功能，比如可以更改显示位置，显示时间日期什么的。需要自己编译，或者也可以直接下载release。在仓库里面&lt;code&gt;example&lt;/code&gt;目录里面有demo脚本可以自己改。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;xsecurelock&lt;/p&gt;
&lt;p&gt;这个和i3lock没有关系，是谷歌的独立项目。好处在于首先是安全，其次是可以使用mpv作为后端来搞动态锁屏。需要自己编译。&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="背光调节"&gt;13. 背光调节&lt;/h2&gt;
&lt;del&gt;
    我看网上的i3背光调节都是使用&lt;code&gt;xbacklight&lt;/code&gt;但是我的完全不起作用，所以我自己用&lt;code&gt;xrandr&lt;/code&gt;写了一个脚本绑定快捷键，聊胜于无吧.
    &lt;/del&gt;
&lt;p&gt;&lt;code&gt;xbacklight&lt;/code&gt; 不起作用的原因：&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&lt;code&gt;xbacklight&lt;/code&gt; only works with Intel. Other drivers (e.g. Radeon) did not add support for the RandR backlight property.&lt;/strong&gt;&lt;/p&gt;
&lt;div class="sourceCode" id="cb7"&gt;&lt;pre class="sourceCode sh"&gt;&lt;code class="sourceCode bash"&gt;&lt;span id="cb7-1"&gt;&lt;a aria-hidden="true" href="#cb7-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="co"&gt;#!/bin/bash&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb7-2"&gt;&lt;a aria-hidden="true" href="#cb7-2" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="va"&gt;B_FILE&lt;/span&gt;&lt;span class="op"&gt;=&lt;/span&gt;~/Ramdisk/backlight&lt;/span&gt;
&lt;span id="cb7-3"&gt;&lt;a aria-hidden="true" href="#cb7-3" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb7-4"&gt;&lt;a aria-hidden="true" href="#cb7-4" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="cf"&gt;if&lt;/span&gt; &lt;span class="bu"&gt;[&lt;/span&gt; &lt;span class="ot"&gt;!&lt;/span&gt; &lt;span class="ot"&gt;-f&lt;/span&gt; &lt;span class="va"&gt;$B_FILE&lt;/span&gt; &lt;span class="bu"&gt;]&lt;/span&gt;&lt;span class="kw"&gt;;&lt;/span&gt;&lt;span class="cf"&gt;then&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb7-5"&gt;&lt;a aria-hidden="true" href="#cb7-5" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="bu"&gt;echo&lt;/span&gt; &lt;span class="st"&gt;'No backlight file found.'&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb7-6"&gt;&lt;a aria-hidden="true" href="#cb7-6" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="bu"&gt;echo&lt;/span&gt; &lt;span class="st"&gt;'1.0'&lt;/span&gt; &lt;span class="op"&gt;&amp;gt;&lt;/span&gt; &lt;span class="va"&gt;$B_FILE&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb7-7"&gt;&lt;a aria-hidden="true" href="#cb7-7" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="cf"&gt;fi&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb7-8"&gt;&lt;a aria-hidden="true" href="#cb7-8" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb7-9"&gt;&lt;a aria-hidden="true" href="#cb7-9" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="va"&gt;old_light&lt;/span&gt;&lt;span class="op"&gt;=&lt;/span&gt;&lt;span class="va"&gt;$(&lt;/span&gt;&lt;span class="fu"&gt;cat&lt;/span&gt; ~/Ramdisk/backlight&lt;span class="va"&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb7-10"&gt;&lt;a aria-hidden="true" href="#cb7-10" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb7-11"&gt;&lt;a aria-hidden="true" href="#cb7-11" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="cf"&gt;if&lt;/span&gt; &lt;span class="bu"&gt;[&lt;/span&gt; &lt;span class="va"&gt;$1&lt;/span&gt; &lt;span class="ot"&gt;==&lt;/span&gt; inc &lt;span class="bu"&gt;]&lt;/span&gt;&lt;span class="kw"&gt;;&lt;/span&gt;&lt;span class="cf"&gt;then&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb7-12"&gt;&lt;a aria-hidden="true" href="#cb7-12" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="va"&gt;new_light&lt;/span&gt;&lt;span class="op"&gt;=&lt;/span&gt;&lt;span class="va"&gt;$(&lt;/span&gt;&lt;span class="bu"&gt;echo&lt;/span&gt; &lt;span class="va"&gt;$old_light&lt;/span&gt; &lt;span class="st"&gt;'+0.1'&lt;/span&gt; &lt;span class="kw"&gt;|&lt;/span&gt; &lt;span class="fu"&gt;bc&lt;/span&gt; &lt;span class="va"&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb7-13"&gt;&lt;a aria-hidden="true" href="#cb7-13" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="cf"&gt;else&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb7-14"&gt;&lt;a aria-hidden="true" href="#cb7-14" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="va"&gt;new_light&lt;/span&gt;&lt;span class="op"&gt;=&lt;/span&gt;&lt;span class="va"&gt;$(&lt;/span&gt;&lt;span class="bu"&gt;echo&lt;/span&gt; &lt;span class="va"&gt;$old_light&lt;/span&gt; &lt;span class="st"&gt;'-0.1'&lt;/span&gt; &lt;span class="kw"&gt;|&lt;/span&gt; &lt;span class="fu"&gt;bc&lt;/span&gt; &lt;span class="va"&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb7-15"&gt;&lt;a aria-hidden="true" href="#cb7-15" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="cf"&gt;fi&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb7-16"&gt;&lt;a aria-hidden="true" href="#cb7-16" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb7-17"&gt;&lt;a aria-hidden="true" href="#cb7-17" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="ex"&gt;xrandr&lt;/span&gt; &lt;span class="at"&gt;--output&lt;/span&gt; eDP &lt;span class="at"&gt;--brightness&lt;/span&gt; &lt;span class="va"&gt;$new_light&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb7-18"&gt;&lt;a aria-hidden="true" href="#cb7-18" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="bu"&gt;echo&lt;/span&gt; &lt;span class="va"&gt;$new_light&lt;/span&gt; &lt;span class="op"&gt;&amp;gt;&lt;/span&gt; &lt;span class="va"&gt;$B_FILE&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id="通知管理"&gt;14. 通知管理&lt;/h2&gt;
&lt;p&gt;其实通知并不是很多。所以简单地使用dunst再抄一份官网上的配置文件就足够了。&lt;/p&gt;
&lt;h2 id="u盘自动挂载"&gt;15. U盘自动挂载&lt;/h2&gt;
&lt;p&gt;相比与完整的桌面环境，i3好像没有可以自动挂载的机制，所以需要手动操作。但是每次sudo mount实在是太麻烦，我找了一下，可以使用&lt;code&gt;udiskie&lt;/code&gt;来自动操作。那就下载一个好了。&lt;/p&gt;
&lt;p&gt;缺点在于，现在i3的自启动daemon有六七个之多……&lt;/p&gt;
&lt;br/&gt;
&lt;!--%%REF%%--&gt;
&lt;br/&gt;
&lt;script async="" crossorigin="anonymous" data-category="Announcements" data-category-id="DIC_kwDOJ7Ymy84CX4eg" data-emit-metadata="0" data-input-position="top" data-lang="zh-CN" data-loading="lazy" data-mapping="title" data-reactions-enabled="1" data-repo="izfsk-ium/izfsk-ium.github.io" data-repo-id="R_kgDOJ7Ymyw" data-strict="0" data-theme="preferred_color_scheme" src="https://giscus.app/client.js"&gt;
&lt;/script&gt;
&lt;/main&gt;
&lt;footer&gt;
&lt;p class="signoff"&gt;
&lt;div class="metadata"&gt;
&lt;p class="date"&gt;&lt;time datetime="2022-07-13"&gt;创建日期：2022-07-13&lt;/time&gt;&lt;/p&gt;
&lt;p class="lastmodify"&gt;&lt;time&gt;最后编译：2023-08-10&lt;/time&gt;&lt;/p&gt;
&lt;p class="lastmodify" id="counter-span"&gt;访问次数：&lt;/p&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;/footer&gt;
&lt;script&gt;
    /* These script should run after page load */
    document.querySelectorAll('code.sourceCode').forEach(
      i =&gt; i.insertAdjacentHTML('beforeend', '&lt;div class="copy"&gt;复制&lt;/div&gt;')
    );
    document.querySelectorAll('div.copy').forEach(
      i =&gt; i.addEventListener(
        'click',
        () =&gt; {
          navigator.clipboard.writeText(i.parentElement.innerText.replace('复制', ''));
          i.innerText = '成功';
          setTimeout(() =&gt; {
            i.innerText = '复制';
          }, 1000);
        }
      )
    );

    if (location.href.includes("127.0.0.1:8080")) {
      document.getElementById("counter-span").innerHTML = "[[development mode]]";
    } else {
      const uuid = document.getElementById("article-uuid").innerText;
      const target = document.getElementById("counter-span");
      const last = localStorage.getItem("lastVisit-" + uuid);
      const shouldIncrease = last === null || new Date().getTime() - parseInt(last) &gt;= (1000 * 60 * 15);

      fetch(shouldIncrease ? ("https://counter.izfsk.top/counter/" + uuid) : ("https://counter.izfsk.top/readOnly/" + uuid))
        .then(r =&gt; r.text())
        .then(d =&gt; {
          if (!d.startsWith("Too"))
            document.getElementById("counter-span").innerText = "访问次数：" + d.toString();
          else
            document.getElementById("counter-span").innerHTML = "";
        });

      localStorage.setItem("lastVisit-" + uuid, new Date().getTime());
    }
  &lt;/script&gt;
&lt;script async="" data-website-id="2a1146ab-fa82-4a84-a04f-30e5967357c3" src="https://analytics.umami.is/script.js"&gt;&lt;/script&gt;
&lt;/body&gt;</content:encoded>
      <guid isPermaLink="false">27229a58-7f89-47b6-b217-54f35d638fb1</guid>
      <pubDate>Wed, 13 Jul 2022 00:00:00 +0800</pubDate>
    </item>
    <item>
      <title>CSS_Tooltip技巧</title>
      <link>https://blog.izfsk.top/articles/CSS-Tooltip技巧.html</link>
      <description>CSS_Tooltip技巧</description>
      <content:encoded>&lt;body&gt;
&lt;progress id="content_progress" value="0"&gt;&lt;/progress&gt;
&lt;button id="back-to-top"&gt;
    回页顶
  &lt;/button&gt;
&lt;header&gt;
&lt;small id="article-uuid" style="display: none !important;"&gt;9a1f2f73-527f-40cc-b3ad-3ca0d7380bf9&lt;/small&gt;
&lt;h1 class="title"&gt;CSS_Tooltip技巧&lt;/h1&gt;
&lt;!-- Subtitle --&gt;
&lt;h3 class="subtitle"&gt; &lt;/h3&gt;
&lt;/header&gt;
&lt;nav id="TOC" role="doc-toc"&gt;
&lt;strong&gt;文章归类: &lt;a href="/pages/category.html#技术"&gt;技术&lt;/a&gt; &lt;/strong&gt;
&lt;input id="contents" type="checkbox"/&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#可以使用纯css实现tooltip" id="toc-可以使用纯css实现tooltip"&gt;可以使用纯CSS实现Tooltip&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#reference"&gt;参考链接&lt;/a&gt;&lt;/li&gt;
&lt;li&gt; &lt;/li&gt;
&lt;li class="tools"&gt;
&lt;span id="backtomain"&gt;
&lt;svg class="bi bi-house" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M8.707 1.5a1 1 0 0 0-1.414 0L.646 8.146a.5.5 0 0 0 .708.708L2 8.207V13.5A1.5 1.5 0 0 0 3.5 15h9a1.5 1.5 0 0 0 1.5-1.5V8.207l.646.647a.5.5 0 0 0 .708-.708L13 5.793V2.5a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v1.293L8.707 1.5ZM13 7.207V13.5a.5.5 0 0 1-.5.5h-9a.5.5 0 0 1-.5-.5V7.207l5-5 5 5Z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="readingmode"&gt;
&lt;svg class="bi bi-book" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M1 2.828c.885-.37 2.154-.769 3.388-.893 1.33-.134 2.458.063 3.112.752v9.746c-.935-.53-2.12-.603-3.213-.493-1.18.12-2.37.461-3.287.811V2.828zm7.5-.141c.654-.689 1.782-.886 3.112-.752 1.234.124 2.503.523 3.388.893v9.923c-.918-.35-2.107-.692-3.287-.81-1.094-.111-2.278-.039-3.213.492V2.687zM8 1.783C7.015.936 5.587.81 4.287.94c-1.514.153-3.042.672-3.994 1.105A.5.5 0 0 0 0 2.5v11a.5.5 0 0 0 .707.455c.882-.4 2.303-.881 3.68-1.02 1.409-.142 2.59.087 3.223.877a.5.5 0 0 0 .78 0c.633-.79 1.814-1.019 3.222-.877 1.378.139 2.8.62 3.681 1.02A.5.5 0 0 0 16 13.5v-11a.5.5 0 0 0-.293-.455c-.952-.433-2.48-.952-3.994-1.105C10.413.809 8.985.936 8 1.783z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="larger"&gt; &lt;/span&gt;
&lt;span id="smaller"&gt;&lt;/span&gt;
&lt;span id="switchfont"&gt;
&lt;svg class="bi bi-fonts" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M12.258 3h-8.51l-.083 2.46h.479c.26-1.544.758-1.783 2.693-1.845l.424-.013v7.827c0 .663-.144.82-1.3.923v.52h4.082v-.52c-1.162-.103-1.306-.26-1.306-.923V3.602l.431.013c1.934.062 2.434.301 2.693 1.846h.479L12.258 3z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="backtotop"&gt;
&lt;svg class="bi bi-arrow-bar-up" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M8 10a.5.5 0 0 0 .5-.5V3.707l2.146 2.147a.5.5 0 0 0 .708-.708l-3-3a.5.5 0 0 0-.708 0l-3 3a.5.5 0 1 0 .708.708L7.5 3.707V9.5a.5.5 0 0 0 .5.5zm-7 2.5a.5.5 0 0 1 .5-.5h13a.5.5 0 0 1 0 1h-13a.5.5 0 0 1-.5-.5z" fill-rule="evenodd"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/nav&gt;
&lt;main&gt;
&lt;h1 id="可以使用纯css实现tooltip"&gt;可以使用纯CSS实现Tooltip&lt;/h1&gt;
&lt;p&gt;原理是使用&lt;code&gt;:after&lt;/code&gt;,&lt;code&gt;:before&lt;/code&gt;伪类和&lt;code&gt;:hover&lt;/code&gt;来动态添加内容。Tooltip的内容可以使用&lt;code&gt;content:attr()&lt;/code&gt;来获取。&lt;/p&gt;
&lt;p&gt;具体实现:&lt;/p&gt;
&lt;div class="sourceCode" id="cb1"&gt;&lt;pre class="sourceCode css"&gt;&lt;code class="sourceCode css"&gt;&lt;span id="cb1-1"&gt;&lt;a aria-hidden="true" href="#cb1-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="fu"&gt;.tooltip&lt;/span&gt; {&lt;/span&gt;
&lt;span id="cb1-2"&gt;&lt;a aria-hidden="true" href="#cb1-2" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="co"&gt;/* 确定Tooltip的位置 */&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-3"&gt;&lt;a aria-hidden="true" href="#cb1-3" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="kw"&gt;position&lt;/span&gt;: &lt;span class="dv"&gt;relative&lt;/span&gt;&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-4"&gt;&lt;a aria-hidden="true" href="#cb1-4" tabindex="-1"&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id="cb1-5"&gt;&lt;a aria-hidden="true" href="#cb1-5" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb1-6"&gt;&lt;a aria-hidden="true" href="#cb1-6" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="fu"&gt;.tooltip&lt;/span&gt;&lt;span class="in"&gt;:hover:after&lt;/span&gt; {&lt;/span&gt;
&lt;span id="cb1-7"&gt;&lt;a aria-hidden="true" href="#cb1-7" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="co"&gt;/* 获取标签的内容 */&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-8"&gt;&lt;a aria-hidden="true" href="#cb1-8" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="kw"&gt;content&lt;/span&gt;: &lt;span class="fu"&gt;attr(&lt;/span&gt;data-tooltip&lt;span class="fu"&gt;)&lt;/span&gt;&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-9"&gt;&lt;a aria-hidden="true" href="#cb1-9" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="kw"&gt;background&lt;/span&gt;: &lt;span class="cn"&gt;#000&lt;/span&gt;&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-10"&gt;&lt;a aria-hidden="true" href="#cb1-10" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="kw"&gt;color&lt;/span&gt;: &lt;span class="cn"&gt;#FFF&lt;/span&gt;&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-11"&gt;&lt;a aria-hidden="true" href="#cb1-11" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="kw"&gt;text-align&lt;/span&gt;: &lt;span class="dv"&gt;center&lt;/span&gt;&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-12"&gt;&lt;a aria-hidden="true" href="#cb1-12" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="kw"&gt;border-radius&lt;/span&gt;: &lt;span class="dv"&gt;3&lt;/span&gt;&lt;span class="dt"&gt;px&lt;/span&gt;&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-13"&gt;&lt;a aria-hidden="true" href="#cb1-13" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="kw"&gt;padding&lt;/span&gt;: &lt;span class="dv"&gt;5&lt;/span&gt;&lt;span class="dt"&gt;px&lt;/span&gt;&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-14"&gt;&lt;a aria-hidden="true" href="#cb1-14" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="kw"&gt;display&lt;/span&gt;: &lt;span class="dv"&gt;inline-block&lt;/span&gt;&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-15"&gt;&lt;a aria-hidden="true" href="#cb1-15" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="co"&gt;/* 保持在目标上方 */&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-16"&gt;&lt;a aria-hidden="true" href="#cb1-16" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="kw"&gt;position&lt;/span&gt;: &lt;span class="dv"&gt;absolute&lt;/span&gt;&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-17"&gt;&lt;a aria-hidden="true" href="#cb1-17" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="kw"&gt;transform&lt;/span&gt;: &lt;span class="fu"&gt;translate(&lt;/span&gt;&lt;span class="dv"&gt;-50&lt;/span&gt;&lt;span class="dt"&gt;%&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt; &lt;span class="dv"&gt;-100&lt;/span&gt;&lt;span class="dt"&gt;%&lt;/span&gt;&lt;span class="fu"&gt;)&lt;/span&gt;&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-18"&gt;&lt;a aria-hidden="true" href="#cb1-18" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="co"&gt;/* 保持居中 */&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-19"&gt;&lt;a aria-hidden="true" href="#cb1-19" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="kw"&gt;left&lt;/span&gt;: &lt;span class="dv"&gt;50&lt;/span&gt;&lt;span class="dt"&gt;%&lt;/span&gt;&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-20"&gt;&lt;a aria-hidden="true" href="#cb1-20" tabindex="-1"&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;这个Tooltip类可以加载几乎任何html标签上。比如一个普通的文字：&lt;/p&gt;
&lt;div class="sourceCode" id="cb2"&gt;&lt;pre class="sourceCode html"&gt;&lt;code class="sourceCode html"&gt;&lt;span id="cb2-1"&gt;&lt;a aria-hidden="true" href="#cb2-1" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb2-2"&gt;&lt;a aria-hidden="true" href="#cb2-2" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;&amp;lt;small&lt;/span&gt; &lt;span class="er"&gt;class&lt;/span&gt;&lt;span class="ot"&gt;=&lt;/span&gt;&lt;span class="st"&gt;"tooltip"&lt;/span&gt; &lt;span class="er"&gt;data-tooltip&lt;/span&gt;&lt;span class="ot"&gt;=&lt;/span&gt;&lt;span class="st"&gt;"this is sample tooltip"&lt;/span&gt; &lt;span class="er"&gt;id&lt;/span&gt;&lt;span class="ot"&gt;=&lt;/span&gt;&lt;span class="st"&gt;"quota"&lt;/span&gt;&lt;span class="kw"&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-3"&gt;&lt;a aria-hidden="true" href="#cb2-3" tabindex="-1"&gt;&lt;/a&gt;    Last Generate : Wed Nov 30 10:17:19 PM  CST 2022&lt;/span&gt;
&lt;span id="cb2-4"&gt;&lt;a aria-hidden="true" href="#cb2-4" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;&amp;lt;/small&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;结果就会是这样：&lt;/p&gt;
&lt;figure&gt;
&lt;img alt="result" src="./assets/result.png"/&gt;
&lt;figcaption aria-hidden="true"&gt;result&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;&lt;em&gt;参考：MDN上的示例:https://developer.mozilla.org/en-US/docs/Web/CSS/::after&lt;/em&gt;(&lt;del&gt;比较难看的Tooltip&lt;/del&gt;)&lt;/p&gt;
&lt;br/&gt;
&lt;!--%%REF%%--&gt;
&lt;br/&gt;
&lt;script async="" crossorigin="anonymous" data-category="Announcements" data-category-id="DIC_kwDOJ7Ymy84CX4eg" data-emit-metadata="0" data-input-position="top" data-lang="zh-CN" data-loading="lazy" data-mapping="title" data-reactions-enabled="1" data-repo="izfsk-ium/izfsk-ium.github.io" data-repo-id="R_kgDOJ7Ymyw" data-strict="0" data-theme="preferred_color_scheme" src="https://giscus.app/client.js"&gt;
&lt;/script&gt;
&lt;/main&gt;
&lt;footer&gt;
&lt;p class="signoff"&gt;
&lt;div class="metadata"&gt;
&lt;p class="date"&gt;&lt;time datetime="2022-11-14"&gt;创建日期：2022-11-14&lt;/time&gt;&lt;/p&gt;
&lt;p class="lastmodify"&gt;&lt;time&gt;最后编译：2023-08-10&lt;/time&gt;&lt;/p&gt;
&lt;p class="lastmodify" id="counter-span"&gt;访问次数：&lt;/p&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;/footer&gt;
&lt;script&gt;
    /* These script should run after page load */
    document.querySelectorAll('code.sourceCode').forEach(
      i =&gt; i.insertAdjacentHTML('beforeend', '&lt;div class="copy"&gt;复制&lt;/div&gt;')
    );
    document.querySelectorAll('div.copy').forEach(
      i =&gt; i.addEventListener(
        'click',
        () =&gt; {
          navigator.clipboard.writeText(i.parentElement.innerText.replace('复制', ''));
          i.innerText = '成功';
          setTimeout(() =&gt; {
            i.innerText = '复制';
          }, 1000);
        }
      )
    );

    if (location.href.includes("127.0.0.1:8080")) {
      document.getElementById("counter-span").innerHTML = "[[development mode]]";
    } else {
      const uuid = document.getElementById("article-uuid").innerText;
      const target = document.getElementById("counter-span");
      const last = localStorage.getItem("lastVisit-" + uuid);
      const shouldIncrease = last === null || new Date().getTime() - parseInt(last) &gt;= (1000 * 60 * 15);

      fetch(shouldIncrease ? ("https://counter.izfsk.top/counter/" + uuid) : ("https://counter.izfsk.top/readOnly/" + uuid))
        .then(r =&gt; r.text())
        .then(d =&gt; {
          if (!d.startsWith("Too"))
            document.getElementById("counter-span").innerText = "访问次数：" + d.toString();
          else
            document.getElementById("counter-span").innerHTML = "";
        });

      localStorage.setItem("lastVisit-" + uuid, new Date().getTime());
    }
  &lt;/script&gt;
&lt;script async="" data-website-id="2a1146ab-fa82-4a84-a04f-30e5967357c3" src="https://analytics.umami.is/script.js"&gt;&lt;/script&gt;
&lt;/body&gt;</content:encoded>
      <guid isPermaLink="false">9a1f2f73-527f-40cc-b3ad-3ca0d7380bf9</guid>
      <pubDate>Mon, 14 Nov 2022 00:00:00 +0800</pubDate>
    </item>
    <item>
      <title>仿Github热力图设计</title>
      <link>https://blog.izfsk.top/articles/仿Github热力图设计.html</link>
      <description>仿Github热力图设计</description>
      <content:encoded>&lt;body&gt;
&lt;progress id="content_progress" value="0"&gt;&lt;/progress&gt;
&lt;button id="back-to-top"&gt;
    回页顶
  &lt;/button&gt;
&lt;header&gt;
&lt;small id="article-uuid" style="display: none !important;"&gt;7f47edb7-e725-491a-b870-567ba2c80029&lt;/small&gt;
&lt;h1 class="title"&gt;仿Github热力图设计&lt;/h1&gt;
&lt;!-- Subtitle --&gt;
&lt;h3 class="subtitle"&gt; &lt;/h3&gt;
&lt;/header&gt;
&lt;nav id="TOC" role="doc-toc"&gt;
&lt;strong&gt;文章归类: &lt;a href="/pages/category.html#技术"&gt;技术&lt;/a&gt; &lt;/strong&gt;
&lt;input id="contents" type="checkbox"/&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#起因" id="toc-起因"&gt;起因&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#需求" id="toc-需求"&gt;需求&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#思路" id="toc-思路"&gt;思路&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#界面构成" id="toc-界面构成"&gt;界面构成&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#数据格式" id="toc-数据格式"&gt;数据格式&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#组件" id="toc-组件"&gt;组件&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#heatmapelement" id="toc-heatmapelement"&gt;HeatMapElement&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#heatmapcolum" id="toc-heatmapcolum"&gt;HeatMapColum&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#heatmap" id="toc-heatmap"&gt;HeatMap&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#其他杂项" id="toc-其他杂项"&gt;其他杂项&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#css" id="toc-css"&gt;CSS&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#实现" id="toc-实现"&gt;实现&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#todo" id="toc-todo"&gt;TODO&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#reference"&gt;参考链接&lt;/a&gt;&lt;/li&gt;
&lt;li&gt; &lt;/li&gt;
&lt;li class="tools"&gt;
&lt;span id="backtomain"&gt;
&lt;svg class="bi bi-house" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M8.707 1.5a1 1 0 0 0-1.414 0L.646 8.146a.5.5 0 0 0 .708.708L2 8.207V13.5A1.5 1.5 0 0 0 3.5 15h9a1.5 1.5 0 0 0 1.5-1.5V8.207l.646.647a.5.5 0 0 0 .708-.708L13 5.793V2.5a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v1.293L8.707 1.5ZM13 7.207V13.5a.5.5 0 0 1-.5.5h-9a.5.5 0 0 1-.5-.5V7.207l5-5 5 5Z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="readingmode"&gt;
&lt;svg class="bi bi-book" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M1 2.828c.885-.37 2.154-.769 3.388-.893 1.33-.134 2.458.063 3.112.752v9.746c-.935-.53-2.12-.603-3.213-.493-1.18.12-2.37.461-3.287.811V2.828zm7.5-.141c.654-.689 1.782-.886 3.112-.752 1.234.124 2.503.523 3.388.893v9.923c-.918-.35-2.107-.692-3.287-.81-1.094-.111-2.278-.039-3.213.492V2.687zM8 1.783C7.015.936 5.587.81 4.287.94c-1.514.153-3.042.672-3.994 1.105A.5.5 0 0 0 0 2.5v11a.5.5 0 0 0 .707.455c.882-.4 2.303-.881 3.68-1.02 1.409-.142 2.59.087 3.223.877a.5.5 0 0 0 .78 0c.633-.79 1.814-1.019 3.222-.877 1.378.139 2.8.62 3.681 1.02A.5.5 0 0 0 16 13.5v-11a.5.5 0 0 0-.293-.455c-.952-.433-2.48-.952-3.994-1.105C10.413.809 8.985.936 8 1.783z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="larger"&gt; &lt;/span&gt;
&lt;span id="smaller"&gt;&lt;/span&gt;
&lt;span id="switchfont"&gt;
&lt;svg class="bi bi-fonts" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M12.258 3h-8.51l-.083 2.46h.479c.26-1.544.758-1.783 2.693-1.845l.424-.013v7.827c0 .663-.144.82-1.3.923v.52h4.082v-.52c-1.162-.103-1.306-.26-1.306-.923V3.602l.431.013c1.934.062 2.434.301 2.693 1.846h.479L12.258 3z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="backtotop"&gt;
&lt;svg class="bi bi-arrow-bar-up" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M8 10a.5.5 0 0 0 .5-.5V3.707l2.146 2.147a.5.5 0 0 0 .708-.708l-3-3a.5.5 0 0 0-.708 0l-3 3a.5.5 0 1 0 .708.708L7.5 3.707V9.5a.5.5 0 0 0 .5.5zm-7 2.5a.5.5 0 0 1 .5-.5h13a.5.5 0 0 1 0 1h-13a.5.5 0 0 1-.5-.5z" fill-rule="evenodd"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/nav&gt;
&lt;main&gt;
&lt;h1 id="起因"&gt;起因&lt;/h1&gt;
&lt;p&gt;我希望能够给自己的日记项目升级一下，参考Github的贡献热力图，构造一个类似的组件。查看了一圈，要么是比较老的库，要么不提供我熟悉的&lt;code&gt;ReactJS+Typescript&lt;/code&gt;框架，再 加上我的需求其实很简单，于是决定自己实现一个简单的热力图。&lt;/p&gt;
&lt;h1 id="需求"&gt;需求&lt;/h1&gt;
&lt;figure&gt;
&lt;img alt="目标" src="./assets/target.png"/&gt;
&lt;figcaption aria-hidden="true"&gt;目标&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;首先它需要和Github的热力图看上去类似，我就不做的那么细致，直接20个星期，每个星期7天，一共140天。不标注月份，但在左侧标注星期几。&lt;/p&gt;
&lt;p&gt;为了好看，要求本日固定在右下角的最后一个格子，星期显示自然要跟着同步。除此以外，鼠标划过需要在右下角显示这一天的日期。 其他的组件，图例，颜色，黑夜模式什么的可以日后再调教。&lt;/p&gt;
&lt;h1 id="思路"&gt;思路&lt;/h1&gt;
&lt;h2 id="界面构成"&gt;界面构成&lt;/h2&gt;
&lt;p&gt;我看了一眼Github的前端，发现小格子都是按列排的&lt;code&gt;&amp;lt;svg&amp;gt;&lt;/code&gt;元素和&lt;code&gt;&amp;lt;rect&amp;gt;&lt;/code&gt;元素。肯定这样是性能更加高，不过这么一来还需要 学svg，&lt;del&gt;总之，我有一万种偷懒的理由&lt;/del&gt;，最终决定使用&lt;code&gt;&amp;lt;div&amp;gt;&lt;/code&gt;+CSS画格子。&lt;/p&gt;
&lt;p&gt;这样的构图很容易就想得出来创建一个矩阵，每个格子对应座标，而每一列作为一个组件，用flex排一下。&lt;/p&gt;
&lt;h2 id="数据格式"&gt;数据格式&lt;/h2&gt;
&lt;p&gt;最方便的就是JSON传个矩阵过来，但这样太肥了。所以打算按照间接寻址来算。以右下角最后一个格子(19,6)为0地址，把整个 热力图矩阵看作是一个线性数组，一直向前推即可。比如8就是对应(18,6)。而每一个方格只有固定的几种可能性，按照绿色的 程度分为1，2，3，4四个级别，0为没有颜色。因为大多数方格是没有颜色的，所以只需要把1，2，3，4四个级别包含的格子指明 即可推出整个矩阵。&lt;/p&gt;
&lt;p&gt;整个Component的props格式定义如下:&lt;/p&gt;
&lt;div class="sourceCode" id="cb1"&gt;&lt;pre class="sourceCode typescript"&gt;&lt;code class="sourceCode typescript"&gt;&lt;span id="cb1-1"&gt;&lt;a aria-hidden="true" href="#cb1-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;interface&lt;/span&gt; HeatMap_Data_T {&lt;/span&gt;
&lt;span id="cb1-2"&gt;&lt;a aria-hidden="true" href="#cb1-2" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="st"&gt;"1"&lt;/span&gt;&lt;span class="op"&gt;?:&lt;/span&gt; &lt;span class="bu"&gt;Array&lt;/span&gt;&lt;span class="op"&gt;&amp;lt;&lt;/span&gt;&lt;span class="dt"&gt;number&lt;/span&gt;&lt;span class="op"&gt;&amp;gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-3"&gt;&lt;a aria-hidden="true" href="#cb1-3" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="st"&gt;"2"&lt;/span&gt;&lt;span class="op"&gt;?:&lt;/span&gt; &lt;span class="bu"&gt;Array&lt;/span&gt;&lt;span class="op"&gt;&amp;lt;&lt;/span&gt;&lt;span class="dt"&gt;number&lt;/span&gt;&lt;span class="op"&gt;&amp;gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-4"&gt;&lt;a aria-hidden="true" href="#cb1-4" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="st"&gt;"3"&lt;/span&gt;&lt;span class="op"&gt;?:&lt;/span&gt; &lt;span class="bu"&gt;Array&lt;/span&gt;&lt;span class="op"&gt;&amp;lt;&lt;/span&gt;&lt;span class="dt"&gt;number&lt;/span&gt;&lt;span class="op"&gt;&amp;gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-5"&gt;&lt;a aria-hidden="true" href="#cb1-5" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="st"&gt;"4"&lt;/span&gt;&lt;span class="op"&gt;?:&lt;/span&gt; &lt;span class="bu"&gt;Array&lt;/span&gt;&lt;span class="op"&gt;&amp;lt;&lt;/span&gt;&lt;span class="dt"&gt;number&lt;/span&gt;&lt;span class="op"&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-6"&gt;&lt;a aria-hidden="true" href="#cb1-6" tabindex="-1"&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;而组件内部的status就很简单了，直接根据props推出来整个矩阵即可。每个矩阵元素保存该方格的level。&lt;/p&gt;
&lt;div class="sourceCode" id="cb2"&gt;&lt;pre class="sourceCode typescript"&gt;&lt;code class="sourceCode typescript"&gt;&lt;span id="cb2-1"&gt;&lt;a aria-hidden="true" href="#cb2-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;type&lt;/span&gt; HeatMap_Data_Internal_T &lt;span class="op"&gt;=&lt;/span&gt; {&lt;/span&gt;
&lt;span id="cb2-2"&gt;&lt;a aria-hidden="true" href="#cb2-2" tabindex="-1"&gt;&lt;/a&gt;        matrix&lt;span class="op"&gt;:&lt;/span&gt; &lt;span class="bu"&gt;Array&lt;/span&gt;&lt;span class="op"&gt;&amp;lt;&lt;/span&gt;&lt;span class="bu"&gt;Array&lt;/span&gt;&lt;span class="op"&gt;&amp;lt;&lt;/span&gt;&lt;span class="dt"&gt;number&lt;/span&gt;&lt;span class="op"&gt;&amp;gt;&amp;gt;&lt;/span&gt;[&lt;span class="dv"&gt;20&lt;/span&gt;][&lt;span class="dv"&gt;7&lt;/span&gt;]&lt;span class="op"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-3"&gt;&lt;a aria-hidden="true" href="#cb2-3" tabindex="-1"&gt;&lt;/a&gt;        infoString&lt;span class="op"&gt;:&lt;/span&gt; &lt;span class="dt"&gt;string&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-4"&gt;&lt;a aria-hidden="true" href="#cb2-4" tabindex="-1"&gt;&lt;/a&gt;    }&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id="组件"&gt;组件&lt;/h2&gt;
&lt;p&gt;分三个层次，整个组件&lt;code&gt;HeatMap&lt;/code&gt;,列&lt;code&gt;HeatMapColum&lt;/code&gt;,和单元格&lt;code&gt;HeatMapElement&lt;/code&gt;。&lt;/p&gt;
&lt;h3 id="heatmapelement"&gt;HeatMapElement&lt;/h3&gt;
&lt;p&gt;很简单，需要的props为座标，level和一个状态提升函数。座标用来传递给状态提升函数，level进行字符串拼接转为传为className 给CSS。整个组件写成function component.&lt;/p&gt;
&lt;div class="sourceCode" id="cb3"&gt;&lt;pre class="sourceCode jsx"&gt;&lt;code class="sourceCode javascriptreact"&gt;&lt;span id="cb3-1"&gt;&lt;a aria-hidden="true" href="#cb3-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;function&lt;/span&gt; &lt;span class="fu"&gt;HeatMapElement&lt;/span&gt;(props&lt;span class="op"&gt;:&lt;/span&gt; {&lt;/span&gt;
&lt;span id="cb3-2"&gt;&lt;a aria-hidden="true" href="#cb3-2" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="dt"&gt;level&lt;/span&gt;&lt;span class="op"&gt;:&lt;/span&gt; number&lt;span class="op"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb3-3"&gt;&lt;a aria-hidden="true" href="#cb3-3" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="dt"&gt;addr&lt;/span&gt;&lt;span class="op"&gt;:&lt;/span&gt; [number&lt;span class="op"&gt;,&lt;/span&gt; number]&lt;span class="op"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb3-4"&gt;&lt;a aria-hidden="true" href="#cb3-4" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="dt"&gt;bubbleFunc&lt;/span&gt;&lt;span class="op"&gt;:&lt;/span&gt; (&lt;span class="dt"&gt;addr&lt;/span&gt;&lt;span class="op"&gt;:&lt;/span&gt; [number&lt;span class="op"&gt;,&lt;/span&gt; number]) &lt;span class="kw"&gt;=&amp;gt;&lt;/span&gt; any&lt;/span&gt;
&lt;span id="cb3-5"&gt;&lt;a aria-hidden="true" href="#cb3-5" tabindex="-1"&gt;&lt;/a&gt;}) {&lt;/span&gt;
&lt;span id="cb3-6"&gt;&lt;a aria-hidden="true" href="#cb3-6" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="cf"&gt;return&lt;/span&gt; (&lt;/span&gt;
&lt;span id="cb3-7"&gt;&lt;a aria-hidden="true" href="#cb3-7" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="kw"&gt;&amp;lt;div&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb3-8"&gt;&lt;a aria-hidden="true" href="#cb3-8" tabindex="-1"&gt;&lt;/a&gt;            &lt;span class="ot"&gt;key&lt;/span&gt;&lt;span class="op"&gt;=&lt;/span&gt;&lt;span class="va"&gt;{&lt;/span&gt;&lt;span class="st"&gt;'_hc'&lt;/span&gt; &lt;span class="op"&gt;+&lt;/span&gt; &lt;span class="bu"&gt;Math&lt;/span&gt;&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;random&lt;/span&gt;()&lt;span class="va"&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb3-9"&gt;&lt;a aria-hidden="true" href="#cb3-9" tabindex="-1"&gt;&lt;/a&gt;            &lt;span class="ot"&gt;className&lt;/span&gt;&lt;span class="op"&gt;=&lt;/span&gt;&lt;span class="va"&gt;{&lt;/span&gt;&lt;span class="vs"&gt;`heatMap_element level_&lt;/span&gt;&lt;span class="sc"&gt;${&lt;/span&gt;props&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="at"&gt;level&lt;/span&gt;&lt;span class="sc"&gt;}&lt;/span&gt;&lt;span class="vs"&gt;`&lt;/span&gt;&lt;span class="va"&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb3-10"&gt;&lt;a aria-hidden="true" href="#cb3-10" tabindex="-1"&gt;&lt;/a&gt;            &lt;span class="ot"&gt;onMouseEnter&lt;/span&gt;&lt;span class="op"&gt;=&lt;/span&gt;&lt;span class="va"&gt;{&lt;/span&gt;(e) &lt;span class="kw"&gt;=&amp;gt;&lt;/span&gt; { props&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;bubbleFunc&lt;/span&gt;(props&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="at"&gt;addr&lt;/span&gt;) }&lt;span class="va"&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb3-11"&gt;&lt;a aria-hidden="true" href="#cb3-11" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="kw"&gt;&amp;gt;&amp;lt;/div&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb3-12"&gt;&lt;a aria-hidden="true" href="#cb3-12" tabindex="-1"&gt;&lt;/a&gt;    )&lt;/span&gt;
&lt;span id="cb3-13"&gt;&lt;a aria-hidden="true" href="#cb3-13" tabindex="-1"&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id="heatmapcolum"&gt;HeatMapColum&lt;/h3&gt;
&lt;p&gt;用来包含小方格的组件，props为x座标，相应矩阵的数据切片（代表这个星期），以及一个状态提升函数。&lt;/p&gt;
&lt;div class="sourceCode" id="cb4"&gt;&lt;pre class="sourceCode jsx"&gt;&lt;code class="sourceCode javascriptreact"&gt;&lt;span id="cb4-1"&gt;&lt;a aria-hidden="true" href="#cb4-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;class&lt;/span&gt; HeatMapColum &lt;span class="kw"&gt;extends&lt;/span&gt; React&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="at"&gt;Component&lt;/span&gt;&lt;span class="op"&gt;&amp;lt;&lt;/span&gt;{&lt;/span&gt;
&lt;span id="cb4-2"&gt;&lt;a aria-hidden="true" href="#cb4-2" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="dt"&gt;weekSlice&lt;/span&gt;&lt;span class="op"&gt;:&lt;/span&gt; &lt;span class="bu"&gt;Array&lt;/span&gt;&lt;span class="op"&gt;&amp;lt;&lt;/span&gt;number&lt;span class="op"&gt;&amp;gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb4-3"&gt;&lt;a aria-hidden="true" href="#cb4-3" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="dt"&gt;addr_x&lt;/span&gt;&lt;span class="op"&gt;:&lt;/span&gt; number&lt;span class="op"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb4-4"&gt;&lt;a aria-hidden="true" href="#cb4-4" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="dt"&gt;bubbleFunc&lt;/span&gt;&lt;span class="op"&gt;:&lt;/span&gt; (&lt;span class="dt"&gt;addr&lt;/span&gt;&lt;span class="op"&gt;:&lt;/span&gt; [number&lt;span class="op"&gt;,&lt;/span&gt; number]) &lt;span class="kw"&gt;=&amp;gt;&lt;/span&gt; any&lt;/span&gt;
&lt;span id="cb4-5"&gt;&lt;a aria-hidden="true" href="#cb4-5" tabindex="-1"&gt;&lt;/a&gt;}&lt;span class="op"&gt;,&lt;/span&gt; {}&lt;span class="op"&gt;&amp;gt;&lt;/span&gt;{&lt;/span&gt;
&lt;span id="cb4-6"&gt;&lt;a aria-hidden="true" href="#cb4-6" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="fu"&gt;constructor&lt;/span&gt;(&lt;span class="dt"&gt;props&lt;/span&gt;&lt;span class="op"&gt;:&lt;/span&gt; any) {&lt;/span&gt;
&lt;span id="cb4-7"&gt;&lt;a aria-hidden="true" href="#cb4-7" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="kw"&gt;super&lt;/span&gt;(props)&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb4-8"&gt;&lt;a aria-hidden="true" href="#cb4-8" tabindex="-1"&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id="cb4-9"&gt;&lt;a aria-hidden="true" href="#cb4-9" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb4-10"&gt;&lt;a aria-hidden="true" href="#cb4-10" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="fu"&gt;render&lt;/span&gt;()&lt;span class="op"&gt;:&lt;/span&gt; ReactNode {&lt;/span&gt;
&lt;span id="cb4-11"&gt;&lt;a aria-hidden="true" href="#cb4-11" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="cf"&gt;return&lt;/span&gt; (&lt;/span&gt;
&lt;span id="cb4-12"&gt;&lt;a aria-hidden="true" href="#cb4-12" tabindex="-1"&gt;&lt;/a&gt;            &lt;span class="kw"&gt;&amp;lt;div&lt;/span&gt; &lt;span class="ot"&gt;className&lt;/span&gt;&lt;span class="op"&gt;=&lt;/span&gt;&lt;span class="st"&gt;"heatMap_colum"&lt;/span&gt;&lt;span class="kw"&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb4-13"&gt;&lt;a aria-hidden="true" href="#cb4-13" tabindex="-1"&gt;&lt;/a&gt;                &lt;span class="va"&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb4-14"&gt;&lt;a aria-hidden="true" href="#cb4-14" tabindex="-1"&gt;&lt;/a&gt;                    [&lt;span class="op"&gt;...&lt;/span&gt;&lt;span class="kw"&gt;new&lt;/span&gt; &lt;span class="bu"&gt;Array&lt;/span&gt;(&lt;span class="dv"&gt;7&lt;/span&gt;)&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;keys&lt;/span&gt;()]&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;map&lt;/span&gt;(i &lt;span class="kw"&gt;=&amp;gt;&lt;/span&gt; {&lt;/span&gt;
&lt;span id="cb4-15"&gt;&lt;a aria-hidden="true" href="#cb4-15" tabindex="-1"&gt;&lt;/a&gt;                        &lt;span class="cf"&gt;return &lt;/span&gt;&lt;span class="fu"&gt;&amp;lt;HeatMapElement&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb4-16"&gt;&lt;a aria-hidden="true" href="#cb4-16" tabindex="-1"&gt;&lt;/a&gt;                            &lt;span class="ot"&gt;bubbleFunc&lt;/span&gt;&lt;span class="op"&gt;=&lt;/span&gt;&lt;span class="va"&gt;{&lt;/span&gt;addr &lt;span class="kw"&gt;=&amp;gt;&lt;/span&gt; { &lt;span class="kw"&gt;this&lt;/span&gt;&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="at"&gt;props&lt;/span&gt;&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;bubbleFunc&lt;/span&gt;(addr) }&lt;span class="va"&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb4-17"&gt;&lt;a aria-hidden="true" href="#cb4-17" tabindex="-1"&gt;&lt;/a&gt;                            &lt;span class="ot"&gt;key&lt;/span&gt;&lt;span class="op"&gt;=&lt;/span&gt;&lt;span class="va"&gt;{&lt;/span&gt;&lt;span class="st"&gt;'_hc_'&lt;/span&gt; &lt;span class="op"&gt;+&lt;/span&gt; i&lt;span class="va"&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb4-18"&gt;&lt;a aria-hidden="true" href="#cb4-18" tabindex="-1"&gt;&lt;/a&gt;                            &lt;span class="ot"&gt;level&lt;/span&gt;&lt;span class="op"&gt;=&lt;/span&gt;&lt;span class="va"&gt;{&lt;/span&gt;&lt;span class="kw"&gt;this&lt;/span&gt;&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="at"&gt;props&lt;/span&gt;&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="at"&gt;weekSlice&lt;/span&gt;[i]&lt;span class="va"&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb4-19"&gt;&lt;a aria-hidden="true" href="#cb4-19" tabindex="-1"&gt;&lt;/a&gt;                            &lt;span class="ot"&gt;addr&lt;/span&gt;&lt;span class="op"&gt;=&lt;/span&gt;&lt;span class="va"&gt;{&lt;/span&gt;[&lt;span class="kw"&gt;this&lt;/span&gt;&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="at"&gt;props&lt;/span&gt;&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="at"&gt;addr_x&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt; i]&lt;span class="va"&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb4-20"&gt;&lt;a aria-hidden="true" href="#cb4-20" tabindex="-1"&gt;&lt;/a&gt;                        &lt;span class="fu"&gt;&amp;gt;&amp;lt;/HeatMapElement&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb4-21"&gt;&lt;a aria-hidden="true" href="#cb4-21" tabindex="-1"&gt;&lt;/a&gt;                    })&lt;/span&gt;
&lt;span id="cb4-22"&gt;&lt;a aria-hidden="true" href="#cb4-22" tabindex="-1"&gt;&lt;/a&gt;                &lt;span class="va"&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb4-23"&gt;&lt;a aria-hidden="true" href="#cb4-23" tabindex="-1"&gt;&lt;/a&gt;            &lt;span class="kw"&gt;&amp;lt;/div&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb4-24"&gt;&lt;a aria-hidden="true" href="#cb4-24" tabindex="-1"&gt;&lt;/a&gt;        )&lt;/span&gt;
&lt;span id="cb4-25"&gt;&lt;a aria-hidden="true" href="#cb4-25" tabindex="-1"&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id="cb4-26"&gt;&lt;a aria-hidden="true" href="#cb4-26" tabindex="-1"&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;em&gt;如果想要避免for循环，直接在&lt;code&gt;render()&lt;/code&gt;里面开数组，就用&lt;code&gt;[...new Array(number).keys()]&lt;/code&gt;就地创建。&lt;/em&gt;&lt;/p&gt;
&lt;h3 id="heatmap"&gt;HeatMap&lt;/h3&gt;
&lt;p&gt;最主要的组件。比较长，不全放上来。&lt;/p&gt;
&lt;div class="sourceCode" id="cb5"&gt;&lt;pre class="sourceCode jsx"&gt;&lt;code class="sourceCode javascriptreact"&gt;&lt;span id="cb5-1"&gt;&lt;a aria-hidden="true" href="#cb5-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="im"&gt;export&lt;/span&gt; &lt;span class="kw"&gt;class&lt;/span&gt; HeatMap &lt;span class="kw"&gt;extends&lt;/span&gt; Component&lt;span class="op"&gt;&amp;lt;&lt;/span&gt;{ &lt;span class="dt"&gt;data&lt;/span&gt;&lt;span class="op"&gt;:&lt;/span&gt; HeatMap_Data_T }&lt;span class="op"&gt;,&lt;/span&gt; HeatMap_Data_Internal_T&lt;span class="op"&gt;&amp;gt;&lt;/span&gt;{&lt;/span&gt;
&lt;span id="cb5-2"&gt;&lt;a aria-hidden="true" href="#cb5-2" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="fu"&gt;constructor&lt;/span&gt;(&lt;span class="dt"&gt;props&lt;/span&gt;&lt;span class="op"&gt;:&lt;/span&gt; any) {&lt;/span&gt;
&lt;span id="cb5-3"&gt;&lt;a aria-hidden="true" href="#cb5-3" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="kw"&gt;super&lt;/span&gt;(props)&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb5-4"&gt;&lt;a aria-hidden="true" href="#cb5-4" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="kw"&gt;const&lt;/span&gt; internal &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="bu"&gt;Array&lt;/span&gt;&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;from&lt;/span&gt;(&lt;span class="kw"&gt;new&lt;/span&gt; &lt;span class="bu"&gt;Array&lt;/span&gt;(&lt;span class="dv"&gt;20&lt;/span&gt;)&lt;span class="op"&gt;,&lt;/span&gt; () &lt;span class="kw"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="kw"&gt;new&lt;/span&gt; &lt;span class="bu"&gt;Array&lt;/span&gt;(&lt;span class="dv"&gt;7&lt;/span&gt;)&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;fill&lt;/span&gt;(&lt;span class="dv"&gt;0&lt;/span&gt;))&lt;/span&gt;
&lt;span id="cb5-5"&gt;&lt;a aria-hidden="true" href="#cb5-5" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="bu"&gt;Object&lt;/span&gt;&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;keys&lt;/span&gt;(&lt;span class="kw"&gt;this&lt;/span&gt;&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="at"&gt;props&lt;/span&gt;&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="at"&gt;data&lt;/span&gt;)&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;map&lt;/span&gt;(i &lt;span class="kw"&gt;=&amp;gt;&lt;/span&gt; {&lt;/span&gt;
&lt;span id="cb5-6"&gt;&lt;a aria-hidden="true" href="#cb5-6" tabindex="-1"&gt;&lt;/a&gt;            &lt;span class="cf"&gt;for&lt;/span&gt; (&lt;span class="kw"&gt;const&lt;/span&gt; index &lt;span class="kw"&gt;of&lt;/span&gt; &lt;span class="kw"&gt;this&lt;/span&gt;&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="at"&gt;props&lt;/span&gt;&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="at"&gt;data&lt;/span&gt;[i]) {&lt;/span&gt;
&lt;span id="cb5-7"&gt;&lt;a aria-hidden="true" href="#cb5-7" tabindex="-1"&gt;&lt;/a&gt;                &lt;span class="kw"&gt;const&lt;/span&gt; [_x&lt;span class="op"&gt;,&lt;/span&gt; _y&lt;span class="op"&gt;,&lt;/span&gt; level] &lt;span class="op"&gt;=&lt;/span&gt; [&lt;span class="dv"&gt;20&lt;/span&gt; &lt;span class="op"&gt;-&lt;/span&gt; &lt;span class="bu"&gt;Math&lt;/span&gt;&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;floor&lt;/span&gt;(index &lt;span class="op"&gt;/&lt;/span&gt; &lt;span class="dv"&gt;7&lt;/span&gt;) &lt;span class="op"&gt;-&lt;/span&gt; &lt;span class="dv"&gt;1&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt; &lt;span class="dv"&gt;7&lt;/span&gt; &lt;span class="op"&gt;-&lt;/span&gt; index &lt;span class="op"&gt;%&lt;/span&gt; &lt;span class="dv"&gt;7&lt;/span&gt; &lt;span class="op"&gt;-&lt;/span&gt; &lt;span class="dv"&gt;1&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt; i]&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb5-8"&gt;&lt;a aria-hidden="true" href="#cb5-8" tabindex="-1"&gt;&lt;/a&gt;                internal[_x][_y] &lt;span class="op"&gt;=&lt;/span&gt; level&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb5-9"&gt;&lt;a aria-hidden="true" href="#cb5-9" tabindex="-1"&gt;&lt;/a&gt;            }&lt;/span&gt;
&lt;span id="cb5-10"&gt;&lt;a aria-hidden="true" href="#cb5-10" tabindex="-1"&gt;&lt;/a&gt;        })&lt;/span&gt;
&lt;span id="cb5-11"&gt;&lt;a aria-hidden="true" href="#cb5-11" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb5-12"&gt;&lt;a aria-hidden="true" href="#cb5-12" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="kw"&gt;this&lt;/span&gt;&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="at"&gt;state&lt;/span&gt; &lt;span class="op"&gt;=&lt;/span&gt; { &lt;span class="dt"&gt;matrix&lt;/span&gt;&lt;span class="op"&gt;:&lt;/span&gt; internal &lt;span class="im"&gt;as&lt;/span&gt; any&lt;span class="op"&gt;,&lt;/span&gt; &lt;span class="dt"&gt;infoString&lt;/span&gt;&lt;span class="op"&gt;:&lt;/span&gt; &lt;span class="st"&gt;''&lt;/span&gt; }&lt;/span&gt;
&lt;span id="cb5-13"&gt;&lt;a aria-hidden="true" href="#cb5-13" tabindex="-1"&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id="cb5-14"&gt;&lt;a aria-hidden="true" href="#cb5-14" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb5-15"&gt;&lt;a aria-hidden="true" href="#cb5-15" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="kw"&gt;static&lt;/span&gt; readonly &lt;span class="dt"&gt;weekDays&lt;/span&gt;&lt;span class="op"&gt;:&lt;/span&gt; &lt;span class="bu"&gt;Array&lt;/span&gt;&lt;span class="op"&gt;&amp;lt;&lt;/span&gt;{ &lt;span class="dt"&gt;name&lt;/span&gt;&lt;span class="op"&gt;:&lt;/span&gt; string&lt;span class="op"&gt;;&lt;/span&gt; &lt;span class="dt"&gt;day&lt;/span&gt;&lt;span class="op"&gt;:&lt;/span&gt; number&lt;span class="op"&gt;;&lt;/span&gt; }&lt;span class="op"&gt;&amp;gt;&lt;/span&gt; &lt;span class="op"&gt;=&lt;/span&gt; [&lt;/span&gt;
&lt;span id="cb5-16"&gt;&lt;a aria-hidden="true" href="#cb5-16" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="co"&gt;// 一个星期的每一天, 略&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb5-17"&gt;&lt;a aria-hidden="true" href="#cb5-17" tabindex="-1"&gt;&lt;/a&gt;        { &lt;span class="dt"&gt;name&lt;/span&gt;&lt;span class="op"&gt;:&lt;/span&gt; &lt;span class="st"&gt;'日'&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt; &lt;span class="dt"&gt;day&lt;/span&gt;&lt;span class="op"&gt;:&lt;/span&gt; &lt;span class="dv"&gt;7&lt;/span&gt; }&lt;span class="op"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb5-18"&gt;&lt;a aria-hidden="true" href="#cb5-18" tabindex="-1"&gt;&lt;/a&gt;    ]&lt;/span&gt;
&lt;span id="cb5-19"&gt;&lt;a aria-hidden="true" href="#cb5-19" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb5-20"&gt;&lt;a aria-hidden="true" href="#cb5-20" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="kw"&gt;private&lt;/span&gt; &lt;span class="fu"&gt;handleMouseHover&lt;/span&gt;(&lt;span class="dt"&gt;addr&lt;/span&gt;&lt;span class="op"&gt;:&lt;/span&gt; [number&lt;span class="op"&gt;,&lt;/span&gt; number]) {&lt;/span&gt;
&lt;span id="cb5-21"&gt;&lt;a aria-hidden="true" href="#cb5-21" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="co"&gt;// 更新infoString, 略&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb5-22"&gt;&lt;a aria-hidden="true" href="#cb5-22" tabindex="-1"&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id="cb5-23"&gt;&lt;a aria-hidden="true" href="#cb5-23" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb5-24"&gt;&lt;a aria-hidden="true" href="#cb5-24" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="fu"&gt;render&lt;/span&gt;()&lt;span class="op"&gt;:&lt;/span&gt; ReactNode {&lt;/span&gt;
&lt;span id="cb5-25"&gt;&lt;a aria-hidden="true" href="#cb5-25" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="kw"&gt;const&lt;/span&gt; today &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="kw"&gt;new&lt;/span&gt; &lt;span class="bu"&gt;Date&lt;/span&gt;()&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;getDay&lt;/span&gt;()&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb5-26"&gt;&lt;a aria-hidden="true" href="#cb5-26" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="kw"&gt;const&lt;/span&gt; weekdayDisplay &lt;span class="op"&gt;=&lt;/span&gt; HeatMap&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="at"&gt;weekDays&lt;/span&gt;&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;map&lt;/span&gt;(i &lt;span class="kw"&gt;=&amp;gt;&lt;/span&gt; {&lt;/span&gt;
&lt;span id="cb5-27"&gt;&lt;a aria-hidden="true" href="#cb5-27" tabindex="-1"&gt;&lt;/a&gt;            i&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="at"&gt;day&lt;/span&gt; &lt;span class="op"&gt;&amp;lt;&lt;/span&gt; today &lt;span class="op"&gt;?&lt;/span&gt; i&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="at"&gt;day&lt;/span&gt; &lt;span class="op"&gt;+=&lt;/span&gt; &lt;span class="dv"&gt;999&lt;/span&gt; &lt;span class="op"&gt;:&lt;/span&gt; (i&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="at"&gt;day&lt;/span&gt; &lt;span class="op"&gt;==&lt;/span&gt; today &lt;span class="op"&gt;?&lt;/span&gt; i&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="at"&gt;day&lt;/span&gt; &lt;span class="op"&gt;-=&lt;/span&gt; &lt;span class="dv"&gt;999&lt;/span&gt; &lt;span class="op"&gt;:&lt;/span&gt; &lt;span class="kw"&gt;null&lt;/span&gt;)&lt;/span&gt;
&lt;span id="cb5-28"&gt;&lt;a aria-hidden="true" href="#cb5-28" tabindex="-1"&gt;&lt;/a&gt;            &lt;span class="cf"&gt;return&lt;/span&gt; i&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb5-29"&gt;&lt;a aria-hidden="true" href="#cb5-29" tabindex="-1"&gt;&lt;/a&gt;        })&lt;/span&gt;
&lt;span id="cb5-30"&gt;&lt;a aria-hidden="true" href="#cb5-30" tabindex="-1"&gt;&lt;/a&gt;            &lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;sort&lt;/span&gt;((a&lt;span class="op"&gt;,&lt;/span&gt; b) &lt;span class="kw"&gt;=&amp;gt;&lt;/span&gt; b&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="at"&gt;day&lt;/span&gt; &lt;span class="op"&gt;-&lt;/span&gt; a&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="at"&gt;day&lt;/span&gt;)&lt;/span&gt;
&lt;span id="cb5-31"&gt;&lt;a aria-hidden="true" href="#cb5-31" tabindex="-1"&gt;&lt;/a&gt;            &lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;map&lt;/span&gt;(i &lt;span class="kw"&gt;=&amp;gt; &amp;lt;div&lt;/span&gt; &lt;span class="ot"&gt;key&lt;/span&gt;&lt;span class="op"&gt;=&lt;/span&gt;&lt;span class="va"&gt;{&lt;/span&gt;&lt;span class="st"&gt;'_hw'&lt;/span&gt; &lt;span class="op"&gt;+&lt;/span&gt; i&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="at"&gt;day&lt;/span&gt;&lt;span class="va"&gt;}&lt;/span&gt; &lt;span class="ot"&gt;className&lt;/span&gt;&lt;span class="op"&gt;=&lt;/span&gt;&lt;span class="st"&gt;"heatMap_weekday"&lt;/span&gt;&lt;span class="kw"&gt;&amp;gt;&lt;/span&gt;&lt;span class="va"&gt;{&lt;/span&gt;i&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="at"&gt;name&lt;/span&gt;&lt;span class="va"&gt;}&lt;/span&gt;&lt;span class="kw"&gt;&amp;lt;/div&amp;gt;&lt;/span&gt;)&lt;/span&gt;
&lt;span id="cb5-32"&gt;&lt;a aria-hidden="true" href="#cb5-32" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb5-33"&gt;&lt;a aria-hidden="true" href="#cb5-33" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="cf"&gt;return&lt;/span&gt; (&lt;/span&gt;
&lt;span id="cb5-34"&gt;&lt;a aria-hidden="true" href="#cb5-34" tabindex="-1"&gt;&lt;/a&gt;            &lt;span class="kw"&gt;&amp;lt;div&lt;/span&gt; &lt;span class="ot"&gt;id&lt;/span&gt;&lt;span class="op"&gt;=&lt;/span&gt;&lt;span class="st"&gt;"HeatMap"&lt;/span&gt;&lt;span class="kw"&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb5-35"&gt;&lt;a aria-hidden="true" href="#cb5-35" tabindex="-1"&gt;&lt;/a&gt;                &lt;span class="kw"&gt;&amp;lt;div&lt;/span&gt; &lt;span class="ot"&gt;className&lt;/span&gt;&lt;span class="op"&gt;=&lt;/span&gt;&lt;span class="st"&gt;"heatMap_main"&lt;/span&gt;&lt;span class="kw"&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb5-36"&gt;&lt;a aria-hidden="true" href="#cb5-36" tabindex="-1"&gt;&lt;/a&gt;                    &lt;span class="kw"&gt;&amp;lt;div&amp;gt;&lt;/span&gt; &lt;span class="va"&gt;{&lt;/span&gt;weekdayDisplay&lt;span class="va"&gt;}&lt;/span&gt; &lt;span class="kw"&gt;&amp;lt;/div&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb5-37"&gt;&lt;a aria-hidden="true" href="#cb5-37" tabindex="-1"&gt;&lt;/a&gt;                    &lt;span class="va"&gt;{&lt;/span&gt;[&lt;span class="op"&gt;...&lt;/span&gt;&lt;span class="kw"&gt;new&lt;/span&gt; &lt;span class="bu"&gt;Array&lt;/span&gt;(&lt;span class="dv"&gt;20&lt;/span&gt;)&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;keys&lt;/span&gt;()]&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;map&lt;/span&gt;(i &lt;span class="kw"&gt;=&amp;gt;&lt;/span&gt; {&lt;/span&gt;
&lt;span id="cb5-38"&gt;&lt;a aria-hidden="true" href="#cb5-38" tabindex="-1"&gt;&lt;/a&gt;                            &lt;span class="cf"&gt;return &lt;/span&gt;&lt;span class="fu"&gt;&amp;lt;HeatMapColum&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb5-39"&gt;&lt;a aria-hidden="true" href="#cb5-39" tabindex="-1"&gt;&lt;/a&gt;                                &lt;span class="ot"&gt;bubbleFunc&lt;/span&gt;&lt;span class="op"&gt;=&lt;/span&gt;&lt;span class="va"&gt;{&lt;/span&gt;addr &lt;span class="kw"&gt;=&amp;gt;&lt;/span&gt; { &lt;span class="kw"&gt;this&lt;/span&gt;&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;handleMouseHover&lt;/span&gt;(addr) }&lt;span class="va"&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb5-40"&gt;&lt;a aria-hidden="true" href="#cb5-40" tabindex="-1"&gt;&lt;/a&gt;                                &lt;span class="ot"&gt;addr_x&lt;/span&gt;&lt;span class="op"&gt;=&lt;/span&gt;&lt;span class="va"&gt;{&lt;/span&gt;i&lt;span class="va"&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb5-41"&gt;&lt;a aria-hidden="true" href="#cb5-41" tabindex="-1"&gt;&lt;/a&gt;                                &lt;span class="ot"&gt;weekSlice&lt;/span&gt;&lt;span class="op"&gt;=&lt;/span&gt;&lt;span class="va"&gt;{&lt;/span&gt;&lt;span class="kw"&gt;this&lt;/span&gt;&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="at"&gt;state&lt;/span&gt;&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="at"&gt;matrix&lt;/span&gt;[i]&lt;span class="va"&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb5-42"&gt;&lt;a aria-hidden="true" href="#cb5-42" tabindex="-1"&gt;&lt;/a&gt;                                &lt;span class="ot"&gt;key&lt;/span&gt;&lt;span class="op"&gt;=&lt;/span&gt;&lt;span class="va"&gt;{&lt;/span&gt;&lt;span class="st"&gt;'_hr'&lt;/span&gt; &lt;span class="op"&gt;+&lt;/span&gt; i&lt;span class="va"&gt;}&lt;/span&gt;&lt;span class="fu"&gt;&amp;gt;&amp;lt;/HeatMapColum&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb5-43"&gt;&lt;a aria-hidden="true" href="#cb5-43" tabindex="-1"&gt;&lt;/a&gt;                    })&lt;span class="va"&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb5-44"&gt;&lt;a aria-hidden="true" href="#cb5-44" tabindex="-1"&gt;&lt;/a&gt;                &lt;span class="kw"&gt;&amp;lt;/div&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb5-45"&gt;&lt;a aria-hidden="true" href="#cb5-45" tabindex="-1"&gt;&lt;/a&gt;                &lt;span class="kw"&gt;&amp;lt;p&lt;/span&gt; &lt;span class="ot"&gt;className&lt;/span&gt;&lt;span class="op"&gt;=&lt;/span&gt;&lt;span class="st"&gt;"heatMap_detail"&lt;/span&gt;&lt;span class="kw"&gt;&amp;gt;&lt;/span&gt;&lt;span class="va"&gt;{&lt;/span&gt;&lt;span class="kw"&gt;this&lt;/span&gt;&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="at"&gt;state&lt;/span&gt;&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="at"&gt;infoString&lt;/span&gt;&lt;span class="va"&gt;}&lt;/span&gt;&lt;span class="kw"&gt;&amp;lt;/p&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb5-46"&gt;&lt;a aria-hidden="true" href="#cb5-46" tabindex="-1"&gt;&lt;/a&gt;            &lt;span class="kw"&gt;&amp;lt;/div&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb5-47"&gt;&lt;a aria-hidden="true" href="#cb5-47" tabindex="-1"&gt;&lt;/a&gt;        )&lt;/span&gt;
&lt;span id="cb5-48"&gt;&lt;a aria-hidden="true" href="#cb5-48" tabindex="-1"&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id="cb5-49"&gt;&lt;a aria-hidden="true" href="#cb5-49" tabindex="-1"&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;主要值得注意的是&lt;code&gt;weekdayDisplay&lt;/code&gt;的处理和使用&lt;code&gt;Array.from(new Array(20), () =&amp;gt; new Array(7).fill(0))&lt;/code&gt;来创建矩阵。&lt;/p&gt;
&lt;h2 id="其他杂项"&gt;其他杂项&lt;/h2&gt;
&lt;h3 id="css"&gt;CSS&lt;/h3&gt;
&lt;p&gt;很少啊很少&lt;/p&gt;
&lt;div class="sourceCode" id="cb6"&gt;&lt;pre class="sourceCode css"&gt;&lt;code class="sourceCode css"&gt;&lt;span id="cb6-1"&gt;&lt;a aria-hidden="true" href="#cb6-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="fu"&gt;.heatMap_main&lt;/span&gt; {&lt;/span&gt;
&lt;span id="cb6-2"&gt;&lt;a aria-hidden="true" href="#cb6-2" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="kw"&gt;display&lt;/span&gt;: &lt;span class="dv"&gt;flex&lt;/span&gt;&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb6-3"&gt;&lt;a aria-hidden="true" href="#cb6-3" tabindex="-1"&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id="cb6-4"&gt;&lt;a aria-hidden="true" href="#cb6-4" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb6-5"&gt;&lt;a aria-hidden="true" href="#cb6-5" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="fu"&gt;.heatMap_element&lt;/span&gt; {&lt;/span&gt;
&lt;span id="cb6-6"&gt;&lt;a aria-hidden="true" href="#cb6-6" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="kw"&gt;width&lt;/span&gt;: &lt;span class="dv"&gt;12&lt;/span&gt;&lt;span class="dt"&gt;px&lt;/span&gt;&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb6-7"&gt;&lt;a aria-hidden="true" href="#cb6-7" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="kw"&gt;height&lt;/span&gt;: &lt;span class="dv"&gt;12&lt;/span&gt;&lt;span class="dt"&gt;px&lt;/span&gt;&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb6-8"&gt;&lt;a aria-hidden="true" href="#cb6-8" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="kw"&gt;border&lt;/span&gt;: &lt;span class="dv"&gt;1&lt;/span&gt;&lt;span class="dt"&gt;px&lt;/span&gt; &lt;span class="dv"&gt;solid&lt;/span&gt; &lt;span class="cn"&gt;#dedddf&lt;/span&gt;&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb6-9"&gt;&lt;a aria-hidden="true" href="#cb6-9" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="kw"&gt;margin&lt;/span&gt;: &lt;span class="dv"&gt;1&lt;/span&gt;&lt;span class="dt"&gt;px&lt;/span&gt;&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb6-10"&gt;&lt;a aria-hidden="true" href="#cb6-10" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="kw"&gt;border-radius&lt;/span&gt;: &lt;span class="dv"&gt;2&lt;/span&gt;&lt;span class="dt"&gt;px&lt;/span&gt;&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb6-11"&gt;&lt;a aria-hidden="true" href="#cb6-11" tabindex="-1"&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id="cb6-12"&gt;&lt;a aria-hidden="true" href="#cb6-12" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb6-13"&gt;&lt;a aria-hidden="true" href="#cb6-13" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="fu"&gt;.heatMap_element&lt;/span&gt;&lt;span class="in"&gt;:hover&lt;/span&gt; {&lt;/span&gt;
&lt;span id="cb6-14"&gt;&lt;a aria-hidden="true" href="#cb6-14" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="kw"&gt;border&lt;/span&gt;: &lt;span class="dv"&gt;1&lt;/span&gt;&lt;span class="dt"&gt;px&lt;/span&gt; &lt;span class="dv"&gt;solid&lt;/span&gt; &lt;span class="cn"&gt;black&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb6-15"&gt;&lt;a aria-hidden="true" href="#cb6-15" tabindex="-1"&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id="cb6-16"&gt;&lt;a aria-hidden="true" href="#cb6-16" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb6-17"&gt;&lt;a aria-hidden="true" href="#cb6-17" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="fu"&gt;.heatMap_weekday&lt;/span&gt; {&lt;/span&gt;
&lt;span id="cb6-18"&gt;&lt;a aria-hidden="true" href="#cb6-18" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="kw"&gt;width&lt;/span&gt;: &lt;span class="dv"&gt;36&lt;/span&gt;&lt;span class="dt"&gt;px&lt;/span&gt;&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb6-19"&gt;&lt;a aria-hidden="true" href="#cb6-19" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="kw"&gt;text-align&lt;/span&gt;: &lt;span class="dv"&gt;center&lt;/span&gt;&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb6-20"&gt;&lt;a aria-hidden="true" href="#cb6-20" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="kw"&gt;line-height&lt;/span&gt;: &lt;span class="dv"&gt;8.5&lt;/span&gt;&lt;span class="dt"&gt;px&lt;/span&gt;&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb6-21"&gt;&lt;a aria-hidden="true" href="#cb6-21" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="kw"&gt;margin-top&lt;/span&gt;: &lt;span class="dv"&gt;6&lt;/span&gt;&lt;span class="dt"&gt;px&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb6-22"&gt;&lt;a aria-hidden="true" href="#cb6-22" tabindex="-1"&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id="cb6-23"&gt;&lt;a aria-hidden="true" href="#cb6-23" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb6-24"&gt;&lt;a aria-hidden="true" href="#cb6-24" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="fu"&gt;.heatMap_detail&lt;/span&gt; {&lt;/span&gt;
&lt;span id="cb6-25"&gt;&lt;a aria-hidden="true" href="#cb6-25" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="kw"&gt;float&lt;/span&gt;: &lt;span class="dv"&gt;right&lt;/span&gt;&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb6-26"&gt;&lt;a aria-hidden="true" href="#cb6-26" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="kw"&gt;padding-right&lt;/span&gt;: &lt;span class="dv"&gt;14&lt;/span&gt;&lt;span class="dt"&gt;px&lt;/span&gt;&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb6-27"&gt;&lt;a aria-hidden="true" href="#cb6-27" tabindex="-1"&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id="cb6-28"&gt;&lt;a aria-hidden="true" href="#cb6-28" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb6-29"&gt;&lt;a aria-hidden="true" href="#cb6-29" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="pp"&gt;#HeatMap&lt;/span&gt; {&lt;/span&gt;
&lt;span id="cb6-30"&gt;&lt;a aria-hidden="true" href="#cb6-30" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="kw"&gt;padding&lt;/span&gt;: &lt;span class="dv"&gt;10&lt;/span&gt;&lt;span class="dt"&gt;px&lt;/span&gt;&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb6-31"&gt;&lt;a aria-hidden="true" href="#cb6-31" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="kw"&gt;width&lt;/span&gt;: &lt;span class="dv"&gt;370&lt;/span&gt;&lt;span class="dt"&gt;px&lt;/span&gt;&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb6-32"&gt;&lt;a aria-hidden="true" href="#cb6-32" tabindex="-1"&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h1 id="实现"&gt;实现&lt;/h1&gt;
&lt;p&gt;使用实验数据:&lt;/p&gt;
&lt;div class="sourceCode" id="cb7"&gt;&lt;pre class="sourceCode js"&gt;&lt;code class="sourceCode javascript"&gt;&lt;span id="cb7-1"&gt;&lt;a aria-hidden="true" href="#cb7-1" tabindex="-1"&gt;&lt;/a&gt;    {&lt;/span&gt;
&lt;span id="cb7-2"&gt;&lt;a aria-hidden="true" href="#cb7-2" tabindex="-1"&gt;&lt;/a&gt;      &lt;span class="st"&gt;"1"&lt;/span&gt;&lt;span class="op"&gt;:&lt;/span&gt; [&lt;span class="dv"&gt;0&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt; &lt;span class="dv"&gt;1&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt; &lt;span class="dv"&gt;2&lt;/span&gt;]&lt;span class="op"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb7-3"&gt;&lt;a aria-hidden="true" href="#cb7-3" tabindex="-1"&gt;&lt;/a&gt;      &lt;span class="st"&gt;"3"&lt;/span&gt;&lt;span class="op"&gt;:&lt;/span&gt; [&lt;span class="dv"&gt;8&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt; &lt;span class="dv"&gt;17&lt;/span&gt;]&lt;span class="op"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb7-4"&gt;&lt;a aria-hidden="true" href="#cb7-4" tabindex="-1"&gt;&lt;/a&gt;      &lt;span class="st"&gt;"2"&lt;/span&gt;&lt;span class="op"&gt;:&lt;/span&gt; [&lt;span class="dv"&gt;4&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt; &lt;span class="dv"&gt;6&lt;/span&gt;]&lt;span class="op"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb7-5"&gt;&lt;a aria-hidden="true" href="#cb7-5" tabindex="-1"&gt;&lt;/a&gt;      &lt;span class="st"&gt;"4"&lt;/span&gt;&lt;span class="op"&gt;:&lt;/span&gt; [&lt;span class="dv"&gt;115&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt; &lt;span class="dv"&gt;139&lt;/span&gt;]&lt;/span&gt;
&lt;span id="cb7-6"&gt;&lt;a aria-hidden="true" href="#cb7-6" tabindex="-1"&gt;&lt;/a&gt;    }&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;最终结果是这样的：&lt;/p&gt;
&lt;figure&gt;
&lt;img alt="最终结果图片" src="./assets/result.png"/&gt;
&lt;figcaption aria-hidden="true"&gt;最终结果图片&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;h1 id="todo"&gt;TODO&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;用svg来替换div&lt;/li&gt;
&lt;li&gt;适应手机端&lt;/li&gt;
&lt;/ul&gt;
&lt;br/&gt;
&lt;!--%%REF%%--&gt;
&lt;br/&gt;
&lt;script async="" crossorigin="anonymous" data-category="Announcements" data-category-id="DIC_kwDOJ7Ymy84CX4eg" data-emit-metadata="0" data-input-position="top" data-lang="zh-CN" data-loading="lazy" data-mapping="title" data-reactions-enabled="1" data-repo="izfsk-ium/izfsk-ium.github.io" data-repo-id="R_kgDOJ7Ymyw" data-strict="0" data-theme="preferred_color_scheme" src="https://giscus.app/client.js"&gt;
&lt;/script&gt;
&lt;/main&gt;
&lt;footer&gt;
&lt;p class="signoff"&gt;
&lt;div class="metadata"&gt;
&lt;p class="date"&gt;&lt;time datetime="2022-11-23"&gt;创建日期：2022-11-23&lt;/time&gt;&lt;/p&gt;
&lt;p class="lastmodify"&gt;&lt;time&gt;最后编译：2023-08-10&lt;/time&gt;&lt;/p&gt;
&lt;p class="lastmodify" id="counter-span"&gt;访问次数：&lt;/p&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;/footer&gt;
&lt;script&gt;
    /* These script should run after page load */
    document.querySelectorAll('code.sourceCode').forEach(
      i =&gt; i.insertAdjacentHTML('beforeend', '&lt;div class="copy"&gt;复制&lt;/div&gt;')
    );
    document.querySelectorAll('div.copy').forEach(
      i =&gt; i.addEventListener(
        'click',
        () =&gt; {
          navigator.clipboard.writeText(i.parentElement.innerText.replace('复制', ''));
          i.innerText = '成功';
          setTimeout(() =&gt; {
            i.innerText = '复制';
          }, 1000);
        }
      )
    );

    if (location.href.includes("127.0.0.1:8080")) {
      document.getElementById("counter-span").innerHTML = "[[development mode]]";
    } else {
      const uuid = document.getElementById("article-uuid").innerText;
      const target = document.getElementById("counter-span");
      const last = localStorage.getItem("lastVisit-" + uuid);
      const shouldIncrease = last === null || new Date().getTime() - parseInt(last) &gt;= (1000 * 60 * 15);

      fetch(shouldIncrease ? ("https://counter.izfsk.top/counter/" + uuid) : ("https://counter.izfsk.top/readOnly/" + uuid))
        .then(r =&gt; r.text())
        .then(d =&gt; {
          if (!d.startsWith("Too"))
            document.getElementById("counter-span").innerText = "访问次数：" + d.toString();
          else
            document.getElementById("counter-span").innerHTML = "";
        });

      localStorage.setItem("lastVisit-" + uuid, new Date().getTime());
    }
  &lt;/script&gt;
&lt;script async="" data-website-id="2a1146ab-fa82-4a84-a04f-30e5967357c3" src="https://analytics.umami.is/script.js"&gt;&lt;/script&gt;
&lt;/body&gt;</content:encoded>
      <guid isPermaLink="false">7f47edb7-e725-491a-b870-567ba2c80029</guid>
      <pubDate>Wed, 23 Nov 2022 00:00:00 +0800</pubDate>
    </item>
    <item>
      <title>Kotlin笔记(1)</title>
      <link>https://blog.izfsk.top/articles/Kotlin笔记(1).html</link>
      <description>Kotlin笔记(1)</description>
      <content:encoded>&lt;body&gt;
&lt;progress id="content_progress" value="0"&gt;&lt;/progress&gt;
&lt;button id="back-to-top"&gt;
    回页顶
  &lt;/button&gt;
&lt;header&gt;
&lt;small id="article-uuid" style="display: none !important;"&gt;49154284-8978-4e9b-81d9-e5cfa757dcea&lt;/small&gt;
&lt;h1 class="title"&gt;Kotlin笔记(1)&lt;/h1&gt;
&lt;!-- Subtitle --&gt;
&lt;h3 class="subtitle"&gt; &lt;/h3&gt;
&lt;/header&gt;
&lt;nav id="TOC" role="doc-toc"&gt;
&lt;strong&gt;文章归类: &lt;a href="/pages/category.html#学习"&gt;学习&lt;/a&gt; &lt;/strong&gt;
&lt;input id="contents" type="checkbox"/&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#开发环境" id="toc-开发环境"&gt;开发环境&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#ide" id="toc-ide"&gt;IDE&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#repl" id="toc-repl"&gt;REPL&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#数据" id="toc-数据"&gt;数据&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#val" id="toc-val"&gt;val&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#var" id="toc-var"&gt;var&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#const-val" id="toc-const-val"&gt;const val&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#基本数据类型" id="toc-基本数据类型"&gt;基本数据类型&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#字符串" id="toc-字符串"&gt;字符串&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#数字" id="toc-数字"&gt;数字&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#list列表" id="toc-list列表"&gt;List列表&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#set集合" id="toc-set集合"&gt;Set集合&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#map散列表" id="toc-map散列表"&gt;Map散列表&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#控制流" id="toc-控制流"&gt;控制流&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#函数" id="toc-函数"&gt;函数&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#匿名函数" id="toc-匿名函数"&gt;匿名函数&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#扩展函数" id="toc-扩展函数"&gt;扩展函数&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#null安全" id="toc-null安全"&gt;null安全&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#reference"&gt;参考链接&lt;/a&gt;&lt;/li&gt;
&lt;li&gt; &lt;/li&gt;
&lt;li class="tools"&gt;
&lt;span id="backtomain"&gt;
&lt;svg class="bi bi-house" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M8.707 1.5a1 1 0 0 0-1.414 0L.646 8.146a.5.5 0 0 0 .708.708L2 8.207V13.5A1.5 1.5 0 0 0 3.5 15h9a1.5 1.5 0 0 0 1.5-1.5V8.207l.646.647a.5.5 0 0 0 .708-.708L13 5.793V2.5a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v1.293L8.707 1.5ZM13 7.207V13.5a.5.5 0 0 1-.5.5h-9a.5.5 0 0 1-.5-.5V7.207l5-5 5 5Z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="readingmode"&gt;
&lt;svg class="bi bi-book" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M1 2.828c.885-.37 2.154-.769 3.388-.893 1.33-.134 2.458.063 3.112.752v9.746c-.935-.53-2.12-.603-3.213-.493-1.18.12-2.37.461-3.287.811V2.828zm7.5-.141c.654-.689 1.782-.886 3.112-.752 1.234.124 2.503.523 3.388.893v9.923c-.918-.35-2.107-.692-3.287-.81-1.094-.111-2.278-.039-3.213.492V2.687zM8 1.783C7.015.936 5.587.81 4.287.94c-1.514.153-3.042.672-3.994 1.105A.5.5 0 0 0 0 2.5v11a.5.5 0 0 0 .707.455c.882-.4 2.303-.881 3.68-1.02 1.409-.142 2.59.087 3.223.877a.5.5 0 0 0 .78 0c.633-.79 1.814-1.019 3.222-.877 1.378.139 2.8.62 3.681 1.02A.5.5 0 0 0 16 13.5v-11a.5.5 0 0 0-.293-.455c-.952-.433-2.48-.952-3.994-1.105C10.413.809 8.985.936 8 1.783z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="larger"&gt; &lt;/span&gt;
&lt;span id="smaller"&gt;&lt;/span&gt;
&lt;span id="switchfont"&gt;
&lt;svg class="bi bi-fonts" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M12.258 3h-8.51l-.083 2.46h.479c.26-1.544.758-1.783 2.693-1.845l.424-.013v7.827c0 .663-.144.82-1.3.923v.52h4.082v-.52c-1.162-.103-1.306-.26-1.306-.923V3.602l.431.013c1.934.062 2.434.301 2.693 1.846h.479L12.258 3z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="backtotop"&gt;
&lt;svg class="bi bi-arrow-bar-up" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M8 10a.5.5 0 0 0 .5-.5V3.707l2.146 2.147a.5.5 0 0 0 .708-.708l-3-3a.5.5 0 0 0-.708 0l-3 3a.5.5 0 1 0 .708.708L7.5 3.707V9.5a.5.5 0 0 0 .5.5zm-7 2.5a.5.5 0 0 1 .5-.5h13a.5.5 0 0 1 0 1h-13a.5.5 0 0 1-.5-.5z" fill-rule="evenodd"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/nav&gt;
&lt;main&gt;
&lt;h1 id="开发环境"&gt;开发环境&lt;/h1&gt;
&lt;h2 id="ide"&gt;IDE&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;IDEA (&lt;a href="https://www.jetbrains.com/idea/download"&gt;JetBrains IDEA 下载&lt;/a&gt;)&lt;/li&gt;
&lt;li&gt;VS Code (&lt;a href="https://code.visualstudio.com/"&gt;VSCode&lt;/a&gt;) + Kotlin 插件(&lt;a href="https://marketplace.visualstudio.com/items?itemName=fwcd.kotlin"&gt;插件&lt;/a&gt;)&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="repl"&gt;REPL&lt;/h2&gt;
&lt;p&gt;打开&lt;code&gt;Tools → Kotlin → Kotlin REPL&lt;/code&gt;使用REPL&lt;/p&gt;
&lt;h1 id="数据"&gt;数据&lt;/h1&gt;
&lt;h2 id="val"&gt;val&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;val&lt;/code&gt;是不可变类型（只读变量）。运行时指定，不可修改。&lt;/p&gt;
&lt;div class="sourceCode" id="cb1"&gt;&lt;pre class="sourceCode kotlin"&gt;&lt;code class="sourceCode kotlin"&gt;&lt;span id="cb1-1"&gt;&lt;a aria-hidden="true" href="#cb1-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;val&lt;/span&gt; &lt;span class="va"&gt;x&lt;/span&gt;&lt;span class="op"&gt;:&lt;/span&gt;&lt;span class="kw"&gt;String&lt;/span&gt; &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="st"&gt;"Hello!"&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-2"&gt;&lt;a aria-hidden="true" href="#cb1-2" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;val&lt;/span&gt; &lt;span class="va"&gt;y&lt;/span&gt; &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="st"&gt;"Hello!"&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-3"&gt;&lt;a aria-hidden="true" href="#cb1-3" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;val&lt;/span&gt; &lt;span class="va"&gt;z&lt;/span&gt;&lt;span class="op"&gt;:&lt;/span&gt;&lt;span class="kw"&gt;String&lt;/span&gt; &lt;span class="op"&gt;=&lt;/span&gt; readLine&lt;span class="op"&gt;()&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id="var"&gt;var&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;var&lt;/code&gt;是可变变量类型。&lt;/p&gt;
&lt;div class="sourceCode" id="cb2"&gt;&lt;pre class="sourceCode kotlin"&gt;&lt;code class="sourceCode kotlin"&gt;&lt;span id="cb2-1"&gt;&lt;a aria-hidden="true" href="#cb2-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;var&lt;/span&gt; &lt;span class="va"&gt;x&lt;/span&gt;&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-2"&gt;&lt;a aria-hidden="true" href="#cb2-2" tabindex="-1"&gt;&lt;/a&gt;x &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="dv"&gt;1024&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id="const-val"&gt;const val&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;const val&lt;/code&gt;是&lt;strong&gt;编译时常量&lt;/strong&gt;，必须在编译时是已知的基本数据类型。必须放在最外层。&lt;/p&gt;
&lt;div class="sourceCode" id="cb3"&gt;&lt;pre class="sourceCode kotlin"&gt;&lt;code class="sourceCode kotlin"&gt;&lt;span id="cb3-1"&gt;&lt;a aria-hidden="true" href="#cb3-1" tabindex="-1"&gt;&lt;/a&gt;const &lt;span class="kw"&gt;val&lt;/span&gt; &lt;span class="va"&gt;x&lt;/span&gt;&lt;span class="op"&gt;=&lt;/span&gt;&lt;span class="st"&gt;"sss"&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id="基本数据类型"&gt;基本数据类型&lt;/h2&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class="header"&gt;
&lt;th&gt;类型&lt;/th&gt;
&lt;th&gt;描述&lt;/th&gt;
&lt;th&gt;举例&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class="odd"&gt;
&lt;td&gt;String&lt;/td&gt;
&lt;td&gt;字符串&lt;/td&gt;
&lt;td&gt;“Hello!”&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="even"&gt;
&lt;td&gt;char&lt;/td&gt;
&lt;td&gt;单个字符&lt;/td&gt;
&lt;td&gt;‘x’&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="odd"&gt;
&lt;td&gt;Boolean&lt;/td&gt;
&lt;td&gt;&lt;code&gt;true/false&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;true&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="even"&gt;
&lt;td&gt;Int&lt;/td&gt;
&lt;td&gt;整数&lt;/td&gt;
&lt;td&gt;114514&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="odd"&gt;
&lt;td&gt;Long&lt;/td&gt;
&lt;td&gt;长整数&lt;/td&gt;
&lt;td&gt;999999999&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="even"&gt;
&lt;td&gt;Byte&lt;/td&gt;
&lt;td&gt;8位整数&lt;/td&gt;
&lt;td&gt;126&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="odd"&gt;
&lt;td&gt;Short&lt;/td&gt;
&lt;td&gt;16位整数&lt;/td&gt;
&lt;td&gt;32767&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="even"&gt;
&lt;td&gt;Float&lt;/td&gt;
&lt;td&gt;32位浮点数&lt;/td&gt;
&lt;td&gt;3.488&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="odd"&gt;
&lt;td&gt;Double&lt;/td&gt;
&lt;td&gt;浮点数&lt;/td&gt;
&lt;td&gt;1919.810&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="even"&gt;
&lt;td&gt;List&lt;/td&gt;
&lt;td&gt;列表&lt;/td&gt;
&lt;td&gt;略&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="odd"&gt;
&lt;td&gt;Set&lt;/td&gt;
&lt;td&gt;集合&lt;/td&gt;
&lt;td&gt;略&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="even"&gt;
&lt;td&gt;Map&lt;/td&gt;
&lt;td&gt;散列表/字典&lt;/td&gt;
&lt;td&gt;略&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="字符串"&gt;字符串&lt;/h3&gt;
&lt;ol type="1"&gt;
&lt;li&gt;&lt;p&gt;字符串截取：使用&lt;code&gt;substring&lt;/code&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;字符串分割：使用&lt;code&gt;split&lt;/code&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;字符串替换字符：使用&lt;code&gt;replace+lambda&lt;/code&gt;:&lt;/p&gt;
&lt;div class="sourceCode" id="cb4"&gt;&lt;pre class="sourceCode kotlin"&gt;&lt;code class="sourceCode kotlin"&gt;&lt;span id="cb4-1"&gt;&lt;a aria-hidden="true" href="#cb4-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;fun&lt;/span&gt; &lt;span class="fu"&gt;toDragonSpeak&lt;/span&gt;&lt;span class="op"&gt;(&lt;/span&gt;&lt;span class="va"&gt;phrase&lt;/span&gt;&lt;span class="op"&gt;:&lt;/span&gt; &lt;span class="dt"&gt;String&lt;/span&gt;&lt;span class="op"&gt;)&lt;/span&gt; &lt;span class="op"&gt;=&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb4-2"&gt;&lt;a aria-hidden="true" href="#cb4-2" tabindex="-1"&gt;&lt;/a&gt;    phrase&lt;span class="op"&gt;.&lt;/span&gt;replace&lt;span class="op"&gt;(&lt;/span&gt;Regex&lt;span class="op"&gt;(&lt;/span&gt;&lt;span class="st"&gt;"[aeiou]"&lt;/span&gt;&lt;span class="op"&gt;))&lt;/span&gt; &lt;span class="op"&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb4-3"&gt;&lt;a aria-hidden="true" href="#cb4-3" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="cf"&gt;when&lt;/span&gt; &lt;span class="op"&gt;(&lt;/span&gt;it&lt;span class="op"&gt;.&lt;/span&gt;value&lt;span class="op"&gt;)&lt;/span&gt; &lt;span class="op"&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb4-4"&gt;&lt;a aria-hidden="true" href="#cb4-4" tabindex="-1"&gt;&lt;/a&gt;            &lt;span class="st"&gt;"a"&lt;/span&gt; &lt;span class="op"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="st"&gt;"4"&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb4-5"&gt;&lt;a aria-hidden="true" href="#cb4-5" tabindex="-1"&gt;&lt;/a&gt;            &lt;span class="st"&gt;"e"&lt;/span&gt; &lt;span class="op"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="st"&gt;"3"&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb4-6"&gt;&lt;a aria-hidden="true" href="#cb4-6" tabindex="-1"&gt;&lt;/a&gt;            &lt;span class="st"&gt;"i"&lt;/span&gt; &lt;span class="op"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="st"&gt;"1"&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb4-7"&gt;&lt;a aria-hidden="true" href="#cb4-7" tabindex="-1"&gt;&lt;/a&gt;            &lt;span class="st"&gt;"o"&lt;/span&gt; &lt;span class="op"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="st"&gt;"0"&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb4-8"&gt;&lt;a aria-hidden="true" href="#cb4-8" tabindex="-1"&gt;&lt;/a&gt;            &lt;span class="st"&gt;"u"&lt;/span&gt; &lt;span class="op"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="st"&gt;"|_|"&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb4-9"&gt;&lt;a aria-hidden="true" href="#cb4-9" tabindex="-1"&gt;&lt;/a&gt;            &lt;span class="cf"&gt;else&lt;/span&gt; &lt;span class="op"&gt;-&amp;gt;&lt;/span&gt; it&lt;span class="op"&gt;.&lt;/span&gt;value&lt;/span&gt;
&lt;span id="cb4-10"&gt;&lt;a aria-hidden="true" href="#cb4-10" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="op"&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb4-11"&gt;&lt;a aria-hidden="true" href="#cb4-11" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="op"&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;字符串比较：可以直接使用&lt;code&gt;==&lt;/code&gt;(与Java不同)：&lt;/p&gt;
&lt;div class="sourceCode" id="cb5"&gt;&lt;pre class="sourceCode kotlin"&gt;&lt;code class="sourceCode kotlin"&gt;&lt;span id="cb5-1"&gt;&lt;a aria-hidden="true" href="#cb5-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;val&lt;/span&gt; &lt;span class="va"&gt;phrase&lt;/span&gt; &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="cf"&gt;if&lt;/span&gt; &lt;span class="op"&gt;(&lt;/span&gt;name &lt;span class="op"&gt;==&lt;/span&gt; &lt;span class="st"&gt;"Dragon's Breath"&lt;/span&gt;&lt;span class="op"&gt;)&lt;/span&gt; &lt;span class="op"&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb5-2"&gt;&lt;a aria-hidden="true" href="#cb5-2" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="st"&gt;"Madrigal exclaims &lt;/span&gt;&lt;span class="ss"&gt;${&lt;/span&gt;toDragonSpeak&lt;span class="op"&gt;(&lt;/span&gt;&lt;span class="st"&gt;"Ah, delicious &lt;/span&gt;&lt;span class="ss"&gt;$name&lt;/span&gt;&lt;span class="st"&gt;!"&lt;/span&gt;&lt;span class="op"&gt;)&lt;/span&gt;&lt;span class="ss"&gt;}&lt;/span&gt;&lt;span class="st"&gt;"&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb5-3"&gt;&lt;a aria-hidden="true" href="#cb5-3" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="op"&gt;}&lt;/span&gt; &lt;span class="cf"&gt;else&lt;/span&gt; &lt;span class="op"&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb5-4"&gt;&lt;a aria-hidden="true" href="#cb5-4" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="st"&gt;"Madrigal says: Thanks for the &lt;/span&gt;&lt;span class="ss"&gt;$name&lt;/span&gt;&lt;span class="st"&gt;."&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb5-5"&gt;&lt;a aria-hidden="true" href="#cb5-5" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="op"&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;遍历字符串： 一个字符串就是一个不可变的字符列表，所以能用在list上的都能用在字符串上。&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id="数字"&gt;数字&lt;/h3&gt;
&lt;h4 id="字符串转数字"&gt;字符串转数字&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;toFloat&lt;/li&gt;
&lt;li&gt;toDouble&lt;/li&gt;
&lt;li&gt;toDoubleOrNull&lt;/li&gt;
&lt;li&gt;toIntOrNull&lt;/li&gt;
&lt;li&gt;toLong&lt;/li&gt;
&lt;li&gt;toBigDecimal&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;等。每一种都有&lt;code&gt;toXXXOrNull&lt;/code&gt;版本，返回可空类型，便于使用&lt;code&gt;?:&lt;/code&gt;运算符避免抓异常。&lt;/p&gt;
&lt;h4 id="数字格式化"&gt;数字格式化&lt;/h4&gt;
&lt;p&gt;按照C语言的格式化字符串规则展开即可。&lt;/p&gt;
&lt;h4 id="位运算"&gt;位运算&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;Integer.toBinaryString()&lt;/code&gt;直接把数字转换为二进制&lt;/li&gt;
&lt;li&gt;&lt;code&gt;shl&lt;/code&gt;:按位左移&lt;/li&gt;
&lt;li&gt;&lt;code&gt;shr&lt;/code&gt;:按位右移&lt;/li&gt;
&lt;li&gt;&lt;code&gt;inv&lt;/code&gt;:按位取反&lt;/li&gt;
&lt;li&gt;&lt;code&gt;xor&lt;/code&gt;:按位异或&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="list列表"&gt;List列表&lt;/h3&gt;
&lt;p&gt;列表是kotlin的基本类型。分为两种，可变列表&lt;code&gt;mutableList&lt;/code&gt;和不可变列表&lt;code&gt;List&lt;/code&gt;。&lt;/p&gt;
&lt;h4 id="创建"&gt;创建&lt;/h4&gt;
&lt;div class="sourceCode" id="cb6"&gt;&lt;pre class="sourceCode kotlin"&gt;&lt;code class="sourceCode kotlin"&gt;&lt;span id="cb6-1"&gt;&lt;a aria-hidden="true" href="#cb6-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;val&lt;/span&gt; &lt;span class="va"&gt;patronList&lt;/span&gt;&lt;span class="op"&gt;:&lt;/span&gt; List&lt;span class="op"&gt;&amp;lt;&lt;/span&gt;&lt;span class="kw"&gt;String&lt;/span&gt;&lt;span class="op"&gt;&amp;gt;&lt;/span&gt; &lt;span class="op"&gt;=&lt;/span&gt; listOf&lt;span class="op"&gt;(&lt;/span&gt;&lt;span class="st"&gt;"Eli"&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt; &lt;span class="st"&gt;"Mordoc"&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt; &lt;span class="st"&gt;"Sophie"&lt;/span&gt;&lt;span class="op"&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb6-2"&gt;&lt;a aria-hidden="true" href="#cb6-2" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;val&lt;/span&gt; &lt;span class="va"&gt;patronMutableList&lt;/span&gt; &lt;span class="op"&gt;=&lt;/span&gt; mutableListOf&lt;span class="op"&gt;&amp;lt;&lt;/span&gt;&lt;span class="kw"&gt;String&lt;/span&gt;&lt;span class="op"&gt;&amp;gt;(&lt;/span&gt;&lt;span class="st"&gt;"Eli"&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt; &lt;span class="st"&gt;"Mordoc"&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt; &lt;span class="st"&gt;"Sophie"&lt;/span&gt;&lt;span class="op"&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb6-3"&gt;&lt;a aria-hidden="true" href="#cb6-3" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb6-4"&gt;&lt;a aria-hidden="true" href="#cb6-4" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;val&lt;/span&gt; &lt;span class="va"&gt;tmp&lt;/span&gt;&lt;span class="op"&gt;=&lt;/span&gt; mutableListOf&lt;span class="op"&gt;&amp;lt;&lt;/span&gt;&lt;span class="kw"&gt;String&lt;/span&gt;&lt;span class="op"&gt;&amp;gt;()&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb6-5"&gt;&lt;a aria-hidden="true" href="#cb6-5" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;val&lt;/span&gt; &lt;span class="va"&gt;lines&lt;/span&gt;&lt;span class="op"&gt;:&lt;/span&gt; List&lt;span class="op"&gt;&amp;lt;&lt;/span&gt;&lt;span class="kw"&gt;String&lt;/span&gt;&lt;span class="op"&gt;&amp;gt;?&lt;/span&gt; &lt;span class="op"&gt;=&lt;/span&gt; File&lt;span class="op"&gt;(&lt;/span&gt;&lt;span class="st"&gt;"file"&lt;/span&gt;&lt;span class="op"&gt;).&lt;/span&gt;takeIf &lt;span class="op"&gt;{&lt;/span&gt; it&lt;span class="op"&gt;.&lt;/span&gt;canRead&lt;span class="op"&gt;()&lt;/span&gt; &lt;span class="op"&gt;}?.&lt;/span&gt;readLines&lt;span class="op"&gt;()&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h4 id="获取与遍历"&gt;获取与遍历&lt;/h4&gt;
&lt;h5 id="获取"&gt;获取&lt;/h5&gt;
&lt;ol type="1"&gt;
&lt;li&gt;&lt;code&gt;get()&lt;/code&gt; : 可能抛出异常。&lt;/li&gt;
&lt;li&gt;&lt;code&gt;getOrNull()&lt;/code&gt; : 便于使用&lt;code&gt;?:&lt;/code&gt;处理null值&lt;/li&gt;
&lt;li&gt;&lt;code&gt;getOrElse()&lt;/code&gt; : 使用lambda获取默认值，例如&lt;code&gt;tmp.getOrElse(15) { "ss" }&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;h5 id="遍历"&gt;遍历&lt;/h5&gt;
&lt;ol type="1"&gt;
&lt;li&gt;&lt;code&gt;forEachIndexed(action: (index: Int, T) -&amp;gt; Unit)&lt;/code&gt; : 带索引的遍历&lt;/li&gt;
&lt;li&gt;&lt;code&gt;forEach(action: (T) -&amp;gt; Unit)&lt;/code&gt; : 没有索引的遍历&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;都是携带一个lambda函数。&lt;strong&gt;注意要使用&lt;code&gt;run&lt;/code&gt;来执行lambda!!!&lt;/strong&gt;&lt;/p&gt;
&lt;h4 id="修改"&gt;修改&lt;/h4&gt;
&lt;p&gt;只有mutableListOf才能修改。有add和addAll两个方法。&lt;/p&gt;
&lt;h4 id="解构"&gt;解构&lt;/h4&gt;
&lt;p&gt;List 集合支持以解构的方式获取其中的元素。 &lt;code&gt;val (type, name, price) = TargetString.split(',')&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;split 函数返回集合数据后,集合里的前三个元素就分别赋值给了 type、 name 和 price 这 三个字符串变量。通过使用_符号过滤不想要的元素。&lt;/p&gt;
&lt;h3 id="set集合"&gt;Set集合&lt;/h3&gt;
&lt;p&gt;Set是会自动去重的集合类型。和List类似，有可变与不可变两种。Set和List可以互相转换。使用&lt;code&gt;toList&lt;/code&gt;和&lt;code&gt;toSet&lt;/code&gt;即可。 Set的创建方法如下：&lt;/p&gt;
&lt;div class="sourceCode" id="cb7"&gt;&lt;pre class="sourceCode kotlin"&gt;&lt;code class="sourceCode kotlin"&gt;&lt;span id="cb7-1"&gt;&lt;a aria-hidden="true" href="#cb7-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;val&lt;/span&gt; &lt;span class="va"&gt;planets&lt;/span&gt; &lt;span class="op"&gt;=&lt;/span&gt; setOf&lt;span class="op"&gt;(&lt;/span&gt;&lt;span class="st"&gt;"Mercury"&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt; &lt;span class="st"&gt;"Venus"&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt; &lt;span class="st"&gt;"Earth"&lt;/span&gt;&lt;span class="op"&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb7-2"&gt;&lt;a aria-hidden="true" href="#cb7-2" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;val&lt;/span&gt; &lt;span class="va"&gt;uniquePatrons&lt;/span&gt; &lt;span class="op"&gt;=&lt;/span&gt; mutableSetOf&lt;span class="op"&gt;&amp;lt;&lt;/span&gt;&lt;span class="kw"&gt;String&lt;/span&gt;&lt;span class="op"&gt;&amp;gt;()&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;类似的，使用&lt;code&gt;add&lt;/code&gt;,&lt;code&gt;addAll&lt;/code&gt;,&lt;code&gt;remove&lt;/code&gt;,&lt;code&gt;removeAll&lt;/code&gt;,&lt;code&gt;clear&lt;/code&gt;等函数处理&lt;strong&gt;可变&lt;/strong&gt;的Set。&lt;/p&gt;
&lt;p&gt;对于线性的容器，可以使用&lt;code&gt;uniquePatrons.shuffled().first()&lt;/code&gt;这种方法方便快捷的取得随机元素。&lt;/p&gt;
&lt;h3 id="map散列表"&gt;Map散列表&lt;/h3&gt;
&lt;p&gt;Map即类似于python中的dict或C++中的map。现代的常用程式语言没有在语言内置散列表的功能是说不过去的。Kotlin的Map用来存放 一组元素,默认只读。创建方法如下：&lt;/p&gt;
&lt;div class="sourceCode" id="cb8"&gt;&lt;pre class="sourceCode kotlin"&gt;&lt;code class="sourceCode kotlin"&gt;&lt;span id="cb8-1"&gt;&lt;a aria-hidden="true" href="#cb8-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;val&lt;/span&gt; &lt;span class="va"&gt;the_map&lt;/span&gt; &lt;span class="op"&gt;=&lt;/span&gt; mapOf&lt;span class="op"&gt;(&lt;/span&gt;&lt;span class="st"&gt;"Eli"&lt;/span&gt; to &lt;span class="fl"&gt;10.5&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt; &lt;span class="st"&gt;"Mordoc"&lt;/span&gt; to &lt;span class="fl"&gt;8.0&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt; &lt;span class="st"&gt;"Sophie"&lt;/span&gt; to &lt;span class="fl"&gt;5.5&lt;/span&gt;&lt;span class="op"&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb8-2"&gt;&lt;a aria-hidden="true" href="#cb8-2" tabindex="-1"&gt;&lt;/a&gt;the_map &lt;span class="op"&gt;+=&lt;/span&gt; &lt;span class="st"&gt;"Sophie"&lt;/span&gt; to &lt;span class="fl"&gt;6.0&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;其中&lt;code&gt;to&lt;/code&gt;是个省略了点号和参数圆括号的特殊函数，把它两边的元素转换为一个&lt;code&gt;Pair&lt;/code&gt;（&lt;code&gt;Pair("Mordoc", 8.00)&lt;/code&gt;）。 读取方法是简单的方括号，也可以使用&lt;code&gt;getOrElse()&lt;/code&gt;,&lt;code&gt;getOrDefault()&lt;/code&gt;来防止null异常。注意&lt;code&gt;getOrElse()&lt;/code&gt;使用匿名函数。 一般情况下，需要使用类似这样的代码来检查和添加元素：&lt;/p&gt;
&lt;div class="sourceCode" id="cb9"&gt;&lt;pre class="sourceCode python"&gt;&lt;code class="sourceCode python"&gt;&lt;span id="cb9-1"&gt;&lt;a aria-hidden="true" href="#cb9-1" tabindex="-1"&gt;&lt;/a&gt;x &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="bu"&gt;dict&lt;/span&gt;()&lt;/span&gt;
&lt;span id="cb9-2"&gt;&lt;a aria-hidden="true" href="#cb9-2" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="cf"&gt;try&lt;/span&gt;:&lt;/span&gt;
&lt;span id="cb9-3"&gt;&lt;a aria-hidden="true" href="#cb9-3" tabindex="-1"&gt;&lt;/a&gt;    result &lt;span class="op"&gt;=&lt;/span&gt; x[&lt;span class="st"&gt;'nohere'&lt;/span&gt;]&lt;/span&gt;
&lt;span id="cb9-4"&gt;&lt;a aria-hidden="true" href="#cb9-4" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="cf"&gt;except&lt;/span&gt; &lt;span class="pp"&gt;Exception&lt;/span&gt; &lt;span class="im"&gt;as&lt;/span&gt; e:&lt;/span&gt;
&lt;span id="cb9-5"&gt;&lt;a aria-hidden="true" href="#cb9-5" tabindex="-1"&gt;&lt;/a&gt;    x[&lt;span class="st"&gt;'nohere'&lt;/span&gt;] &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="st"&gt;'default'&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb9-6"&gt;&lt;a aria-hidden="true" href="#cb9-6" tabindex="-1"&gt;&lt;/a&gt;    result &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="st"&gt;'default'&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;但在kotlin中只需要一个&lt;code&gt;getOrPut()&lt;/code&gt;函数即可，很方便。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;其实，有IDEA这样的IDE并不需要记住这些函数的原型，一般只需要猜即可。放入操作大凡是put，取出则大凡是get。&lt;/strong&gt;&lt;/p&gt;
&lt;h2 id="控制流"&gt;控制流&lt;/h2&gt;
&lt;p&gt;if,else,while,for等等控制流不必多言。&lt;/p&gt;
&lt;p&gt;导入的话，可以类似python用&lt;code&gt;import XXX as XXX&lt;/code&gt;了。&lt;/p&gt;
&lt;p&gt;&lt;code&gt;import com.a.b.c.d as myHappyFunc&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;由于Kotlin比较灵活的语法，可以写的更舒服。有一种TMTOWTDI的意思了。&lt;/p&gt;
&lt;p&gt;(话说回来我觉得Python的不好之处就在于一些全局函数，比如不得不使用&lt;code&gt;map(),str()&lt;/code&gt;之类的&lt;strong&gt;函数&lt;/strong&gt;，而不是在各种对象上调用&lt;code&gt;xxx.map().str()&lt;/code&gt;的方法。 即使对象有内置的&lt;code&gt;__str__()&lt;/code&gt;方法，而且Python的lambda比较弱)&lt;/p&gt;
&lt;h2 id="函数"&gt;函数&lt;/h2&gt;
&lt;h3 id="匿名函数"&gt;匿名函数&lt;/h3&gt;
&lt;del&gt;
    约翰·麦卡锡和阿隆佐·丘奇们的英灵可以告慰啦！现代语言几乎都支持匿名函数和函数式写法，哪怕 大家并不知道啥alpha转换，beta规约（
    &lt;/del&gt;
&lt;p&gt;再加上几个标准函数，真的可以做到函数式一把梭。（apply, let, with, run, also, takeIf, takeUnless)&lt;/p&gt;
&lt;p&gt;稍举一例：&lt;/p&gt;
&lt;div class="sourceCode" id="cb10"&gt;&lt;pre class="sourceCode kotlin"&gt;&lt;code class="sourceCode kotlin"&gt;&lt;span id="cb10-1"&gt;&lt;a aria-hidden="true" href="#cb10-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;val&lt;/span&gt; &lt;span class="va"&gt;fileContents&lt;/span&gt; &lt;span class="op"&gt;=&lt;/span&gt; File&lt;span class="op"&gt;(&lt;/span&gt;&lt;span class="st"&gt;"myfile.txt"&lt;/span&gt;&lt;span class="op"&gt;).&lt;/span&gt;takeIf &lt;span class="op"&gt;{&lt;/span&gt; it&lt;span class="op"&gt;.&lt;/span&gt;canRead&lt;span class="op"&gt;()&lt;/span&gt; &lt;span class="op"&gt;&amp;amp;&amp;amp;&lt;/span&gt; it&lt;span class="op"&gt;.&lt;/span&gt;canWrite&lt;span class="op"&gt;()&lt;/span&gt; &lt;span class="op"&gt;}?.&lt;/span&gt;readText&lt;span class="op"&gt;()&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id="扩展函数"&gt;扩展函数&lt;/h3&gt;
&lt;p&gt;扩展可以在不直接修改类定义的情况下增加类功能。javascript可以使用这样的方法给已有的类添加方法：&lt;/p&gt;
&lt;div class="sourceCode" id="cb11"&gt;&lt;pre class="sourceCode js"&gt;&lt;code class="sourceCode javascript"&gt;&lt;span id="cb11-1"&gt;&lt;a aria-hidden="true" href="#cb11-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="bu"&gt;String&lt;/span&gt;&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="at"&gt;prototype&lt;/span&gt;&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="at"&gt;ddd&lt;/span&gt; &lt;span class="op"&gt;=&lt;/span&gt; () &lt;span class="kw"&gt;=&amp;gt;&lt;/span&gt; { &lt;span class="bu"&gt;console&lt;/span&gt;&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;log&lt;/span&gt;(&lt;span class="st"&gt;'Hello!'&lt;/span&gt;) }&lt;/span&gt;
&lt;span id="cb11-2"&gt;&lt;a aria-hidden="true" href="#cb11-2" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="st"&gt;"Hello!"&lt;/span&gt;&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;ddd&lt;/span&gt;()&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class="sourceCode" id="cb12"&gt;&lt;pre class="sourceCode kotlin"&gt;&lt;code class="sourceCode kotlin"&gt;&lt;span id="cb12-1"&gt;&lt;a aria-hidden="true" href="#cb12-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;fun&lt;/span&gt; &lt;span class="fu"&gt;String&lt;/span&gt;&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;myFunc&lt;/span&gt;&lt;span class="op"&gt;(&lt;/span&gt;&lt;span class="va"&gt;amount&lt;/span&gt;&lt;span class="op"&gt;:&lt;/span&gt; &lt;span class="dt"&gt;Int&lt;/span&gt; &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="dv"&gt;1&lt;/span&gt;&lt;span class="op"&gt;)&lt;/span&gt; &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="kw"&gt;this&lt;/span&gt; &lt;span class="op"&gt;+&lt;/span&gt; &lt;span class="st"&gt;"!"&lt;/span&gt;&lt;span class="op"&gt;.&lt;/span&gt;repeat&lt;span class="op"&gt;(&lt;/span&gt;amount&lt;span class="op"&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb12-2"&gt;&lt;a aria-hidden="true" href="#cb12-2" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;fun&lt;/span&gt; &lt;span class="fu"&gt;main&lt;/span&gt;&lt;span class="op"&gt;(&lt;/span&gt;&lt;span class="va"&gt;args&lt;/span&gt;&lt;span class="op"&gt;:&lt;/span&gt; &lt;span class="dt"&gt;Array&lt;/span&gt;&amp;lt;&lt;span class="va"&gt;String&lt;/span&gt;&amp;gt;&lt;span class="op"&gt;)&lt;/span&gt; &lt;span class="op"&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb12-3"&gt;&lt;a aria-hidden="true" href="#cb12-3" tabindex="-1"&gt;&lt;/a&gt;    println&lt;span class="op"&gt;(&lt;/span&gt;&lt;span class="st"&gt;"Hello!"&lt;/span&gt;&lt;span class="op"&gt;.&lt;/span&gt;myFunc&lt;span class="op"&gt;())&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb12-4"&gt;&lt;a aria-hidden="true" href="#cb12-4" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="op"&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb12-5"&gt;&lt;a aria-hidden="true" href="#cb12-5" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb12-6"&gt;&lt;a aria-hidden="true" href="#cb12-6" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;fun&lt;/span&gt; &lt;span class="fu"&gt;Any&lt;/span&gt;&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;easyPrint&lt;/span&gt;&lt;span class="op"&gt;()&lt;/span&gt; &lt;span class="op"&gt;=&lt;/span&gt; println&lt;span class="op"&gt;(&lt;/span&gt;&lt;span class="kw"&gt;this&lt;/span&gt;&lt;span class="op"&gt;)&lt;/span&gt; &lt;span class="co"&gt;// 超类亦可&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb12-7"&gt;&lt;a aria-hidden="true" href="#cb12-7" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;fun&lt;/span&gt; &lt;span class="fu"&gt;main&lt;/span&gt;&lt;span class="op"&gt;(&lt;/span&gt;&lt;span class="va"&gt;args&lt;/span&gt;&lt;span class="op"&gt;:&lt;/span&gt; &lt;span class="dt"&gt;Array&lt;/span&gt;&amp;lt;&lt;span class="va"&gt;String&lt;/span&gt;&amp;gt;&lt;span class="op"&gt;)&lt;/span&gt; &lt;span class="op"&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb12-8"&gt;&lt;a aria-hidden="true" href="#cb12-8" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="fl"&gt;42.&lt;/span&gt;easyPrint&lt;span class="op"&gt;()&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb12-9"&gt;&lt;a aria-hidden="true" href="#cb12-9" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="op"&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id="null安全"&gt;null安全&lt;/h2&gt;
&lt;p&gt;在类型后面加个问号表示可空类型。例如&lt;code&gt;String?&lt;/code&gt;。&lt;/p&gt;
&lt;p&gt;使用&lt;code&gt;?.&lt;/code&gt;（安全调用运算符）来防止在null上调用函数出现&lt;code&gt;NPE&lt;/code&gt;，可以使用&lt;code&gt;!!.&lt;/code&gt;来强制调用，跳过检查。 使用&lt;code&gt;?:&lt;/code&gt;来实现类似Javascript中&lt;code&gt;undefined || "default"&lt;/code&gt;的取值。&lt;/p&gt;
&lt;br/&gt;
&lt;!--%%REF%%--&gt;
&lt;br/&gt;
&lt;script async="" crossorigin="anonymous" data-category="Announcements" data-category-id="DIC_kwDOJ7Ymy84CX4eg" data-emit-metadata="0" data-input-position="top" data-lang="zh-CN" data-loading="lazy" data-mapping="title" data-reactions-enabled="1" data-repo="izfsk-ium/izfsk-ium.github.io" data-repo-id="R_kgDOJ7Ymyw" data-strict="0" data-theme="preferred_color_scheme" src="https://giscus.app/client.js"&gt;
&lt;/script&gt;
&lt;/main&gt;
&lt;footer&gt;
&lt;p class="signoff"&gt;
&lt;div class="metadata"&gt;
&lt;p class="date"&gt;&lt;time datetime="2022-11-24"&gt;创建日期：2022-11-24&lt;/time&gt;&lt;/p&gt;
&lt;p class="lastmodify"&gt;&lt;time&gt;最后编译：2023-08-10&lt;/time&gt;&lt;/p&gt;
&lt;p class="lastmodify" id="counter-span"&gt;访问次数：&lt;/p&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;/footer&gt;
&lt;script&gt;
    /* These script should run after page load */
    document.querySelectorAll('code.sourceCode').forEach(
      i =&gt; i.insertAdjacentHTML('beforeend', '&lt;div class="copy"&gt;复制&lt;/div&gt;')
    );
    document.querySelectorAll('div.copy').forEach(
      i =&gt; i.addEventListener(
        'click',
        () =&gt; {
          navigator.clipboard.writeText(i.parentElement.innerText.replace('复制', ''));
          i.innerText = '成功';
          setTimeout(() =&gt; {
            i.innerText = '复制';
          }, 1000);
        }
      )
    );

    if (location.href.includes("127.0.0.1:8080")) {
      document.getElementById("counter-span").innerHTML = "[[development mode]]";
    } else {
      const uuid = document.getElementById("article-uuid").innerText;
      const target = document.getElementById("counter-span");
      const last = localStorage.getItem("lastVisit-" + uuid);
      const shouldIncrease = last === null || new Date().getTime() - parseInt(last) &gt;= (1000 * 60 * 15);

      fetch(shouldIncrease ? ("https://counter.izfsk.top/counter/" + uuid) : ("https://counter.izfsk.top/readOnly/" + uuid))
        .then(r =&gt; r.text())
        .then(d =&gt; {
          if (!d.startsWith("Too"))
            document.getElementById("counter-span").innerText = "访问次数：" + d.toString();
          else
            document.getElementById("counter-span").innerHTML = "";
        });

      localStorage.setItem("lastVisit-" + uuid, new Date().getTime());
    }
  &lt;/script&gt;
&lt;script async="" data-website-id="2a1146ab-fa82-4a84-a04f-30e5967357c3" src="https://analytics.umami.is/script.js"&gt;&lt;/script&gt;
&lt;/body&gt;</content:encoded>
      <guid isPermaLink="false">49154284-8978-4e9b-81d9-e5cfa757dcea</guid>
      <pubDate>Thu, 24 Nov 2022 00:00:00 +0800</pubDate>
    </item>
    <item>
      <title>React+Redux简单使用</title>
      <link>https://blog.izfsk.top/articles/React+Redux简单使用.html</link>
      <description>React+Redux简单使用</description>
      <content:encoded>&lt;body&gt;
&lt;progress id="content_progress" value="0"&gt;&lt;/progress&gt;
&lt;button id="back-to-top"&gt;
    回页顶
  &lt;/button&gt;
&lt;header&gt;
&lt;small id="article-uuid" style="display: none !important;"&gt;8535e383-e302-48c1-849a-d0c4447265f4&lt;/small&gt;
&lt;h1 class="title"&gt;React+Redux简单使用&lt;/h1&gt;
&lt;!-- Subtitle --&gt;
&lt;h3 class="subtitle"&gt; &lt;/h3&gt;
&lt;/header&gt;
&lt;nav id="TOC" role="doc-toc"&gt;
&lt;strong&gt;文章归类: &lt;a href="/pages/category.html#学习"&gt;学习&lt;/a&gt; &lt;/strong&gt;
&lt;input id="contents" type="checkbox"/&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#缘起" id="toc-缘起"&gt;缘起&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#场景" id="toc-场景"&gt;场景&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#使用" id="toc-使用"&gt;使用&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#redux-方面" id="toc-redux-方面"&gt;Redux 方面&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#react方面" id="toc-react方面"&gt;React方面&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#订阅数据" id="toc-订阅数据"&gt;“订阅”数据&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#组件获取数据" id="toc-组件获取数据"&gt;组件获取数据&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#组件更改数据" id="toc-组件更改数据"&gt;组件更改数据&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#异步操作和在组件外进行dispatch" id="toc-异步操作和在组件外进行dispatch"&gt;异步操作和在组件外进行dispatch&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#初始化时fetch内容" id="toc-初始化时fetch内容"&gt;初始化时fetch内容&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#组件内fetch内容" id="toc-组件内fetch内容"&gt;组件内fetch内容&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#参见" id="toc-参见"&gt;参见&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#reference"&gt;参考链接&lt;/a&gt;&lt;/li&gt;
&lt;li&gt; &lt;/li&gt;
&lt;li class="tools"&gt;
&lt;span id="backtomain"&gt;
&lt;svg class="bi bi-house" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M8.707 1.5a1 1 0 0 0-1.414 0L.646 8.146a.5.5 0 0 0 .708.708L2 8.207V13.5A1.5 1.5 0 0 0 3.5 15h9a1.5 1.5 0 0 0 1.5-1.5V8.207l.646.647a.5.5 0 0 0 .708-.708L13 5.793V2.5a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v1.293L8.707 1.5ZM13 7.207V13.5a.5.5 0 0 1-.5.5h-9a.5.5 0 0 1-.5-.5V7.207l5-5 5 5Z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="readingmode"&gt;
&lt;svg class="bi bi-book" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M1 2.828c.885-.37 2.154-.769 3.388-.893 1.33-.134 2.458.063 3.112.752v9.746c-.935-.53-2.12-.603-3.213-.493-1.18.12-2.37.461-3.287.811V2.828zm7.5-.141c.654-.689 1.782-.886 3.112-.752 1.234.124 2.503.523 3.388.893v9.923c-.918-.35-2.107-.692-3.287-.81-1.094-.111-2.278-.039-3.213.492V2.687zM8 1.783C7.015.936 5.587.81 4.287.94c-1.514.153-3.042.672-3.994 1.105A.5.5 0 0 0 0 2.5v11a.5.5 0 0 0 .707.455c.882-.4 2.303-.881 3.68-1.02 1.409-.142 2.59.087 3.223.877a.5.5 0 0 0 .78 0c.633-.79 1.814-1.019 3.222-.877 1.378.139 2.8.62 3.681 1.02A.5.5 0 0 0 16 13.5v-11a.5.5 0 0 0-.293-.455c-.952-.433-2.48-.952-3.994-1.105C10.413.809 8.985.936 8 1.783z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="larger"&gt; &lt;/span&gt;
&lt;span id="smaller"&gt;&lt;/span&gt;
&lt;span id="switchfont"&gt;
&lt;svg class="bi bi-fonts" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M12.258 3h-8.51l-.083 2.46h.479c.26-1.544.758-1.783 2.693-1.845l.424-.013v7.827c0 .663-.144.82-1.3.923v.52h4.082v-.52c-1.162-.103-1.306-.26-1.306-.923V3.602l.431.013c1.934.062 2.434.301 2.693 1.846h.479L12.258 3z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="backtotop"&gt;
&lt;svg class="bi bi-arrow-bar-up" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M8 10a.5.5 0 0 0 .5-.5V3.707l2.146 2.147a.5.5 0 0 0 .708-.708l-3-3a.5.5 0 0 0-.708 0l-3 3a.5.5 0 1 0 .708.708L7.5 3.707V9.5a.5.5 0 0 0 .5.5zm-7 2.5a.5.5 0 0 1 .5-.5h13a.5.5 0 0 1 0 1h-13a.5.5 0 0 1-.5-.5z" fill-rule="evenodd"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/nav&gt;
&lt;main&gt;
&lt;h1 id="缘起"&gt;缘起&lt;/h1&gt;
&lt;p&gt;我需要使用到 redux，找到的教程要么是阐释 redux 设计的大道至简精深奥妙超凡脱俗出类拔萃，要么是只有方案没有解释的片段，难遂我意。所以我在自己摸索以后做一个简单记录。&lt;/p&gt;
&lt;h1 id="场景"&gt;场景&lt;/h1&gt;
&lt;p&gt;Redux 所适应的场景是需要处理很多复杂数据，并且这些数据被页面上不同的组件依赖和改变。例如，需要制作一个日历 APP ，包括一个日历，显示事件的窗格，显示这一天心情的窗格， 用户点击更改日历上的日期，另外两个窗格也需要更改内容，那么它们都依赖于一个全局的数据源，如果使用传统的方法，在各个 React 组件里面传入一个函数处理，很快就会凌乱不堪， 所以需要一个统一管理这个「全局变量」的东西，实现各个组件订阅数据，一旦改变，各个组件都能够接收到改变的功能。那就是 redux 了。&lt;/p&gt;
&lt;p&gt;我设想的情景就是这么一个网页 App ，并且需要使用 React 实现三个组件。在改变日期时还需要从服务器动态获取数据异步加载。&lt;/p&gt;
&lt;h1 id="使用"&gt;使用&lt;/h1&gt;
&lt;h2 id="redux-方面"&gt;Redux 方面&lt;/h2&gt;
&lt;p&gt;首先需要安装 redux 。使用的是 &lt;code&gt;yarn add @reduxjs/toolkit react-redux&lt;/code&gt; 。react 项目直接用 &lt;code&gt;creat-vite&lt;/code&gt; 来创建一个脚手架项目。&lt;/p&gt;
&lt;p&gt;使用到 redux 的项目一般不是一个 &lt;code&gt;index.js&lt;/code&gt; 就能够解决的。一般来讲需要创建几个不同的目录：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;store.js 用来保存初始状态和整个 redux 的配置&lt;/li&gt;
&lt;li&gt;features 一个目录，用来保存 app 的各个功能需要用到的数据 &lt;code&gt;Slice&lt;/code&gt;。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;一个 app 是复杂的，比如本文的 app 三个组件，日历组件可能需要时间，日期，这一天星期几；事件查看机需要一个事件列表；而心情窗格需要心情，额外文本等。每个部分的功能所需要的 数据某种程度上独立，但都统合在 store 里面相互影响，比如，星期几的改变会改变另外两个的内容，所以每一个组件所定义的「全局数据片段」保存在单独的 feature 文件里面。所得到的就是各自的 &lt;code&gt;features/XXXSlice.js&lt;/code&gt;。&lt;/p&gt;
&lt;p&gt;如果把redux想象成全局变量管理器，这个全局变量，也就是store需要有一个初始值，分解到每一个Slice，它们各自都需要定义自己的初始状态，才能成为整个store的初始状态。 Slice文件不仅定义的这个组件（功能片段）的数据定义和初始状态，也定义了改变状态的方法，也就是&lt;code&gt;reducer&lt;/code&gt;。对于redux来讲，reducer需要是一个&lt;strong&gt;纯函数&lt;/strong&gt;， 接收一个状态，返回一个状态。白话来讲，就是：&lt;code&gt;(state, action) =&amp;gt; newState&lt;/code&gt;，其中&lt;code&gt;state&lt;/code&gt;是老的状态，&lt;code&gt;action&lt;/code&gt;是这个reducer的发起者（比如点击日历日期后的事件处理函数） 发送的关于怎么改数据的action，返回一个新的状态。这个&lt;code&gt;action&lt;/code&gt;有具体的格式，必须是这样的：&lt;/p&gt;
&lt;div class="sourceCode" id="cb1"&gt;&lt;pre class="sourceCode typescript"&gt;&lt;code class="sourceCode typescript"&gt;&lt;span id="cb1-1"&gt;&lt;a aria-hidden="true" href="#cb1-1" tabindex="-1"&gt;&lt;/a&gt;actions&lt;span class="op"&gt;:&lt;/span&gt; {&lt;/span&gt;
&lt;span id="cb1-2"&gt;&lt;a aria-hidden="true" href="#cb1-2" tabindex="-1"&gt;&lt;/a&gt;    payload&lt;span class="op"&gt;:&lt;/span&gt; &lt;span class="dt"&gt;any&lt;/span&gt;&lt;span class="op"&gt;;&lt;/span&gt;   &lt;span class="co"&gt;// 一般是一个String, 或者可以序列化的类型&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-3"&gt;&lt;a aria-hidden="true" href="#cb1-3" tabindex="-1"&gt;&lt;/a&gt;    type&lt;span class="op"&gt;:&lt;/span&gt; &lt;span class="dt"&gt;string&lt;/span&gt;&lt;span class="op"&gt;;&lt;/span&gt;   &lt;span class="co"&gt;// 类似 'calendarSlice/changeDate' 这样的字符串&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-4"&gt;&lt;a aria-hidden="true" href="#cb1-4" tabindex="-1"&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;进行reduce的操作叫做&lt;code&gt;dispatch&lt;/code&gt;。 幸运的是，react-redux 这个toolkit给了很多便捷的方法来创建这些东西。&lt;/p&gt;
&lt;p&gt;一个slice（日期组件）的举例：&lt;/p&gt;
&lt;div class="sourceCode" id="cb2"&gt;&lt;pre class="sourceCode typescript"&gt;&lt;code class="sourceCode typescript"&gt;&lt;span id="cb2-1"&gt;&lt;a aria-hidden="true" href="#cb2-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="im"&gt;import&lt;/span&gt; { createSlice } &lt;span class="im"&gt;from&lt;/span&gt; &lt;span class="st"&gt;'@reduxjs/toolkit'&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-2"&gt;&lt;a aria-hidden="true" href="#cb2-2" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb2-3"&gt;&lt;a aria-hidden="true" href="#cb2-3" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="im"&gt;export&lt;/span&gt; &lt;span class="kw"&gt;const&lt;/span&gt; calendarSlice &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="fu"&gt;createSlice&lt;/span&gt;({&lt;/span&gt;
&lt;span id="cb2-4"&gt;&lt;a aria-hidden="true" href="#cb2-4" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="co"&gt;// name是必须的，用来合成各个reducer的payload中的type&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-5"&gt;&lt;a aria-hidden="true" href="#cb2-5" tabindex="-1"&gt;&lt;/a&gt;    name&lt;span class="op"&gt;:&lt;/span&gt; &lt;span class="st"&gt;"CalendarSlice"&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-6"&gt;&lt;a aria-hidden="true" href="#cb2-6" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="co"&gt;// 初始状态&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-7"&gt;&lt;a aria-hidden="true" href="#cb2-7" tabindex="-1"&gt;&lt;/a&gt;    initialState&lt;span class="op"&gt;:&lt;/span&gt; {&lt;/span&gt;
&lt;span id="cb2-8"&gt;&lt;a aria-hidden="true" href="#cb2-8" tabindex="-1"&gt;&lt;/a&gt;        currentDisplayDate&lt;span class="op"&gt;:&lt;/span&gt; &lt;span class="kw"&gt;new&lt;/span&gt; &lt;span class="bu"&gt;Date&lt;/span&gt;()&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;getTime&lt;/span&gt;()&lt;span class="op"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-9"&gt;&lt;a aria-hidden="true" href="#cb2-9" tabindex="-1"&gt;&lt;/a&gt;        numberOfEventsToday&lt;span class="op"&gt;:&lt;/span&gt; &lt;span class="dv"&gt;0&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-10"&gt;&lt;a aria-hidden="true" href="#cb2-10" tabindex="-1"&gt;&lt;/a&gt;        isHoliday&lt;span class="op"&gt;:&lt;/span&gt; &lt;span class="kw"&gt;false&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-11"&gt;&lt;a aria-hidden="true" href="#cb2-11" tabindex="-1"&gt;&lt;/a&gt;    }&lt;span class="op"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-12"&gt;&lt;a aria-hidden="true" href="#cb2-12" tabindex="-1"&gt;&lt;/a&gt;    reducers&lt;span class="op"&gt;:&lt;/span&gt; {&lt;/span&gt;
&lt;span id="cb2-13"&gt;&lt;a aria-hidden="true" href="#cb2-13" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="co"&gt;// 设置日期的reducer，这里的payload是一个action类型&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-14"&gt;&lt;a aria-hidden="true" href="#cb2-14" tabindex="-1"&gt;&lt;/a&gt;        setNewDate&lt;span class="op"&gt;:&lt;/span&gt; (state&lt;span class="op"&gt;,&lt;/span&gt; payload) &lt;span class="kw"&gt;=&amp;gt;&lt;/span&gt; {&lt;/span&gt;
&lt;span id="cb2-15"&gt;&lt;a aria-hidden="true" href="#cb2-15" tabindex="-1"&gt;&lt;/a&gt;            state&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="at"&gt;currentDisplayDate&lt;/span&gt; &lt;span class="op"&gt;=&lt;/span&gt; payload&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="at"&gt;payload&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-16"&gt;&lt;a aria-hidden="true" href="#cb2-16" tabindex="-1"&gt;&lt;/a&gt;        }&lt;span class="op"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-17"&gt;&lt;a aria-hidden="true" href="#cb2-17" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="co"&gt;// 设置事件数量的reducer&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-18"&gt;&lt;a aria-hidden="true" href="#cb2-18" tabindex="-1"&gt;&lt;/a&gt;        modifyEvents&lt;span class="op"&gt;:&lt;/span&gt; (state&lt;span class="op"&gt;,&lt;/span&gt; payload) &lt;span class="kw"&gt;=&amp;gt;&lt;/span&gt; {&lt;/span&gt;
&lt;span id="cb2-19"&gt;&lt;a aria-hidden="true" href="#cb2-19" tabindex="-1"&gt;&lt;/a&gt;            &lt;span class="cf"&gt;if&lt;/span&gt; (payload&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="at"&gt;payload&lt;/span&gt; &lt;span class="op"&gt;===&lt;/span&gt; &lt;span class="st"&gt;'minus'&lt;/span&gt;) &lt;/span&gt;
&lt;span id="cb2-20"&gt;&lt;a aria-hidden="true" href="#cb2-20" tabindex="-1"&gt;&lt;/a&gt;                    state&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="at"&gt;numberOfEventsToday&lt;/span&gt; &lt;span class="op"&gt;-=&lt;/span&gt; &lt;span class="dv"&gt;1&lt;/span&gt;&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-21"&gt;&lt;a aria-hidden="true" href="#cb2-21" tabindex="-1"&gt;&lt;/a&gt;            &lt;span class="cf"&gt;else&lt;/span&gt;    state&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="at"&gt;numberOfEventsToday&lt;/span&gt; &lt;span class="op"&gt;+=&lt;/span&gt; &lt;span class="dv"&gt;1&lt;/span&gt;&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-22"&gt;&lt;a aria-hidden="true" href="#cb2-22" tabindex="-1"&gt;&lt;/a&gt;        }&lt;span class="op"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-23"&gt;&lt;a aria-hidden="true" href="#cb2-23" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="co"&gt;// 是否是假期，如果不需要，reducer可以不带payload&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-24"&gt;&lt;a aria-hidden="true" href="#cb2-24" tabindex="-1"&gt;&lt;/a&gt;        toggleIsHoliday&lt;span class="op"&gt;:&lt;/span&gt; (state) &lt;span class="kw"&gt;=&amp;gt;&lt;/span&gt; {&lt;/span&gt;
&lt;span id="cb2-25"&gt;&lt;a aria-hidden="true" href="#cb2-25" tabindex="-1"&gt;&lt;/a&gt;            state&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="at"&gt;isHoliday&lt;/span&gt; &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="op"&gt;!&lt;/span&gt;state&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="at"&gt;isHoliday&lt;/span&gt;&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-26"&gt;&lt;a aria-hidden="true" href="#cb2-26" tabindex="-1"&gt;&lt;/a&gt;        }&lt;/span&gt;
&lt;span id="cb2-27"&gt;&lt;a aria-hidden="true" href="#cb2-27" tabindex="-1"&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id="cb2-28"&gt;&lt;a aria-hidden="true" href="#cb2-28" tabindex="-1"&gt;&lt;/a&gt;})&lt;/span&gt;
&lt;span id="cb2-29"&gt;&lt;a aria-hidden="true" href="#cb2-29" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb2-30"&gt;&lt;a aria-hidden="true" href="#cb2-30" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="im"&gt;export&lt;/span&gt; &lt;span class="kw"&gt;const&lt;/span&gt; { setNewDate&lt;span class="op"&gt;,&lt;/span&gt; toggleIsHoliday&lt;span class="op"&gt;,&lt;/span&gt; modifyEvents } &lt;span class="op"&gt;=&lt;/span&gt; calendarSlice&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="at"&gt;actions&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-31"&gt;&lt;a aria-hidden="true" href="#cb2-31" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb2-32"&gt;&lt;a aria-hidden="true" href="#cb2-32" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="im"&gt;export&lt;/span&gt; &lt;span class="im"&gt;default&lt;/span&gt; calendarSlice&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;这就成功的创建的一个slice了。一般就保存为&lt;code&gt;features/calendarSlice.js&lt;/code&gt;。&lt;/p&gt;
&lt;p&gt;其他的几个组件都是类似的定义，那么最后还需要一个总的store的设置：&lt;/p&gt;
&lt;div class="sourceCode" id="cb3"&gt;&lt;pre class="sourceCode typescript"&gt;&lt;code class="sourceCode typescript"&gt;&lt;span id="cb3-1"&gt;&lt;a aria-hidden="true" href="#cb3-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="im"&gt;import&lt;/span&gt; { configureStore }   &lt;span class="im"&gt;from&lt;/span&gt; &lt;span class="st"&gt;'@reduxjs/toolkit'&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb3-2"&gt;&lt;a aria-hidden="true" href="#cb3-2" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="im"&gt;import&lt;/span&gt; EditorSlice          &lt;span class="im"&gt;from&lt;/span&gt; &lt;span class="st"&gt;'./features/editorSlice'&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb3-3"&gt;&lt;a aria-hidden="true" href="#cb3-3" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="im"&gt;import&lt;/span&gt; globalSlice          &lt;span class="im"&gt;from&lt;/span&gt; &lt;span class="st"&gt;'./features/globalSlice'&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb3-4"&gt;&lt;a aria-hidden="true" href="#cb3-4" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="im"&gt;import&lt;/span&gt; calendarSlice        &lt;span class="im"&gt;from&lt;/span&gt; &lt;span class="st"&gt;'./features/calendarSlice'&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb3-5"&gt;&lt;a aria-hidden="true" href="#cb3-5" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb3-6"&gt;&lt;a aria-hidden="true" href="#cb3-6" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="im"&gt;export&lt;/span&gt; &lt;span class="kw"&gt;const&lt;/span&gt; applicationStore &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="fu"&gt;configureStore&lt;/span&gt;({&lt;/span&gt;
&lt;span id="cb3-7"&gt;&lt;a aria-hidden="true" href="#cb3-7" tabindex="-1"&gt;&lt;/a&gt;    reducer&lt;span class="op"&gt;:&lt;/span&gt; {&lt;/span&gt;
&lt;span id="cb3-8"&gt;&lt;a aria-hidden="true" href="#cb3-8" tabindex="-1"&gt;&lt;/a&gt;        calendarStatus&lt;span class="op"&gt;:&lt;/span&gt; calendarSlice&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="at"&gt;reducer&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb3-9"&gt;&lt;a aria-hidden="true" href="#cb3-9" tabindex="-1"&gt;&lt;/a&gt;        globalStatus&lt;span class="op"&gt;:&lt;/span&gt; globalSlice&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="at"&gt;reducer&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb3-10"&gt;&lt;a aria-hidden="true" href="#cb3-10" tabindex="-1"&gt;&lt;/a&gt;        editorStatus&lt;span class="op"&gt;:&lt;/span&gt; EditorSlice&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="at"&gt;reducer&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb3-11"&gt;&lt;a aria-hidden="true" href="#cb3-11" tabindex="-1"&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id="cb3-12"&gt;&lt;a aria-hidden="true" href="#cb3-12" tabindex="-1"&gt;&lt;/a&gt;})&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;这就创建了一个全局的store，内含三个组件的Slice，共同组成一个“全局数据”。如果直接看的话，它的内容应该是这样的：&lt;/p&gt;
&lt;div class="sourceCode" id="cb4"&gt;&lt;pre class="sourceCode typescript"&gt;&lt;code class="sourceCode typescript"&gt;&lt;span id="cb4-1"&gt;&lt;a aria-hidden="true" href="#cb4-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;interface&lt;/span&gt; applicationStore_T {&lt;/span&gt;
&lt;span id="cb4-2"&gt;&lt;a aria-hidden="true" href="#cb4-2" tabindex="-1"&gt;&lt;/a&gt;    calendarStatus&lt;span class="op"&gt;:&lt;/span&gt; {&lt;/span&gt;
&lt;span id="cb4-3"&gt;&lt;a aria-hidden="true" href="#cb4-3" tabindex="-1"&gt;&lt;/a&gt;        currentDisplayDate&lt;span class="op"&gt;:&lt;/span&gt; &lt;span class="dt"&gt;number&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb4-4"&gt;&lt;a aria-hidden="true" href="#cb4-4" tabindex="-1"&gt;&lt;/a&gt;        numberOfEventsToday&lt;span class="op"&gt;:&lt;/span&gt; &lt;span class="dt"&gt;number&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb4-5"&gt;&lt;a aria-hidden="true" href="#cb4-5" tabindex="-1"&gt;&lt;/a&gt;        isHoliday&lt;span class="op"&gt;:&lt;/span&gt; &lt;span class="dt"&gt;boolean&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb4-6"&gt;&lt;a aria-hidden="true" href="#cb4-6" tabindex="-1"&gt;&lt;/a&gt;    }&lt;span class="op"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb4-7"&gt;&lt;a aria-hidden="true" href="#cb4-7" tabindex="-1"&gt;&lt;/a&gt;    globalStatus&lt;span class="op"&gt;:&lt;/span&gt; { &lt;span class="co"&gt;/* 这个Slice的数据定义 */&lt;/span&gt;}&lt;span class="op"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb4-8"&gt;&lt;a aria-hidden="true" href="#cb4-8" tabindex="-1"&gt;&lt;/a&gt;    editorStatus&lt;span class="op"&gt;:&lt;/span&gt; { &lt;span class="co"&gt;/* 这个Slice的数据定义 */&lt;/span&gt;}&lt;/span&gt;
&lt;span id="cb4-9"&gt;&lt;a aria-hidden="true" href="#cb4-9" tabindex="-1"&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;那么比如要得到目前这一天是不是假期，就可以用&lt;code&gt;store.calendarStatus.isHoliday&lt;/code&gt;来判断了。&lt;/p&gt;
&lt;h2 id="react方面"&gt;React方面&lt;/h2&gt;
&lt;p&gt;光有数据不行，还要能够显示和改变它们。redux的store需要一个“订阅者”来使用这些数据。也就是React组件。虽然React支持函数式和ES6 Class两种类型，但是react-redux更加偏向使用函数类型(&lt;del&gt;虽然我喜欢写class&lt;/del&gt;)。&lt;/p&gt;
&lt;p&gt;众所周知react组件需要props和state，那么在结合了redux以后，&lt;strong&gt;和app整体的数据有关的，比如日历组件的日期和更改日期，就不再采用props，state了，而与app整体数据无关的，比如编辑器显示的目前输入的字符数量之类，既不需要全局数据，也不会对它产生影响，依然可以使用旧的方法处理&lt;/strong&gt;。&lt;/p&gt;
&lt;h3 id="订阅数据"&gt;“订阅”数据&lt;/h3&gt;
&lt;p&gt;只需要在根元素上面“订阅”一次就可以拿来使用了，redux会自动初始化各自的数据：&lt;/p&gt;
&lt;div class="sourceCode" id="cb5"&gt;&lt;pre class="sourceCode typescript"&gt;&lt;code class="sourceCode typescript"&gt;&lt;span id="cb5-1"&gt;&lt;a aria-hidden="true" href="#cb5-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="im"&gt;import&lt;/span&gt; { applicationStore } &lt;span class="im"&gt;from&lt;/span&gt; &lt;span class="st"&gt;'./store'&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb5-2"&gt;&lt;a aria-hidden="true" href="#cb5-2" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="im"&gt;import&lt;/span&gt; { Provider } &lt;span class="im"&gt;from&lt;/span&gt; &lt;span class="st"&gt;'react-redux'&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb5-3"&gt;&lt;a aria-hidden="true" href="#cb5-3" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb5-4"&gt;&lt;a aria-hidden="true" href="#cb5-4" tabindex="-1"&gt;&lt;/a&gt;ReactDOM&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;createRoot&lt;/span&gt;(&lt;span class="bu"&gt;root&lt;/span&gt;)&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;render&lt;/span&gt;(&lt;/span&gt;
&lt;span id="cb5-5"&gt;&lt;a aria-hidden="true" href="#cb5-5" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="op"&gt;&amp;lt;&lt;/span&gt;Provider store&lt;span class="op"&gt;=&lt;/span&gt;{applicationStore}&lt;span class="op"&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb5-6"&gt;&lt;a aria-hidden="true" href="#cb5-6" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="op"&gt;&amp;lt;&lt;/span&gt;Application &lt;span class="op"&gt;/&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb5-7"&gt;&lt;a aria-hidden="true" href="#cb5-7" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="op"&gt;&amp;lt;/&lt;/span&gt;Provider&lt;span class="op"&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb5-8"&gt;&lt;a aria-hidden="true" href="#cb5-8" tabindex="-1"&gt;&lt;/a&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id="组件获取数据"&gt;组件获取数据&lt;/h3&gt;
&lt;p&gt;各个组件需要自己的那一份slice，而不是把整个store的内容都拿来，这就需要对目前的store内容进行一个选择。 在react-redux中，&lt;code&gt;useSelector()&lt;/code&gt;就是用来给组件自己的那一份数据的，以日历组件为例：&lt;/p&gt;
&lt;div class="sourceCode" id="cb6"&gt;&lt;pre class="sourceCode typescript"&gt;&lt;code class="sourceCode typescript"&gt;&lt;span id="cb6-1"&gt;&lt;a aria-hidden="true" href="#cb6-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="im"&gt;import&lt;/span&gt; { useSelector } &lt;span class="im"&gt;from&lt;/span&gt; &lt;span class="st"&gt;'react-redux'&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb6-2"&gt;&lt;a aria-hidden="true" href="#cb6-2" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="im"&gt;import&lt;/span&gt; { useState } &lt;span class="im"&gt;from&lt;/span&gt; &lt;span class="st"&gt;"react"&lt;/span&gt;&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb6-3"&gt;&lt;a aria-hidden="true" href="#cb6-3" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb6-4"&gt;&lt;a aria-hidden="true" href="#cb6-4" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="im"&gt;export&lt;/span&gt; &lt;span class="kw"&gt;function&lt;/span&gt; &lt;span class="fu"&gt;PageHeader&lt;/span&gt;(props&lt;span class="op"&gt;:&lt;/span&gt; &lt;span class="dt"&gt;any&lt;/span&gt;) {&lt;/span&gt;
&lt;span id="cb6-5"&gt;&lt;a aria-hidden="true" href="#cb6-5" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="kw"&gt;const&lt;/span&gt; [count&lt;span class="op"&gt;,&lt;/span&gt; setCount] &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="fu"&gt;useState&lt;/span&gt;(&lt;span class="dv"&gt;0&lt;/span&gt;)   &lt;span class="co"&gt;// 一个和全局数据无关的state，照样使用&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb6-6"&gt;&lt;a aria-hidden="true" href="#cb6-6" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="kw"&gt;const&lt;/span&gt; slice &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="fu"&gt;useSelector&lt;/span&gt;((state&lt;span class="op"&gt;:&lt;/span&gt; &lt;span class="dt"&gt;any&lt;/span&gt;) &lt;span class="kw"&gt;=&amp;gt;&lt;/span&gt; state&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="at"&gt;calendarStatus&lt;/span&gt;) &lt;span class="co"&gt;// 返回的就是Calendar这个组件需要的Slice内容&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb6-7"&gt;&lt;a aria-hidden="true" href="#cb6-7" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="op"&gt;......&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb6-8"&gt;&lt;a aria-hidden="true" href="#cb6-8" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="cf"&gt;return&lt;/span&gt; ({&lt;span class="co"&gt;/* Calendar的相关jsx */&lt;/span&gt;})&lt;/span&gt;
&lt;span id="cb6-9"&gt;&lt;a aria-hidden="true" href="#cb6-9" tabindex="-1"&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;每当store中的calendarStatus因为某种原因改变了，slice也会改变，并进行&lt;strong&gt;重新渲染&lt;/strong&gt;，某种意义上来讲它类似一个&lt;code&gt;props&lt;/code&gt;。&lt;/p&gt;
&lt;h3 id="组件更改数据"&gt;组件更改数据&lt;/h3&gt;
&lt;p&gt;一般在子组件需要更改外部数据，会在props里面设置一个状态提升的函数，当事件发生时调用它来传出去，在redux里面，一个组件要修改store的数据，需要使用dispatch的方法。&lt;code&gt;useDispatch()&lt;/code&gt;相当于一个邮递员，帮助组件把信息传递给对应的&lt;code&gt;reducer&lt;/code&gt;。依旧举例日历组件：&lt;/p&gt;
&lt;div class="sourceCode" id="cb7"&gt;&lt;pre class="sourceCode typescript"&gt;&lt;code class="sourceCode typescript"&gt;&lt;span id="cb7-1"&gt;&lt;a aria-hidden="true" href="#cb7-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="im"&gt;import&lt;/span&gt; { useSelector&lt;span class="op"&gt;,&lt;/span&gt; useDispatch } &lt;span class="im"&gt;from&lt;/span&gt; &lt;span class="st"&gt;'react-redux'&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb7-2"&gt;&lt;a aria-hidden="true" href="#cb7-2" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb7-3"&gt;&lt;a aria-hidden="true" href="#cb7-3" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="im"&gt;export&lt;/span&gt; &lt;span class="kw"&gt;function&lt;/span&gt; &lt;span class="fu"&gt;PageHeader&lt;/span&gt;(props&lt;span class="op"&gt;:&lt;/span&gt; &lt;span class="dt"&gt;any&lt;/span&gt;) {&lt;/span&gt;
&lt;span id="cb7-4"&gt;&lt;a aria-hidden="true" href="#cb7-4" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="op"&gt;......&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb7-5"&gt;&lt;a aria-hidden="true" href="#cb7-5" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="kw"&gt;const&lt;/span&gt; dispatch &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="fu"&gt;useDispatch&lt;/span&gt;()  &lt;span class="co"&gt;// 请来邮递员先生！&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb7-6"&gt;&lt;a aria-hidden="true" href="#cb7-6" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb7-7"&gt;&lt;a aria-hidden="true" href="#cb7-7" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="cf"&gt;return&lt;/span&gt; (&lt;/span&gt;
&lt;span id="cb7-8"&gt;&lt;a aria-hidden="true" href="#cb7-8" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="op"&gt;&amp;lt;&lt;/span&gt;div className&lt;span class="op"&gt;=&lt;/span&gt;&lt;span class="st"&gt;"cal"&lt;/span&gt;&lt;span class="op"&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb7-9"&gt;&lt;a aria-hidden="true" href="#cb7-9" tabindex="-1"&gt;&lt;/a&gt;            {&lt;span class="co"&gt;/* a lot of codes */&lt;/span&gt;}&lt;/span&gt;
&lt;span id="cb7-10"&gt;&lt;a aria-hidden="true" href="#cb7-10" tabindex="-1"&gt;&lt;/a&gt;            &lt;span class="op"&gt;......&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb7-11"&gt;&lt;a aria-hidden="true" href="#cb7-11" tabindex="-1"&gt;&lt;/a&gt;                &lt;span class="op"&gt;&amp;lt;&lt;/span&gt;div&lt;/span&gt;
&lt;span id="cb7-12"&gt;&lt;a aria-hidden="true" href="#cb7-12" tabindex="-1"&gt;&lt;/a&gt;                    className&lt;span class="op"&gt;=&lt;/span&gt;&lt;span class="st"&gt;"day btn"&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb7-13"&gt;&lt;a aria-hidden="true" href="#cb7-13" tabindex="-1"&gt;&lt;/a&gt;                    onClick&lt;span class="op"&gt;=&lt;/span&gt;{e &lt;span class="kw"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="fu"&gt;dispatch&lt;/span&gt;(&lt;span class="fu"&gt;setNewDate&lt;/span&gt;(&lt;span class="dv"&gt;114514&lt;/span&gt;))} &lt;span class="op"&gt;/&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb7-14"&gt;&lt;a aria-hidden="true" href="#cb7-14" tabindex="-1"&gt;&lt;/a&gt;            &lt;span class="op"&gt;......&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb7-15"&gt;&lt;a aria-hidden="true" href="#cb7-15" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="op"&gt;&amp;lt;/&lt;/span&gt;div&lt;span class="op"&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb7-16"&gt;&lt;a aria-hidden="true" href="#cb7-16" tabindex="-1"&gt;&lt;/a&gt;    )&lt;/span&gt;
&lt;span id="cb7-17"&gt;&lt;a aria-hidden="true" href="#cb7-17" tabindex="-1"&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;在这里，使用了dispatch来调用之前&lt;code&gt;features/calendarSlice.js&lt;/code&gt;预先定义的&lt;code&gt;reducer&lt;/code&gt;函数，而&lt;code&gt;dispatch&lt;/code&gt;的作用就是把消息包装成标准的action类型发送出去。包装出来类似这样：&lt;/p&gt;
&lt;div class="sourceCode" id="cb8"&gt;&lt;pre class="sourceCode ts"&gt;&lt;code class="sourceCode typescript"&gt;&lt;span id="cb8-1"&gt;&lt;a aria-hidden="true" href="#cb8-1" tabindex="-1"&gt;&lt;/a&gt;{&lt;/span&gt;
&lt;span id="cb8-2"&gt;&lt;a aria-hidden="true" href="#cb8-2" tabindex="-1"&gt;&lt;/a&gt;    payload&lt;span class="op"&gt;:&lt;/span&gt; &lt;span class="dv"&gt;114514&lt;/span&gt;&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb8-3"&gt;&lt;a aria-hidden="true" href="#cb8-3" tabindex="-1"&gt;&lt;/a&gt;    type&lt;span class="op"&gt;:&lt;/span&gt; &lt;span class="st"&gt;"CalendarSlice/setNewDate"&lt;/span&gt;&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb8-4"&gt;&lt;a aria-hidden="true" href="#cb8-4" tabindex="-1"&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;然后再去调用&lt;code&gt;setNewDate(state, action)&lt;/code&gt;，其中的state自动是原先的状态。改变之后，在通知所有的订阅者。流程就是这样。&lt;/p&gt;
&lt;h2 id="异步操作和在组件外进行dispatch"&gt;异步操作和在组件外进行dispatch&lt;/h2&gt;
&lt;h3 id="初始化时fetch内容"&gt;初始化时fetch内容&lt;/h3&gt;
&lt;p&gt;没有ajax或者fetch的web是不可想象的，假如用户更改了时间，或者修改了这一天的事件，就要把数据传输回服务器或者请求过来。传输回去直接开一个fetch即可，但请求就有点麻烦，必须要考虑异步问题。&lt;/p&gt;
&lt;p&gt;比如说，在初始化时fetch内容，这是很常见的需求，一般可以结合UI框架的&lt;code&gt;Skeleton&lt;/code&gt;或者类似的组件实现一个”加载中请稍候”的功能，等到初始化完毕再显示。解决方法可以是，现在store里面保存一个全局的&lt;code&gt;isPageLoaded&lt;/code&gt;，各个组件检测它，如果为真，就显示内容，否则加载中。这就涉及到在全局数据fetch完毕以后在react组件外部触发reducer。&lt;/p&gt;
&lt;p&gt;其实是可以的，因为redux本身不依赖于任何框架。react-redux只是提供的快捷方式而已。且看dispatch的定义：&lt;/p&gt;
&lt;div class="sourceCode" id="cb9"&gt;&lt;pre class="sourceCode typescript"&gt;&lt;code class="sourceCode typescript"&gt;&lt;span id="cb9-1"&gt;&lt;a aria-hidden="true" href="#cb9-1" tabindex="-1"&gt;&lt;/a&gt;ToolkitStore&lt;span class="op"&gt;&amp;lt;&lt;/span&gt;{ &lt;span class="co"&gt;/* Store的类型定义 */&lt;/span&gt; }&lt;span class="op"&gt;,&lt;/span&gt; AnyAction&lt;span class="op"&gt;,&lt;/span&gt; [&lt;span class="op"&gt;...&lt;/span&gt;]&lt;span class="op"&gt;&amp;gt;.&lt;/span&gt;&lt;span class="at"&gt;dispatch&lt;/span&gt;&lt;span class="op"&gt;:&lt;/span&gt; &lt;span class="op"&gt;&amp;lt;&lt;/span&gt;{&lt;/span&gt;
&lt;span id="cb9-2"&gt;&lt;a aria-hidden="true" href="#cb9-2" tabindex="-1"&gt;&lt;/a&gt;    payload&lt;span class="op"&gt;:&lt;/span&gt; &lt;span class="dt"&gt;boolean&lt;/span&gt;&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb9-3"&gt;&lt;a aria-hidden="true" href="#cb9-3" tabindex="-1"&gt;&lt;/a&gt;    type&lt;span class="op"&gt;:&lt;/span&gt; &lt;span class="dt"&gt;string&lt;/span&gt;&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb9-4"&gt;&lt;a aria-hidden="true" href="#cb9-4" tabindex="-1"&gt;&lt;/a&gt;}&lt;span class="op"&gt;&amp;gt;&lt;/span&gt;(action&lt;span class="op"&gt;:&lt;/span&gt; {&lt;/span&gt;
&lt;span id="cb9-5"&gt;&lt;a aria-hidden="true" href="#cb9-5" tabindex="-1"&gt;&lt;/a&gt;    payload&lt;span class="op"&gt;:&lt;/span&gt; &lt;span class="dt"&gt;boolean&lt;/span&gt;&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb9-6"&gt;&lt;a aria-hidden="true" href="#cb9-6" tabindex="-1"&gt;&lt;/a&gt;    type&lt;span class="op"&gt;:&lt;/span&gt; &lt;span class="dt"&gt;string&lt;/span&gt;&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb9-7"&gt;&lt;a aria-hidden="true" href="#cb9-7" tabindex="-1"&gt;&lt;/a&gt;}) &lt;span class="kw"&gt;=&amp;gt;&lt;/span&gt; {&lt;/span&gt;
&lt;span id="cb9-8"&gt;&lt;a aria-hidden="true" href="#cb9-8" tabindex="-1"&gt;&lt;/a&gt;    payload&lt;span class="op"&gt;:&lt;/span&gt; &lt;span class="dt"&gt;boolean&lt;/span&gt;&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb9-9"&gt;&lt;a aria-hidden="true" href="#cb9-9" tabindex="-1"&gt;&lt;/a&gt;    type&lt;span class="op"&gt;:&lt;/span&gt; &lt;span class="dt"&gt;string&lt;/span&gt;&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb9-10"&gt;&lt;a aria-hidden="true" href="#cb9-10" tabindex="-1"&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;所以，你需要生成对应的type字段。在例子中，假如这个&lt;code&gt;isPageLoaded&lt;/code&gt;保存在&lt;code&gt;globalSlice&lt;/code&gt;中(也就是这个Slice文件的&lt;code&gt;name&lt;/code&gt;是&lt;code&gt;globalSlice&lt;/code&gt;)，reducer名字是&lt;code&gt;togglePageLoaded&lt;/code&gt;，那么手动触发的程式码如下：&lt;/p&gt;
&lt;div class="sourceCode" id="cb10"&gt;&lt;pre class="sourceCode typescript"&gt;&lt;code class="sourceCode typescript"&gt;&lt;span id="cb10-1"&gt;&lt;a aria-hidden="true" href="#cb10-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="im"&gt;import&lt;/span&gt; { applicationStore } &lt;span class="im"&gt;from&lt;/span&gt; &lt;span class="st"&gt;'./store'&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb10-2"&gt;&lt;a aria-hidden="true" href="#cb10-2" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb10-3"&gt;&lt;a aria-hidden="true" href="#cb10-3" tabindex="-1"&gt;&lt;/a&gt;applicationStore&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;dispatch&lt;/span&gt;((() &lt;span class="kw"&gt;=&amp;gt;&lt;/span&gt; {&lt;/span&gt;
&lt;span id="cb10-4"&gt;&lt;a aria-hidden="true" href="#cb10-4" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="cf"&gt;return&lt;/span&gt; {&lt;/span&gt;
&lt;span id="cb10-5"&gt;&lt;a aria-hidden="true" href="#cb10-5" tabindex="-1"&gt;&lt;/a&gt;    payload&lt;span class="op"&gt;:&lt;/span&gt; &lt;span class="kw"&gt;true&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb10-6"&gt;&lt;a aria-hidden="true" href="#cb10-6" tabindex="-1"&gt;&lt;/a&gt;    type&lt;span class="op"&gt;:&lt;/span&gt; &lt;span class="st"&gt;"globalSlice/togglePageLoaded"&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb10-7"&gt;&lt;a aria-hidden="true" href="#cb10-7" tabindex="-1"&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id="cb10-8"&gt;&lt;a aria-hidden="true" href="#cb10-8" tabindex="-1"&gt;&lt;/a&gt;})())&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id="组件内fetch内容"&gt;组件内fetch内容&lt;/h3&gt;
&lt;p&gt;当用户点击一个日期后进行切换，那么另外两个组件在加载完毕数据之前应该显示一个”loading…“之类的提示，一旦加载完毕马上显示出来。&lt;/p&gt;
&lt;p&gt;为此需要&lt;code&gt;createAsyncThunk()&lt;/code&gt;这个功能。首先是在相应的Slice里面定义一个Thunk函数，且看定义：&lt;/p&gt;
&lt;div class="sourceCode" id="cb11"&gt;&lt;pre class="sourceCode typescript"&gt;&lt;code class="sourceCode typescript"&gt;&lt;span id="cb11-1"&gt;&lt;a aria-hidden="true" href="#cb11-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="fu"&gt;createAsyncThunk&lt;/span&gt;&lt;span class="op"&gt;&amp;lt;&lt;/span&gt;&lt;span class="dt"&gt;any&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt; &lt;span class="dt"&gt;void&lt;/span&gt;&lt;span class="op"&gt;&amp;gt;&lt;/span&gt;(typePrefix&lt;span class="op"&gt;:&lt;/span&gt; &lt;span class="dt"&gt;string&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt; payloadCreator&lt;span class="op"&gt;:&lt;/span&gt; AsyncThunkPayloadCreator&lt;span class="op"&gt;&amp;lt;&lt;/span&gt;&lt;span class="dt"&gt;any&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt; &lt;span class="dt"&gt;void&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt; AsyncThunkConfig&lt;span class="op"&gt;&amp;gt;,&lt;/span&gt; options&lt;span class="op"&gt;?:&lt;/span&gt; AsyncThunkOptions&lt;span class="op"&gt;&amp;lt;&lt;/span&gt;&lt;span class="dt"&gt;void&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt; AsyncThunkConfig&lt;span class="op"&gt;&amp;gt;&lt;/span&gt; &lt;span class="op"&gt;|&lt;/span&gt; &lt;span class="dt"&gt;undefined&lt;/span&gt;)&lt;span class="op"&gt;:&lt;/span&gt; AsyncThunk&lt;span class="op"&gt;&amp;lt;...&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;三个参数 &lt;code&gt;typePrefix&lt;/code&gt;，是一个string，也就是用来识别这个action的字符串。对应的就是类似&lt;code&gt;CalendarSlice/setNewDate&lt;/code&gt;即action类型的&lt;code&gt;type&lt;/code&gt;。&lt;code&gt;payloadCreator&lt;/code&gt;是一个Promise，&lt;code&gt;options&lt;/code&gt;可以省略。那么，如果要给日历组件写这个chunk，应该是这样：&lt;/p&gt;
&lt;div class="sourceCode" id="cb12"&gt;&lt;pre class="sourceCode typescript"&gt;&lt;code class="sourceCode typescript"&gt;&lt;span id="cb12-1"&gt;&lt;a aria-hidden="true" href="#cb12-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="im"&gt;export&lt;/span&gt; &lt;span class="kw"&gt;const&lt;/span&gt; fetchData &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="fu"&gt;createAsyncThunk&lt;/span&gt;(&lt;span class="st"&gt;'CalendarSlice/fetchData'&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt; &lt;span class="kw"&gt;async&lt;/span&gt; () &lt;span class="kw"&gt;=&amp;gt;&lt;/span&gt; {&lt;/span&gt;
&lt;span id="cb12-2"&gt;&lt;a aria-hidden="true" href="#cb12-2" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="kw"&gt;const&lt;/span&gt; response &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="cf"&gt;await&lt;/span&gt; &lt;span class="fu"&gt;fetch&lt;/span&gt;(&lt;span class="st"&gt;"/data"&lt;/span&gt;)   &lt;span class="co"&gt;// fetch函数&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb12-3"&gt;&lt;a aria-hidden="true" href="#cb12-3" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="cf"&gt;return&lt;/span&gt; response&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;json&lt;/span&gt;()&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb12-4"&gt;&lt;a aria-hidden="true" href="#cb12-4" tabindex="-1"&gt;&lt;/a&gt;})&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;其次是为这个slice创建额外的reducer，不同于一般的reducer函数，Promise有三个状态，&lt;code&gt;pending&lt;/code&gt;,&lt;code&gt;fulfilled&lt;/code&gt;,&lt;code&gt;rejected&lt;/code&gt;三种情况都需要处理。react-redux为我们提供了&lt;code&gt;ActionReducerMapBuilder&lt;/code&gt;来处理这个情况。在原本的&lt;code&gt;features/calendarSlice.js&lt;/code&gt;中修改：&lt;/p&gt;
&lt;div class="sourceCode" id="cb13"&gt;&lt;pre class="sourceCode typescript"&gt;&lt;code class="sourceCode typescript"&gt;&lt;span id="cb13-1"&gt;&lt;a aria-hidden="true" href="#cb13-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="im"&gt;export&lt;/span&gt; &lt;span class="kw"&gt;const&lt;/span&gt; calendarSlice &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="fu"&gt;createSlice&lt;/span&gt;({&lt;/span&gt;
&lt;span id="cb13-2"&gt;&lt;a aria-hidden="true" href="#cb13-2" tabindex="-1"&gt;&lt;/a&gt;    name&lt;span class="op"&gt;:&lt;/span&gt; &lt;span class="st"&gt;"CalendarSlice"&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb13-3"&gt;&lt;a aria-hidden="true" href="#cb13-3" tabindex="-1"&gt;&lt;/a&gt;    initialState&lt;span class="op"&gt;:&lt;/span&gt; {&lt;span class="op"&gt;...&lt;/span&gt;}&lt;span class="op"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb13-4"&gt;&lt;a aria-hidden="true" href="#cb13-4" tabindex="-1"&gt;&lt;/a&gt;    reducers&lt;span class="op"&gt;:&lt;/span&gt; {&lt;span class="op"&gt;...&lt;/span&gt;}&lt;span class="op"&gt;,&lt;/span&gt;    &lt;span class="co"&gt;// 同上&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb13-5"&gt;&lt;a aria-hidden="true" href="#cb13-5" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="fu"&gt;extraReducers&lt;/span&gt;(builder) {&lt;/span&gt;
&lt;span id="cb13-6"&gt;&lt;a aria-hidden="true" href="#cb13-6" tabindex="-1"&gt;&lt;/a&gt;    builder&lt;/span&gt;
&lt;span id="cb13-7"&gt;&lt;a aria-hidden="true" href="#cb13-7" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;addCase&lt;/span&gt;(fetchData&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="at"&gt;pending&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt; (state&lt;span class="op"&gt;,&lt;/span&gt; action) &lt;span class="kw"&gt;=&amp;gt;&lt;/span&gt; {&lt;/span&gt;
&lt;span id="cb13-8"&gt;&lt;a aria-hidden="true" href="#cb13-8" tabindex="-1"&gt;&lt;/a&gt;            state&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="at"&gt;isLoading&lt;/span&gt; &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="kw"&gt;true&lt;/span&gt;      &lt;span class="co"&gt;/* 正在加载 */&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb13-9"&gt;&lt;a aria-hidden="true" href="#cb13-9" tabindex="-1"&gt;&lt;/a&gt;        })&lt;/span&gt;
&lt;span id="cb13-10"&gt;&lt;a aria-hidden="true" href="#cb13-10" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;addCase&lt;/span&gt;(fetchData&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="at"&gt;fulfilled&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt; (state&lt;span class="op"&gt;,&lt;/span&gt; action) &lt;span class="kw"&gt;=&amp;gt;&lt;/span&gt; {&lt;/span&gt;
&lt;span id="cb13-11"&gt;&lt;a aria-hidden="true" href="#cb13-11" tabindex="-1"&gt;&lt;/a&gt;            state&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="at"&gt;isLoading&lt;/span&gt; &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="kw"&gt;false&lt;/span&gt;&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb13-12"&gt;&lt;a aria-hidden="true" href="#cb13-12" tabindex="-1"&gt;&lt;/a&gt;            state&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="at"&gt;data&lt;/span&gt; &lt;span class="op"&gt;=&lt;/span&gt; action&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="at"&gt;payload&lt;/span&gt;&lt;span class="op"&gt;;&lt;/span&gt;    &lt;span class="co"&gt;/* 可以处理获取的数据了 */&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb13-13"&gt;&lt;a aria-hidden="true" href="#cb13-13" tabindex="-1"&gt;&lt;/a&gt;        })&lt;/span&gt;
&lt;span id="cb13-14"&gt;&lt;a aria-hidden="true" href="#cb13-14" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;addCase&lt;/span&gt;(fetchData&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="at"&gt;rejected&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt; (state&lt;span class="op"&gt;,&lt;/span&gt; action) &lt;span class="kw"&gt;=&amp;gt;&lt;/span&gt; {&lt;/span&gt;
&lt;span id="cb13-15"&gt;&lt;a aria-hidden="true" href="#cb13-15" tabindex="-1"&gt;&lt;/a&gt;            &lt;span class="co"&gt;/* 处理出错逻辑 */&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb13-16"&gt;&lt;a aria-hidden="true" href="#cb13-16" tabindex="-1"&gt;&lt;/a&gt;        })&lt;/span&gt;
&lt;span id="cb13-17"&gt;&lt;a aria-hidden="true" href="#cb13-17" tabindex="-1"&gt;&lt;/a&gt;    }&lt;span class="op"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb13-18"&gt;&lt;a aria-hidden="true" href="#cb13-18" tabindex="-1"&gt;&lt;/a&gt;})&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h1 id="参见"&gt;参见&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://redux.js.org/tutorials/index" title="Redux Tutorials"&gt;Redux 官方教程&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://jasonwatmore.com/post/2022/06/16/react-redux-toolkit-fetch-data-in-async-action-with-createasyncthunk" title="React + Redux Toolkit - Fetch Data in Async Action with createAsyncThunk"&gt;关于createAsyncThunk的另外一个教程&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;br/&gt;
&lt;!--%%REF%%--&gt;
&lt;br/&gt;
&lt;script async="" crossorigin="anonymous" data-category="Announcements" data-category-id="DIC_kwDOJ7Ymy84CX4eg" data-emit-metadata="0" data-input-position="top" data-lang="zh-CN" data-loading="lazy" data-mapping="title" data-reactions-enabled="1" data-repo="izfsk-ium/izfsk-ium.github.io" data-repo-id="R_kgDOJ7Ymyw" data-strict="0" data-theme="preferred_color_scheme" src="https://giscus.app/client.js"&gt;
&lt;/script&gt;
&lt;/main&gt;
&lt;footer&gt;
&lt;p class="signoff"&gt;
&lt;div class="metadata"&gt;
&lt;p class="date"&gt;&lt;time datetime="2022-12-04"&gt;创建日期：2022-12-04&lt;/time&gt;&lt;/p&gt;
&lt;p class="lastmodify"&gt;&lt;time&gt;最后编译：2023-08-10&lt;/time&gt;&lt;/p&gt;
&lt;p class="lastmodify" id="counter-span"&gt;访问次数：&lt;/p&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;/footer&gt;
&lt;script&gt;
    /* These script should run after page load */
    document.querySelectorAll('code.sourceCode').forEach(
      i =&gt; i.insertAdjacentHTML('beforeend', '&lt;div class="copy"&gt;复制&lt;/div&gt;')
    );
    document.querySelectorAll('div.copy').forEach(
      i =&gt; i.addEventListener(
        'click',
        () =&gt; {
          navigator.clipboard.writeText(i.parentElement.innerText.replace('复制', ''));
          i.innerText = '成功';
          setTimeout(() =&gt; {
            i.innerText = '复制';
          }, 1000);
        }
      )
    );

    if (location.href.includes("127.0.0.1:8080")) {
      document.getElementById("counter-span").innerHTML = "[[development mode]]";
    } else {
      const uuid = document.getElementById("article-uuid").innerText;
      const target = document.getElementById("counter-span");
      const last = localStorage.getItem("lastVisit-" + uuid);
      const shouldIncrease = last === null || new Date().getTime() - parseInt(last) &gt;= (1000 * 60 * 15);

      fetch(shouldIncrease ? ("https://counter.izfsk.top/counter/" + uuid) : ("https://counter.izfsk.top/readOnly/" + uuid))
        .then(r =&gt; r.text())
        .then(d =&gt; {
          if (!d.startsWith("Too"))
            document.getElementById("counter-span").innerText = "访问次数：" + d.toString();
          else
            document.getElementById("counter-span").innerHTML = "";
        });

      localStorage.setItem("lastVisit-" + uuid, new Date().getTime());
    }
  &lt;/script&gt;
&lt;script async="" data-website-id="2a1146ab-fa82-4a84-a04f-30e5967357c3" src="https://analytics.umami.is/script.js"&gt;&lt;/script&gt;
&lt;/body&gt;</content:encoded>
      <guid isPermaLink="false">8535e383-e302-48c1-849a-d0c4447265f4</guid>
      <pubDate>Sun, 04 Dec 2022 00:00:00 +0800</pubDate>
    </item>
    <item>
      <title>Python的more-itertools模块</title>
      <link>https://blog.izfsk.top/articles/Python的more-itertools模块.html</link>
      <description>Python的more-itertools模块</description>
      <content:encoded>&lt;body&gt;
&lt;progress id="content_progress" value="0"&gt;&lt;/progress&gt;
&lt;button id="back-to-top"&gt;
    回页顶
  &lt;/button&gt;
&lt;header&gt;
&lt;small id="article-uuid" style="display: none !important;"&gt;426704c4-a51f-470c-a9c9-f3e3ecc43bfc&lt;/small&gt;
&lt;h1 class="title"&gt;Python的more-itertools模块&lt;/h1&gt;
&lt;!-- Subtitle --&gt;
&lt;h3 class="subtitle"&gt; &lt;/h3&gt;
&lt;/header&gt;
&lt;nav id="TOC" role="doc-toc"&gt;
&lt;strong&gt;文章归类: &lt;a href="/pages/category.html#学习"&gt;学习&lt;/a&gt; &lt;/strong&gt;
&lt;input id="contents" type="checkbox"/&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#前提" id="toc-前提"&gt;前提&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#迭代器" id="toc-迭代器"&gt;迭代器&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#itertools" id="toc-itertools"&gt;itertools&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#accumulate-迭代操作器" id="toc-accumulate-迭代操作器"&gt;Accumulate : 迭代操作器&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#groupby-数据分类汇总" id="toc-groupby-数据分类汇总"&gt;Groupby : 数据分类汇总&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#product-全排列" id="toc-product-全排列"&gt;Product : 全排列&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#pairwise-成双成对藕断丝连" id="toc-pairwise-成双成对藕断丝连"&gt;Pairwise : 成双成对，藕断丝连&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#more_itertools" id="toc-more_itertools"&gt;more_itertools&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#一变多系列" id="toc-一变多系列"&gt;一变多系列&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#grouper" id="toc-grouper"&gt;Grouper&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#partition" id="toc-partition"&gt;Partition&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#divide" id="toc-divide"&gt;Divide&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#split_xxx-系列" id="toc-split_xxx-系列"&gt;Split_XXX 系列&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#多变一系列" id="toc-多变一系列"&gt;多变一系列&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#flatten" id="toc-flatten"&gt;Flatten&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#collapse" id="toc-collapse"&gt;Collapse&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#unzip" id="toc-unzip"&gt;Unzip&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#挨个操作系列" id="toc-挨个操作系列"&gt;挨个操作系列&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#map_except" id="toc-map_except"&gt;Map_except&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#map_reduce" id="toc-map_reduce"&gt;Map_reduce&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#numeric_range" id="toc-numeric_range"&gt;Numeric_range&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#过滤器系列" id="toc-过滤器系列"&gt;过滤器系列&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#strip-系列" id="toc-strip-系列"&gt;Strip 系列&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#filter_except" id="toc-filter_except"&gt;Filter_except&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#参考" id="toc-参考"&gt;参考&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#reference"&gt;参考链接&lt;/a&gt;&lt;/li&gt;
&lt;li&gt; &lt;/li&gt;
&lt;li class="tools"&gt;
&lt;span id="backtomain"&gt;
&lt;svg class="bi bi-house" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M8.707 1.5a1 1 0 0 0-1.414 0L.646 8.146a.5.5 0 0 0 .708.708L2 8.207V13.5A1.5 1.5 0 0 0 3.5 15h9a1.5 1.5 0 0 0 1.5-1.5V8.207l.646.647a.5.5 0 0 0 .708-.708L13 5.793V2.5a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v1.293L8.707 1.5ZM13 7.207V13.5a.5.5 0 0 1-.5.5h-9a.5.5 0 0 1-.5-.5V7.207l5-5 5 5Z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="readingmode"&gt;
&lt;svg class="bi bi-book" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M1 2.828c.885-.37 2.154-.769 3.388-.893 1.33-.134 2.458.063 3.112.752v9.746c-.935-.53-2.12-.603-3.213-.493-1.18.12-2.37.461-3.287.811V2.828zm7.5-.141c.654-.689 1.782-.886 3.112-.752 1.234.124 2.503.523 3.388.893v9.923c-.918-.35-2.107-.692-3.287-.81-1.094-.111-2.278-.039-3.213.492V2.687zM8 1.783C7.015.936 5.587.81 4.287.94c-1.514.153-3.042.672-3.994 1.105A.5.5 0 0 0 0 2.5v11a.5.5 0 0 0 .707.455c.882-.4 2.303-.881 3.68-1.02 1.409-.142 2.59.087 3.223.877a.5.5 0 0 0 .78 0c.633-.79 1.814-1.019 3.222-.877 1.378.139 2.8.62 3.681 1.02A.5.5 0 0 0 16 13.5v-11a.5.5 0 0 0-.293-.455c-.952-.433-2.48-.952-3.994-1.105C10.413.809 8.985.936 8 1.783z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="larger"&gt; &lt;/span&gt;
&lt;span id="smaller"&gt;&lt;/span&gt;
&lt;span id="switchfont"&gt;
&lt;svg class="bi bi-fonts" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M12.258 3h-8.51l-.083 2.46h.479c.26-1.544.758-1.783 2.693-1.845l.424-.013v7.827c0 .663-.144.82-1.3.923v.52h4.082v-.52c-1.162-.103-1.306-.26-1.306-.923V3.602l.431.013c1.934.062 2.434.301 2.693 1.846h.479L12.258 3z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="backtotop"&gt;
&lt;svg class="bi bi-arrow-bar-up" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M8 10a.5.5 0 0 0 .5-.5V3.707l2.146 2.147a.5.5 0 0 0 .708-.708l-3-3a.5.5 0 0 0-.708 0l-3 3a.5.5 0 1 0 .708.708L7.5 3.707V9.5a.5.5 0 0 0 .5.5zm-7 2.5a.5.5 0 0 1 .5-.5h13a.5.5 0 0 1 0 1h-13a.5.5 0 0 1-.5-.5z" fill-rule="evenodd"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/nav&gt;
&lt;main&gt;
&lt;h1 id="前提"&gt;前提&lt;/h1&gt;
&lt;p&gt;所谓程序就是“一定的环境中处理数据”，日常编码中总是会碰到“在一个序列的数据中过滤”和“对序列中的每一个项目操作”这样的需求，我们可以这样做：&lt;/p&gt;
&lt;div class="sourceCode" id="cb1"&gt;&lt;pre class="sourceCode python"&gt;&lt;code class="sourceCode python"&gt;&lt;span id="cb1-1"&gt;&lt;a aria-hidden="true" href="#cb1-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="cf"&gt;for&lt;/span&gt; i &lt;span class="kw"&gt;in&lt;/span&gt; raw:&lt;/span&gt;
&lt;span id="cb1-2"&gt;&lt;a aria-hidden="true" href="#cb1-2" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="cf"&gt;if&lt;/span&gt; i.attribute &lt;span class="op"&gt;==&lt;/span&gt; &lt;span class="va"&gt;True&lt;/span&gt;:&lt;/span&gt;
&lt;span id="cb1-3"&gt;&lt;a aria-hidden="true" href="#cb1-3" tabindex="-1"&gt;&lt;/a&gt;        targetA.append(i)&lt;/span&gt;
&lt;span id="cb1-4"&gt;&lt;a aria-hidden="true" href="#cb1-4" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="cf"&gt;else&lt;/span&gt;:&lt;/span&gt;
&lt;span id="cb1-5"&gt;&lt;a aria-hidden="true" href="#cb1-5" tabindex="-1"&gt;&lt;/a&gt;        targetB.append(i)&lt;/span&gt;
&lt;span id="cb1-6"&gt;&lt;a aria-hidden="true" href="#cb1-6" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="cf"&gt;for&lt;/span&gt; (index, target) &lt;span class="kw"&gt;in&lt;/span&gt; &lt;span class="bu"&gt;enumerate&lt;/span&gt;(targetA):&lt;/span&gt;
&lt;span id="cb1-7"&gt;&lt;a aria-hidden="true" href="#cb1-7" tabindex="-1"&gt;&lt;/a&gt;    targetA &lt;span class="op"&gt;=&lt;/span&gt; do_something(target)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;也可以类似Javascript这样:&lt;/p&gt;
&lt;div class="sourceCode" id="cb2"&gt;&lt;pre class="sourceCode javascript"&gt;&lt;code class="sourceCode javascript"&gt;&lt;span id="cb2-1"&gt;&lt;a aria-hidden="true" href="#cb2-1" tabindex="-1"&gt;&lt;/a&gt;[&lt;span class="dv"&gt;1&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt;&lt;span class="dv"&gt;2&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt;&lt;span class="dv"&gt;3&lt;/span&gt;]&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;filter&lt;/span&gt;(i &lt;span class="kw"&gt;=&amp;gt;&lt;/span&gt; i &lt;span class="op"&gt;&amp;gt;&lt;/span&gt; &lt;span class="dv"&gt;2&lt;/span&gt;)&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;map&lt;/span&gt;(i &lt;span class="kw"&gt;=&amp;gt;&lt;/span&gt; i &lt;span class="op"&gt;**&lt;/span&gt; i)&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;当然，Python虽然提供了&lt;code&gt;map()&lt;/code&gt;，&lt;code&gt;filter()&lt;/code&gt;函数，但是不能够和JS那样链式调用，不过本文介绍的是比&lt;code&gt;map()&lt;/code&gt;，&lt;code&gt;filter()&lt;/code&gt;更加强大的函数们。&lt;/p&gt;
&lt;h2 id="迭代器"&gt;迭代器&lt;/h2&gt;
&lt;p&gt;简单的来讲，所谓迭代器，就是一个懒加载的列表。有一个指针&lt;code&gt;__next__()&lt;/code&gt;指向“目前的项目”，调用这个指针就会“消费掉”这个值。而使用&lt;code&gt;list()&lt;/code&gt;就能把整个迭代器变成列表。&lt;/p&gt;
&lt;p&gt;迭代器比列表更加节省内存，因为每一个值会在需要的时候才计算。但是同样的，如果你试图把一个无限的迭代器转list，那就会爆内存。&lt;/p&gt;
&lt;h1 id="itertools"&gt;itertools&lt;/h1&gt;
&lt;p&gt;&lt;code&gt;itertools&lt;/code&gt;是python提供的标准库，包含了许多帮助函数。这些函数的教程网上已经汗牛充栋，这里只提几个：&lt;/p&gt;
&lt;h2 id="accumulate-迭代操作器"&gt;Accumulate : 迭代操作器&lt;/h2&gt;
&lt;p&gt;按照字面意思翻译，这个函数应该叫做“累加器”，最基础的使用方法也是累加：&lt;/p&gt;
&lt;div class="sourceCode" id="cb3"&gt;&lt;pre class="sourceCode python"&gt;&lt;code class="sourceCode python"&gt;&lt;span id="cb3-1"&gt;&lt;a aria-hidden="true" href="#cb3-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="bu"&gt;list&lt;/span&gt;(itertools.accumulate([&lt;span class="dv"&gt;1&lt;/span&gt;,&lt;span class="dv"&gt;2&lt;/span&gt;,&lt;span class="dv"&gt;3&lt;/span&gt;]))&lt;/span&gt;
&lt;span id="cb3-2"&gt;&lt;a aria-hidden="true" href="#cb3-2" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="co"&gt;#[1, 3, 6]&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;这个函数相当于：&lt;/p&gt;
&lt;div class="sourceCode" id="cb4"&gt;&lt;pre class="sourceCode python"&gt;&lt;code class="sourceCode python"&gt;&lt;span id="cb4-1"&gt;&lt;a aria-hidden="true" href="#cb4-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="bu"&gt;list&lt;/span&gt;(itertools.accumulate([&lt;span class="dv"&gt;1&lt;/span&gt;,&lt;span class="dv"&gt;2&lt;/span&gt;,&lt;span class="dv"&gt;3&lt;/span&gt;],&lt;span class="kw"&gt;lambda&lt;/span&gt; x,y:x&lt;span class="op"&gt;+&lt;/span&gt;y))&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;可以看到这个函数的第二个参数是一个函数。你可以给任意一个“输入两个值输出一个值”的函数，然后一步一步得到它的结果。换成&lt;code&gt;operator.mul&lt;/code&gt;就是阶乘（&lt;code&gt;1*2，2*6，6*4......&lt;/code&gt;）；换成&lt;code&gt;max&lt;/code&gt;就是带过程的取最大值。&lt;/p&gt;
&lt;h2 id="groupby-数据分类汇总"&gt;Groupby : 数据分类汇总&lt;/h2&gt;
&lt;p&gt;假如你有这样的数据：&lt;/p&gt;
&lt;div class="sourceCode" id="cb5"&gt;&lt;pre class="sourceCode json"&gt;&lt;code class="sourceCode json"&gt;&lt;span id="cb5-1"&gt;&lt;a aria-hidden="true" href="#cb5-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="er"&gt;data&lt;/span&gt; &lt;span class="er"&gt;=&lt;/span&gt; &lt;span class="ot"&gt;[&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb5-2"&gt;&lt;a aria-hidden="true" href="#cb5-2" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="fu"&gt;{&lt;/span&gt;&lt;span class="dt"&gt;"type"&lt;/span&gt;&lt;span class="fu"&gt;:&lt;/span&gt; &lt;span class="dv"&gt;1&lt;/span&gt;&lt;span class="fu"&gt;,&lt;/span&gt; &lt;span class="dt"&gt;"data"&lt;/span&gt;&lt;span class="fu"&gt;:&lt;/span&gt; &lt;span class="st"&gt;"John"&lt;/span&gt;&lt;span class="fu"&gt;}&lt;/span&gt;&lt;span class="ot"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb5-3"&gt;&lt;a aria-hidden="true" href="#cb5-3" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="fu"&gt;{&lt;/span&gt;&lt;span class="dt"&gt;"type"&lt;/span&gt;&lt;span class="fu"&gt;:&lt;/span&gt; &lt;span class="dv"&gt;1&lt;/span&gt;&lt;span class="fu"&gt;,&lt;/span&gt; &lt;span class="dt"&gt;"data"&lt;/span&gt;&lt;span class="fu"&gt;:&lt;/span&gt; &lt;span class="st"&gt;"Mike"&lt;/span&gt;&lt;span class="fu"&gt;}&lt;/span&gt;&lt;span class="ot"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb5-4"&gt;&lt;a aria-hidden="true" href="#cb5-4" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="fu"&gt;{&lt;/span&gt;&lt;span class="dt"&gt;"type"&lt;/span&gt;&lt;span class="fu"&gt;:&lt;/span&gt; &lt;span class="dv"&gt;2&lt;/span&gt;&lt;span class="fu"&gt;,&lt;/span&gt; &lt;span class="dt"&gt;"data"&lt;/span&gt;&lt;span class="fu"&gt;:&lt;/span&gt; &lt;span class="st"&gt;"Jenny"&lt;/span&gt;&lt;span class="fu"&gt;}&lt;/span&gt;&lt;span class="ot"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb5-5"&gt;&lt;a aria-hidden="true" href="#cb5-5" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="fu"&gt;{&lt;/span&gt;&lt;span class="dt"&gt;"type"&lt;/span&gt;&lt;span class="fu"&gt;:&lt;/span&gt; &lt;span class="dv"&gt;2&lt;/span&gt;&lt;span class="fu"&gt;,&lt;/span&gt; &lt;span class="dt"&gt;"data"&lt;/span&gt;&lt;span class="fu"&gt;:&lt;/span&gt; &lt;span class="st"&gt;"Wang"&lt;/span&gt;&lt;span class="fu"&gt;}&lt;/span&gt;&lt;span class="ot"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb5-6"&gt;&lt;a aria-hidden="true" href="#cb5-6" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="fu"&gt;{&lt;/span&gt;&lt;span class="dt"&gt;"type"&lt;/span&gt;&lt;span class="fu"&gt;:&lt;/span&gt; &lt;span class="dv"&gt;3&lt;/span&gt;&lt;span class="fu"&gt;,&lt;/span&gt; &lt;span class="dt"&gt;"data"&lt;/span&gt;&lt;span class="fu"&gt;:&lt;/span&gt; &lt;span class="st"&gt;"August"&lt;/span&gt;&lt;span class="fu"&gt;}&lt;/span&gt;&lt;span class="ot"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb5-7"&gt;&lt;a aria-hidden="true" href="#cb5-7" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="ot"&gt;]&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;你想拿到这样的结果：&lt;/p&gt;
&lt;div class="sourceCode" id="cb6"&gt;&lt;pre class="sourceCode python"&gt;&lt;code class="sourceCode python"&gt;&lt;span id="cb6-1"&gt;&lt;a aria-hidden="true" href="#cb6-1" tabindex="-1"&gt;&lt;/a&gt;[&lt;/span&gt;
&lt;span id="cb6-2"&gt;&lt;a aria-hidden="true" href="#cb6-2" tabindex="-1"&gt;&lt;/a&gt;    {&lt;span class="st"&gt;"type"&lt;/span&gt;: &lt;span class="dv"&gt;1&lt;/span&gt;, &lt;span class="st"&gt;"items"&lt;/span&gt;: [&lt;span class="st"&gt;"John"&lt;/span&gt;, &lt;span class="st"&gt;"Mike"&lt;/span&gt;]},&lt;/span&gt;
&lt;span id="cb6-3"&gt;&lt;a aria-hidden="true" href="#cb6-3" tabindex="-1"&gt;&lt;/a&gt;    {&lt;span class="st"&gt;"type"&lt;/span&gt;: &lt;span class="dv"&gt;2&lt;/span&gt;, &lt;span class="st"&gt;"items"&lt;/span&gt;: [&lt;span class="st"&gt;"Jenny"&lt;/span&gt;, &lt;span class="st"&gt;"Wang"&lt;/span&gt;]},&lt;/span&gt;
&lt;span id="cb6-4"&gt;&lt;a aria-hidden="true" href="#cb6-4" tabindex="-1"&gt;&lt;/a&gt;    {&lt;span class="st"&gt;"type"&lt;/span&gt;: &lt;span class="dv"&gt;3&lt;/span&gt;, &lt;span class="st"&gt;"items"&lt;/span&gt;: [&lt;span class="st"&gt;"August"&lt;/span&gt;]},&lt;/span&gt;
&lt;span id="cb6-5"&gt;&lt;a aria-hidden="true" href="#cb6-5" tabindex="-1"&gt;&lt;/a&gt;]&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;就可以使用这串魔法：&lt;/p&gt;
&lt;div class="sourceCode" id="cb7"&gt;&lt;pre class="sourceCode python"&gt;&lt;code class="sourceCode python"&gt;&lt;span id="cb7-1"&gt;&lt;a aria-hidden="true" href="#cb7-1" tabindex="-1"&gt;&lt;/a&gt;[{&lt;span class="st"&gt;'type'&lt;/span&gt;:i,&lt;span class="st"&gt;'items'&lt;/span&gt;:[i[&lt;span class="st"&gt;'data'&lt;/span&gt;] &lt;span class="cf"&gt;for&lt;/span&gt; i &lt;span class="kw"&gt;in&lt;/span&gt; &lt;span class="bu"&gt;list&lt;/span&gt;(j)]} &lt;span class="cf"&gt;for&lt;/span&gt; i,j &lt;span class="kw"&gt;in&lt;/span&gt; itertools.groupby(data, key&lt;span class="op"&gt;=&lt;/span&gt;&lt;span class="kw"&gt;lambda&lt;/span&gt; x: x[&lt;span class="st"&gt;"type"&lt;/span&gt;])]&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;其实也不是那么魔法，最重要的就是这一串：&lt;/p&gt;
&lt;p&gt;&lt;code&gt;groupby(data, key=lambda x: x["type"])&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;同样的，groupby函数接收两个参数，一个是迭代器，一个是函数类型，用来指定分类的key。可以理解成SQL&lt;code&gt;SELECT something FROM table GROUP BY key&lt;/code&gt;中的&lt;code&gt;key&lt;/code&gt;。返回类型是一个二元元组，(这个key，包含这个类别的元素的迭代器)。接下来就可以使用&lt;code&gt;list()&lt;/code&gt;来转换了，这也是&lt;code&gt;[i['data'] for i in list(j)]&lt;/code&gt;的作用。&lt;/p&gt;
&lt;div class="note blue"&gt;
&lt;table&gt;
&lt;tbody&gt;
&lt;tr class="odd"&gt;
&lt;td&gt;ℹ️ groupby 在使用之前&lt;strong&gt;一定&lt;/strong&gt;要对数据排序好！&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;p&gt;还是看不懂？那就看这个版本吧：&lt;/p&gt;
&lt;div class="sourceCode" id="cb8"&gt;&lt;pre class="sourceCode python"&gt;&lt;code class="sourceCode python"&gt;&lt;span id="cb8-1"&gt;&lt;a aria-hidden="true" href="#cb8-1" tabindex="-1"&gt;&lt;/a&gt;result &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="bu"&gt;list&lt;/span&gt;()&lt;/span&gt;
&lt;span id="cb8-2"&gt;&lt;a aria-hidden="true" href="#cb8-2" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb8-3"&gt;&lt;a aria-hidden="true" href="#cb8-3" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;def&lt;/span&gt; keyFunction(item):&lt;/span&gt;
&lt;span id="cb8-4"&gt;&lt;a aria-hidden="true" href="#cb8-4" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="cf"&gt;return&lt;/span&gt; item[&lt;span class="st"&gt;"type"&lt;/span&gt;]&lt;/span&gt;
&lt;span id="cb8-5"&gt;&lt;a aria-hidden="true" href="#cb8-5" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb8-6"&gt;&lt;a aria-hidden="true" href="#cb8-6" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="cf"&gt;for&lt;/span&gt; key, iterator_of_items &lt;span class="kw"&gt;in&lt;/span&gt; itertools.groupby(data, key&lt;span class="op"&gt;=&lt;/span&gt;keyFunction):&lt;/span&gt;
&lt;span id="cb8-7"&gt;&lt;a aria-hidden="true" href="#cb8-7" tabindex="-1"&gt;&lt;/a&gt;    list_of_items_of_this_type &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="bu"&gt;list&lt;/span&gt;(iterator_of_items)&lt;/span&gt;
&lt;span id="cb8-8"&gt;&lt;a aria-hidden="true" href="#cb8-8" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb8-9"&gt;&lt;a aria-hidden="true" href="#cb8-9" tabindex="-1"&gt;&lt;/a&gt;    result.append(&lt;/span&gt;
&lt;span id="cb8-10"&gt;&lt;a aria-hidden="true" href="#cb8-10" tabindex="-1"&gt;&lt;/a&gt;        {&lt;span class="st"&gt;"type"&lt;/span&gt;: key, &lt;span class="st"&gt;"items"&lt;/span&gt;: [i[&lt;span class="st"&gt;"data"&lt;/span&gt;] &lt;span class="cf"&gt;for&lt;/span&gt; i &lt;span class="kw"&gt;in&lt;/span&gt; list_of_items_of_this_type]}&lt;/span&gt;
&lt;span id="cb8-11"&gt;&lt;a aria-hidden="true" href="#cb8-11" tabindex="-1"&gt;&lt;/a&gt;    )&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id="product-全排列"&gt;Product : 全排列&lt;/h2&gt;
&lt;p&gt;假如你有’ABCD’和’xy’，你想要得到&lt;code&gt;Ax Ay Bx By Cx Cy Dx Dy&lt;/code&gt;的排列组合，那么你就可以使用&lt;/p&gt;
&lt;p&gt;&lt;code&gt;product('ABCD', 'xy')&lt;/code&gt;来得到。很简单。函数签名是这样的：&lt;code&gt;itertools.product(*iterables, repeat=1)&lt;/code&gt;，也就是你可以给出任何数量的迭代器。&lt;/p&gt;
&lt;h2 id="pairwise-成双成对藕断丝连"&gt;Pairwise : 成双成对，藕断丝连&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;pairwise()&lt;/code&gt;的用法很简单：&lt;code&gt;pairwise('ABCDEFG') --&amp;gt; AB BC CD DE EF FG&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;它的实现方式类似于：&lt;/p&gt;
&lt;div class="sourceCode" id="cb9"&gt;&lt;pre class="sourceCode python"&gt;&lt;code class="sourceCode python"&gt;&lt;span id="cb9-1"&gt;&lt;a aria-hidden="true" href="#cb9-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;def&lt;/span&gt; pairwise(iterable):&lt;/span&gt;
&lt;span id="cb9-2"&gt;&lt;a aria-hidden="true" href="#cb9-2" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="co"&gt;# s -&amp;gt; (s0, s1), (s1, s2), (s2, s3), ...&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb9-3"&gt;&lt;a aria-hidden="true" href="#cb9-3" tabindex="-1"&gt;&lt;/a&gt;    a, b &lt;span class="op"&gt;=&lt;/span&gt; tee(iterable, &lt;span class="dv"&gt;2&lt;/span&gt;)     &lt;span class="co"&gt;# 获取两个指针&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb9-4"&gt;&lt;a aria-hidden="true" href="#cb9-4" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="bu"&gt;next&lt;/span&gt;(b, &lt;span class="va"&gt;None&lt;/span&gt;)               &lt;span class="co"&gt;# 一个指针前移&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb9-5"&gt;&lt;a aria-hidden="true" href="#cb9-5" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="cf"&gt;return&lt;/span&gt; &lt;span class="bu"&gt;zip&lt;/span&gt;(a, b)            &lt;span class="co"&gt;# 配对&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h1 id="more_itertools"&gt;more_itertools&lt;/h1&gt;
&lt;p&gt;好，现在进入高阶魔法阶段。这里将会一边介绍用法，一边简单分析源码。准备好：）&lt;/p&gt;
&lt;h2 id="一变多系列"&gt;一变多系列&lt;/h2&gt;
&lt;p&gt;输入一个迭代器，返回多个结果的类型。&lt;/p&gt;
&lt;h3 id="grouper"&gt;Grouper&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;more_itertools.grouper(iterable, n, incomplete='fill', fillvalue=None)&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;按照给定的长度把一个可迭代类型分组。得到一个迭代器，里面包含指定长度的元组。&lt;/p&gt;
&lt;div class="sourceCode" id="cb10"&gt;&lt;pre class="sourceCode python"&gt;&lt;code class="sourceCode python"&gt;&lt;span id="cb10-1"&gt;&lt;a aria-hidden="true" href="#cb10-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="bu"&gt;list&lt;/span&gt;(grouper(&lt;span class="st"&gt;'ABCDEF'&lt;/span&gt;, &lt;span class="dv"&gt;3&lt;/span&gt;)) &lt;span class="co"&gt;# 得到 [('A', 'B', 'C'), ('D', 'E', 'F')]&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;不过并不是每一个迭代器都能正好是整除你的&lt;code&gt;n&lt;/code&gt;，所以&lt;code&gt;incomplete&lt;/code&gt;和&lt;code&gt;fillvalue&lt;/code&gt;控制不同的表现。假如你的分组目标是”ABCDEFG”，n=3，那么：&lt;/p&gt;
&lt;div class="sourceCode" id="cb11"&gt;&lt;pre class="sourceCode python"&gt;&lt;code class="sourceCode python"&gt;&lt;span id="cb11-1"&gt;&lt;a aria-hidden="true" href="#cb11-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="bu"&gt;list&lt;/span&gt;(grouper(&lt;span class="st"&gt;'ABCDEFG'&lt;/span&gt;, &lt;span class="dv"&gt;3&lt;/span&gt;, incomplete&lt;span class="op"&gt;=&lt;/span&gt;&lt;span class="st"&gt;'fill'&lt;/span&gt;, fillvalue&lt;span class="op"&gt;=&lt;/span&gt;&lt;span class="st"&gt;'x'&lt;/span&gt;))  &lt;/span&gt;
&lt;span id="cb11-2"&gt;&lt;a aria-hidden="true" href="#cb11-2" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="co"&gt;# [('A', 'B', 'C'), ('D', 'E', 'F'), ('G', 'x', 'x')]&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb11-3"&gt;&lt;a aria-hidden="true" href="#cb11-3" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="bu"&gt;list&lt;/span&gt;(grouper(&lt;span class="st"&gt;'ABCDEFG'&lt;/span&gt;, &lt;span class="dv"&gt;3&lt;/span&gt;, incomplete&lt;span class="op"&gt;=&lt;/span&gt;&lt;span class="st"&gt;'ignore'&lt;/span&gt;, fillvalue&lt;span class="op"&gt;=&lt;/span&gt;&lt;span class="st"&gt;'x'&lt;/span&gt;)) &lt;/span&gt;
&lt;span id="cb11-4"&gt;&lt;a aria-hidden="true" href="#cb11-4" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="co"&gt;# [('A', 'B', 'C'), ('D', 'E', 'F')]&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb11-5"&gt;&lt;a aria-hidden="true" href="#cb11-5" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="bu"&gt;list&lt;/span&gt;(grouper(&lt;span class="st"&gt;'ABCDEFG'&lt;/span&gt;, &lt;span class="dv"&gt;3&lt;/span&gt;, incomplete&lt;span class="op"&gt;=&lt;/span&gt;&lt;span class="st"&gt;'strict'&lt;/span&gt;))&lt;/span&gt;
&lt;span id="cb11-6"&gt;&lt;a aria-hidden="true" href="#cb11-6" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="co"&gt;# 抛出异常 UnequalIterablesError&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;这玩意的实现机制很简单：&lt;/p&gt;
&lt;p&gt;首先，如果你要展开一个iter，可以在它前面使用&lt;code&gt;*&lt;/code&gt;号。比如&lt;code&gt;print(*iter([1,2,3]))&lt;/code&gt;就会打印出&lt;code&gt;1 2 3&lt;/code&gt;。&lt;/p&gt;
&lt;p&gt;首先判断&lt;code&gt;incomplete&lt;/code&gt;，如果是&lt;code&gt;ignored&lt;/code&gt;，就直接上zip，否则，如果是&lt;code&gt;fill&lt;/code&gt;的话，就使用&lt;code&gt;zip_longest(*args, fillvalue=fillvalue)&lt;/code&gt;，是&lt;code&gt;strict&lt;/code&gt;就使用&lt;code&gt;_zip_equal(*args)&lt;/code&gt;。但核心是一样的，以&lt;code&gt;ignored&lt;/code&gt;模式为例：&lt;/p&gt;
&lt;div class="sourceCode" id="cb12"&gt;&lt;pre class="sourceCode python"&gt;&lt;code class="sourceCode python"&gt;&lt;span id="cb12-1"&gt;&lt;a aria-hidden="true" href="#cb12-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="bu"&gt;zip&lt;/span&gt;(&lt;span class="op"&gt;*&lt;/span&gt;[&lt;span class="bu"&gt;iter&lt;/span&gt;(target_iterable)] &lt;span class="op"&gt;*&lt;/span&gt; n)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;注意到&lt;code&gt;[iter()]*n&lt;/code&gt;会创造出一个包含&lt;code&gt;n&lt;/code&gt;个迭代器的列表，&lt;strong&gt;其中每一个迭代器的内存地址是一样的&lt;/strong&gt;，操作一个就是操作全体！那么：&lt;/p&gt;
&lt;div class="sourceCode" id="cb13"&gt;&lt;pre class="sourceCode python"&gt;&lt;code class="sourceCode python"&gt;&lt;span id="cb13-1"&gt;&lt;a aria-hidden="true" href="#cb13-1" tabindex="-1"&gt;&lt;/a&gt;a,b,c&lt;span class="op"&gt;=&lt;/span&gt;[&lt;span class="bu"&gt;iter&lt;/span&gt;(&lt;span class="st"&gt;"hello!"&lt;/span&gt;)]&lt;span class="op"&gt;*&lt;/span&gt;&lt;span class="dv"&gt;3&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb13-2"&gt;&lt;a aria-hidden="true" href="#cb13-2" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="co"&gt;# a &amp;lt;str_iterator at 0x7fd3b529ecb0&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb13-3"&gt;&lt;a aria-hidden="true" href="#cb13-3" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="co"&gt;# b &amp;lt;str_iterator at 0x7fd3b529ecb0&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb13-4"&gt;&lt;a aria-hidden="true" href="#cb13-4" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="co"&gt;# c &amp;lt;str_iterator at 0x7fd3b529ecb0&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb13-5"&gt;&lt;a aria-hidden="true" href="#cb13-5" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="bu"&gt;list&lt;/span&gt;(&lt;span class="bu"&gt;zip&lt;/span&gt;(a,b,c))&lt;/span&gt;
&lt;span id="cb13-6"&gt;&lt;a aria-hidden="true" href="#cb13-6" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="co"&gt;# [('h', 'e', 'l'), ('l', 'o', '!')]&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;在这里，zip函数第一次取得的并不是&lt;code&gt;h,h,h&lt;/code&gt;，而是&lt;code&gt;h,e,l&lt;/code&gt;，因为每一次取得，所有三个指针的位置都会向前移动一格。&lt;/p&gt;
&lt;h3 id="partition"&gt;Partition&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;partition(pred, iterable)&lt;/code&gt;：返回两个可迭代元素作为元组，前一个不符合你的条件，后一个符合你的条件。可以用来把一个迭代器一分为二成两个部分，&lt;del&gt;不同意的请站到左边，同意的请站到右边&lt;/del&gt;。它的使用就比较普遍了。还记得文章开头的那个例子吗？就可以用这个函数来处理，这里另外举例。&lt;/p&gt;
&lt;div class="sourceCode" id="cb14"&gt;&lt;pre class="sourceCode python"&gt;&lt;code class="sourceCode python"&gt;&lt;span id="cb14-1"&gt;&lt;a aria-hidden="true" href="#cb14-1" tabindex="-1"&gt;&lt;/a&gt;data &lt;span class="op"&gt;=&lt;/span&gt; [&lt;/span&gt;
&lt;span id="cb14-2"&gt;&lt;a aria-hidden="true" href="#cb14-2" tabindex="-1"&gt;&lt;/a&gt;    {&lt;span class="st"&gt;"type"&lt;/span&gt;: &lt;span class="dv"&gt;1&lt;/span&gt;, &lt;span class="st"&gt;"data"&lt;/span&gt;: &lt;span class="st"&gt;"John"&lt;/span&gt;},&lt;/span&gt;
&lt;span id="cb14-3"&gt;&lt;a aria-hidden="true" href="#cb14-3" tabindex="-1"&gt;&lt;/a&gt;    {&lt;span class="st"&gt;"type"&lt;/span&gt;: &lt;span class="dv"&gt;1&lt;/span&gt;, &lt;span class="st"&gt;"data"&lt;/span&gt;: &lt;span class="st"&gt;"Mike"&lt;/span&gt;},&lt;/span&gt;
&lt;span id="cb14-4"&gt;&lt;a aria-hidden="true" href="#cb14-4" tabindex="-1"&gt;&lt;/a&gt;    {&lt;span class="st"&gt;"type"&lt;/span&gt;: &lt;span class="dv"&gt;2&lt;/span&gt;, &lt;span class="st"&gt;"data"&lt;/span&gt;: &lt;span class="st"&gt;"Jenny"&lt;/span&gt;},&lt;/span&gt;
&lt;span id="cb14-5"&gt;&lt;a aria-hidden="true" href="#cb14-5" tabindex="-1"&gt;&lt;/a&gt;    {&lt;span class="st"&gt;"type"&lt;/span&gt;: &lt;span class="dv"&gt;2&lt;/span&gt;, &lt;span class="st"&gt;"data"&lt;/span&gt;: &lt;span class="st"&gt;"Wang"&lt;/span&gt;}&lt;/span&gt;
&lt;span id="cb14-6"&gt;&lt;a aria-hidden="true" href="#cb14-6" tabindex="-1"&gt;&lt;/a&gt;]&lt;/span&gt;
&lt;span id="cb14-7"&gt;&lt;a aria-hidden="true" href="#cb14-7" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb14-8"&gt;&lt;a aria-hidden="true" href="#cb14-8" tabindex="-1"&gt;&lt;/a&gt;is_allowed &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="kw"&gt;lambda&lt;/span&gt; x: x[&lt;span class="st"&gt;"type"&lt;/span&gt;] &lt;span class="op"&gt;==&lt;/span&gt; &lt;span class="dv"&gt;1&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb14-9"&gt;&lt;a aria-hidden="true" href="#cb14-9" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb14-10"&gt;&lt;a aria-hidden="true" href="#cb14-10" tabindex="-1"&gt;&lt;/a&gt;allowed, forbidden &lt;span class="op"&gt;=&lt;/span&gt; partition(is_allowed, files)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id="divide"&gt;Divide&lt;/h3&gt;
&lt;p&gt;顾名思义，这个函数把一个可迭代序列分割成若干个子迭代器。&lt;/p&gt;
&lt;div class="sourceCode" id="cb15"&gt;&lt;pre class="sourceCode python"&gt;&lt;code class="sourceCode python"&gt;&lt;span id="cb15-1"&gt;&lt;a aria-hidden="true" href="#cb15-1" tabindex="-1"&gt;&lt;/a&gt;data &lt;span class="op"&gt;=&lt;/span&gt; [&lt;span class="st"&gt;"first"&lt;/span&gt;, &lt;span class="st"&gt;"second"&lt;/span&gt;, &lt;span class="st"&gt;"third"&lt;/span&gt;, &lt;span class="st"&gt;"fourth"&lt;/span&gt;, &lt;span class="st"&gt;"fifth"&lt;/span&gt;, &lt;span class="st"&gt;"sixth"&lt;/span&gt;, &lt;span class="st"&gt;"seventh"&lt;/span&gt;]&lt;/span&gt;
&lt;span id="cb15-2"&gt;&lt;a aria-hidden="true" href="#cb15-2" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb15-3"&gt;&lt;a aria-hidden="true" href="#cb15-3" tabindex="-1"&gt;&lt;/a&gt;[&lt;span class="bu"&gt;list&lt;/span&gt;(l) &lt;span class="cf"&gt;for&lt;/span&gt; l &lt;span class="kw"&gt;in&lt;/span&gt; divide(&lt;span class="dv"&gt;3&lt;/span&gt;, data)]&lt;/span&gt;
&lt;span id="cb15-4"&gt;&lt;a aria-hidden="true" href="#cb15-4" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="co"&gt;#  [['first', 'second', 'third'], ['fourth', 'fifth'], ['sixth', 'seventh']]&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;函数签名是&lt;code&gt;divide(n, iterable)&lt;/code&gt;。其实现为，首先，尝试对&lt;code&gt;iterable&lt;/code&gt;进行一个下标操作，通过捕获异常来判断类型：&lt;/p&gt;
&lt;div class="sourceCode" id="cb16"&gt;&lt;pre class="sourceCode python"&gt;&lt;code class="sourceCode python"&gt;&lt;span id="cb16-1"&gt;&lt;a aria-hidden="true" href="#cb16-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="cf"&gt;try&lt;/span&gt;:&lt;/span&gt;
&lt;span id="cb16-2"&gt;&lt;a aria-hidden="true" href="#cb16-2" tabindex="-1"&gt;&lt;/a&gt;    iterable[:&lt;span class="dv"&gt;0&lt;/span&gt;]&lt;/span&gt;
&lt;span id="cb16-3"&gt;&lt;a aria-hidden="true" href="#cb16-3" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="cf"&gt;except&lt;/span&gt; &lt;span class="pp"&gt;TypeError&lt;/span&gt;:&lt;/span&gt;
&lt;span id="cb16-4"&gt;&lt;a aria-hidden="true" href="#cb16-4" tabindex="-1"&gt;&lt;/a&gt;    seq &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="bu"&gt;tuple&lt;/span&gt;(iterable)   &lt;span class="co"&gt;# 相当于是到元组类型的转换，因为迭代器类型不能取下标&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb16-5"&gt;&lt;a aria-hidden="true" href="#cb16-5" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="cf"&gt;else&lt;/span&gt;:&lt;/span&gt;
&lt;span id="cb16-6"&gt;&lt;a aria-hidden="true" href="#cb16-6" tabindex="-1"&gt;&lt;/a&gt;    seq &lt;span class="op"&gt;=&lt;/span&gt; iterable          &lt;span class="co"&gt;# 原来的输入是可以取下标的类型，例如普通列表&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;接着，使用&lt;code&gt;q, r = divmod(len(seq), n)&lt;/code&gt;来获取商q和余数r。&lt;code&gt;divmod&lt;/code&gt;是一个Python的内置函数，用来同时获得商和余数的元组。然后按照步长&lt;code&gt;n&lt;/code&gt;结合q,r截取原来的列表构建结果列表：&lt;/p&gt;
&lt;div class="sourceCode" id="cb17"&gt;&lt;pre class="sourceCode python"&gt;&lt;code class="sourceCode python"&gt;&lt;span id="cb17-1"&gt;&lt;a aria-hidden="true" href="#cb17-1" tabindex="-1"&gt;&lt;/a&gt;ret, stop &lt;span class="op"&gt;=&lt;/span&gt; [], &lt;span class="dv"&gt;0&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb17-2"&gt;&lt;a aria-hidden="true" href="#cb17-2" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="cf"&gt;for&lt;/span&gt; i &lt;span class="kw"&gt;in&lt;/span&gt; &lt;span class="bu"&gt;range&lt;/span&gt;(&lt;span class="dv"&gt;1&lt;/span&gt;, n &lt;span class="op"&gt;+&lt;/span&gt; &lt;span class="dv"&gt;1&lt;/span&gt;):&lt;/span&gt;
&lt;span id="cb17-3"&gt;&lt;a aria-hidden="true" href="#cb17-3" tabindex="-1"&gt;&lt;/a&gt;    start &lt;span class="op"&gt;=&lt;/span&gt; stop&lt;/span&gt;
&lt;span id="cb17-4"&gt;&lt;a aria-hidden="true" href="#cb17-4" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="cf"&gt;if&lt;/span&gt; i &lt;span class="op"&gt;&amp;lt;=&lt;/span&gt; r:&lt;/span&gt;
&lt;span id="cb17-5"&gt;&lt;a aria-hidden="true" href="#cb17-5" tabindex="-1"&gt;&lt;/a&gt;        stop &lt;span class="op"&gt;+=&lt;/span&gt; q &lt;span class="op"&gt;+&lt;/span&gt; &lt;span class="dv"&gt;1&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb17-6"&gt;&lt;a aria-hidden="true" href="#cb17-6" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="cf"&gt;else&lt;/span&gt;:&lt;/span&gt;
&lt;span id="cb17-7"&gt;&lt;a aria-hidden="true" href="#cb17-7" tabindex="-1"&gt;&lt;/a&gt;        stop &lt;span class="op"&gt;+=&lt;/span&gt; q&lt;/span&gt;
&lt;span id="cb17-8"&gt;&lt;a aria-hidden="true" href="#cb17-8" tabindex="-1"&gt;&lt;/a&gt;    ret.append(&lt;span class="bu"&gt;iter&lt;/span&gt;(seq[start:stop]))&lt;/span&gt;
&lt;span id="cb17-9"&gt;&lt;a aria-hidden="true" href="#cb17-9" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="cf"&gt;return&lt;/span&gt; ret&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;可以看到总是能够保证得到的结果会是&lt;code&gt;n&lt;/code&gt;个迭代器。&lt;/p&gt;
&lt;h3 id="split_xxx-系列"&gt;Split_XXX 系列&lt;/h3&gt;
&lt;p&gt;对于字符串，可以使用&lt;code&gt;'hello!world!'.split('!')&lt;/code&gt;这样的方法把字符串分割成列表，那自然我们也希望能够对一个可迭代元素这样操作。&lt;code&gt;split_at()&lt;/code&gt;函数接收的不是一个字符串而是一个函数，如果序列内的元素返回真，就在这里分割。其函数签名如下：&lt;code&gt;split_at(iterable, pred, maxsplit=-1, keep_separator=False)&lt;/code&gt;。其中，&lt;code&gt;pred&lt;/code&gt;是判断函数，&lt;code&gt;maxsplit&lt;/code&gt;是最多分割次数，&lt;code&gt;keep_separator&lt;/code&gt;决定是否保留真元素。&lt;/p&gt;
&lt;div class="sourceCode" id="cb18"&gt;&lt;pre class="sourceCode python"&gt;&lt;code class="sourceCode python"&gt;&lt;span id="cb18-1"&gt;&lt;a aria-hidden="true" href="#cb18-1" tabindex="-1"&gt;&lt;/a&gt;[&lt;span class="st"&gt;''&lt;/span&gt;.join(i) &lt;span class="cf"&gt;for&lt;/span&gt; i &lt;span class="kw"&gt;in&lt;/span&gt; more_itertools.split_at(&lt;span class="st"&gt;'hello!world'&lt;/span&gt;,&lt;span class="kw"&gt;lambda&lt;/span&gt; x:x&lt;span class="op"&gt;==&lt;/span&gt;&lt;span class="st"&gt;'!'&lt;/span&gt;,keep_separator&lt;span class="op"&gt;=&lt;/span&gt;&lt;span class="va"&gt;True&lt;/span&gt;)]&lt;/span&gt;
&lt;span id="cb18-2"&gt;&lt;a aria-hidden="true" href="#cb18-2" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="co"&gt;# ['hello', '!', 'world']&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;库里面还提供了其他几个函数，举例说明。约定&lt;code&gt;raw='aaaAaaaAaaaAaa'&lt;/code&gt;，则：&lt;/p&gt;
&lt;table&gt;
&lt;colgroup&gt;
&lt;col style="width: 25%"/&gt;
&lt;col style="width: 25%"/&gt;
&lt;col style="width: 25%"/&gt;
&lt;col style="width: 25%"/&gt;
&lt;/colgroup&gt;
&lt;thead&gt;
&lt;tr class="header"&gt;
&lt;th&gt;函数&lt;/th&gt;
&lt;th&gt;描述&lt;/th&gt;
&lt;th&gt;示例&lt;/th&gt;
&lt;th&gt;结果&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class="odd"&gt;
&lt;td&gt;&lt;code&gt;split_at(iterable, pred, maxsplit=-1, keep_separator=False)&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;按照指定条件分割序列&lt;/td&gt;
&lt;td&gt;&lt;code&gt;list(more_itertools.split_at(raw,lambda x:x=='A'))&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;[['a', 'a', 'a'], ['a', 'a', 'a'], ['a', 'a', 'a'], ['a', 'a']]&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="even"&gt;
&lt;td&gt;&lt;code&gt;split_before(iterable, pred, maxsplit=-1)&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;在返回真的元素之前分割，保留真元素&lt;/td&gt;
&lt;td&gt;&lt;code&gt;list(more_itertools.split_before(raw,lambda x:x=='A'))&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;[['a', 'a', 'a'], ['A', 'a', 'a', 'a'], ['A', 'a', 'a', 'a'], ['A', 'a', 'a']]&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="odd"&gt;
&lt;td&gt;&lt;code&gt;split_after(iterable, pred, maxsplit=-1)&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;在返回真的元素之后分割，保留真元素&lt;/td&gt;
&lt;td&gt;&lt;code&gt;list(more_itertools.split_after(raw,lambda x:x=='A'))&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;[['a', 'a', 'a', 'A'], ['a', 'a', 'a', 'A'], ['a', 'a', 'a', 'A'], ['a', 'a']]&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;整个&lt;code&gt;split_xxx&lt;/code&gt;系列都有类似的实现。首先判断&lt;code&gt;maxsplit&lt;/code&gt;，为0就直接&lt;code&gt;yield list(iterator)&lt;/code&gt;。再遍历原来序列的每一个元素，判断并按照要求&lt;code&gt;yield&lt;/code&gt;即可：&lt;/p&gt;
&lt;div class="sourceCode" id="cb19"&gt;&lt;pre class="sourceCode python"&gt;&lt;code class="sourceCode python"&gt;&lt;span id="cb19-1"&gt;&lt;a aria-hidden="true" href="#cb19-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="cf"&gt;if&lt;/span&gt; maxsplit &lt;span class="op"&gt;==&lt;/span&gt; &lt;span class="dv"&gt;0&lt;/span&gt;:&lt;/span&gt;
&lt;span id="cb19-2"&gt;&lt;a aria-hidden="true" href="#cb19-2" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="cf"&gt;yield&lt;/span&gt; &lt;span class="bu"&gt;list&lt;/span&gt;(iterable)&lt;/span&gt;
&lt;span id="cb19-3"&gt;&lt;a aria-hidden="true" href="#cb19-3" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="cf"&gt;return&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb19-4"&gt;&lt;a aria-hidden="true" href="#cb19-4" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb19-5"&gt;&lt;a aria-hidden="true" href="#cb19-5" tabindex="-1"&gt;&lt;/a&gt;buf, it &lt;span class="op"&gt;=&lt;/span&gt; [], &lt;span class="bu"&gt;iter&lt;/span&gt;(iterable)    &lt;span class="co"&gt;# buf 是每一次返回的结果&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb19-6"&gt;&lt;a aria-hidden="true" href="#cb19-6" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="cf"&gt;for&lt;/span&gt; item &lt;span class="kw"&gt;in&lt;/span&gt; it:&lt;/span&gt;
&lt;span id="cb19-7"&gt;&lt;a aria-hidden="true" href="#cb19-7" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="cf"&gt;if&lt;/span&gt; pred(item):&lt;/span&gt;
&lt;span id="cb19-8"&gt;&lt;a aria-hidden="true" href="#cb19-8" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="cf"&gt;yield&lt;/span&gt; buf&lt;/span&gt;
&lt;span id="cb19-9"&gt;&lt;a aria-hidden="true" href="#cb19-9" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="co"&gt;# 其他判断，略&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb19-10"&gt;&lt;a aria-hidden="true" href="#cb19-10" tabindex="-1"&gt;&lt;/a&gt;        buf &lt;span class="op"&gt;=&lt;/span&gt; []&lt;/span&gt;
&lt;span id="cb19-11"&gt;&lt;a aria-hidden="true" href="#cb19-11" tabindex="-1"&gt;&lt;/a&gt;        maxsplit &lt;span class="op"&gt;-=&lt;/span&gt; &lt;span class="dv"&gt;1&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb19-12"&gt;&lt;a aria-hidden="true" href="#cb19-12" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="cf"&gt;else&lt;/span&gt;:&lt;/span&gt;
&lt;span id="cb19-13"&gt;&lt;a aria-hidden="true" href="#cb19-13" tabindex="-1"&gt;&lt;/a&gt;        buf.append(item)&lt;/span&gt;
&lt;span id="cb19-14"&gt;&lt;a aria-hidden="true" href="#cb19-14" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="cf"&gt;yield&lt;/span&gt; buf                   &lt;span class="co"&gt;# 返回结果，yield返回的依旧是一个生成器&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;注意这个函数返回的依旧是一个&lt;strong&gt;generator object&lt;/strong&gt;，所以最后使用yield关键字。假如使用&lt;code&gt;split_at('00100',lambda x:x=='1')&lt;/code&gt;的话，首先会&lt;code&gt;append&lt;/code&gt;两次，把前面两个0放到结果中去，然后遇到1，直接把buf yield出去，下一次再进入时，buf再次被置零为空列表(第一个yield下面一行)再继续操作。最后遍历全部完成，再把剩下的返回。buf就是保存每一次结果的列表。其他split系列的函数实现类似，略有不同。&lt;/p&gt;
&lt;p&gt;有两个函数与众不同，一个是&lt;code&gt;split_when&lt;/code&gt;，这个函数接收的条件判断函数需要两个参数，返回真时则在这两个元素之间分割。例如，对输入&lt;code&gt;[1, 2, 3, 3, 2, 5, 2, 4, 2]&lt;/code&gt;，判断函数拿到的就是&lt;code&gt;(1,2),(2,3),(3,3)......&lt;/code&gt;这样的一组元素。实现上就需要用到双重指针了，一个指向目前项目，一个指向未来(next)项目。&lt;/p&gt;
&lt;div class="sourceCode" id="cb20"&gt;&lt;pre class="sourceCode python"&gt;&lt;code class="sourceCode python"&gt;&lt;span id="cb20-1"&gt;&lt;a aria-hidden="true" href="#cb20-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="bu"&gt;list&lt;/span&gt;(split_when([&lt;span class="dv"&gt;1&lt;/span&gt;, &lt;span class="dv"&gt;2&lt;/span&gt;, &lt;span class="dv"&gt;3&lt;/span&gt;, &lt;span class="dv"&gt;3&lt;/span&gt;, &lt;span class="dv"&gt;2&lt;/span&gt;, &lt;span class="dv"&gt;5&lt;/span&gt;, &lt;span class="dv"&gt;2&lt;/span&gt;, &lt;span class="dv"&gt;4&lt;/span&gt;, &lt;span class="dv"&gt;2&lt;/span&gt;], &lt;span class="kw"&gt;lambda&lt;/span&gt; x, y: x &lt;span class="op"&gt;&amp;gt;&lt;/span&gt; y))&lt;/span&gt;
&lt;span id="cb20-2"&gt;&lt;a aria-hidden="true" href="#cb20-2" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="co"&gt;# [[1, 2, 3, 3], [2, 5], [2, 4], [2]]&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;另外一个是&lt;code&gt;split_into(iterable, sizes)&lt;/code&gt;函数，很简单，就是按照sizes指定的大小列表分割：&lt;/p&gt;
&lt;div class="sourceCode" id="cb21"&gt;&lt;pre class="sourceCode python"&gt;&lt;code class="sourceCode python"&gt;&lt;span id="cb21-1"&gt;&lt;a aria-hidden="true" href="#cb21-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="bu"&gt;list&lt;/span&gt;(split_into([&lt;span class="dv"&gt;1&lt;/span&gt;,&lt;span class="dv"&gt;2&lt;/span&gt;,&lt;span class="dv"&gt;3&lt;/span&gt;,&lt;span class="dv"&gt;4&lt;/span&gt;,&lt;span class="dv"&gt;5&lt;/span&gt;,&lt;span class="dv"&gt;6&lt;/span&gt;], [&lt;span class="dv"&gt;1&lt;/span&gt;,&lt;span class="dv"&gt;2&lt;/span&gt;,&lt;span class="dv"&gt;3&lt;/span&gt;]))&lt;/span&gt;
&lt;span id="cb21-2"&gt;&lt;a aria-hidden="true" href="#cb21-2" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="co"&gt;# [[1], [2, 3], [4, 5, 6]]&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;实现起来相当简单，遍历sizes切分即可，基本上就相当于&lt;code&gt;[list(itertools.islice(iterator,i)) for i in sizes]&lt;/code&gt;(所以返回的依旧是迭代器)。&lt;/p&gt;
&lt;h2 id="多变一系列"&gt;多变一系列&lt;/h2&gt;
&lt;h3 id="flatten"&gt;Flatten&lt;/h3&gt;
&lt;p&gt;打平，也就是把&lt;code&gt;[[1,2,3],[4,5]]&lt;/code&gt;变成&lt;code&gt;[1,2,3,4,5]&lt;/code&gt;这样的。可以想到把每一个每个子列表链接起来即可：&lt;/p&gt;
&lt;div class="sourceCode" id="cb22"&gt;&lt;pre class="sourceCode python"&gt;&lt;code class="sourceCode python"&gt;&lt;span id="cb22-1"&gt;&lt;a aria-hidden="true" href="#cb22-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="bu"&gt;list&lt;/span&gt;(itertools.chain.from_iterable([[&lt;span class="dv"&gt;1&lt;/span&gt;,&lt;span class="dv"&gt;2&lt;/span&gt;,&lt;span class="dv"&gt;3&lt;/span&gt;],[&lt;span class="dv"&gt;4&lt;/span&gt;,&lt;span class="dv"&gt;5&lt;/span&gt;]]))&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;然而，如果输入是多层嵌套的就会失败，假如输入&lt;code&gt;[[1,2,3],[4,5,[6,7]]]&lt;/code&gt;，结果是&lt;code&gt;[1, 2, 3, 4, 5, [6, 7]]&lt;/code&gt;。这种时候需要使用&lt;code&gt;collapse&lt;/code&gt;。&lt;/p&gt;
&lt;h3 id="collapse"&gt;Collapse&lt;/h3&gt;
&lt;p&gt;用法不多说了，很简单。把一个多层嵌套的列表“打平”是常见的操作，一个常见的思路是使用递归：&lt;/p&gt;
&lt;div class="sourceCode" id="cb23"&gt;&lt;pre class="sourceCode python"&gt;&lt;code class="sourceCode python"&gt;&lt;span id="cb23-1"&gt;&lt;a aria-hidden="true" href="#cb23-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;def&lt;/span&gt; flat(raw, result&lt;span class="op"&gt;=&lt;/span&gt;[]):&lt;/span&gt;
&lt;span id="cb23-2"&gt;&lt;a aria-hidden="true" href="#cb23-2" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="cf"&gt;for&lt;/span&gt; i &lt;span class="kw"&gt;in&lt;/span&gt; raw:&lt;/span&gt;
&lt;span id="cb23-3"&gt;&lt;a aria-hidden="true" href="#cb23-3" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="cf"&gt;if&lt;/span&gt; &lt;span class="bu"&gt;type&lt;/span&gt;(i) &lt;span class="op"&gt;==&lt;/span&gt; &lt;span class="bu"&gt;list&lt;/span&gt;:&lt;/span&gt;
&lt;span id="cb23-4"&gt;&lt;a aria-hidden="true" href="#cb23-4" tabindex="-1"&gt;&lt;/a&gt;            flat(i, result)&lt;/span&gt;
&lt;span id="cb23-5"&gt;&lt;a aria-hidden="true" href="#cb23-5" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="cf"&gt;else&lt;/span&gt;:&lt;/span&gt;
&lt;span id="cb23-6"&gt;&lt;a aria-hidden="true" href="#cb23-6" tabindex="-1"&gt;&lt;/a&gt;            result.append(i)&lt;/span&gt;
&lt;span id="cb23-7"&gt;&lt;a aria-hidden="true" href="#cb23-7" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="cf"&gt;return&lt;/span&gt; result&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;如果把它改写成生成器的写法就变成了：&lt;/p&gt;
&lt;div class="sourceCode" id="cb24"&gt;&lt;pre class="sourceCode python"&gt;&lt;code class="sourceCode python"&gt;&lt;span id="cb24-1"&gt;&lt;a aria-hidden="true" href="#cb24-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;def&lt;/span&gt; flat(raw, result&lt;span class="op"&gt;=&lt;/span&gt;[]):&lt;/span&gt;
&lt;span id="cb24-2"&gt;&lt;a aria-hidden="true" href="#cb24-2" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="cf"&gt;for&lt;/span&gt; i &lt;span class="kw"&gt;in&lt;/span&gt; raw:&lt;/span&gt;
&lt;span id="cb24-3"&gt;&lt;a aria-hidden="true" href="#cb24-3" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="cf"&gt;if&lt;/span&gt; &lt;span class="bu"&gt;type&lt;/span&gt;(i) &lt;span class="op"&gt;==&lt;/span&gt; &lt;span class="bu"&gt;list&lt;/span&gt;:&lt;/span&gt;
&lt;span id="cb24-4"&gt;&lt;a aria-hidden="true" href="#cb24-4" tabindex="-1"&gt;&lt;/a&gt;            &lt;span class="cf"&gt;yield&lt;/span&gt; &lt;span class="cf"&gt;from&lt;/span&gt; flat(i, result)&lt;/span&gt;
&lt;span id="cb24-5"&gt;&lt;a aria-hidden="true" href="#cb24-5" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="cf"&gt;else&lt;/span&gt;:&lt;/span&gt;
&lt;span id="cb24-6"&gt;&lt;a aria-hidden="true" href="#cb24-6" tabindex="-1"&gt;&lt;/a&gt;            &lt;span class="cf"&gt;yield&lt;/span&gt; i&lt;/span&gt;
&lt;span id="cb24-7"&gt;&lt;a aria-hidden="true" href="#cb24-7" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="cf"&gt;yield&lt;/span&gt; &lt;span class="cf"&gt;from&lt;/span&gt; result&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;把for循环写到里面去，就变成：&lt;/p&gt;
&lt;div class="sourceCode" id="cb25"&gt;&lt;pre class="sourceCode python"&gt;&lt;code class="sourceCode python"&gt;&lt;span id="cb25-1"&gt;&lt;a aria-hidden="true" href="#cb25-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;def&lt;/span&gt; flat(raw, result&lt;span class="op"&gt;=&lt;/span&gt;[]):&lt;/span&gt;
&lt;span id="cb25-2"&gt;&lt;a aria-hidden="true" href="#cb25-2" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="cf"&gt;if&lt;/span&gt; &lt;span class="bu"&gt;type&lt;/span&gt;(raw) &lt;span class="op"&gt;==&lt;/span&gt; &lt;span class="bu"&gt;list&lt;/span&gt;:&lt;/span&gt;
&lt;span id="cb25-3"&gt;&lt;a aria-hidden="true" href="#cb25-3" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="cf"&gt;for&lt;/span&gt; i &lt;span class="kw"&gt;in&lt;/span&gt; raw:&lt;/span&gt;
&lt;span id="cb25-4"&gt;&lt;a aria-hidden="true" href="#cb25-4" tabindex="-1"&gt;&lt;/a&gt;            &lt;span class="cf"&gt;yield&lt;/span&gt; &lt;span class="cf"&gt;from&lt;/span&gt; flat(i, result)&lt;/span&gt;
&lt;span id="cb25-5"&gt;&lt;a aria-hidden="true" href="#cb25-5" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="cf"&gt;else&lt;/span&gt;:&lt;/span&gt;
&lt;span id="cb25-6"&gt;&lt;a aria-hidden="true" href="#cb25-6" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="cf"&gt;yield&lt;/span&gt; raw&lt;/span&gt;
&lt;span id="cb25-7"&gt;&lt;a aria-hidden="true" href="#cb25-7" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="cf"&gt;return&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;这其实就是库的实现方式。不过它把内部循环单独实现了一下，限制了递归级数，并且加上了对bytes,str和用户定义的“不处理类型”的处理：&lt;/p&gt;
&lt;div class="sourceCode" id="cb26"&gt;&lt;pre class="sourceCode python"&gt;&lt;code class="sourceCode python"&gt;&lt;span id="cb26-1"&gt;&lt;a aria-hidden="true" href="#cb26-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;def&lt;/span&gt; walk(node, level):&lt;/span&gt;
&lt;span id="cb26-2"&gt;&lt;a aria-hidden="true" href="#cb26-2" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="cf"&gt;if&lt;/span&gt; (((levels &lt;span class="kw"&gt;is&lt;/span&gt; &lt;span class="kw"&gt;not&lt;/span&gt; &lt;span class="va"&gt;None&lt;/span&gt;) &lt;span class="kw"&gt;and&lt;/span&gt; (level &lt;span class="op"&gt;&amp;gt;&lt;/span&gt; levels)) &lt;/span&gt;
&lt;span id="cb26-3"&gt;&lt;a aria-hidden="true" href="#cb26-3" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="kw"&gt;or&lt;/span&gt; &lt;span class="bu"&gt;isinstance&lt;/span&gt;(node, (&lt;span class="bu"&gt;str&lt;/span&gt;, &lt;span class="bu"&gt;bytes&lt;/span&gt;)) &lt;/span&gt;
&lt;span id="cb26-4"&gt;&lt;a aria-hidden="true" href="#cb26-4" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="kw"&gt;or&lt;/span&gt; ((base_type &lt;span class="kw"&gt;is&lt;/span&gt; &lt;span class="kw"&gt;not&lt;/span&gt; &lt;span class="va"&gt;None&lt;/span&gt;) &lt;span class="kw"&gt;and&lt;/span&gt; &lt;span class="bu"&gt;isinstance&lt;/span&gt;(node, base_type))):&lt;/span&gt;
&lt;span id="cb26-5"&gt;&lt;a aria-hidden="true" href="#cb26-5" tabindex="-1"&gt;&lt;/a&gt;            &lt;span class="cf"&gt;yield&lt;/span&gt; node&lt;/span&gt;
&lt;span id="cb26-6"&gt;&lt;a aria-hidden="true" href="#cb26-6" tabindex="-1"&gt;&lt;/a&gt;            &lt;span class="cf"&gt;return&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb26-7"&gt;&lt;a aria-hidden="true" href="#cb26-7" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="cf"&gt;try&lt;/span&gt;:&lt;/span&gt;
&lt;span id="cb26-8"&gt;&lt;a aria-hidden="true" href="#cb26-8" tabindex="-1"&gt;&lt;/a&gt;        tree &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="bu"&gt;iter&lt;/span&gt;(node)&lt;/span&gt;
&lt;span id="cb26-9"&gt;&lt;a aria-hidden="true" href="#cb26-9" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="cf"&gt;except&lt;/span&gt; &lt;span class="pp"&gt;TypeError&lt;/span&gt;:&lt;/span&gt;
&lt;span id="cb26-10"&gt;&lt;a aria-hidden="true" href="#cb26-10" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="cf"&gt;yield&lt;/span&gt; node&lt;/span&gt;
&lt;span id="cb26-11"&gt;&lt;a aria-hidden="true" href="#cb26-11" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="cf"&gt;return&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb26-12"&gt;&lt;a aria-hidden="true" href="#cb26-12" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="cf"&gt;else&lt;/span&gt;:&lt;/span&gt;
&lt;span id="cb26-13"&gt;&lt;a aria-hidden="true" href="#cb26-13" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="cf"&gt;for&lt;/span&gt; child &lt;span class="kw"&gt;in&lt;/span&gt; tree:&lt;/span&gt;
&lt;span id="cb26-14"&gt;&lt;a aria-hidden="true" href="#cb26-14" tabindex="-1"&gt;&lt;/a&gt;            &lt;span class="cf"&gt;yield&lt;/span&gt; &lt;span class="cf"&gt;from&lt;/span&gt; walk(child, level &lt;span class="op"&gt;+&lt;/span&gt; &lt;span class="dv"&gt;1&lt;/span&gt;)&lt;/span&gt;
&lt;span id="cb26-15"&gt;&lt;a aria-hidden="true" href="#cb26-15" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb26-16"&gt;&lt;a aria-hidden="true" href="#cb26-16" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="cf"&gt;yield&lt;/span&gt; &lt;span class="cf"&gt;from&lt;/span&gt; walk(iterable, &lt;span class="dv"&gt;0&lt;/span&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;它的函数签名是&lt;code&gt;collapse(iterable, base_type=None, levels=None)&lt;/code&gt;，可以指定不处理的类型和递归层级。&lt;/p&gt;
&lt;h3 id="unzip"&gt;Unzip&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;unzip&lt;/code&gt;是标准函数&lt;code&gt;zip&lt;/code&gt;的逆向过程。很容易理解，就是“先取每个迭代器的第一个组成第一个结果，再取每个迭代器的第二个组成第二个结果……”，实现方式类似于这样：&lt;/p&gt;
&lt;div class="sourceCode" id="cb27"&gt;&lt;pre class="sourceCode python"&gt;&lt;code class="sourceCode python"&gt;&lt;span id="cb27-1"&gt;&lt;a aria-hidden="true" href="#cb27-1" tabindex="-1"&gt;&lt;/a&gt;raw &lt;span class="op"&gt;=&lt;/span&gt; [(&lt;span class="st"&gt;"a"&lt;/span&gt;, &lt;span class="dv"&gt;1&lt;/span&gt;), (&lt;span class="st"&gt;"b"&lt;/span&gt;, &lt;span class="dv"&gt;2&lt;/span&gt;), (&lt;span class="st"&gt;"c"&lt;/span&gt;, &lt;span class="dv"&gt;3&lt;/span&gt;), (&lt;span class="st"&gt;"d"&lt;/span&gt;, &lt;span class="dv"&gt;4&lt;/span&gt;)]&lt;/span&gt;
&lt;span id="cb27-2"&gt;&lt;a aria-hidden="true" href="#cb27-2" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb27-3"&gt;&lt;a aria-hidden="true" href="#cb27-3" tabindex="-1"&gt;&lt;/a&gt;result &lt;span class="op"&gt;=&lt;/span&gt; []&lt;/span&gt;
&lt;span id="cb27-4"&gt;&lt;a aria-hidden="true" href="#cb27-4" tabindex="-1"&gt;&lt;/a&gt;iterators &lt;span class="op"&gt;=&lt;/span&gt; itertools.tee(raw, &lt;span class="bu"&gt;len&lt;/span&gt;((&lt;span class="st"&gt;"a"&lt;/span&gt;, &lt;span class="dv"&gt;1&lt;/span&gt;)))   &lt;span class="co"&gt;# 每一个原始类型元组的长度&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb27-5"&gt;&lt;a aria-hidden="true" href="#cb27-5" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb27-6"&gt;&lt;a aria-hidden="true" href="#cb27-6" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="cf"&gt;for&lt;/span&gt; index, iterator &lt;span class="kw"&gt;in&lt;/span&gt; &lt;span class="bu"&gt;enumerate&lt;/span&gt;(iterators):&lt;/span&gt;
&lt;span id="cb27-7"&gt;&lt;a aria-hidden="true" href="#cb27-7" tabindex="-1"&gt;&lt;/a&gt;    result.append(&lt;span class="bu"&gt;list&lt;/span&gt;(&lt;span class="bu"&gt;map&lt;/span&gt;(&lt;span class="kw"&gt;lambda&lt;/span&gt; x: x[index], iterator)))&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;最终的结果是&lt;code&gt;[['a', 'b', 'c', 'd'], [1, 2, 3, 4]]&lt;/code&gt;。库的实现是嵌套函数，并且返回的是一个&lt;code&gt;tuple&lt;/code&gt;类型。但是请注意，如果输入类型不是严格匹配，参差不一的话会抛出&lt;code&gt;StopIteration&lt;/code&gt;，其中的&lt;del&gt;间谍&lt;/del&gt;&lt;code&gt;spy&lt;/code&gt;的作用是拿到第一个元素和整个迭代器的副本并不去调用__next__()：&lt;/p&gt;
&lt;div class="sourceCode" id="cb28"&gt;&lt;pre class="sourceCode python"&gt;&lt;code class="sourceCode python"&gt;&lt;span id="cb28-1"&gt;&lt;a aria-hidden="true" href="#cb28-1" tabindex="-1"&gt;&lt;/a&gt;head, iterable &lt;span class="op"&gt;=&lt;/span&gt; spy(&lt;span class="bu"&gt;iter&lt;/span&gt;(iterable))&lt;/span&gt;
&lt;span id="cb28-2"&gt;&lt;a aria-hidden="true" href="#cb28-2" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="cf"&gt;if&lt;/span&gt; &lt;span class="kw"&gt;not&lt;/span&gt; head:&lt;/span&gt;
&lt;span id="cb28-3"&gt;&lt;a aria-hidden="true" href="#cb28-3" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="cf"&gt;return&lt;/span&gt; ()&lt;/span&gt;
&lt;span id="cb28-4"&gt;&lt;a aria-hidden="true" href="#cb28-4" tabindex="-1"&gt;&lt;/a&gt;head &lt;span class="op"&gt;=&lt;/span&gt; head[&lt;span class="dv"&gt;0&lt;/span&gt;]&lt;/span&gt;
&lt;span id="cb28-5"&gt;&lt;a aria-hidden="true" href="#cb28-5" tabindex="-1"&gt;&lt;/a&gt;iterables &lt;span class="op"&gt;=&lt;/span&gt; tee(iterable, &lt;span class="bu"&gt;len&lt;/span&gt;(head))&lt;/span&gt;
&lt;span id="cb28-6"&gt;&lt;a aria-hidden="true" href="#cb28-6" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb28-7"&gt;&lt;a aria-hidden="true" href="#cb28-7" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;def&lt;/span&gt; itemgetter(i):&lt;/span&gt;
&lt;span id="cb28-8"&gt;&lt;a aria-hidden="true" href="#cb28-8" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="kw"&gt;def&lt;/span&gt; getter(obj):&lt;/span&gt;
&lt;span id="cb28-9"&gt;&lt;a aria-hidden="true" href="#cb28-9" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="cf"&gt;try&lt;/span&gt;:&lt;/span&gt;
&lt;span id="cb28-10"&gt;&lt;a aria-hidden="true" href="#cb28-10" tabindex="-1"&gt;&lt;/a&gt;            &lt;span class="cf"&gt;return&lt;/span&gt; obj[i]&lt;/span&gt;
&lt;span id="cb28-11"&gt;&lt;a aria-hidden="true" href="#cb28-11" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="cf"&gt;except&lt;/span&gt; &lt;span class="pp"&gt;IndexError&lt;/span&gt;:&lt;/span&gt;
&lt;span id="cb28-12"&gt;&lt;a aria-hidden="true" href="#cb28-12" tabindex="-1"&gt;&lt;/a&gt;            &lt;span class="cf"&gt;raise&lt;/span&gt; &lt;span class="pp"&gt;StopIteration&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb28-13"&gt;&lt;a aria-hidden="true" href="#cb28-13" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="cf"&gt;return&lt;/span&gt; getter&lt;/span&gt;
&lt;span id="cb28-14"&gt;&lt;a aria-hidden="true" href="#cb28-14" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb28-15"&gt;&lt;a aria-hidden="true" href="#cb28-15" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="cf"&gt;return&lt;/span&gt; &lt;span class="bu"&gt;tuple&lt;/span&gt;(&lt;span class="bu"&gt;map&lt;/span&gt;(itemgetter(i), it) &lt;span class="cf"&gt;for&lt;/span&gt; i, it &lt;span class="kw"&gt;in&lt;/span&gt; &lt;span class="bu"&gt;enumerate&lt;/span&gt;(iterables))&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id="挨个操作系列"&gt;挨个操作系列&lt;/h2&gt;
&lt;h3 id="map_except"&gt;Map_except&lt;/h3&gt;
&lt;p&gt;很简单的函数，如果你有一个参差不一的列表想要&lt;code&gt;map&lt;/code&gt;但不希望因为里面有一堆不想要的数据类型导致抛出异常就使用它。此函数会简单的忽略出现的异常：&lt;/p&gt;
&lt;div class="sourceCode" id="cb29"&gt;&lt;pre class="sourceCode python"&gt;&lt;code class="sourceCode python"&gt;&lt;span id="cb29-1"&gt;&lt;a aria-hidden="true" href="#cb29-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;def&lt;/span&gt; map_except(function, iterable, &lt;span class="op"&gt;*&lt;/span&gt;exceptions):&lt;/span&gt;
&lt;span id="cb29-2"&gt;&lt;a aria-hidden="true" href="#cb29-2" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="cf"&gt;for&lt;/span&gt; item &lt;span class="kw"&gt;in&lt;/span&gt; iterable:&lt;/span&gt;
&lt;span id="cb29-3"&gt;&lt;a aria-hidden="true" href="#cb29-3" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="cf"&gt;try&lt;/span&gt;:&lt;/span&gt;
&lt;span id="cb29-4"&gt;&lt;a aria-hidden="true" href="#cb29-4" tabindex="-1"&gt;&lt;/a&gt;            &lt;span class="cf"&gt;yield&lt;/span&gt; function(item)&lt;/span&gt;
&lt;span id="cb29-5"&gt;&lt;a aria-hidden="true" href="#cb29-5" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="cf"&gt;except&lt;/span&gt; exceptions:&lt;/span&gt;
&lt;span id="cb29-6"&gt;&lt;a aria-hidden="true" href="#cb29-6" tabindex="-1"&gt;&lt;/a&gt;            &lt;span class="cf"&gt;pass&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;可以接收多个exception类型作为&lt;code&gt;exceptions&lt;/code&gt;的参数，除此以外的不会被捕捉。当然，可以给一个&lt;code&gt;Exception&lt;/code&gt;基类捕获一切异常。其实我来设计的话我会给它加一个默认值：&lt;/p&gt;
&lt;div class="sourceCode" id="cb30"&gt;&lt;pre class="sourceCode python"&gt;&lt;code class="sourceCode python"&gt;&lt;span id="cb30-1"&gt;&lt;a aria-hidden="true" href="#cb30-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;def&lt;/span&gt; map_except(function, iterable, default, &lt;span class="op"&gt;*&lt;/span&gt;exceptions):&lt;/span&gt;
&lt;span id="cb30-2"&gt;&lt;a aria-hidden="true" href="#cb30-2" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="cf"&gt;for&lt;/span&gt; item &lt;span class="kw"&gt;in&lt;/span&gt; iterable:&lt;/span&gt;
&lt;span id="cb30-3"&gt;&lt;a aria-hidden="true" href="#cb30-3" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="cf"&gt;try&lt;/span&gt;:&lt;/span&gt;
&lt;span id="cb30-4"&gt;&lt;a aria-hidden="true" href="#cb30-4" tabindex="-1"&gt;&lt;/a&gt;            &lt;span class="cf"&gt;yield&lt;/span&gt; function(item)&lt;/span&gt;
&lt;span id="cb30-5"&gt;&lt;a aria-hidden="true" href="#cb30-5" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="cf"&gt;except&lt;/span&gt; exceptions:&lt;/span&gt;
&lt;span id="cb30-6"&gt;&lt;a aria-hidden="true" href="#cb30-6" tabindex="-1"&gt;&lt;/a&gt;            &lt;span class="cf"&gt;yield&lt;/span&gt; default&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id="map_reduce"&gt;Map_reduce&lt;/h3&gt;
&lt;p&gt;组合拳，略复杂，看例子：&lt;/p&gt;
&lt;div class="sourceCode" id="cb31"&gt;&lt;pre class="sourceCode python"&gt;&lt;code class="sourceCode python"&gt;&lt;span id="cb31-1"&gt;&lt;a aria-hidden="true" href="#cb31-1" tabindex="-1"&gt;&lt;/a&gt;data &lt;span class="op"&gt;=&lt;/span&gt; [&lt;/span&gt;
&lt;span id="cb31-2"&gt;&lt;a aria-hidden="true" href="#cb31-2" tabindex="-1"&gt;&lt;/a&gt;    {&lt;span class="st"&gt;"type"&lt;/span&gt;: &lt;span class="dv"&gt;1&lt;/span&gt;, &lt;span class="st"&gt;"data"&lt;/span&gt;: &lt;span class="st"&gt;"John"&lt;/span&gt;},&lt;/span&gt;
&lt;span id="cb31-3"&gt;&lt;a aria-hidden="true" href="#cb31-3" tabindex="-1"&gt;&lt;/a&gt;    {&lt;span class="st"&gt;"type"&lt;/span&gt;: &lt;span class="dv"&gt;1&lt;/span&gt;, &lt;span class="st"&gt;"data"&lt;/span&gt;: &lt;span class="st"&gt;"Mike"&lt;/span&gt;},&lt;/span&gt;
&lt;span id="cb31-4"&gt;&lt;a aria-hidden="true" href="#cb31-4" tabindex="-1"&gt;&lt;/a&gt;    {&lt;span class="st"&gt;"type"&lt;/span&gt;: &lt;span class="dv"&gt;2&lt;/span&gt;, &lt;span class="st"&gt;"data"&lt;/span&gt;: &lt;span class="st"&gt;"Jenny"&lt;/span&gt;},&lt;/span&gt;
&lt;span id="cb31-5"&gt;&lt;a aria-hidden="true" href="#cb31-5" tabindex="-1"&gt;&lt;/a&gt;    {&lt;span class="st"&gt;"type"&lt;/span&gt;: &lt;span class="dv"&gt;2&lt;/span&gt;, &lt;span class="st"&gt;"data"&lt;/span&gt;: &lt;span class="st"&gt;"Wang"&lt;/span&gt;},&lt;/span&gt;
&lt;span id="cb31-6"&gt;&lt;a aria-hidden="true" href="#cb31-6" tabindex="-1"&gt;&lt;/a&gt;    {&lt;span class="st"&gt;"type"&lt;/span&gt;: &lt;span class="dv"&gt;3&lt;/span&gt;, &lt;span class="st"&gt;"data"&lt;/span&gt;: &lt;span class="st"&gt;"August"&lt;/span&gt;},&lt;/span&gt;
&lt;span id="cb31-7"&gt;&lt;a aria-hidden="true" href="#cb31-7" tabindex="-1"&gt;&lt;/a&gt;]&lt;/span&gt;
&lt;span id="cb31-8"&gt;&lt;a aria-hidden="true" href="#cb31-8" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb31-9"&gt;&lt;a aria-hidden="true" href="#cb31-9" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="im"&gt;import&lt;/span&gt; more_itertools&lt;/span&gt;
&lt;span id="cb31-10"&gt;&lt;a aria-hidden="true" href="#cb31-10" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb31-11"&gt;&lt;a aria-hidden="true" href="#cb31-11" tabindex="-1"&gt;&lt;/a&gt;result &lt;span class="op"&gt;=&lt;/span&gt; more_itertools.map_reduce(&lt;/span&gt;
&lt;span id="cb31-12"&gt;&lt;a aria-hidden="true" href="#cb31-12" tabindex="-1"&gt;&lt;/a&gt;    data,&lt;/span&gt;
&lt;span id="cb31-13"&gt;&lt;a aria-hidden="true" href="#cb31-13" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="kw"&gt;lambda&lt;/span&gt; item: &lt;span class="bu"&gt;str&lt;/span&gt;(item[&lt;span class="st"&gt;"type"&lt;/span&gt;]), &lt;span class="co"&gt;# 分类函数&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb31-14"&gt;&lt;a aria-hidden="true" href="#cb31-14" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="kw"&gt;lambda&lt;/span&gt; data: &lt;span class="dv"&gt;1&lt;/span&gt;, &lt;span class="co"&gt;# 转换函数&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb31-15"&gt;&lt;a aria-hidden="true" href="#cb31-15" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="bu"&gt;sum&lt;/span&gt; &lt;span class="co"&gt;# 规约函数&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb31-16"&gt;&lt;a aria-hidden="true" href="#cb31-16" tabindex="-1"&gt;&lt;/a&gt;)&lt;/span&gt;
&lt;span id="cb31-17"&gt;&lt;a aria-hidden="true" href="#cb31-17" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb31-18"&gt;&lt;a aria-hidden="true" href="#cb31-18" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="co"&gt;# 得到 defaultdict(None, {'1': 2, '2': 2, '3': 1})&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id="numeric_range"&gt;Numeric_range&lt;/h3&gt;
&lt;p&gt;假设你要遍历1到10，你可以使用&lt;code&gt;range(1, 11)&lt;/code&gt;，自然你也希望有一种方法可以遍历日期，分数，小数，乃至一切你直觉上觉得可以按照一定间隔遍历的东西，比如 &lt;code&gt;range(datetime(2022,11,11),datetime(2022,11,20))&lt;/code&gt;这样，那么&lt;code&gt;numeric_range&lt;/code&gt;就是你需要的：&lt;/p&gt;
&lt;div class="sourceCode" id="cb32"&gt;&lt;pre class="sourceCode python"&gt;&lt;code class="sourceCode python"&gt;&lt;span id="cb32-1"&gt;&lt;a aria-hidden="true" href="#cb32-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="bu"&gt;list&lt;/span&gt;(more_itertools.numeric_range(datetime(&lt;span class="dv"&gt;2022&lt;/span&gt;,&lt;span class="dv"&gt;11&lt;/span&gt;,&lt;span class="dv"&gt;11&lt;/span&gt;),datetime(&lt;span class="dv"&gt;2022&lt;/span&gt;,&lt;span class="dv"&gt;11&lt;/span&gt;,&lt;span class="dv"&gt;20&lt;/span&gt;)))&lt;/span&gt;
&lt;span id="cb32-2"&gt;&lt;a aria-hidden="true" href="#cb32-2" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="co"&gt;# 将会得到：&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb32-3"&gt;&lt;a aria-hidden="true" href="#cb32-3" tabindex="-1"&gt;&lt;/a&gt;[datetime.datetime(&lt;span class="dv"&gt;2022&lt;/span&gt;, &lt;span class="dv"&gt;11&lt;/span&gt;, &lt;span class="dv"&gt;11&lt;/span&gt;, &lt;span class="dv"&gt;0&lt;/span&gt;, &lt;span class="dv"&gt;0&lt;/span&gt;),&lt;/span&gt;
&lt;span id="cb32-4"&gt;&lt;a aria-hidden="true" href="#cb32-4" tabindex="-1"&gt;&lt;/a&gt; datetime.datetime(&lt;span class="dv"&gt;2022&lt;/span&gt;, &lt;span class="dv"&gt;11&lt;/span&gt;, &lt;span class="dv"&gt;12&lt;/span&gt;, &lt;span class="dv"&gt;0&lt;/span&gt;, &lt;span class="dv"&gt;0&lt;/span&gt;),&lt;/span&gt;
&lt;span id="cb32-5"&gt;&lt;a aria-hidden="true" href="#cb32-5" tabindex="-1"&gt;&lt;/a&gt; datetime.datetime(&lt;span class="dv"&gt;2022&lt;/span&gt;, &lt;span class="dv"&gt;11&lt;/span&gt;, &lt;span class="dv"&gt;13&lt;/span&gt;, &lt;span class="dv"&gt;0&lt;/span&gt;, &lt;span class="dv"&gt;0&lt;/span&gt;),&lt;/span&gt;
&lt;span id="cb32-6"&gt;&lt;a aria-hidden="true" href="#cb32-6" tabindex="-1"&gt;&lt;/a&gt; datetime.datetime(&lt;span class="dv"&gt;2022&lt;/span&gt;, &lt;span class="dv"&gt;11&lt;/span&gt;, &lt;span class="dv"&gt;14&lt;/span&gt;, &lt;span class="dv"&gt;0&lt;/span&gt;, &lt;span class="dv"&gt;0&lt;/span&gt;),&lt;/span&gt;
&lt;span id="cb32-7"&gt;&lt;a aria-hidden="true" href="#cb32-7" tabindex="-1"&gt;&lt;/a&gt; datetime.datetime(&lt;span class="dv"&gt;2022&lt;/span&gt;, &lt;span class="dv"&gt;11&lt;/span&gt;, &lt;span class="dv"&gt;15&lt;/span&gt;, &lt;span class="dv"&gt;0&lt;/span&gt;, &lt;span class="dv"&gt;0&lt;/span&gt;),&lt;/span&gt;
&lt;span id="cb32-8"&gt;&lt;a aria-hidden="true" href="#cb32-8" tabindex="-1"&gt;&lt;/a&gt; datetime.datetime(&lt;span class="dv"&gt;2022&lt;/span&gt;, &lt;span class="dv"&gt;11&lt;/span&gt;, &lt;span class="dv"&gt;16&lt;/span&gt;, &lt;span class="dv"&gt;0&lt;/span&gt;, &lt;span class="dv"&gt;0&lt;/span&gt;),&lt;/span&gt;
&lt;span id="cb32-9"&gt;&lt;a aria-hidden="true" href="#cb32-9" tabindex="-1"&gt;&lt;/a&gt; datetime.datetime(&lt;span class="dv"&gt;2022&lt;/span&gt;, &lt;span class="dv"&gt;11&lt;/span&gt;, &lt;span class="dv"&gt;17&lt;/span&gt;, &lt;span class="dv"&gt;0&lt;/span&gt;, &lt;span class="dv"&gt;0&lt;/span&gt;),&lt;/span&gt;
&lt;span id="cb32-10"&gt;&lt;a aria-hidden="true" href="#cb32-10" tabindex="-1"&gt;&lt;/a&gt; datetime.datetime(&lt;span class="dv"&gt;2022&lt;/span&gt;, &lt;span class="dv"&gt;11&lt;/span&gt;, &lt;span class="dv"&gt;18&lt;/span&gt;, &lt;span class="dv"&gt;0&lt;/span&gt;, &lt;span class="dv"&gt;0&lt;/span&gt;),&lt;/span&gt;
&lt;span id="cb32-11"&gt;&lt;a aria-hidden="true" href="#cb32-11" tabindex="-1"&gt;&lt;/a&gt; datetime.datetime(&lt;span class="dv"&gt;2022&lt;/span&gt;, &lt;span class="dv"&gt;11&lt;/span&gt;, &lt;span class="dv"&gt;19&lt;/span&gt;, &lt;span class="dv"&gt;0&lt;/span&gt;, &lt;span class="dv"&gt;0&lt;/span&gt;)]&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;首先，&lt;code&gt;numberic_range&lt;/code&gt;是一个继承了&lt;code&gt;abc.Sequence&lt;/code&gt;和&lt;code&gt;abc.Hashable&lt;/code&gt;的类，这也就意味着它并不是一个&lt;code&gt;iterator&lt;/code&gt;。按照文档，继承了&lt;code&gt;Sequence&lt;/code&gt;就要实现一些方法：&lt;/p&gt;
&lt;div class="sourceCode" id="cb33"&gt;&lt;pre class="sourceCode python"&gt;&lt;code class="sourceCode python"&gt;&lt;span id="cb33-1"&gt;&lt;a aria-hidden="true" href="#cb33-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;class&lt;/span&gt; C(Sequence):                      &lt;span class="co"&gt;# Direct inheritance&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb33-2"&gt;&lt;a aria-hidden="true" href="#cb33-2" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="kw"&gt;def&lt;/span&gt; &lt;span class="fu"&gt;__init__&lt;/span&gt;(&lt;span class="va"&gt;self&lt;/span&gt;): ...             &lt;span class="co"&gt;# Extra method not required by the ABC&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb33-3"&gt;&lt;a aria-hidden="true" href="#cb33-3" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="kw"&gt;def&lt;/span&gt; &lt;span class="fu"&gt;__getitem__&lt;/span&gt;(&lt;span class="va"&gt;self&lt;/span&gt;, index):  ...  &lt;span class="co"&gt;# Required abstract method&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb33-4"&gt;&lt;a aria-hidden="true" href="#cb33-4" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="kw"&gt;def&lt;/span&gt; &lt;span class="fu"&gt;__len__&lt;/span&gt;(&lt;span class="va"&gt;self&lt;/span&gt;):  ...             &lt;span class="co"&gt;# Required abstract method&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb33-5"&gt;&lt;a aria-hidden="true" href="#cb33-5" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="kw"&gt;def&lt;/span&gt; count(&lt;span class="va"&gt;self&lt;/span&gt;, value): ...         &lt;span class="co"&gt;# Optionally override a mixin method&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;与&lt;code&gt;range&lt;/code&gt;函数相同，它的构造函数也接收一到三个参数，即起，末和间隔。无论给出的是多少个参数，在构造函数 中会生成&lt;code&gt;self._start&lt;/code&gt;,&lt;code&gt;self._stop&lt;/code&gt;,&lt;code&gt;self._step&lt;/code&gt;代表起，末和间隔。为了自动推导出来，在构造函数中使用了一些技巧，也就是&lt;code&gt;type&lt;/code&gt;函数。比如给出参数&lt;code&gt;4,5&lt;/code&gt;，那么会使用这样的方法得出 第三个参数(自动指定间隔为1)：&lt;/p&gt;
&lt;div class="sourceCode" id="cb34"&gt;&lt;pre class="sourceCode python"&gt;&lt;code class="sourceCode python"&gt;&lt;span id="cb34-1"&gt;&lt;a aria-hidden="true" href="#cb34-1" tabindex="-1"&gt;&lt;/a&gt;start,stop &lt;span class="op"&gt;=&lt;/span&gt; (&lt;span class="dv"&gt;4&lt;/span&gt;,&lt;span class="dv"&gt;5&lt;/span&gt;)&lt;/span&gt;
&lt;span id="cb34-2"&gt;&lt;a aria-hidden="true" href="#cb34-2" tabindex="-1"&gt;&lt;/a&gt;step &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="bu"&gt;type&lt;/span&gt;(stop &lt;span class="op"&gt;-&lt;/span&gt; start)(&lt;span class="dv"&gt;1&lt;/span&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;code&gt;__getitem__&lt;/code&gt;可以处理int的key或者slice的key，按照不同的类型返回不同结果。如果是简单的获取指定位置的元素，只需要&lt;code&gt;self._start + i * self._step&lt;/code&gt;即可。&lt;/p&gt;
&lt;p&gt;同样的，使用&lt;code&gt;self._zero = type(self._step)(0)&lt;/code&gt;就可以得到这个类型的0值。除此以外，构造函数还需要判断给出的起末是递增的还是递减的，这个判断使用&lt;code&gt;self._step &amp;gt; self._zero&lt;/code&gt;来实现。最简示例如下：&lt;/p&gt;
&lt;div class="sourceCode" id="cb35"&gt;&lt;pre class="sourceCode python"&gt;&lt;code class="sourceCode python"&gt;&lt;span id="cb35-1"&gt;&lt;a aria-hidden="true" href="#cb35-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;class&lt;/span&gt; numeric_range(abc.Sequence, abc.Hashable):&lt;/span&gt;
&lt;span id="cb35-2"&gt;&lt;a aria-hidden="true" href="#cb35-2" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="kw"&gt;def&lt;/span&gt; &lt;span class="fu"&gt;__init__&lt;/span&gt;(&lt;span class="va"&gt;self&lt;/span&gt;, &lt;span class="op"&gt;*&lt;/span&gt;args):&lt;/span&gt;
&lt;span id="cb35-3"&gt;&lt;a aria-hidden="true" href="#cb35-3" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="va"&gt;self&lt;/span&gt;._start, &lt;span class="va"&gt;self&lt;/span&gt;._stop, &lt;span class="va"&gt;self&lt;/span&gt;._step &lt;span class="op"&gt;=&lt;/span&gt; args&lt;/span&gt;
&lt;span id="cb35-4"&gt;&lt;a aria-hidden="true" href="#cb35-4" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="co"&gt;# datetime(2020, 2, 10), datetime(2020, 2, 15), timedelta(days=2)&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb35-5"&gt;&lt;a aria-hidden="true" href="#cb35-5" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="va"&gt;self&lt;/span&gt;._zero &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="bu"&gt;type&lt;/span&gt;(&lt;span class="va"&gt;self&lt;/span&gt;._step)(&lt;span class="dv"&gt;0&lt;/span&gt;)&lt;/span&gt;
&lt;span id="cb35-6"&gt;&lt;a aria-hidden="true" href="#cb35-6" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="co"&gt;# timedelta(0)&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb35-7"&gt;&lt;a aria-hidden="true" href="#cb35-7" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="va"&gt;self&lt;/span&gt;._growing &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="va"&gt;self&lt;/span&gt;._step &lt;span class="op"&gt;&amp;gt;&lt;/span&gt; &lt;span class="va"&gt;self&lt;/span&gt;._zero&lt;/span&gt;
&lt;span id="cb35-8"&gt;&lt;a aria-hidden="true" href="#cb35-8" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="co"&gt;# True&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb35-9"&gt;&lt;a aria-hidden="true" href="#cb35-9" tabindex="-1"&gt;&lt;/a&gt;        q, r &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="bu"&gt;divmod&lt;/span&gt;(&lt;span class="va"&gt;self&lt;/span&gt;._stop &lt;span class="op"&gt;-&lt;/span&gt; &lt;span class="va"&gt;self&lt;/span&gt;._start, step)&lt;/span&gt;
&lt;span id="cb35-10"&gt;&lt;a aria-hidden="true" href="#cb35-10" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="va"&gt;self&lt;/span&gt;._len &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="bu"&gt;int&lt;/span&gt;(q) &lt;span class="op"&gt;+&lt;/span&gt; &lt;span class="bu"&gt;int&lt;/span&gt;(r &lt;span class="op"&gt;!=&lt;/span&gt; &lt;span class="va"&gt;self&lt;/span&gt;._zero)&lt;/span&gt;
&lt;span id="cb35-11"&gt;&lt;a aria-hidden="true" href="#cb35-11" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="co"&gt;# 3&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb35-12"&gt;&lt;a aria-hidden="true" href="#cb35-12" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb35-13"&gt;&lt;a aria-hidden="true" href="#cb35-13" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="kw"&gt;def&lt;/span&gt; &lt;span class="fu"&gt;__getitem__&lt;/span&gt;(&lt;span class="va"&gt;self&lt;/span&gt;, key):&lt;/span&gt;
&lt;span id="cb35-14"&gt;&lt;a aria-hidden="true" href="#cb35-14" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="cf"&gt;return&lt;/span&gt; &lt;span class="va"&gt;self&lt;/span&gt;._start &lt;span class="op"&gt;+&lt;/span&gt; i &lt;span class="op"&gt;*&lt;/span&gt; &lt;span class="va"&gt;self&lt;/span&gt;._step&lt;/span&gt;
&lt;span id="cb35-15"&gt;&lt;a aria-hidden="true" href="#cb35-15" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb35-16"&gt;&lt;a aria-hidden="true" href="#cb35-16" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="kw"&gt;def&lt;/span&gt; &lt;span class="fu"&gt;__hash__&lt;/span&gt;(&lt;span class="va"&gt;self&lt;/span&gt;):&lt;/span&gt;
&lt;span id="cb35-17"&gt;&lt;a aria-hidden="true" href="#cb35-17" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="cf"&gt;return&lt;/span&gt; &lt;span class="bu"&gt;hash&lt;/span&gt;((&lt;span class="va"&gt;self&lt;/span&gt;._start, &lt;span class="va"&gt;self&lt;/span&gt;._get_by_index(&lt;span class="op"&gt;-&lt;/span&gt;&lt;span class="dv"&gt;1&lt;/span&gt;), &lt;span class="va"&gt;self&lt;/span&gt;._step))&lt;/span&gt;
&lt;span id="cb35-18"&gt;&lt;a aria-hidden="true" href="#cb35-18" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb35-19"&gt;&lt;a aria-hidden="true" href="#cb35-19" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="kw"&gt;def&lt;/span&gt; &lt;span class="fu"&gt;__len__&lt;/span&gt;(&lt;span class="va"&gt;self&lt;/span&gt;):&lt;/span&gt;
&lt;span id="cb35-20"&gt;&lt;a aria-hidden="true" href="#cb35-20" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="cf"&gt;return&lt;/span&gt; &lt;span class="va"&gt;self&lt;/span&gt;._len&lt;/span&gt;
&lt;span id="cb35-21"&gt;&lt;a aria-hidden="true" href="#cb35-21" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb35-22"&gt;&lt;a aria-hidden="true" href="#cb35-22" tabindex="-1"&gt;&lt;/a&gt;start &lt;span class="op"&gt;=&lt;/span&gt; datetime.datetime(&lt;span class="dv"&gt;2020&lt;/span&gt;, &lt;span class="dv"&gt;2&lt;/span&gt;, &lt;span class="dv"&gt;10&lt;/span&gt;)&lt;/span&gt;
&lt;span id="cb35-23"&gt;&lt;a aria-hidden="true" href="#cb35-23" tabindex="-1"&gt;&lt;/a&gt;stop &lt;span class="op"&gt;=&lt;/span&gt; datetime.datetime(&lt;span class="dv"&gt;2020&lt;/span&gt;, &lt;span class="dv"&gt;2&lt;/span&gt;, &lt;span class="dv"&gt;15&lt;/span&gt;)              &lt;/span&gt;
&lt;span id="cb35-24"&gt;&lt;a aria-hidden="true" href="#cb35-24" tabindex="-1"&gt;&lt;/a&gt;step &lt;span class="op"&gt;=&lt;/span&gt; datetime.timedelta(days&lt;span class="op"&gt;=&lt;/span&gt;&lt;span class="dv"&gt;2&lt;/span&gt;)   &lt;/span&gt;
&lt;span id="cb35-25"&gt;&lt;a aria-hidden="true" href="#cb35-25" tabindex="-1"&gt;&lt;/a&gt;x &lt;span class="op"&gt;=&lt;/span&gt; numeric_range(start, stop, step)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id="过滤器系列"&gt;过滤器系列&lt;/h2&gt;
&lt;h3 id="strip-系列"&gt;Strip 系列&lt;/h3&gt;
&lt;p&gt;像字符串的&lt;code&gt;strip&lt;/code&gt;函数一样，对一个序列进行操作，去除末尾元素。不过接收的是一个函数类型：&lt;/p&gt;
&lt;div class="sourceCode" id="cb36"&gt;&lt;pre class="sourceCode python"&gt;&lt;code class="sourceCode python"&gt;&lt;span id="cb36-1"&gt;&lt;a aria-hidden="true" href="#cb36-1" tabindex="-1"&gt;&lt;/a&gt;iterable &lt;span class="op"&gt;=&lt;/span&gt; (&lt;span class="va"&gt;None&lt;/span&gt;, &lt;span class="va"&gt;False&lt;/span&gt;, &lt;span class="va"&gt;None&lt;/span&gt;, &lt;span class="dv"&gt;1&lt;/span&gt;, &lt;span class="dv"&gt;2&lt;/span&gt;, &lt;span class="va"&gt;None&lt;/span&gt;, &lt;span class="dv"&gt;3&lt;/span&gt;, &lt;span class="va"&gt;False&lt;/span&gt;, &lt;span class="va"&gt;None&lt;/span&gt;)&lt;/span&gt;
&lt;span id="cb36-2"&gt;&lt;a aria-hidden="true" href="#cb36-2" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb36-3"&gt;&lt;a aria-hidden="true" href="#cb36-3" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="co"&gt;# [False, None, 1, 2, None, 3, False]&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb36-4"&gt;&lt;a aria-hidden="true" href="#cb36-4" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="bu"&gt;list&lt;/span&gt;(more_itertools.strip(iterable,&lt;span class="kw"&gt;lambda&lt;/span&gt; x:x &lt;span class="op"&gt;==&lt;/span&gt; &lt;span class="va"&gt;None&lt;/span&gt;))&lt;/span&gt;
&lt;span id="cb36-5"&gt;&lt;a aria-hidden="true" href="#cb36-5" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb36-6"&gt;&lt;a aria-hidden="true" href="#cb36-6" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="co"&gt;# [False, None, 1, 2, None, 3, False, None]&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb36-7"&gt;&lt;a aria-hidden="true" href="#cb36-7" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="bu"&gt;list&lt;/span&gt;(more_itertools.lstrip(iterable,&lt;span class="kw"&gt;lambda&lt;/span&gt; x:x &lt;span class="op"&gt;==&lt;/span&gt; &lt;span class="va"&gt;None&lt;/span&gt;))&lt;/span&gt;
&lt;span id="cb36-8"&gt;&lt;a aria-hidden="true" href="#cb36-8" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb36-9"&gt;&lt;a aria-hidden="true" href="#cb36-9" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="co"&gt;# [None, False, None, 1, 2, None, 3, False]&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb36-10"&gt;&lt;a aria-hidden="true" href="#cb36-10" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="bu"&gt;list&lt;/span&gt;(more_itertools.rstrip(iterable,&lt;span class="kw"&gt;lambda&lt;/span&gt; x:x &lt;span class="op"&gt;==&lt;/span&gt; &lt;span class="va"&gt;None&lt;/span&gt;))&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;code&gt;lstrip&lt;/code&gt;的实现就是一个&lt;code&gt;dropwhile(pred, iterable)&lt;/code&gt;，而&lt;code&gt;rstrip&lt;/code&gt;使用一个列表来处理符合条件的元素：&lt;/p&gt;
&lt;div class="sourceCode" id="cb37"&gt;&lt;pre class="sourceCode python"&gt;&lt;code class="sourceCode python"&gt;&lt;span id="cb37-1"&gt;&lt;a aria-hidden="true" href="#cb37-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;def&lt;/span&gt; rstrip(iterable, pred):&lt;/span&gt;
&lt;span id="cb37-2"&gt;&lt;a aria-hidden="true" href="#cb37-2" tabindex="-1"&gt;&lt;/a&gt;    cache &lt;span class="op"&gt;=&lt;/span&gt; []&lt;/span&gt;
&lt;span id="cb37-3"&gt;&lt;a aria-hidden="true" href="#cb37-3" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="cf"&gt;for&lt;/span&gt; x &lt;span class="kw"&gt;in&lt;/span&gt; iterable:&lt;/span&gt;
&lt;span id="cb37-4"&gt;&lt;a aria-hidden="true" href="#cb37-4" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="cf"&gt;if&lt;/span&gt; pred(x):&lt;/span&gt;
&lt;span id="cb37-5"&gt;&lt;a aria-hidden="true" href="#cb37-5" tabindex="-1"&gt;&lt;/a&gt;            cache.append(x)&lt;/span&gt;
&lt;span id="cb37-6"&gt;&lt;a aria-hidden="true" href="#cb37-6" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="cf"&gt;else&lt;/span&gt;:&lt;/span&gt;
&lt;span id="cb37-7"&gt;&lt;a aria-hidden="true" href="#cb37-7" tabindex="-1"&gt;&lt;/a&gt;            &lt;span class="cf"&gt;yield&lt;/span&gt; &lt;span class="cf"&gt;from&lt;/span&gt; cache&lt;/span&gt;
&lt;span id="cb37-8"&gt;&lt;a aria-hidden="true" href="#cb37-8" tabindex="-1"&gt;&lt;/a&gt;            cache.clear()&lt;/span&gt;
&lt;span id="cb37-9"&gt;&lt;a aria-hidden="true" href="#cb37-9" tabindex="-1"&gt;&lt;/a&gt;            &lt;span class="cf"&gt;yield&lt;/span&gt; x&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id="filter_except"&gt;Filter_except&lt;/h3&gt;
&lt;p&gt;和&lt;code&gt;map_except&lt;/code&gt;类似，不过是一个过滤操作：&lt;/p&gt;
&lt;div class="sourceCode" id="cb38"&gt;&lt;pre class="sourceCode python"&gt;&lt;code class="sourceCode python"&gt;&lt;span id="cb38-1"&gt;&lt;a aria-hidden="true" href="#cb38-1" tabindex="-1"&gt;&lt;/a&gt;data &lt;span class="op"&gt;=&lt;/span&gt; [&lt;span class="st"&gt;'1.5'&lt;/span&gt;, &lt;span class="st"&gt;'6'&lt;/span&gt;, &lt;span class="st"&gt;'not-important'&lt;/span&gt;, &lt;span class="st"&gt;'11'&lt;/span&gt;, &lt;span class="st"&gt;'1.23E-7'&lt;/span&gt;, &lt;span class="st"&gt;'remove-me'&lt;/span&gt;, &lt;span class="st"&gt;'25'&lt;/span&gt;, &lt;span class="st"&gt;'trash'&lt;/span&gt;]&lt;/span&gt;
&lt;span id="cb38-2"&gt;&lt;a aria-hidden="true" href="#cb38-2" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="bu"&gt;list&lt;/span&gt;(&lt;span class="bu"&gt;map&lt;/span&gt;(&lt;span class="bu"&gt;float&lt;/span&gt;, filter_except(&lt;span class="bu"&gt;float&lt;/span&gt;, data, &lt;span class="pp"&gt;TypeError&lt;/span&gt;, &lt;span class="pp"&gt;ValueError&lt;/span&gt;)))&lt;/span&gt;
&lt;span id="cb38-3"&gt;&lt;a aria-hidden="true" href="#cb38-3" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="co"&gt;#  [1.5, 6.0, 11.0, 1.23e-07, 25.0]&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h1 id="参考"&gt;参考&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://more-itertools.readthedocs.io/en/stable/_modules/more_itertools/more.html" title="Source code for more_itertools.more"&gt;more_itertools文档&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://martinheinz.dev/blog/52" title="Functools - The Power of Higher-Order Functions in Python"&gt;functools介绍文章&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://docs.python.org/3/library/itertools.html#itertools-recipes" title="Itertools Recipes"&gt;itertools文档&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;br/&gt;
&lt;!--%%REF%%--&gt;
&lt;br/&gt;
&lt;script async="" crossorigin="anonymous" data-category="Announcements" data-category-id="DIC_kwDOJ7Ymy84CX4eg" data-emit-metadata="0" data-input-position="top" data-lang="zh-CN" data-loading="lazy" data-mapping="title" data-reactions-enabled="1" data-repo="izfsk-ium/izfsk-ium.github.io" data-repo-id="R_kgDOJ7Ymyw" data-strict="0" data-theme="preferred_color_scheme" src="https://giscus.app/client.js"&gt;
&lt;/script&gt;
&lt;/main&gt;
&lt;footer&gt;
&lt;p class="signoff"&gt;
&lt;div class="metadata"&gt;
&lt;p class="date"&gt;&lt;time datetime="2022-12-08"&gt;创建日期：2022-12-08&lt;/time&gt;&lt;/p&gt;
&lt;p class="lastmodify"&gt;&lt;time&gt;最后编译：2023-08-10&lt;/time&gt;&lt;/p&gt;
&lt;p class="lastmodify" id="counter-span"&gt;访问次数：&lt;/p&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;/footer&gt;
&lt;script&gt;
    /* These script should run after page load */
    document.querySelectorAll('code.sourceCode').forEach(
      i =&gt; i.insertAdjacentHTML('beforeend', '&lt;div class="copy"&gt;复制&lt;/div&gt;')
    );
    document.querySelectorAll('div.copy').forEach(
      i =&gt; i.addEventListener(
        'click',
        () =&gt; {
          navigator.clipboard.writeText(i.parentElement.innerText.replace('复制', ''));
          i.innerText = '成功';
          setTimeout(() =&gt; {
            i.innerText = '复制';
          }, 1000);
        }
      )
    );

    if (location.href.includes("127.0.0.1:8080")) {
      document.getElementById("counter-span").innerHTML = "[[development mode]]";
    } else {
      const uuid = document.getElementById("article-uuid").innerText;
      const target = document.getElementById("counter-span");
      const last = localStorage.getItem("lastVisit-" + uuid);
      const shouldIncrease = last === null || new Date().getTime() - parseInt(last) &gt;= (1000 * 60 * 15);

      fetch(shouldIncrease ? ("https://counter.izfsk.top/counter/" + uuid) : ("https://counter.izfsk.top/readOnly/" + uuid))
        .then(r =&gt; r.text())
        .then(d =&gt; {
          if (!d.startsWith("Too"))
            document.getElementById("counter-span").innerText = "访问次数：" + d.toString();
          else
            document.getElementById("counter-span").innerHTML = "";
        });

      localStorage.setItem("lastVisit-" + uuid, new Date().getTime());
    }
  &lt;/script&gt;
&lt;script async="" data-website-id="2a1146ab-fa82-4a84-a04f-30e5967357c3" src="https://analytics.umami.is/script.js"&gt;&lt;/script&gt;
&lt;/body&gt;</content:encoded>
      <guid isPermaLink="false">426704c4-a51f-470c-a9c9-f3e3ecc43bfc</guid>
      <pubDate>Thu, 08 Dec 2022 00:00:00 +0800</pubDate>
    </item>
    <item>
      <title>LRU-Cache与functools</title>
      <link>https://blog.izfsk.top/articles/LRU-Cache与functools.html</link>
      <description>LRU-Cache与functools</description>
      <content:encoded>&lt;body&gt;
&lt;progress id="content_progress" value="0"&gt;&lt;/progress&gt;
&lt;button id="back-to-top"&gt;
    回页顶
  &lt;/button&gt;
&lt;header&gt;
&lt;small id="article-uuid" style="display: none !important;"&gt;809dd759-e6d9-4bb0-8e9b-31e48c7a9366&lt;/small&gt;
&lt;h1 class="title"&gt;LRU-Cache与functools&lt;/h1&gt;
&lt;!-- Subtitle --&gt;
&lt;h3 class="subtitle"&gt; &lt;/h3&gt;
&lt;/header&gt;
&lt;nav id="TOC" role="doc-toc"&gt;
&lt;strong&gt;文章归类: &lt;a href="/pages/category.html#算法"&gt;算法&lt;/a&gt; &lt;/strong&gt;
&lt;input id="contents" type="checkbox"/&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#啥是-lru-cache" id="toc-啥是-lru-cache"&gt;啥是 LRU Cache&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#实现思路" id="toc-实现思路"&gt;实现思路&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#c" id="toc-c"&gt;C++&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#python" id="toc-python"&gt;Python&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#双向链表的模拟" id="toc-双向链表的模拟"&gt;双向链表的模拟&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#collections.deque" id="toc-collections.deque"&gt;collections.deque&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#functools" id="toc-functools"&gt;functools&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#lru_cache" id="toc-lru_cache"&gt;&lt;span class="citation" data-cites="lru_cache"&gt;@lru_cache&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#参见" id="toc-参见"&gt;参见&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#reference"&gt;参考链接&lt;/a&gt;&lt;/li&gt;
&lt;li&gt; &lt;/li&gt;
&lt;li class="tools"&gt;
&lt;span id="backtomain"&gt;
&lt;svg class="bi bi-house" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M8.707 1.5a1 1 0 0 0-1.414 0L.646 8.146a.5.5 0 0 0 .708.708L2 8.207V13.5A1.5 1.5 0 0 0 3.5 15h9a1.5 1.5 0 0 0 1.5-1.5V8.207l.646.647a.5.5 0 0 0 .708-.708L13 5.793V2.5a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v1.293L8.707 1.5ZM13 7.207V13.5a.5.5 0 0 1-.5.5h-9a.5.5 0 0 1-.5-.5V7.207l5-5 5 5Z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="readingmode"&gt;
&lt;svg class="bi bi-book" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M1 2.828c.885-.37 2.154-.769 3.388-.893 1.33-.134 2.458.063 3.112.752v9.746c-.935-.53-2.12-.603-3.213-.493-1.18.12-2.37.461-3.287.811V2.828zm7.5-.141c.654-.689 1.782-.886 3.112-.752 1.234.124 2.503.523 3.388.893v9.923c-.918-.35-2.107-.692-3.287-.81-1.094-.111-2.278-.039-3.213.492V2.687zM8 1.783C7.015.936 5.587.81 4.287.94c-1.514.153-3.042.672-3.994 1.105A.5.5 0 0 0 0 2.5v11a.5.5 0 0 0 .707.455c.882-.4 2.303-.881 3.68-1.02 1.409-.142 2.59.087 3.223.877a.5.5 0 0 0 .78 0c.633-.79 1.814-1.019 3.222-.877 1.378.139 2.8.62 3.681 1.02A.5.5 0 0 0 16 13.5v-11a.5.5 0 0 0-.293-.455c-.952-.433-2.48-.952-3.994-1.105C10.413.809 8.985.936 8 1.783z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="larger"&gt; &lt;/span&gt;
&lt;span id="smaller"&gt;&lt;/span&gt;
&lt;span id="switchfont"&gt;
&lt;svg class="bi bi-fonts" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M12.258 3h-8.51l-.083 2.46h.479c.26-1.544.758-1.783 2.693-1.845l.424-.013v7.827c0 .663-.144.82-1.3.923v.52h4.082v-.52c-1.162-.103-1.306-.26-1.306-.923V3.602l.431.013c1.934.062 2.434.301 2.693 1.846h.479L12.258 3z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="backtotop"&gt;
&lt;svg class="bi bi-arrow-bar-up" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M8 10a.5.5 0 0 0 .5-.5V3.707l2.146 2.147a.5.5 0 0 0 .708-.708l-3-3a.5.5 0 0 0-.708 0l-3 3a.5.5 0 1 0 .708.708L7.5 3.707V9.5a.5.5 0 0 0 .5.5zm-7 2.5a.5.5 0 0 1 .5-.5h13a.5.5 0 0 1 0 1h-13a.5.5 0 0 1-.5-.5z" fill-rule="evenodd"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/nav&gt;
&lt;main&gt;
&lt;h1 id="啥是-lru-cache"&gt;啥是 LRU Cache&lt;/h1&gt;
&lt;p&gt;LRU的全称是 Least recently used，也就是「最近最少使用」，这是一种用来管理缓存的机制。缓存的容量是有限的，不能无限制的放各种数据，通常，在缓存里面放容易命中的常用数据肯定比放冷门的数据好，LRU机制假设一个数据如果在最近一段时间没有被访问，那么它在未来被访问的可能性也比较小。由此，在缓存满了以后，就通过淘汰最近没有用过的数据项来更新。&lt;/p&gt;
&lt;h1 id="实现思路"&gt;实现思路&lt;/h1&gt;
&lt;p&gt;先陈述一下思路，目标是实现一个 &lt;code&gt;LRUCache&lt;/code&gt; 类，可以参照 &lt;a href="https://leetcode.com/problems/lru-cache/"&gt;leetcode&lt;/a&gt; 上的题目来做。&lt;/p&gt;
&lt;p&gt;实现一个朴素的 lru cache 需要两个容器，一个双向链表 (item) 用来保存数据权重，一个哈希表 (key:item) 用来保存实际的数据，和链表相互配合。除此以外还需要一个缓存最大大小。保存实际数据的是一个类似于 pair 的结构 LRU_Item ，使用 &lt;code&gt;decltype&lt;/code&gt; 来推导类型。&lt;/p&gt;
&lt;div class="sourceCode" id="cb1"&gt;&lt;pre class="sourceCode cpp"&gt;&lt;code class="sourceCode cpp"&gt;&lt;span id="cb1-1"&gt;&lt;a aria-hidden="true" href="#cb1-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="co"&gt;// 大小&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-2"&gt;&lt;a aria-hidden="true" href="#cb1-2" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="at"&gt;const&lt;/span&gt; &lt;span class="dt"&gt;long&lt;/span&gt; capacity&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-3"&gt;&lt;a aria-hidden="true" href="#cb1-3" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="co"&gt;// 保存权重&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-4"&gt;&lt;a aria-hidden="true" href="#cb1-4" tabindex="-1"&gt;&lt;/a&gt;list&lt;span class="op"&gt;&amp;lt;&lt;/span&gt;LRU_Item&lt;span class="op"&gt;&amp;lt;&lt;/span&gt;Key_T&lt;span class="op"&gt;,&lt;/span&gt; Val_T&lt;span class="op"&gt;&amp;gt;&amp;gt;&lt;/span&gt; items&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-5"&gt;&lt;a aria-hidden="true" href="#cb1-5" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="co"&gt;// 保存实际数据，真实数据是LRU_Item类型中的Val_T的类型&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-6"&gt;&lt;a aria-hidden="true" href="#cb1-6" tabindex="-1"&gt;&lt;/a&gt;unordered_map&lt;span class="op"&gt;&amp;lt;&lt;/span&gt;Key_T&lt;span class="op"&gt;,&lt;/span&gt; &lt;span class="kw"&gt;decltype&lt;/span&gt;&lt;span class="op"&gt;(&lt;/span&gt;items&lt;span class="op"&gt;.&lt;/span&gt;begin&lt;span class="op"&gt;())&amp;gt;&lt;/span&gt; items_map&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;当访问一个数据项时，从哈希表中寻找目标，如果找不到，返回这个模板类型的默认值，否则就命中缓存项目，&lt;strong&gt;之后，更新权重表&lt;/strong&gt;，将目标 key 提到列表的最前面即将该数据移至链表头部。当插入一个数据项目时，如果已经存在项目 key ，删除旧项目，之后作为最新的项目在链表的最前面插入，再检查缓存大小，将多余的项目排除。虽然使用一个定长的双向链表也能实现，但使用哈希表降低了操作的复杂度。&lt;/p&gt;
&lt;p&gt;举例：假设有一个 Cache ，其容量为2，首先插入一条数据 &lt;code&gt;(k=1,v=1)&lt;/code&gt; :&lt;/p&gt;
&lt;p&gt;&lt;code&gt;{ (1:1) }&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;接下来插入一条数据 &lt;code&gt;(k=2,v=2)&lt;/code&gt; :&lt;/p&gt;
&lt;p&gt;&lt;code&gt;[ (2:2) (1:1) ]&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;接下来获取 &lt;code&gt;key=1&lt;/code&gt; ，则返回结果后缓存内容变为：&lt;/p&gt;
&lt;p&gt;&lt;code&gt;[ (1:1) (2:2) ]&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;可以看到 &lt;code&gt;(1:1)&lt;/code&gt; 被提到了最前面。如果在这时再次插入一个 &lt;code&gt;(k=3,v=3)&lt;/code&gt; ，由于容量为2，最不常用的也就是处于列表最末尾的元素被移除，新的元素插入开头:&lt;/p&gt;
&lt;p&gt;&lt;code&gt;[ (3:3) (1:1) ]&lt;/code&gt;&lt;/p&gt;
&lt;h2 id="c"&gt;C++&lt;/h2&gt;
&lt;p&gt;以下是 C++ 实现的 LRU-Cache 类：&lt;/p&gt;
&lt;div class="sourceCode" id="cb2"&gt;&lt;pre class="sourceCode cpp"&gt;&lt;code class="sourceCode cpp"&gt;&lt;span id="cb2-1"&gt;&lt;a aria-hidden="true" href="#cb2-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="pp"&gt;#include &lt;/span&gt;&lt;span class="im"&gt;&amp;lt;unordered_map&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-2"&gt;&lt;a aria-hidden="true" href="#cb2-2" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="pp"&gt;#include &lt;/span&gt;&lt;span class="im"&gt;&amp;lt;list&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-3"&gt;&lt;a aria-hidden="true" href="#cb2-3" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb2-4"&gt;&lt;a aria-hidden="true" href="#cb2-4" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;using&lt;/span&gt; &lt;span class="kw"&gt;namespace&lt;/span&gt; std&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-5"&gt;&lt;a aria-hidden="true" href="#cb2-5" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb2-6"&gt;&lt;a aria-hidden="true" href="#cb2-6" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;template&lt;/span&gt; &lt;span class="op"&gt;&amp;lt;&lt;/span&gt;&lt;span class="kw"&gt;typename&lt;/span&gt; KT&lt;span class="op"&gt;,&lt;/span&gt; &lt;span class="kw"&gt;typename&lt;/span&gt; VT&lt;span class="op"&gt;&amp;gt;&lt;/span&gt; &lt;span class="kw"&gt;struct&lt;/span&gt; LRU_Item &lt;span class="op"&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-7"&gt;&lt;a aria-hidden="true" href="#cb2-7" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="kw"&gt;public&lt;/span&gt;&lt;span class="op"&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-8"&gt;&lt;a aria-hidden="true" href="#cb2-8" tabindex="-1"&gt;&lt;/a&gt;        KT key&lt;span class="op"&gt;;&lt;/span&gt; VT value&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-9"&gt;&lt;a aria-hidden="true" href="#cb2-9" tabindex="-1"&gt;&lt;/a&gt;        LRU_Item&lt;span class="op"&gt;(&lt;/span&gt;KT key&lt;span class="op"&gt;,&lt;/span&gt;VT value&lt;span class="op"&gt;):&lt;/span&gt;key&lt;span class="op"&gt;(&lt;/span&gt;key&lt;span class="op"&gt;),&lt;/span&gt;value&lt;span class="op"&gt;(&lt;/span&gt;value&lt;span class="op"&gt;)&lt;/span&gt; &lt;span class="op"&gt;{&lt;/span&gt; &lt;span class="op"&gt;;&lt;/span&gt; &lt;span class="op"&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-10"&gt;&lt;a aria-hidden="true" href="#cb2-10" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="op"&gt;};&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-11"&gt;&lt;a aria-hidden="true" href="#cb2-11" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb2-12"&gt;&lt;a aria-hidden="true" href="#cb2-12" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;template&lt;/span&gt; &lt;span class="op"&gt;&amp;lt;&lt;/span&gt;&lt;span class="kw"&gt;typename&lt;/span&gt; Key_T&lt;span class="op"&gt;,&lt;/span&gt; &lt;span class="kw"&gt;typename&lt;/span&gt; Val_T&lt;span class="op"&gt;&amp;gt;&lt;/span&gt; &lt;span class="kw"&gt;class&lt;/span&gt; LRU_Cache &lt;span class="op"&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-13"&gt;&lt;a aria-hidden="true" href="#cb2-13" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="kw"&gt;public&lt;/span&gt;&lt;span class="op"&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-14"&gt;&lt;a aria-hidden="true" href="#cb2-14" tabindex="-1"&gt;&lt;/a&gt;        LRU_Cache&lt;span class="op"&gt;(&lt;/span&gt;&lt;span class="dt"&gt;int&lt;/span&gt; capacity&lt;span class="op"&gt;):&lt;/span&gt;capacity&lt;span class="op"&gt;(&lt;/span&gt;capacity&lt;span class="op"&gt;)&lt;/span&gt; &lt;span class="op"&gt;{&lt;/span&gt; &lt;span class="op"&gt;;&lt;/span&gt; &lt;span class="op"&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-15"&gt;&lt;a aria-hidden="true" href="#cb2-15" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="dt"&gt;void&lt;/span&gt; putItem&lt;span class="op"&gt;(&lt;/span&gt;&lt;span class="at"&gt;const&lt;/span&gt; Key_T &lt;span class="op"&gt;&amp;amp;&lt;/span&gt;key&lt;span class="op"&gt;,&lt;/span&gt; &lt;span class="at"&gt;const&lt;/span&gt; Val_T &lt;span class="op"&gt;&amp;amp;&lt;/span&gt;value&lt;span class="op"&gt;);&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-16"&gt;&lt;a aria-hidden="true" href="#cb2-16" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="at"&gt;const&lt;/span&gt; Val_T getItem&lt;span class="op"&gt;(&lt;/span&gt;&lt;span class="at"&gt;const&lt;/span&gt; Key_T &lt;span class="op"&gt;&amp;amp;&lt;/span&gt;key&lt;span class="op"&gt;);&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-17"&gt;&lt;a aria-hidden="true" href="#cb2-17" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="kw"&gt;private&lt;/span&gt;&lt;span class="op"&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-18"&gt;&lt;a aria-hidden="true" href="#cb2-18" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="at"&gt;const&lt;/span&gt; &lt;span class="dt"&gt;long&lt;/span&gt; capacity&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-19"&gt;&lt;a aria-hidden="true" href="#cb2-19" tabindex="-1"&gt;&lt;/a&gt;        list&lt;span class="op"&gt;&amp;lt;&lt;/span&gt;LRU_Item&lt;span class="op"&gt;&amp;lt;&lt;/span&gt;Key_T&lt;span class="op"&gt;,&lt;/span&gt; Val_T&lt;span class="op"&gt;&amp;gt;&amp;gt;&lt;/span&gt; items&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-20"&gt;&lt;a aria-hidden="true" href="#cb2-20" tabindex="-1"&gt;&lt;/a&gt;        unordered_map&lt;span class="op"&gt;&amp;lt;&lt;/span&gt;Key_T&lt;span class="op"&gt;,&lt;/span&gt; &lt;span class="kw"&gt;decltype&lt;/span&gt;&lt;span class="op"&gt;(&lt;/span&gt;items&lt;span class="op"&gt;.&lt;/span&gt;begin&lt;span class="op"&gt;())&amp;gt;&lt;/span&gt; items_map&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-21"&gt;&lt;a aria-hidden="true" href="#cb2-21" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="op"&gt;};&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-22"&gt;&lt;a aria-hidden="true" href="#cb2-22" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb2-23"&gt;&lt;a aria-hidden="true" href="#cb2-23" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;template&lt;/span&gt; &lt;span class="op"&gt;&amp;lt;&lt;/span&gt;&lt;span class="kw"&gt;typename&lt;/span&gt; Key_T&lt;span class="op"&gt;,&lt;/span&gt; &lt;span class="kw"&gt;typename&lt;/span&gt; Val_T&lt;span class="op"&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-24"&gt;&lt;a aria-hidden="true" href="#cb2-24" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="dt"&gt;void&lt;/span&gt; LRU_Cache&lt;span class="op"&gt;&amp;lt;&lt;/span&gt;Key_T&lt;span class="op"&gt;,&lt;/span&gt; Val_T&lt;span class="op"&gt;&amp;gt;::&lt;/span&gt;putItem&lt;span class="op"&gt;(&lt;/span&gt;&lt;span class="at"&gt;const&lt;/span&gt; Key_T &lt;span class="op"&gt;&amp;amp;&lt;/span&gt;key&lt;span class="op"&gt;,&lt;/span&gt; &lt;span class="at"&gt;const&lt;/span&gt; Val_T &lt;span class="op"&gt;&amp;amp;&lt;/span&gt;value&lt;span class="op"&gt;){&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-25"&gt;&lt;a aria-hidden="true" href="#cb2-25" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="kw"&gt;auto&lt;/span&gt; iter &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="kw"&gt;this&lt;/span&gt;&lt;span class="op"&gt;-&amp;gt;&lt;/span&gt;items_map&lt;span class="op"&gt;.&lt;/span&gt;find&lt;span class="op"&gt;(&lt;/span&gt;key&lt;span class="op"&gt;);&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-26"&gt;&lt;a aria-hidden="true" href="#cb2-26" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="cf"&gt;if&lt;/span&gt; &lt;span class="op"&gt;(&lt;/span&gt;iter &lt;span class="op"&gt;!=&lt;/span&gt; &lt;span class="kw"&gt;this&lt;/span&gt;&lt;span class="op"&gt;-&amp;gt;&lt;/span&gt;items_map&lt;span class="op"&gt;.&lt;/span&gt;end&lt;span class="op"&gt;()){&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-27"&gt;&lt;a aria-hidden="true" href="#cb2-27" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="co"&gt;// delete exists item and insert in front of list&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-28"&gt;&lt;a aria-hidden="true" href="#cb2-28" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="kw"&gt;this&lt;/span&gt;&lt;span class="op"&gt;-&amp;gt;&lt;/span&gt;items&lt;span class="op"&gt;.&lt;/span&gt;erase&lt;span class="op"&gt;(&lt;/span&gt;iter&lt;span class="op"&gt;-&amp;gt;&lt;/span&gt;second&lt;span class="op"&gt;);&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-29"&gt;&lt;a aria-hidden="true" href="#cb2-29" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="kw"&gt;this&lt;/span&gt;&lt;span class="op"&gt;-&amp;gt;&lt;/span&gt;items_map&lt;span class="op"&gt;.&lt;/span&gt;erase&lt;span class="op"&gt;(&lt;/span&gt;iter&lt;span class="op"&gt;);&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-30"&gt;&lt;a aria-hidden="true" href="#cb2-30" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="op"&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-31"&gt;&lt;a aria-hidden="true" href="#cb2-31" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="co"&gt;// insert element in front of the list&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-32"&gt;&lt;a aria-hidden="true" href="#cb2-32" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="kw"&gt;auto&lt;/span&gt; element &lt;span class="op"&gt;=&lt;/span&gt; LRU_Item&lt;span class="op"&gt;&amp;lt;&lt;/span&gt;Key_T&lt;span class="op"&gt;,&lt;/span&gt;Val_T&lt;span class="op"&gt;&amp;gt;(&lt;/span&gt;key&lt;span class="op"&gt;,&lt;/span&gt;value&lt;span class="op"&gt;);&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-33"&gt;&lt;a aria-hidden="true" href="#cb2-33" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="kw"&gt;this&lt;/span&gt;&lt;span class="op"&gt;-&amp;gt;&lt;/span&gt;items&lt;span class="op"&gt;.&lt;/span&gt;push_front&lt;span class="op"&gt;(&lt;/span&gt;element&lt;span class="op"&gt;);&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-34"&gt;&lt;a aria-hidden="true" href="#cb2-34" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="co"&gt;// store it into map&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-35"&gt;&lt;a aria-hidden="true" href="#cb2-35" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="kw"&gt;this&lt;/span&gt;&lt;span class="op"&gt;-&amp;gt;&lt;/span&gt;items_map&lt;span class="op"&gt;.&lt;/span&gt;insert&lt;span class="op"&gt;(&lt;/span&gt;make_pair&lt;span class="op"&gt;(&lt;/span&gt;key&lt;span class="op"&gt;,&lt;/span&gt; &lt;span class="kw"&gt;this&lt;/span&gt;&lt;span class="op"&gt;-&amp;gt;&lt;/span&gt;items&lt;span class="op"&gt;.&lt;/span&gt;begin&lt;span class="op"&gt;()));&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-36"&gt;&lt;a aria-hidden="true" href="#cb2-36" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="co"&gt;// check size and strip&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-37"&gt;&lt;a aria-hidden="true" href="#cb2-37" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="cf"&gt;for&lt;/span&gt; &lt;span class="op"&gt;(&lt;/span&gt;&lt;span class="dt"&gt;int&lt;/span&gt; i &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="kw"&gt;this&lt;/span&gt;&lt;span class="op"&gt;-&amp;gt;&lt;/span&gt;items_map&lt;span class="op"&gt;.&lt;/span&gt;size&lt;span class="op"&gt;()&lt;/span&gt; &lt;span class="op"&gt;-&lt;/span&gt; &lt;span class="kw"&gt;this&lt;/span&gt;&lt;span class="op"&gt;-&amp;gt;&lt;/span&gt;capacity &lt;span class="op"&gt;;&lt;/span&gt; i &lt;span class="op"&gt;&amp;gt;&lt;/span&gt; &lt;span class="dv"&gt;0&lt;/span&gt;&lt;span class="op"&gt;;&lt;/span&gt; i&lt;span class="op"&gt;--){&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-38"&gt;&lt;a aria-hidden="true" href="#cb2-38" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="kw"&gt;auto&lt;/span&gt; iter &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="kw"&gt;this&lt;/span&gt;&lt;span class="op"&gt;-&amp;gt;&lt;/span&gt;items&lt;span class="op"&gt;.&lt;/span&gt;end&lt;span class="op"&gt;();&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-39"&gt;&lt;a aria-hidden="true" href="#cb2-39" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="kw"&gt;this&lt;/span&gt;&lt;span class="op"&gt;-&amp;gt;&lt;/span&gt;items_map&lt;span class="op"&gt;.&lt;/span&gt;erase&lt;span class="op"&gt;((--&lt;/span&gt;iter&lt;span class="op"&gt;)-&amp;gt;&lt;/span&gt;key&lt;span class="op"&gt;);&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-40"&gt;&lt;a aria-hidden="true" href="#cb2-40" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="kw"&gt;this&lt;/span&gt;&lt;span class="op"&gt;-&amp;gt;&lt;/span&gt;items&lt;span class="op"&gt;.&lt;/span&gt;pop_back&lt;span class="op"&gt;();&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-41"&gt;&lt;a aria-hidden="true" href="#cb2-41" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="op"&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-42"&gt;&lt;a aria-hidden="true" href="#cb2-42" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="op"&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-43"&gt;&lt;a aria-hidden="true" href="#cb2-43" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb2-44"&gt;&lt;a aria-hidden="true" href="#cb2-44" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;template&lt;/span&gt; &lt;span class="op"&gt;&amp;lt;&lt;/span&gt;&lt;span class="kw"&gt;typename&lt;/span&gt; T&lt;span class="op"&gt;&amp;gt;&lt;/span&gt; &lt;span class="kw"&gt;struct&lt;/span&gt; I &lt;span class="op"&gt;{&lt;/span&gt; T _&lt;span class="op"&gt;;&lt;/span&gt; I&lt;span class="op"&gt;():&lt;/span&gt;_&lt;span class="op"&gt;()&lt;/span&gt; &lt;span class="op"&gt;{&lt;/span&gt; &lt;span class="op"&gt;;&lt;/span&gt; &lt;span class="op"&gt;}&lt;/span&gt; &lt;span class="op"&gt;};&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-45"&gt;&lt;a aria-hidden="true" href="#cb2-45" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb2-46"&gt;&lt;a aria-hidden="true" href="#cb2-46" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;template&lt;/span&gt; &lt;span class="op"&gt;&amp;lt;&lt;/span&gt;&lt;span class="kw"&gt;typename&lt;/span&gt; Key_T&lt;span class="op"&gt;,&lt;/span&gt; &lt;span class="kw"&gt;typename&lt;/span&gt; Val_T&lt;span class="op"&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-47"&gt;&lt;a aria-hidden="true" href="#cb2-47" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="at"&gt;const&lt;/span&gt; Val_T LRU_Cache&lt;span class="op"&gt;&amp;lt;&lt;/span&gt;Key_T&lt;span class="op"&gt;,&lt;/span&gt; Val_T&lt;span class="op"&gt;&amp;gt;::&lt;/span&gt;getItem&lt;span class="op"&gt;(&lt;/span&gt;&lt;span class="at"&gt;const&lt;/span&gt; Key_T &lt;span class="op"&gt;&amp;amp;&lt;/span&gt;key&lt;span class="op"&gt;){&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-48"&gt;&lt;a aria-hidden="true" href="#cb2-48" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="kw"&gt;auto&lt;/span&gt; iter &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="kw"&gt;this&lt;/span&gt;&lt;span class="op"&gt;-&amp;gt;&lt;/span&gt;items_map&lt;span class="op"&gt;.&lt;/span&gt;find&lt;span class="op"&gt;(&lt;/span&gt;key&lt;span class="op"&gt;);&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-49"&gt;&lt;a aria-hidden="true" href="#cb2-49" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="cf"&gt;if&lt;/span&gt; &lt;span class="op"&gt;(&lt;/span&gt;iter &lt;span class="op"&gt;==&lt;/span&gt;  &lt;span class="kw"&gt;this&lt;/span&gt;&lt;span class="op"&gt;-&amp;gt;&lt;/span&gt;items_map&lt;span class="op"&gt;.&lt;/span&gt;end&lt;span class="op"&gt;()){&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-50"&gt;&lt;a aria-hidden="true" href="#cb2-50" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="co"&gt;// not found, return default value&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-51"&gt;&lt;a aria-hidden="true" href="#cb2-51" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="cf"&gt;return&lt;/span&gt; &lt;span class="op"&gt;(&lt;/span&gt;&lt;span class="kw"&gt;new&lt;/span&gt; I&lt;span class="op"&gt;&amp;lt;&lt;/span&gt;Val_T&lt;span class="op"&gt;&amp;gt;())-&amp;gt;&lt;/span&gt;_&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-52"&gt;&lt;a aria-hidden="true" href="#cb2-52" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="op"&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-53"&gt;&lt;a aria-hidden="true" href="#cb2-53" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="co"&gt;// update list, put iter to the first&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-54"&gt;&lt;a aria-hidden="true" href="#cb2-54" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="kw"&gt;this&lt;/span&gt;&lt;span class="op"&gt;-&amp;gt;&lt;/span&gt;items&lt;span class="op"&gt;.&lt;/span&gt;splice&lt;span class="op"&gt;(&lt;/span&gt;&lt;span class="kw"&gt;this&lt;/span&gt;&lt;span class="op"&gt;-&amp;gt;&lt;/span&gt;items&lt;span class="op"&gt;.&lt;/span&gt;begin&lt;span class="op"&gt;(),&lt;/span&gt; &lt;span class="kw"&gt;this&lt;/span&gt;&lt;span class="op"&gt;-&amp;gt;&lt;/span&gt;items&lt;span class="op"&gt;,&lt;/span&gt; iter&lt;span class="op"&gt;-&amp;gt;&lt;/span&gt;second&lt;span class="op"&gt;);&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-55"&gt;&lt;a aria-hidden="true" href="#cb2-55" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="cf"&gt;return&lt;/span&gt; iter&lt;span class="op"&gt;-&amp;gt;&lt;/span&gt;second&lt;span class="op"&gt;-&amp;gt;&lt;/span&gt;value&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-56"&gt;&lt;a aria-hidden="true" href="#cb2-56" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="op"&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;测试用例（采取 leetcode 的测试代码）：&lt;/p&gt;
&lt;div class="sourceCode" id="cb3"&gt;&lt;pre class="sourceCode cpp"&gt;&lt;code class="sourceCode cpp"&gt;&lt;span id="cb3-1"&gt;&lt;a aria-hidden="true" href="#cb3-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="dt"&gt;int&lt;/span&gt; main&lt;span class="op"&gt;(&lt;/span&gt;&lt;span class="dt"&gt;int&lt;/span&gt; argc&lt;span class="op"&gt;,&lt;/span&gt; &lt;span class="dt"&gt;char&lt;/span&gt; &lt;span class="op"&gt;**&lt;/span&gt;argv&lt;span class="op"&gt;){&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb3-2"&gt;&lt;a aria-hidden="true" href="#cb3-2" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="kw"&gt;auto&lt;/span&gt; lRUCache &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="kw"&gt;new&lt;/span&gt; LRU_Cache&lt;span class="op"&gt;&amp;lt;&lt;/span&gt;&lt;span class="dt"&gt;int&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt;&lt;span class="dt"&gt;int&lt;/span&gt;&lt;span class="op"&gt;&amp;gt;(&lt;/span&gt;&lt;span class="dv"&gt;2&lt;/span&gt;&lt;span class="op"&gt;);&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb3-3"&gt;&lt;a aria-hidden="true" href="#cb3-3" tabindex="-1"&gt;&lt;/a&gt;    lRUCache&lt;span class="op"&gt;-&amp;gt;&lt;/span&gt;putItem&lt;span class="op"&gt;(&lt;/span&gt;&lt;span class="dv"&gt;1&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt; &lt;span class="dv"&gt;1&lt;/span&gt;&lt;span class="op"&gt;);&lt;/span&gt; &lt;span class="co"&gt;// cache is {1=1}&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb3-4"&gt;&lt;a aria-hidden="true" href="#cb3-4" tabindex="-1"&gt;&lt;/a&gt;    lRUCache&lt;span class="op"&gt;-&amp;gt;&lt;/span&gt;putItem&lt;span class="op"&gt;(&lt;/span&gt;&lt;span class="dv"&gt;2&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt; &lt;span class="dv"&gt;2&lt;/span&gt;&lt;span class="op"&gt;);&lt;/span&gt; &lt;span class="co"&gt;// cache is {1=1, 2=2}&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb3-5"&gt;&lt;a aria-hidden="true" href="#cb3-5" tabindex="-1"&gt;&lt;/a&gt;    cout &lt;span class="op"&gt;&amp;lt;&amp;lt;&lt;/span&gt; lRUCache&lt;span class="op"&gt;-&amp;gt;&lt;/span&gt;getItem&lt;span class="op"&gt;(&lt;/span&gt;&lt;span class="dv"&gt;1&lt;/span&gt;&lt;span class="op"&gt;)&lt;/span&gt; &lt;span class="op"&gt;&amp;lt;&amp;lt;&lt;/span&gt; endl&lt;span class="op"&gt;;&lt;/span&gt;    &lt;span class="co"&gt;// return 1&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb3-6"&gt;&lt;a aria-hidden="true" href="#cb3-6" tabindex="-1"&gt;&lt;/a&gt;    lRUCache&lt;span class="op"&gt;-&amp;gt;&lt;/span&gt;putItem&lt;span class="op"&gt;(&lt;/span&gt;&lt;span class="dv"&gt;3&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt; &lt;span class="dv"&gt;3&lt;/span&gt;&lt;span class="op"&gt;);&lt;/span&gt; &lt;span class="co"&gt;// LRU key was 2, evicts key 2, cache is {1=1, 3=3}&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb3-7"&gt;&lt;a aria-hidden="true" href="#cb3-7" tabindex="-1"&gt;&lt;/a&gt;    cout &lt;span class="op"&gt;&amp;lt;&amp;lt;&lt;/span&gt; lRUCache&lt;span class="op"&gt;-&amp;gt;&lt;/span&gt;getItem&lt;span class="op"&gt;(&lt;/span&gt;&lt;span class="dv"&gt;2&lt;/span&gt;&lt;span class="op"&gt;)&lt;/span&gt; &lt;span class="op"&gt;&amp;lt;&amp;lt;&lt;/span&gt; endl&lt;span class="op"&gt;;&lt;/span&gt;    &lt;span class="co"&gt;// returns 0 (not found)&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb3-8"&gt;&lt;a aria-hidden="true" href="#cb3-8" tabindex="-1"&gt;&lt;/a&gt;    lRUCache&lt;span class="op"&gt;-&amp;gt;&lt;/span&gt;putItem&lt;span class="op"&gt;(&lt;/span&gt;&lt;span class="dv"&gt;4&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt; &lt;span class="dv"&gt;4&lt;/span&gt;&lt;span class="op"&gt;);&lt;/span&gt; &lt;span class="co"&gt;// LRU key was 1, evicts key 1, cache is {4=4, 3=3}&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb3-9"&gt;&lt;a aria-hidden="true" href="#cb3-9" tabindex="-1"&gt;&lt;/a&gt;    cout &lt;span class="op"&gt;&amp;lt;&amp;lt;&lt;/span&gt; lRUCache&lt;span class="op"&gt;-&amp;gt;&lt;/span&gt;getItem&lt;span class="op"&gt;(&lt;/span&gt;&lt;span class="dv"&gt;1&lt;/span&gt;&lt;span class="op"&gt;)&lt;/span&gt; &lt;span class="op"&gt;&amp;lt;&amp;lt;&lt;/span&gt; endl&lt;span class="op"&gt;;&lt;/span&gt;    &lt;span class="co"&gt;// return 0 (not found)&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb3-10"&gt;&lt;a aria-hidden="true" href="#cb3-10" tabindex="-1"&gt;&lt;/a&gt;    cout &lt;span class="op"&gt;&amp;lt;&amp;lt;&lt;/span&gt; lRUCache&lt;span class="op"&gt;-&amp;gt;&lt;/span&gt;getItem&lt;span class="op"&gt;(&lt;/span&gt;&lt;span class="dv"&gt;3&lt;/span&gt;&lt;span class="op"&gt;)&lt;/span&gt; &lt;span class="op"&gt;&amp;lt;&amp;lt;&lt;/span&gt; endl&lt;span class="op"&gt;;&lt;/span&gt;    &lt;span class="co"&gt;// return 3&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb3-11"&gt;&lt;a aria-hidden="true" href="#cb3-11" tabindex="-1"&gt;&lt;/a&gt;    cout &lt;span class="op"&gt;&amp;lt;&amp;lt;&lt;/span&gt; lRUCache&lt;span class="op"&gt;-&amp;gt;&lt;/span&gt;getItem&lt;span class="op"&gt;(&lt;/span&gt;&lt;span class="dv"&gt;4&lt;/span&gt;&lt;span class="op"&gt;)&lt;/span&gt; &lt;span class="op"&gt;&amp;lt;&amp;lt;&lt;/span&gt; endl&lt;span class="op"&gt;;&lt;/span&gt;    &lt;span class="co"&gt;// return 4&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb3-12"&gt;&lt;a aria-hidden="true" href="#cb3-12" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="op"&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;请注意，这里的代码&lt;strong&gt;并不一定是最佳的解答，效率和性能也不一定最好&lt;/strong&gt;，但求清晰。&lt;/p&gt;
&lt;h2 id="python"&gt;Python&lt;/h2&gt;
&lt;h3 id="双向链表的模拟"&gt;双向链表的模拟&lt;/h3&gt;
&lt;p&gt;当然也可以采用 Python 实现。使用一个 list 和一个 dict 可以轻松的完成任务，但为了和设计一致，在这里使用 python 的列表来模拟循环双向链表(这也是 &lt;code&gt;Lib/functools.py&lt;/code&gt; 的实现方式)。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;不得不吐槽，你必须把自己的思想扭曲到一定程度才能熟练而自然的在 python 里面模拟指针类型和循环双向链表&lt;/strong&gt;，以下是一个实现：&lt;/p&gt;
&lt;div class="sourceCode" id="cb4"&gt;&lt;pre class="sourceCode python"&gt;&lt;code class="sourceCode python"&gt;&lt;span id="cb4-1"&gt;&lt;a aria-hidden="true" href="#cb4-1" tabindex="-1"&gt;&lt;/a&gt;PREV, NEXT, VALUE &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="dv"&gt;0&lt;/span&gt;, &lt;span class="dv"&gt;1&lt;/span&gt;, &lt;span class="dv"&gt;2&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb4-2"&gt;&lt;a aria-hidden="true" href="#cb4-2" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb4-3"&gt;&lt;a aria-hidden="true" href="#cb4-3" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;class&lt;/span&gt; CircularDoublyLinkedList:&lt;/span&gt;
&lt;span id="cb4-4"&gt;&lt;a aria-hidden="true" href="#cb4-4" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="kw"&gt;def&lt;/span&gt; &lt;span class="fu"&gt;__init__&lt;/span&gt;(&lt;span class="va"&gt;self&lt;/span&gt;) &lt;span class="op"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="va"&gt;None&lt;/span&gt;:&lt;/span&gt;
&lt;span id="cb4-5"&gt;&lt;a aria-hidden="true" href="#cb4-5" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="va"&gt;self&lt;/span&gt;.length &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="dv"&gt;0&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb4-6"&gt;&lt;a aria-hidden="true" href="#cb4-6" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="va"&gt;self&lt;/span&gt;.root &lt;span class="op"&gt;=&lt;/span&gt; [] &lt;/span&gt;
&lt;span id="cb4-7"&gt;&lt;a aria-hidden="true" href="#cb4-7" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="va"&gt;self&lt;/span&gt;.root[:] &lt;span class="op"&gt;=&lt;/span&gt; [&lt;span class="va"&gt;self&lt;/span&gt;.root, &lt;span class="va"&gt;self&lt;/span&gt;.root, &lt;span class="va"&gt;None&lt;/span&gt;] &lt;/span&gt;
&lt;span id="cb4-8"&gt;&lt;a aria-hidden="true" href="#cb4-8" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="co"&gt;# PREV, NEXT, VALUE&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb4-9"&gt;&lt;a aria-hidden="true" href="#cb4-9" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb4-10"&gt;&lt;a aria-hidden="true" href="#cb4-10" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="kw"&gt;def&lt;/span&gt; insert(&lt;span class="va"&gt;self&lt;/span&gt;, value):&lt;/span&gt;
&lt;span id="cb4-11"&gt;&lt;a aria-hidden="true" href="#cb4-11" tabindex="-1"&gt;&lt;/a&gt;        newNode &lt;span class="op"&gt;=&lt;/span&gt; [&lt;span class="va"&gt;None&lt;/span&gt;, &lt;span class="va"&gt;None&lt;/span&gt;, value]&lt;/span&gt;
&lt;span id="cb4-12"&gt;&lt;a aria-hidden="true" href="#cb4-12" tabindex="-1"&gt;&lt;/a&gt;        last &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="va"&gt;self&lt;/span&gt;.root[PREV]&lt;/span&gt;
&lt;span id="cb4-13"&gt;&lt;a aria-hidden="true" href="#cb4-13" tabindex="-1"&gt;&lt;/a&gt;        newNode[PREV] &lt;span class="op"&gt;=&lt;/span&gt; last&lt;/span&gt;
&lt;span id="cb4-14"&gt;&lt;a aria-hidden="true" href="#cb4-14" tabindex="-1"&gt;&lt;/a&gt;        newNode[NEXT] &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="va"&gt;self&lt;/span&gt;.root&lt;/span&gt;
&lt;span id="cb4-15"&gt;&lt;a aria-hidden="true" href="#cb4-15" tabindex="-1"&gt;&lt;/a&gt;        last[NEXT] &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="va"&gt;self&lt;/span&gt;.root[PREV] &lt;span class="op"&gt;=&lt;/span&gt; newNode&lt;/span&gt;
&lt;span id="cb4-16"&gt;&lt;a aria-hidden="true" href="#cb4-16" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="va"&gt;self&lt;/span&gt;.length &lt;span class="op"&gt;+=&lt;/span&gt; &lt;span class="dv"&gt;1&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb4-17"&gt;&lt;a aria-hidden="true" href="#cb4-17" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb4-18"&gt;&lt;a aria-hidden="true" href="#cb4-18" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="kw"&gt;def&lt;/span&gt; getNode(&lt;span class="va"&gt;self&lt;/span&gt;, index):&lt;/span&gt;
&lt;span id="cb4-19"&gt;&lt;a aria-hidden="true" href="#cb4-19" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="cf"&gt;if&lt;/span&gt; index &lt;span class="op"&gt;&amp;lt;&lt;/span&gt; &lt;span class="dv"&gt;0&lt;/span&gt; &lt;span class="kw"&gt;or&lt;/span&gt; index &lt;span class="op"&gt;&amp;gt;&lt;/span&gt; &lt;span class="va"&gt;self&lt;/span&gt;.length:&lt;/span&gt;
&lt;span id="cb4-20"&gt;&lt;a aria-hidden="true" href="#cb4-20" tabindex="-1"&gt;&lt;/a&gt;            &lt;span class="cf"&gt;raise&lt;/span&gt; &lt;span class="pp"&gt;IndexError&lt;/span&gt;()&lt;/span&gt;
&lt;span id="cb4-21"&gt;&lt;a aria-hidden="true" href="#cb4-21" tabindex="-1"&gt;&lt;/a&gt;        tmp &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="va"&gt;self&lt;/span&gt;.root[NEXT]&lt;/span&gt;
&lt;span id="cb4-22"&gt;&lt;a aria-hidden="true" href="#cb4-22" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="cf"&gt;for&lt;/span&gt; i &lt;span class="kw"&gt;in&lt;/span&gt; &lt;span class="bu"&gt;range&lt;/span&gt;(index):&lt;/span&gt;
&lt;span id="cb4-23"&gt;&lt;a aria-hidden="true" href="#cb4-23" tabindex="-1"&gt;&lt;/a&gt;            tmp &lt;span class="op"&gt;=&lt;/span&gt; tmp[NEXT]&lt;/span&gt;
&lt;span id="cb4-24"&gt;&lt;a aria-hidden="true" href="#cb4-24" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="cf"&gt;return&lt;/span&gt; tmp&lt;/span&gt;
&lt;span id="cb4-25"&gt;&lt;a aria-hidden="true" href="#cb4-25" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb4-26"&gt;&lt;a aria-hidden="true" href="#cb4-26" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="kw"&gt;def&lt;/span&gt; get(&lt;span class="va"&gt;self&lt;/span&gt;, index):&lt;/span&gt;
&lt;span id="cb4-27"&gt;&lt;a aria-hidden="true" href="#cb4-27" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="cf"&gt;return&lt;/span&gt; &lt;span class="va"&gt;self&lt;/span&gt;.getNode(index)[VALUE]&lt;/span&gt;
&lt;span id="cb4-28"&gt;&lt;a aria-hidden="true" href="#cb4-28" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb4-29"&gt;&lt;a aria-hidden="true" href="#cb4-29" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="kw"&gt;def&lt;/span&gt; swapEnd(&lt;span class="va"&gt;self&lt;/span&gt;, index):&lt;/span&gt;
&lt;span id="cb4-30"&gt;&lt;a aria-hidden="true" href="#cb4-30" tabindex="-1"&gt;&lt;/a&gt;        targetNode &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="va"&gt;self&lt;/span&gt;.getNode(index)&lt;/span&gt;
&lt;span id="cb4-31"&gt;&lt;a aria-hidden="true" href="#cb4-31" tabindex="-1"&gt;&lt;/a&gt;        prev, &lt;span class="bu"&gt;next&lt;/span&gt;, value &lt;span class="op"&gt;=&lt;/span&gt; targetNode&lt;/span&gt;
&lt;span id="cb4-32"&gt;&lt;a aria-hidden="true" href="#cb4-32" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="co"&gt;# delete node&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb4-33"&gt;&lt;a aria-hidden="true" href="#cb4-33" tabindex="-1"&gt;&lt;/a&gt;        prev[NEXT] &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="bu"&gt;next&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb4-34"&gt;&lt;a aria-hidden="true" href="#cb4-34" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="bu"&gt;next&lt;/span&gt;[PREV] &lt;span class="op"&gt;=&lt;/span&gt; prev&lt;/span&gt;
&lt;span id="cb4-35"&gt;&lt;a aria-hidden="true" href="#cb4-35" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="co"&gt;# insert into the end of the list&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb4-36"&gt;&lt;a aria-hidden="true" href="#cb4-36" tabindex="-1"&gt;&lt;/a&gt;        last &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="va"&gt;self&lt;/span&gt;.root[PREV]&lt;/span&gt;
&lt;span id="cb4-37"&gt;&lt;a aria-hidden="true" href="#cb4-37" tabindex="-1"&gt;&lt;/a&gt;        last[NEXT] &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="va"&gt;self&lt;/span&gt;.root[PREV] &lt;span class="op"&gt;=&lt;/span&gt; targetNode&lt;/span&gt;
&lt;span id="cb4-38"&gt;&lt;a aria-hidden="true" href="#cb4-38" tabindex="-1"&gt;&lt;/a&gt;        targetNode[PREV] &lt;span class="op"&gt;=&lt;/span&gt; last&lt;/span&gt;
&lt;span id="cb4-39"&gt;&lt;a aria-hidden="true" href="#cb4-39" tabindex="-1"&gt;&lt;/a&gt;        targetNode[NEXT] &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="va"&gt;self&lt;/span&gt;.root&lt;/span&gt;
&lt;span id="cb4-40"&gt;&lt;a aria-hidden="true" href="#cb4-40" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb4-41"&gt;&lt;a aria-hidden="true" href="#cb4-41" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="kw"&gt;def&lt;/span&gt; search(&lt;span class="va"&gt;self&lt;/span&gt;, value) &lt;span class="op"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="bu"&gt;int&lt;/span&gt;:&lt;/span&gt;
&lt;span id="cb4-42"&gt;&lt;a aria-hidden="true" href="#cb4-42" tabindex="-1"&gt;&lt;/a&gt;        tmp &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="va"&gt;self&lt;/span&gt;.root[NEXT]&lt;/span&gt;
&lt;span id="cb4-43"&gt;&lt;a aria-hidden="true" href="#cb4-43" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="cf"&gt;for&lt;/span&gt; i &lt;span class="kw"&gt;in&lt;/span&gt; &lt;span class="bu"&gt;range&lt;/span&gt;(&lt;span class="va"&gt;self&lt;/span&gt;.length):&lt;/span&gt;
&lt;span id="cb4-44"&gt;&lt;a aria-hidden="true" href="#cb4-44" tabindex="-1"&gt;&lt;/a&gt;            &lt;span class="cf"&gt;if&lt;/span&gt; tmp[VALUE] &lt;span class="op"&gt;==&lt;/span&gt; value:&lt;/span&gt;
&lt;span id="cb4-45"&gt;&lt;a aria-hidden="true" href="#cb4-45" tabindex="-1"&gt;&lt;/a&gt;                &lt;span class="cf"&gt;return&lt;/span&gt; i&lt;/span&gt;
&lt;span id="cb4-46"&gt;&lt;a aria-hidden="true" href="#cb4-46" tabindex="-1"&gt;&lt;/a&gt;            tmp &lt;span class="op"&gt;=&lt;/span&gt; tmp[NEXT]&lt;/span&gt;
&lt;span id="cb4-47"&gt;&lt;a aria-hidden="true" href="#cb4-47" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="cf"&gt;return&lt;/span&gt; &lt;span class="op"&gt;-&lt;/span&gt;&lt;span class="dv"&gt;1&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb4-48"&gt;&lt;a aria-hidden="true" href="#cb4-48" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb4-49"&gt;&lt;a aria-hidden="true" href="#cb4-49" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="kw"&gt;def&lt;/span&gt; stripLeft(&lt;span class="va"&gt;self&lt;/span&gt;):&lt;/span&gt;
&lt;span id="cb4-50"&gt;&lt;a aria-hidden="true" href="#cb4-50" tabindex="-1"&gt;&lt;/a&gt;        nodeToDelete &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="va"&gt;self&lt;/span&gt;.getNode(&lt;span class="va"&gt;self&lt;/span&gt;.length &lt;span class="op"&gt;-&lt;/span&gt; &lt;span class="dv"&gt;1&lt;/span&gt;)&lt;/span&gt;
&lt;span id="cb4-51"&gt;&lt;a aria-hidden="true" href="#cb4-51" tabindex="-1"&gt;&lt;/a&gt;        tmp &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="va"&gt;self&lt;/span&gt;.root&lt;/span&gt;
&lt;span id="cb4-52"&gt;&lt;a aria-hidden="true" href="#cb4-52" tabindex="-1"&gt;&lt;/a&gt;        tmp[VALUE] &lt;span class="op"&gt;=&lt;/span&gt; nodeToDelete[VALUE]&lt;/span&gt;
&lt;span id="cb4-53"&gt;&lt;a aria-hidden="true" href="#cb4-53" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="va"&gt;self&lt;/span&gt;.root &lt;span class="op"&gt;=&lt;/span&gt; tmp[NEXT]&lt;/span&gt;
&lt;span id="cb4-54"&gt;&lt;a aria-hidden="true" href="#cb4-54" tabindex="-1"&gt;&lt;/a&gt;        oldValue &lt;span class="op"&gt;=&lt;/span&gt; nodeToDelete[VALUE]&lt;/span&gt;
&lt;span id="cb4-55"&gt;&lt;a aria-hidden="true" href="#cb4-55" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="va"&gt;self&lt;/span&gt;.root[VALUE] &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="va"&gt;None&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb4-56"&gt;&lt;a aria-hidden="true" href="#cb4-56" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="va"&gt;self&lt;/span&gt;.length &lt;span class="op"&gt;-=&lt;/span&gt; &lt;span class="dv"&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;虽然在这里「模拟」出了双向链表，你以为的链表内容:&lt;/p&gt;
&lt;div class="sourceCode" id="cb5"&gt;&lt;pre class="sourceCode python"&gt;&lt;code class="sourceCode python"&gt;&lt;span id="cb5-1"&gt;&lt;a aria-hidden="true" href="#cb5-1" tabindex="-1"&gt;&lt;/a&gt;[ [&lt;span class="op"&gt;&amp;lt;&lt;/span&gt;pointer&lt;span class="op"&gt;&amp;gt;&lt;/span&gt;, &lt;span class="op"&gt;&amp;lt;&lt;/span&gt;pointer&lt;span class="op"&gt;&amp;gt;&lt;/span&gt;, &lt;span class="dv"&gt;1&lt;/span&gt;], [&lt;span class="op"&gt;&amp;lt;&lt;/span&gt;pointer&lt;span class="op"&gt;&amp;gt;&lt;/span&gt;, &lt;span class="op"&gt;&amp;lt;&lt;/span&gt;pointer&lt;span class="op"&gt;&amp;gt;&lt;/span&gt;, &lt;span class="dv"&gt;2&lt;/span&gt;] ... [&lt;span class="op"&gt;&amp;lt;&lt;/span&gt;pointer&lt;span class="op"&gt;&amp;gt;&lt;/span&gt;, &lt;span class="op"&gt;&amp;lt;&lt;/span&gt;pointer&lt;span class="op"&gt;&amp;gt;&lt;/span&gt;, &lt;span class="dv"&gt;999&lt;/span&gt;] ]&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;但其实是:&lt;/p&gt;
&lt;div class="sourceCode" id="cb6"&gt;&lt;pre class="sourceCode python"&gt;&lt;code class="sourceCode python"&gt;&lt;span id="cb6-1"&gt;&lt;a aria-hidden="true" href="#cb6-1" tabindex="-1"&gt;&lt;/a&gt;[[[[&lt;span class="op"&gt;&amp;lt;&lt;/span&gt;Recursion on &lt;span class="bu"&gt;list&lt;/span&gt; &lt;span class="cf"&gt;with&lt;/span&gt; &lt;span class="bu"&gt;id&lt;/span&gt;&lt;span class="op"&gt;=&lt;/span&gt;&lt;span class="dv"&gt;140593175582080&lt;/span&gt;&lt;span class="op"&gt;&amp;gt;&lt;/span&gt;,&lt;/span&gt;
&lt;span id="cb6-2"&gt;&lt;a aria-hidden="true" href="#cb6-2" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="op"&gt;&amp;lt;&lt;/span&gt;Recursion on &lt;span class="bu"&gt;list&lt;/span&gt; &lt;span class="cf"&gt;with&lt;/span&gt; &lt;span class="bu"&gt;id&lt;/span&gt;&lt;span class="op"&gt;=&lt;/span&gt;&lt;span class="dv"&gt;140593172979712&lt;/span&gt;&lt;span class="op"&gt;&amp;gt;&lt;/span&gt;,&lt;/span&gt;
&lt;span id="cb6-3"&gt;&lt;a aria-hidden="true" href="#cb6-3" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="dv"&gt;0&lt;/span&gt;],&lt;/span&gt;
&lt;span id="cb6-4"&gt;&lt;a aria-hidden="true" href="#cb6-4" tabindex="-1"&gt;&lt;/a&gt;   &lt;span class="op"&gt;&amp;lt;&lt;/span&gt;Recursion on &lt;span class="bu"&gt;list&lt;/span&gt; &lt;span class="cf"&gt;with&lt;/span&gt; &lt;span class="bu"&gt;id&lt;/span&gt;&lt;span class="op"&gt;=&lt;/span&gt;&lt;span class="dv"&gt;140593173013888&lt;/span&gt;&lt;span class="op"&gt;&amp;gt;&lt;/span&gt;,&lt;/span&gt;
&lt;span id="cb6-5"&gt;&lt;a aria-hidden="true" href="#cb6-5" tabindex="-1"&gt;&lt;/a&gt;   &lt;span class="dv"&gt;1&lt;/span&gt;],&lt;/span&gt;
&lt;span id="cb6-6"&gt;&lt;a aria-hidden="true" href="#cb6-6" tabindex="-1"&gt;&lt;/a&gt;  &lt;span class="op"&gt;&amp;lt;&lt;/span&gt;Recursion on &lt;span class="bu"&gt;list&lt;/span&gt; &lt;span class="cf"&gt;with&lt;/span&gt; &lt;span class="bu"&gt;id&lt;/span&gt;&lt;span class="op"&gt;=&lt;/span&gt;&lt;span class="dv"&gt;140593175582080&lt;/span&gt;&lt;span class="op"&gt;&amp;gt;&lt;/span&gt;,&lt;/span&gt;
&lt;span id="cb6-7"&gt;&lt;a aria-hidden="true" href="#cb6-7" tabindex="-1"&gt;&lt;/a&gt;  &lt;span class="dv"&gt;2&lt;/span&gt;],&lt;/span&gt;
&lt;span id="cb6-8"&gt;&lt;a aria-hidden="true" href="#cb6-8" tabindex="-1"&gt;&lt;/a&gt; [&lt;span class="op"&gt;&amp;lt;&lt;/span&gt;Recursion on &lt;span class="bu"&gt;list&lt;/span&gt; &lt;span class="cf"&gt;with&lt;/span&gt; &lt;span class="bu"&gt;id&lt;/span&gt;&lt;span class="op"&gt;=&lt;/span&gt;&lt;span class="dv"&gt;140593175582080&lt;/span&gt;&lt;span class="op"&gt;&amp;gt;&lt;/span&gt;,&lt;/span&gt;
&lt;span id="cb6-9"&gt;&lt;a aria-hidden="true" href="#cb6-9" tabindex="-1"&gt;&lt;/a&gt;  [&lt;span class="op"&gt;&amp;lt;&lt;/span&gt;Recursion on &lt;span class="bu"&gt;list&lt;/span&gt; &lt;span class="cf"&gt;with&lt;/span&gt; &lt;span class="bu"&gt;id&lt;/span&gt;&lt;span class="op"&gt;=&lt;/span&gt;&lt;span class="dv"&gt;140593173014784&lt;/span&gt;&lt;span class="op"&gt;&amp;gt;&lt;/span&gt;,&lt;/span&gt;
&lt;span id="cb6-10"&gt;&lt;a aria-hidden="true" href="#cb6-10" tabindex="-1"&gt;&lt;/a&gt;   [&lt;span class="op"&gt;&amp;lt;&lt;/span&gt;Recursion on &lt;span class="bu"&gt;list&lt;/span&gt; &lt;span class="cf"&gt;with&lt;/span&gt; &lt;span class="bu"&gt;id&lt;/span&gt;&lt;span class="op"&gt;=&lt;/span&gt;&lt;span class="dv"&gt;140593172979712&lt;/span&gt;&lt;span class="op"&gt;&amp;gt;&lt;/span&gt;,&lt;/span&gt;
&lt;span id="cb6-11"&gt;&lt;a aria-hidden="true" href="#cb6-11" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="op"&gt;&amp;lt;&lt;/span&gt;Recursion on &lt;span class="bu"&gt;list&lt;/span&gt; &lt;span class="cf"&gt;with&lt;/span&gt; &lt;span class="bu"&gt;id&lt;/span&gt;&lt;span class="op"&gt;=&lt;/span&gt;&lt;span class="dv"&gt;140593175582080&lt;/span&gt;&lt;span class="op"&gt;&amp;gt;&lt;/span&gt;,&lt;/span&gt;
&lt;span id="cb6-12"&gt;&lt;a aria-hidden="true" href="#cb6-12" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="dv"&gt;2&lt;/span&gt;],&lt;/span&gt;
&lt;span id="cb6-13"&gt;&lt;a aria-hidden="true" href="#cb6-13" tabindex="-1"&gt;&lt;/a&gt;   &lt;span class="dv"&gt;1&lt;/span&gt;],&lt;/span&gt;
&lt;span id="cb6-14"&gt;&lt;a aria-hidden="true" href="#cb6-14" tabindex="-1"&gt;&lt;/a&gt;  &lt;span class="dv"&gt;0&lt;/span&gt;],&lt;/span&gt;
&lt;span id="cb6-15"&gt;&lt;a aria-hidden="true" href="#cb6-15" tabindex="-1"&gt;&lt;/a&gt; &lt;span class="va"&gt;None&lt;/span&gt;]&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;这也就意味着，但凡是比较大的列表，就会 &lt;code&gt;RecursionError: maximum recursion depth exceeded while calling a Python object&lt;/code&gt; 。&lt;/p&gt;
&lt;p&gt;那么接下来使用这个脆弱的双向链表来实现一个脆弱的 LRU_Cache ，注意，和 C++ 实现不同，这里的 item_list 是&lt;strong&gt;反过来存储&lt;/strong&gt;的，也就是最新的元素插入在右端，去除的是左端的内容:&lt;/p&gt;
&lt;div class="sourceCode" id="cb7"&gt;&lt;pre class="sourceCode python"&gt;&lt;code class="sourceCode python"&gt;&lt;span id="cb7-1"&gt;&lt;a aria-hidden="true" href="#cb7-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;class&lt;/span&gt; LRU_Cache:&lt;/span&gt;
&lt;span id="cb7-2"&gt;&lt;a aria-hidden="true" href="#cb7-2" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="kw"&gt;def&lt;/span&gt; &lt;span class="fu"&gt;__init__&lt;/span&gt;(&lt;span class="va"&gt;self&lt;/span&gt;, size) &lt;span class="op"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="va"&gt;None&lt;/span&gt;:&lt;/span&gt;
&lt;span id="cb7-3"&gt;&lt;a aria-hidden="true" href="#cb7-3" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="va"&gt;self&lt;/span&gt;.capacity &lt;span class="op"&gt;=&lt;/span&gt; size&lt;/span&gt;
&lt;span id="cb7-4"&gt;&lt;a aria-hidden="true" href="#cb7-4" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="va"&gt;self&lt;/span&gt;.item_list &lt;span class="op"&gt;=&lt;/span&gt; CircularDoublyLinkedList()  &lt;span class="co"&gt;# Key queue&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb7-5"&gt;&lt;a aria-hidden="true" href="#cb7-5" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="va"&gt;self&lt;/span&gt;.item_store &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="bu"&gt;dict&lt;/span&gt;()  &lt;span class="co"&gt;# real store&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb7-6"&gt;&lt;a aria-hidden="true" href="#cb7-6" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb7-7"&gt;&lt;a aria-hidden="true" href="#cb7-7" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="kw"&gt;def&lt;/span&gt; getItem(&lt;span class="va"&gt;self&lt;/span&gt;, key):&lt;/span&gt;
&lt;span id="cb7-8"&gt;&lt;a aria-hidden="true" href="#cb7-8" tabindex="-1"&gt;&lt;/a&gt;        target &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="va"&gt;self&lt;/span&gt;.item_store.get(key)&lt;/span&gt;
&lt;span id="cb7-9"&gt;&lt;a aria-hidden="true" href="#cb7-9" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="cf"&gt;if&lt;/span&gt; target &lt;span class="kw"&gt;is&lt;/span&gt; &lt;span class="va"&gt;None&lt;/span&gt;:&lt;/span&gt;
&lt;span id="cb7-10"&gt;&lt;a aria-hidden="true" href="#cb7-10" tabindex="-1"&gt;&lt;/a&gt;            &lt;span class="cf"&gt;return&lt;/span&gt; &lt;span class="va"&gt;None&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb7-11"&gt;&lt;a aria-hidden="true" href="#cb7-11" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="va"&gt;self&lt;/span&gt;.item_list.swapEnd(&lt;span class="va"&gt;self&lt;/span&gt;.item_list.search(key))&lt;/span&gt;
&lt;span id="cb7-12"&gt;&lt;a aria-hidden="true" href="#cb7-12" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="cf"&gt;return&lt;/span&gt; target&lt;/span&gt;
&lt;span id="cb7-13"&gt;&lt;a aria-hidden="true" href="#cb7-13" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb7-14"&gt;&lt;a aria-hidden="true" href="#cb7-14" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="kw"&gt;def&lt;/span&gt; setItem(&lt;span class="va"&gt;self&lt;/span&gt;, key, value):&lt;/span&gt;
&lt;span id="cb7-15"&gt;&lt;a aria-hidden="true" href="#cb7-15" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="cf"&gt;if&lt;/span&gt; &lt;span class="va"&gt;self&lt;/span&gt;.getItem(key) &lt;span class="op"&gt;!=&lt;/span&gt; &lt;span class="va"&gt;None&lt;/span&gt;:&lt;/span&gt;
&lt;span id="cb7-16"&gt;&lt;a aria-hidden="true" href="#cb7-16" tabindex="-1"&gt;&lt;/a&gt;            &lt;span class="va"&gt;self&lt;/span&gt;.item_list.delete(&lt;span class="va"&gt;self&lt;/span&gt;.item_list.searchKey(key))&lt;/span&gt;
&lt;span id="cb7-17"&gt;&lt;a aria-hidden="true" href="#cb7-17" tabindex="-1"&gt;&lt;/a&gt;            &lt;span class="kw"&gt;del&lt;/span&gt; &lt;span class="va"&gt;self&lt;/span&gt;.item_store[key]&lt;/span&gt;
&lt;span id="cb7-18"&gt;&lt;a aria-hidden="true" href="#cb7-18" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="va"&gt;self&lt;/span&gt;.item_store[key] &lt;span class="op"&gt;=&lt;/span&gt; value&lt;/span&gt;
&lt;span id="cb7-19"&gt;&lt;a aria-hidden="true" href="#cb7-19" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="va"&gt;self&lt;/span&gt;.item_list.insert(key)&lt;/span&gt;
&lt;span id="cb7-20"&gt;&lt;a aria-hidden="true" href="#cb7-20" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="cf"&gt;if&lt;/span&gt; &lt;span class="va"&gt;self&lt;/span&gt;.capacity &lt;span class="op"&gt;&amp;lt;&lt;/span&gt; &lt;span class="va"&gt;self&lt;/span&gt;.item_list.length:&lt;/span&gt;
&lt;span id="cb7-21"&gt;&lt;a aria-hidden="true" href="#cb7-21" tabindex="-1"&gt;&lt;/a&gt;            keyD &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="va"&gt;self&lt;/span&gt;.item_list.get(&lt;span class="dv"&gt;0&lt;/span&gt;)&lt;/span&gt;
&lt;span id="cb7-22"&gt;&lt;a aria-hidden="true" href="#cb7-22" tabindex="-1"&gt;&lt;/a&gt;            &lt;span class="va"&gt;self&lt;/span&gt;.item_list.stripLeft()&lt;/span&gt;
&lt;span id="cb7-23"&gt;&lt;a aria-hidden="true" href="#cb7-23" tabindex="-1"&gt;&lt;/a&gt;            &lt;span class="kw"&gt;del&lt;/span&gt; &lt;span class="va"&gt;self&lt;/span&gt;.item_store[keyD]&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;这个实现可以通过测试,&lt;del&gt;但也只保证通过测试(&lt;/del&gt;&lt;/p&gt;
&lt;h3 id="collections.deque"&gt;collections.deque&lt;/h3&gt;
&lt;p&gt;其实使用双向链表之类的目的在于能够快捷的处理「在初始插入」之类的操作，但这种操作在标准库 &lt;code&gt;collections&lt;/code&gt; 中已经被 &lt;a href="https://docs.python.org/3.3/library/collections.html#collections.deque"&gt;&lt;code&gt;deque&lt;/code&gt;&lt;/a&gt; 提供了。&lt;code&gt;deque&lt;/code&gt; 是一个内置类型，使用 C 实现，位于源码 &lt;code&gt;Modules/_collectionsmodule.c&lt;/code&gt; ，库路径位于 &lt;code&gt;lib64/python/lib-dynload/_collections.so&lt;/code&gt; 。它提供了 &lt;code&gt;appendLeft&lt;/code&gt; , &lt;code&gt;popLeft&lt;/code&gt; 这类操作。&lt;/p&gt;
&lt;p&gt;对于 deque 来说，删除任意位置元素可以这样实现：&lt;/p&gt;
&lt;div class="sourceCode" id="cb8"&gt;&lt;pre class="sourceCode python"&gt;&lt;code class="sourceCode python"&gt;&lt;span id="cb8-1"&gt;&lt;a aria-hidden="true" href="#cb8-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;def&lt;/span&gt; delete_nth(d, n):&lt;/span&gt;
&lt;span id="cb8-2"&gt;&lt;a aria-hidden="true" href="#cb8-2" tabindex="-1"&gt;&lt;/a&gt;    d.rotate(&lt;span class="op"&gt;-&lt;/span&gt;n)&lt;/span&gt;
&lt;span id="cb8-3"&gt;&lt;a aria-hidden="true" href="#cb8-3" tabindex="-1"&gt;&lt;/a&gt;    d.popleft()&lt;/span&gt;
&lt;span id="cb8-4"&gt;&lt;a aria-hidden="true" href="#cb8-4" tabindex="-1"&gt;&lt;/a&gt;    d.rotate(n)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;再将删除的元素重新排到末尾即可实现 &lt;code&gt;swapEnd&lt;/code&gt; 。其他的操作和之前类似。&lt;/p&gt;
&lt;h1 id="functools"&gt;functools&lt;/h1&gt;
&lt;p&gt;所谓装饰器，可以理解为「操作函数的函数」。实际上就是定义了一个函数，这个函数接收另外一个函数，作出一些修改，再返回这个函数。而「装饰器」是这个过程的语法糖。&lt;/p&gt;
&lt;h2 id="lru_cache"&gt;&lt;span class="citation" data-cites="lru_cache"&gt;@lru_cache&lt;/span&gt;&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;lru_cache&lt;/code&gt; 的函数原型是 &lt;code&gt;@functools.lru_cache(maxsize=None, typed=False)&lt;/code&gt;，使用 lru 缓存机制，可以设定最大缓存数量。真正的缓存实现位于 &lt;a href="https://github.com/python/cpython/blob/00e24cdca422f792b80016287562b6b3bccab239/Lib/functools.py#L478"&gt;&lt;code&gt;_lru_cache_wrapper&lt;/code&gt;&lt;/a&gt; 函数中。该函数使用列表模拟的双向循环链表+ dict 的方式存储缓存。&lt;/p&gt;
&lt;p&gt;可以像这样来使用：&lt;/p&gt;
&lt;div class="sourceCode" id="cb9"&gt;&lt;pre class="sourceCode python"&gt;&lt;code class="sourceCode python"&gt;&lt;span id="cb9-1"&gt;&lt;a aria-hidden="true" href="#cb9-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="im"&gt;from&lt;/span&gt; functools &lt;span class="im"&gt;import&lt;/span&gt; lru_cache&lt;/span&gt;
&lt;span id="cb9-2"&gt;&lt;a aria-hidden="true" href="#cb9-2" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="im"&gt;import&lt;/span&gt; time&lt;/span&gt;
&lt;span id="cb9-3"&gt;&lt;a aria-hidden="true" href="#cb9-3" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb9-4"&gt;&lt;a aria-hidden="true" href="#cb9-4" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb9-5"&gt;&lt;a aria-hidden="true" href="#cb9-5" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;def&lt;/span&gt; timeit(f):&lt;/span&gt;
&lt;span id="cb9-6"&gt;&lt;a aria-hidden="true" href="#cb9-6" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="kw"&gt;def&lt;/span&gt; func(&lt;span class="op"&gt;*&lt;/span&gt;args, &lt;span class="op"&gt;**&lt;/span&gt;kwargs):&lt;/span&gt;
&lt;span id="cb9-7"&gt;&lt;a aria-hidden="true" href="#cb9-7" tabindex="-1"&gt;&lt;/a&gt;        time_start &lt;span class="op"&gt;=&lt;/span&gt; time.perf_counter()&lt;/span&gt;
&lt;span id="cb9-8"&gt;&lt;a aria-hidden="true" href="#cb9-8" tabindex="-1"&gt;&lt;/a&gt;        result &lt;span class="op"&gt;=&lt;/span&gt; f(&lt;span class="op"&gt;*&lt;/span&gt;args, &lt;span class="op"&gt;**&lt;/span&gt;kwargs)&lt;/span&gt;
&lt;span id="cb9-9"&gt;&lt;a aria-hidden="true" href="#cb9-9" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="bu"&gt;print&lt;/span&gt;(&lt;span class="ss"&gt;f"&lt;/span&gt;&lt;span class="sc"&gt;{&lt;/span&gt;f&lt;span class="sc"&gt;.&lt;/span&gt;&lt;span class="va"&gt;__name__&lt;/span&gt;&lt;span class="sc"&gt;}&lt;/span&gt;&lt;span class="ss"&gt; used &lt;/span&gt;&lt;span class="sc"&gt;{&lt;/span&gt;time&lt;span class="sc"&gt;.&lt;/span&gt;perf_counter()&lt;span class="op"&gt;-&lt;/span&gt;time_start&lt;span class="sc"&gt;:.5f}&lt;/span&gt;&lt;span class="ss"&gt; seconds."&lt;/span&gt;)&lt;/span&gt;
&lt;span id="cb9-10"&gt;&lt;a aria-hidden="true" href="#cb9-10" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="cf"&gt;return&lt;/span&gt; result&lt;/span&gt;
&lt;span id="cb9-11"&gt;&lt;a aria-hidden="true" href="#cb9-11" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="cf"&gt;return&lt;/span&gt; func&lt;/span&gt;
&lt;span id="cb9-12"&gt;&lt;a aria-hidden="true" href="#cb9-12" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb9-13"&gt;&lt;a aria-hidden="true" href="#cb9-13" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb9-14"&gt;&lt;a aria-hidden="true" href="#cb9-14" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="at"&gt;@lru_cache&lt;/span&gt;(&lt;span class="dv"&gt;2048&lt;/span&gt;)&lt;/span&gt;
&lt;span id="cb9-15"&gt;&lt;a aria-hidden="true" href="#cb9-15" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;def&lt;/span&gt; fact(x):&lt;/span&gt;
&lt;span id="cb9-16"&gt;&lt;a aria-hidden="true" href="#cb9-16" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="cf"&gt;return&lt;/span&gt; &lt;span class="dv"&gt;1&lt;/span&gt; &lt;span class="cf"&gt;if&lt;/span&gt; x &lt;span class="op"&gt;&amp;lt;&lt;/span&gt; &lt;span class="dv"&gt;1&lt;/span&gt; &lt;span class="cf"&gt;else&lt;/span&gt; x &lt;span class="op"&gt;*&lt;/span&gt; fact(x &lt;span class="op"&gt;-&lt;/span&gt; &lt;span class="dv"&gt;1&lt;/span&gt;)&lt;/span&gt;
&lt;span id="cb9-17"&gt;&lt;a aria-hidden="true" href="#cb9-17" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb9-18"&gt;&lt;a aria-hidden="true" href="#cb9-18" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="at"&gt;@timeit&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb9-19"&gt;&lt;a aria-hidden="true" href="#cb9-19" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;def&lt;/span&gt; testA():&lt;/span&gt;
&lt;span id="cb9-20"&gt;&lt;a aria-hidden="true" href="#cb9-20" tabindex="-1"&gt;&lt;/a&gt;    fact(&lt;span class="dv"&gt;384&lt;/span&gt;)&lt;/span&gt;
&lt;span id="cb9-21"&gt;&lt;a aria-hidden="true" href="#cb9-21" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb9-22"&gt;&lt;a aria-hidden="true" href="#cb9-22" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="at"&gt;@timeit&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb9-23"&gt;&lt;a aria-hidden="true" href="#cb9-23" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;def&lt;/span&gt; testB():&lt;/span&gt;
&lt;span id="cb9-24"&gt;&lt;a aria-hidden="true" href="#cb9-24" tabindex="-1"&gt;&lt;/a&gt;    fact(&lt;span class="dv"&gt;384&lt;/span&gt;)&lt;/span&gt;
&lt;span id="cb9-25"&gt;&lt;a aria-hidden="true" href="#cb9-25" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb9-26"&gt;&lt;a aria-hidden="true" href="#cb9-26" tabindex="-1"&gt;&lt;/a&gt;testA()&lt;/span&gt;
&lt;span id="cb9-27"&gt;&lt;a aria-hidden="true" href="#cb9-27" tabindex="-1"&gt;&lt;/a&gt;testB()&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;结果：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;testA used 0.00023 seconds.
testB used 0.00000 seconds.&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;可以看到 lru_cache 显著降低了时间。&lt;/p&gt;
&lt;h1 id="参见"&gt;参见&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://stackoverflow.com/questions/5300602/template-return-type-with-default-value" title="Template Return Type with Default Value"&gt;模板类返回类型默认值&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://github.com/python/cpython/blob/00e24cdca422f792b80016287562b6b3bccab239/Lib/functools.py#L478"&gt;functools 源码&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;br/&gt;
&lt;!--%%REF%%--&gt;
&lt;br/&gt;
&lt;script async="" crossorigin="anonymous" data-category="Announcements" data-category-id="DIC_kwDOJ7Ymy84CX4eg" data-emit-metadata="0" data-input-position="top" data-lang="zh-CN" data-loading="lazy" data-mapping="title" data-reactions-enabled="1" data-repo="izfsk-ium/izfsk-ium.github.io" data-repo-id="R_kgDOJ7Ymyw" data-strict="0" data-theme="preferred_color_scheme" src="https://giscus.app/client.js"&gt;
&lt;/script&gt;
&lt;/main&gt;
&lt;footer&gt;
&lt;p class="signoff"&gt;
&lt;div class="metadata"&gt;
&lt;p class="date"&gt;&lt;time datetime="2022-12-13"&gt;创建日期：2022-12-13&lt;/time&gt;&lt;/p&gt;
&lt;p class="lastmodify"&gt;&lt;time&gt;最后编译：2023-08-10&lt;/time&gt;&lt;/p&gt;
&lt;p class="lastmodify" id="counter-span"&gt;访问次数：&lt;/p&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;/footer&gt;
&lt;script&gt;
    /* These script should run after page load */
    document.querySelectorAll('code.sourceCode').forEach(
      i =&gt; i.insertAdjacentHTML('beforeend', '&lt;div class="copy"&gt;复制&lt;/div&gt;')
    );
    document.querySelectorAll('div.copy').forEach(
      i =&gt; i.addEventListener(
        'click',
        () =&gt; {
          navigator.clipboard.writeText(i.parentElement.innerText.replace('复制', ''));
          i.innerText = '成功';
          setTimeout(() =&gt; {
            i.innerText = '复制';
          }, 1000);
        }
      )
    );

    if (location.href.includes("127.0.0.1:8080")) {
      document.getElementById("counter-span").innerHTML = "[[development mode]]";
    } else {
      const uuid = document.getElementById("article-uuid").innerText;
      const target = document.getElementById("counter-span");
      const last = localStorage.getItem("lastVisit-" + uuid);
      const shouldIncrease = last === null || new Date().getTime() - parseInt(last) &gt;= (1000 * 60 * 15);

      fetch(shouldIncrease ? ("https://counter.izfsk.top/counter/" + uuid) : ("https://counter.izfsk.top/readOnly/" + uuid))
        .then(r =&gt; r.text())
        .then(d =&gt; {
          if (!d.startsWith("Too"))
            document.getElementById("counter-span").innerText = "访问次数：" + d.toString();
          else
            document.getElementById("counter-span").innerHTML = "";
        });

      localStorage.setItem("lastVisit-" + uuid, new Date().getTime());
    }
  &lt;/script&gt;
&lt;script async="" data-website-id="2a1146ab-fa82-4a84-a04f-30e5967357c3" src="https://analytics.umami.is/script.js"&gt;&lt;/script&gt;
&lt;/body&gt;</content:encoded>
      <guid isPermaLink="false">809dd759-e6d9-4bb0-8e9b-31e48c7a9366</guid>
      <pubDate>Tue, 13 Dec 2022 00:00:00 +0800</pubDate>
    </item>
    <item>
      <title>我的2022</title>
      <link>https://blog.izfsk.top/articles/我的2022.html</link>
      <description>我的2022</description>
      <content:encoded>&lt;body&gt;
&lt;progress id="content_progress" value="0"&gt;&lt;/progress&gt;
&lt;button id="back-to-top"&gt;
    回页顶
  &lt;/button&gt;
&lt;header&gt;
&lt;small id="article-uuid" style="display: none !important;"&gt;0b76294d-1212-48fa-98d0-f7fda869006e&lt;/small&gt;
&lt;h1 class="title"&gt;我的2022&lt;/h1&gt;
&lt;!-- Subtitle --&gt;
&lt;h3 class="subtitle"&gt; &lt;/h3&gt;
&lt;/header&gt;
&lt;nav id="TOC" role="doc-toc"&gt;
&lt;strong&gt;文章归类: &lt;a href="/pages/category.html#杂感"&gt;杂感&lt;/a&gt; &lt;/strong&gt;
&lt;input id="contents" type="checkbox"/&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#年我做了什么" id="toc-年我做了什么"&gt;2022年我做了什么&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#的计划." id="toc-的计划."&gt;2023的计划.&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#reference"&gt;参考链接&lt;/a&gt;&lt;/li&gt;
&lt;li&gt; &lt;/li&gt;
&lt;li class="tools"&gt;
&lt;span id="backtomain"&gt;
&lt;svg class="bi bi-house" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M8.707 1.5a1 1 0 0 0-1.414 0L.646 8.146a.5.5 0 0 0 .708.708L2 8.207V13.5A1.5 1.5 0 0 0 3.5 15h9a1.5 1.5 0 0 0 1.5-1.5V8.207l.646.647a.5.5 0 0 0 .708-.708L13 5.793V2.5a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v1.293L8.707 1.5ZM13 7.207V13.5a.5.5 0 0 1-.5.5h-9a.5.5 0 0 1-.5-.5V7.207l5-5 5 5Z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="readingmode"&gt;
&lt;svg class="bi bi-book" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M1 2.828c.885-.37 2.154-.769 3.388-.893 1.33-.134 2.458.063 3.112.752v9.746c-.935-.53-2.12-.603-3.213-.493-1.18.12-2.37.461-3.287.811V2.828zm7.5-.141c.654-.689 1.782-.886 3.112-.752 1.234.124 2.503.523 3.388.893v9.923c-.918-.35-2.107-.692-3.287-.81-1.094-.111-2.278-.039-3.213.492V2.687zM8 1.783C7.015.936 5.587.81 4.287.94c-1.514.153-3.042.672-3.994 1.105A.5.5 0 0 0 0 2.5v11a.5.5 0 0 0 .707.455c.882-.4 2.303-.881 3.68-1.02 1.409-.142 2.59.087 3.223.877a.5.5 0 0 0 .78 0c.633-.79 1.814-1.019 3.222-.877 1.378.139 2.8.62 3.681 1.02A.5.5 0 0 0 16 13.5v-11a.5.5 0 0 0-.293-.455c-.952-.433-2.48-.952-3.994-1.105C10.413.809 8.985.936 8 1.783z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="larger"&gt; &lt;/span&gt;
&lt;span id="smaller"&gt;&lt;/span&gt;
&lt;span id="switchfont"&gt;
&lt;svg class="bi bi-fonts" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M12.258 3h-8.51l-.083 2.46h.479c.26-1.544.758-1.783 2.693-1.845l.424-.013v7.827c0 .663-.144.82-1.3.923v.52h4.082v-.52c-1.162-.103-1.306-.26-1.306-.923V3.602l.431.013c1.934.062 2.434.301 2.693 1.846h.479L12.258 3z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="backtotop"&gt;
&lt;svg class="bi bi-arrow-bar-up" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M8 10a.5.5 0 0 0 .5-.5V3.707l2.146 2.147a.5.5 0 0 0 .708-.708l-3-3a.5.5 0 0 0-.708 0l-3 3a.5.5 0 1 0 .708.708L7.5 3.707V9.5a.5.5 0 0 0 .5.5zm-7 2.5a.5.5 0 0 1 .5-.5h13a.5.5 0 0 1 0 1h-13a.5.5 0 0 1-.5-.5z" fill-rule="evenodd"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/nav&gt;
&lt;main&gt;
&lt;h1 id="年我做了什么"&gt;2022年我做了什么&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;学习了前端开发。&lt;/p&gt;
&lt;p&gt;从一开始不知道 &lt;code&gt;npm&lt;/code&gt; 为何物，瞎抄 CSS ，直接写 &lt;code&gt;&amp;lt;script&amp;gt;&lt;/code&gt; 标签实现各种功能，到使用 &lt;code&gt;JQuery&lt;/code&gt; 添加动画，再到引入 &lt;code&gt;react&lt;/code&gt; ，再学习 Typescript 初次接触比较现代的前端开发，最后到现在学会用 &lt;code&gt;React+Redux+Typescript&lt;/code&gt; 配合 &lt;code&gt;vite&lt;/code&gt; 和&lt;code&gt;rollup&lt;/code&gt; 进行现代前端页面开发，顺便学习了 SCSS ，了解了 CSS 动画并使用了一些常见的 CSS 框架，以及了解了许多浏览器机制，算是来了一场「前端开发从远古到现代」之旅了。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;学习了 Java 和 Kotlin 。&lt;/p&gt;
&lt;p&gt;本着学算法（很奇怪）的目标，我开始学习自己一开始就不喜欢的 Java ，并且确实没有喜欢上这门语言。但无论如何，至少我现在能使用这门语言干活，虽然不是也不太可能成为 JVM 大师，而且 Java 水平也就在一个「刚刚能上手」的水平。&lt;/p&gt;
&lt;p&gt;至于 Kotlin ，学习它自然是为了能够替换 Java ，顺便给 Android 开发铺垫一下。虽然我依旧不太喜欢 JVM 语言就是了。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;简单的后端开发，数据库和缓存的知识&lt;/p&gt;
&lt;p&gt;有前端必然有后端，下半年基本上在倒腾一些经典的玩具项目诸如「作业管理系统」，「班级管理系统」，「博客管理系统」等等，并且参与了一个实际项目的开发，我算是把前端和后端结合在了一起。一开始使用 nodejs 前后一致，到后来后端用 Java 和 springboot ，顺便把 sqlite, postgresql, redis 缓存, openapi, 乃至 grpc 都折腾了一圈，虽然不敢说在哪个方面达到精通水平，但至少算是入了门，顺便锻炼了 Linux 乃至 openBSD 的运维能力。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;半途而废的其他&lt;/p&gt;
&lt;p&gt;我还尝试了其他一些语言/框架等，不过没有坚持下来，要么是火候不够，要么是与我水土不服&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Golang ：我尝试了一下，但是我对它的语法感到很难受很难受，缺乏类机制和异常也让我用起来很不愉快，再加上难以名状的网络环境……我觉得除非工作需要我应该不会再碰它了。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Ruby on rails ：它大而全，所以当我一开始想要学习它的时候根本不知道入口点在哪里，再加上网上的资料多半过期，ruby 语言热度又不高，遂弃。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Raku &amp;amp; Dlang ：它们很好的语言！但是现在已经不是20世纪90年代了……&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;C# ：很简单，我没法在 linux 上使用 Visual Studio ，更没法在 Linux 上面运行带图形界面的C#程序，更别提开发了。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Emacs ：很多人一开始纠结于如何退出 vi ，但对于我是如何退出 emacs。&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;除此以外……&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;完整的看的实体书有半本《计算机程序的构造和解释》以及《Java核心技术》两本。《算法》看了半本但没怎么看进去。《CSAPP》只看了一点点。&lt;/p&gt;
&lt;p&gt;俩项目，从开发到部署到维护&lt;del&gt;到下线&lt;/del&gt;，焦头烂额（&lt;/p&gt;
&lt;h1 id="的计划."&gt;2023的计划.&lt;/h1&gt;
&lt;p&gt;首先，要&lt;strong&gt;活下来&lt;/strong&gt;。&lt;/p&gt;
&lt;p&gt;我也知道在 21 世纪的今天把目标定为「活下来」是有点不可思议，但是现实就是那么魔幻。「天地不仁，以万物为刍狗」，病毒可以对人类一视同仁，但人却不是这样。我希望自己，自己的家人，朋友们都能够平安度过这一年。&lt;/p&gt;
&lt;p&gt;在计算机方面，不如去回归一下初心，去「追寻一下隐匿在计算机里的神灵」好了。所以一方面我打算重新学学 C 和 C++，倒腾下数据结构和算法，另一方面继续学 Lisp 和 Emacs，「计算」这件事情本身也很有意思。前端什么的，我还想再学学 Vue，顺便多了解一些 Javascript 。至于 Java 和 Kotlin 的话，如果有需要再说。其实我还想学 Rust，不过这个愿望看上去是很难实现了。&lt;/p&gt;
&lt;p&gt;其实情况一直会变化，有计划也很难准确执行毕竟咱不是计算机系的学生，学习起来也很难有一个系统路线，经常是想到哪里学到哪里，或者需求啥学习什么，只能尽力而为吧。&lt;/p&gt;
&lt;br/&gt;
&lt;!--%%REF%%--&gt;
&lt;br/&gt;
&lt;script async="" crossorigin="anonymous" data-category="Announcements" data-category-id="DIC_kwDOJ7Ymy84CX4eg" data-emit-metadata="0" data-input-position="top" data-lang="zh-CN" data-loading="lazy" data-mapping="title" data-reactions-enabled="1" data-repo="izfsk-ium/izfsk-ium.github.io" data-repo-id="R_kgDOJ7Ymyw" data-strict="0" data-theme="preferred_color_scheme" src="https://giscus.app/client.js"&gt;
&lt;/script&gt;
&lt;/main&gt;
&lt;footer&gt;
&lt;p class="signoff"&gt;
&lt;div class="metadata"&gt;
&lt;p class="date"&gt;&lt;time datetime="2022-12-14"&gt;创建日期：2022-12-14&lt;/time&gt;&lt;/p&gt;
&lt;p class="lastmodify"&gt;&lt;time&gt;最后编译：2023-08-10&lt;/time&gt;&lt;/p&gt;
&lt;p class="lastmodify" id="counter-span"&gt;访问次数：&lt;/p&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;/footer&gt;
&lt;script&gt;
    /* These script should run after page load */
    document.querySelectorAll('code.sourceCode').forEach(
      i =&gt; i.insertAdjacentHTML('beforeend', '&lt;div class="copy"&gt;复制&lt;/div&gt;')
    );
    document.querySelectorAll('div.copy').forEach(
      i =&gt; i.addEventListener(
        'click',
        () =&gt; {
          navigator.clipboard.writeText(i.parentElement.innerText.replace('复制', ''));
          i.innerText = '成功';
          setTimeout(() =&gt; {
            i.innerText = '复制';
          }, 1000);
        }
      )
    );

    if (location.href.includes("127.0.0.1:8080")) {
      document.getElementById("counter-span").innerHTML = "[[development mode]]";
    } else {
      const uuid = document.getElementById("article-uuid").innerText;
      const target = document.getElementById("counter-span");
      const last = localStorage.getItem("lastVisit-" + uuid);
      const shouldIncrease = last === null || new Date().getTime() - parseInt(last) &gt;= (1000 * 60 * 15);

      fetch(shouldIncrease ? ("https://counter.izfsk.top/counter/" + uuid) : ("https://counter.izfsk.top/readOnly/" + uuid))
        .then(r =&gt; r.text())
        .then(d =&gt; {
          if (!d.startsWith("Too"))
            document.getElementById("counter-span").innerText = "访问次数：" + d.toString();
          else
            document.getElementById("counter-span").innerHTML = "";
        });

      localStorage.setItem("lastVisit-" + uuid, new Date().getTime());
    }
  &lt;/script&gt;
&lt;script async="" data-website-id="2a1146ab-fa82-4a84-a04f-30e5967357c3" src="https://analytics.umami.is/script.js"&gt;&lt;/script&gt;
&lt;/body&gt;</content:encoded>
      <guid isPermaLink="false">0b76294d-1212-48fa-98d0-f7fda869006e</guid>
      <pubDate>Wed, 14 Dec 2022 00:00:00 +0800</pubDate>
    </item>
    <item>
      <title>scrcpy+sndcpy+kdeconnect多屏协作</title>
      <link>https://blog.izfsk.top/articles/scrcpy+sndcpy+kdeconnect多屏协作.html</link>
      <description>scrcpy+sndcpy+kdeconnect多屏协作</description>
      <content:encoded>&lt;body&gt;
&lt;progress id="content_progress" value="0"&gt;&lt;/progress&gt;
&lt;button id="back-to-top"&gt;
    回页顶
  &lt;/button&gt;
&lt;header&gt;
&lt;small id="article-uuid" style="display: none !important;"&gt;92a3c86b-baca-4a5d-bf87-e4b091adfd74&lt;/small&gt;
&lt;h1 class="title"&gt;scrcpy+sndcpy+kdeconnect多屏协作&lt;/h1&gt;
&lt;!-- Subtitle --&gt;
&lt;h3 class="subtitle"&gt; &lt;/h3&gt;
&lt;/header&gt;
&lt;nav id="TOC" role="doc-toc"&gt;
&lt;strong&gt;文章归类: &lt;a href="/pages/category.html#备忘录"&gt;备忘录&lt;/a&gt; &lt;/strong&gt;
&lt;input id="contents" type="checkbox"/&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#目标" id="toc-目标"&gt;目标&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#scrcpy" id="toc-scrcpy"&gt;scrcpy&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#手机关闭显示" id="toc-手机关闭显示"&gt;手机关闭显示&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#多个设备连接" id="toc-多个设备连接"&gt;多个设备连接&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#无线调试" id="toc-无线调试"&gt;无线调试&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#录屏" id="toc-录屏"&gt;录屏&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#多重虚拟屏幕" id="toc-多重虚拟屏幕"&gt;多重虚拟屏幕&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#sndcpy" id="toc-sndcpy"&gt;sndcpy&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#kdeconnect" id="toc-kdeconnect"&gt;kdeconnect&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#附录scrcpy-快捷键" id="toc-附录scrcpy-快捷键"&gt;附录：scrcpy 快捷键&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#参考" id="toc-参考"&gt;参考&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#reference"&gt;参考链接&lt;/a&gt;&lt;/li&gt;
&lt;li&gt; &lt;/li&gt;
&lt;li class="tools"&gt;
&lt;span id="backtomain"&gt;
&lt;svg class="bi bi-house" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M8.707 1.5a1 1 0 0 0-1.414 0L.646 8.146a.5.5 0 0 0 .708.708L2 8.207V13.5A1.5 1.5 0 0 0 3.5 15h9a1.5 1.5 0 0 0 1.5-1.5V8.207l.646.647a.5.5 0 0 0 .708-.708L13 5.793V2.5a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v1.293L8.707 1.5ZM13 7.207V13.5a.5.5 0 0 1-.5.5h-9a.5.5 0 0 1-.5-.5V7.207l5-5 5 5Z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="readingmode"&gt;
&lt;svg class="bi bi-book" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M1 2.828c.885-.37 2.154-.769 3.388-.893 1.33-.134 2.458.063 3.112.752v9.746c-.935-.53-2.12-.603-3.213-.493-1.18.12-2.37.461-3.287.811V2.828zm7.5-.141c.654-.689 1.782-.886 3.112-.752 1.234.124 2.503.523 3.388.893v9.923c-.918-.35-2.107-.692-3.287-.81-1.094-.111-2.278-.039-3.213.492V2.687zM8 1.783C7.015.936 5.587.81 4.287.94c-1.514.153-3.042.672-3.994 1.105A.5.5 0 0 0 0 2.5v11a.5.5 0 0 0 .707.455c.882-.4 2.303-.881 3.68-1.02 1.409-.142 2.59.087 3.223.877a.5.5 0 0 0 .78 0c.633-.79 1.814-1.019 3.222-.877 1.378.139 2.8.62 3.681 1.02A.5.5 0 0 0 16 13.5v-11a.5.5 0 0 0-.293-.455c-.952-.433-2.48-.952-3.994-1.105C10.413.809 8.985.936 8 1.783z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="larger"&gt; &lt;/span&gt;
&lt;span id="smaller"&gt;&lt;/span&gt;
&lt;span id="switchfont"&gt;
&lt;svg class="bi bi-fonts" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M12.258 3h-8.51l-.083 2.46h.479c.26-1.544.758-1.783 2.693-1.845l.424-.013v7.827c0 .663-.144.82-1.3.923v.52h4.082v-.52c-1.162-.103-1.306-.26-1.306-.923V3.602l.431.013c1.934.062 2.434.301 2.693 1.846h.479L12.258 3z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="backtotop"&gt;
&lt;svg class="bi bi-arrow-bar-up" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M8 10a.5.5 0 0 0 .5-.5V3.707l2.146 2.147a.5.5 0 0 0 .708-.708l-3-3a.5.5 0 0 0-.708 0l-3 3a.5.5 0 1 0 .708.708L7.5 3.707V9.5a.5.5 0 0 0 .5.5zm-7 2.5a.5.5 0 0 1 .5-.5h13a.5.5 0 0 1 0 1h-13a.5.5 0 0 1-.5-.5z" fill-rule="evenodd"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/nav&gt;
&lt;main&gt;
&lt;p&gt;「多屏协作」是很多电子设备厂商的卖点，本着 &lt;a href="https://unix.org/license-plate.html"&gt;Live free or die&lt;/a&gt; 的头铁原则，使用 Linux 也可以利用各种工具实现这样的功能，并且，效果还不错。&lt;/p&gt;
&lt;h1 id="目标"&gt;目标&lt;/h1&gt;
&lt;p&gt;要达到我心目中的「多屏协作」，至少需要：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;手机屏幕投射&lt;/li&gt;
&lt;li&gt;双向文件互传&lt;/li&gt;
&lt;li&gt;剪贴板分享&lt;/li&gt;
&lt;li&gt;双向远程控制&lt;/li&gt;
&lt;li&gt;媒体转接&lt;/li&gt;
&lt;li&gt;通知传递&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;另外这一切都不应该借助数据线，经过一番折腾，我基本实现了这些目标，虽然免不了有一种自由软件大杂烩以后经典的「它能跑，但是毛毛糙糙」的感觉。&lt;/p&gt;
&lt;h1 id="scrcpy"&gt;scrcpy&lt;/h1&gt;
&lt;p&gt;&lt;code&gt;scrcpy&lt;/code&gt;是一个命令行应用，用于把安卓设备的屏幕投射到电脑上，支持交互功能。你可以在&lt;a href="https://scrcpy.org"&gt;这里&lt;/a&gt;下载。除此以外，你还需要在电脑上安装 adb 调试工具链接电脑，并在手机上打开 USB 调试功能。&lt;/p&gt;
&lt;p&gt;最简单的使用就是直接用 USB 链接手机，允许 USB 调试，之后终端执行&lt;/p&gt;
&lt;pre class="shell"&gt;&lt;code&gt;$ scrcpy &lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;即可。scrcpy 自带了键盘模拟输入，鼠标代替触摸操作等。除此以外，系统剪贴板和手机剪贴板可以自动互通，拖放电脑文件到手机窗口会把文件 push 到 &lt;code&gt;/storage/emulated/0/Downloads/&lt;/code&gt; 目录，也就是手机默认的「下载」目录。&lt;/p&gt;
&lt;h2 id="手机关闭显示"&gt;手机关闭显示&lt;/h2&gt;
&lt;p&gt;如果你觉得手机一直亮着很费电，添加 &lt;code&gt;-S&lt;/code&gt; 参数在连接电脑后自动熄灭屏幕即可。当然，如果再次操作物理手机还是能够正常使用的。&lt;/p&gt;
&lt;h2 id="多个设备连接"&gt;多个设备连接&lt;/h2&gt;
&lt;p&gt;如果你有很多设备连接，要么指定设备序列号，要么使用无线调试。先使用 &lt;code&gt;adb devices&lt;/code&gt; 列出所有设备，第一列的就是设备编号，scrcpy 使用 &lt;code&gt;-s&lt;/code&gt; 参数来辨别你要连接的设备。&lt;/p&gt;
&lt;pre class="shell"&gt;&lt;code&gt;$ scrcpy -S -s your-device&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id="无线调试"&gt;无线调试&lt;/h2&gt;
&lt;p&gt;在同一个局域网下，可以使用无线调试功能，解放 usb 插口。&lt;/p&gt;
&lt;div class="note blue"&gt;
&lt;table&gt;
&lt;colgroup&gt;
&lt;col style="width: 100%"/&gt;
&lt;/colgroup&gt;
&lt;tbody&gt;
&lt;tr class="odd"&gt;
&lt;td&gt;💭 &lt;strong&gt;无线调试比较费带宽，如果 wifi 信号不好，或者正在下载什么东西，可能会卡顿明显。&lt;/strong&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;p&gt;首先，你需要 USB 连接手机，确保 adb 畅通，接下来，启用无线调试：&lt;/p&gt;
&lt;pre class="shell"&gt;&lt;code&gt;$ adb tcpip 5555&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;默认的端口是 5555，当然你也可以自定义。接下来你要知道你的手机的 IP 地址：&lt;/p&gt;
&lt;pre class="shell"&gt;&lt;code&gt;$ adb shell ip addr&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;和 PC 不同，Android 设备会密密麻麻显示出几十个网络接口，一般 wlan 接口就是 &lt;code&gt;wlan0&lt;/code&gt; 之类的，局域网地址一般以 &lt;code&gt;192.168&lt;/code&gt; 开头。找到以后，输入 connect 连接：&lt;/p&gt;
&lt;pre class="shell"&gt;&lt;code&gt;$ adb connect 192.168.1.114:5555&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;如果没有问题，会显示 &lt;code&gt;connected to 192.168.1.114:5555&lt;/code&gt;，这时候再 &lt;code&gt;adb devices&lt;/code&gt; 会显示出无线调试的设备。此时就可以拔出 USB 线，直接远程连接了。如上所述，远程连接会比较耗费带宽，如果卡顿，可以试试限制视频大小。使用 &lt;code&gt;-m&lt;/code&gt; 参数限制视频的宽度和高度，长宽比会被保留。实际上 1024 就可以用了，除非是列文虎克，否则看不太出来差别。&lt;/p&gt;
&lt;pre class="shell"&gt;&lt;code&gt;$ scrcpy -S --tcpip=192.168.1.114 -m 1024&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;如果出现问题或者找不到设备：&lt;/p&gt;
&lt;ol type="1"&gt;
&lt;li&gt;再三检查自己的手机有没有连接 wifi，并且和电脑在同一个网域。&lt;/li&gt;
&lt;li&gt;尝试 &lt;code&gt;adb kill-server&lt;/code&gt; 重新来过。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;连接结束后，可以使用 &lt;code&gt;adb disconnect&lt;/code&gt; 结束连接。&lt;/p&gt;
&lt;h2 id="录屏"&gt;录屏&lt;/h2&gt;
&lt;p&gt;使用 &lt;code&gt;-r&lt;/code&gt; 参数加文件名录屏。格式是 mp4 或者 mkv，按照文件扩展名自动选择。&lt;/p&gt;
&lt;pre class="shell"&gt;&lt;code&gt;$ scrcpy -m 1024 -r record.mp4&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;实际测试一段 8 秒钟的视频，使用 mp4 格式， &lt;code&gt;-m 1024&lt;/code&gt; 参数，大小是 4MB 左右（无声音）。&lt;/p&gt;
&lt;div class="note red"&gt;
&lt;table&gt;
&lt;colgroup&gt;
&lt;col style="width: 100%"/&gt;
&lt;/colgroup&gt;
&lt;tbody&gt;
&lt;tr class="odd"&gt;
&lt;td&gt;⚠️ &lt;strong&gt;scrcpy 很诚实，它会把所有的一切录下来，包括你的锁屏和锁屏密码！&lt;/strong&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;p&gt;注：Android 13 以后不再有这个问题。&lt;/p&gt;
&lt;h2 id="多重虚拟屏幕"&gt;多重虚拟屏幕&lt;/h2&gt;
&lt;p&gt;Android 开发人员选项有一个 Simulate secondary displays 的选项，可以设置虚拟显示屏。如果你的手机支持「桌面模式」，可以尝试开启，在手机和电脑上各开一个显示。&lt;/p&gt;
&lt;p&gt;你可以使用 adb 命令开启一个虚拟显示输出：&lt;/p&gt;
&lt;pre class="shell"&gt;&lt;code&gt;$ adb shell settings put global overlay_display_devices 3840x2160/480&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;然后通过&lt;/p&gt;
&lt;pre class="shell"&gt;&lt;code&gt;$ adb shell dumpsys display | grep mDisplayId=&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;来获取虚拟显示输出的编号。编号 0 是手机的物理屏幕。接下来就可以使用 scrcpy 连接指定的虚拟屏幕了：&lt;/p&gt;
&lt;pre class="shell"&gt;&lt;code&gt;$ scrcpy -m 1024 --display 11&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;注意，不是每一个型号的手机都可以支持「桌面模式」，大部分手机的虚拟显示器投屏以后只是灰屏。&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;如果你想关闭虚拟显示屏，在「开发人员选项」里面找到 Simulate secondary displays 选取一个再关闭即可。&lt;/p&gt;
&lt;h1 id="sndcpy"&gt;sndcpy&lt;/h1&gt;
&lt;p&gt;&lt;code&gt;scrcpy&lt;/code&gt; 只能投送屏幕，不能接管音频。如果想要把手机的音频也接管到电脑上来，需要其他的工具。你可以在&lt;a href="https://github.com/rom1v/sndcpy"&gt;这里&lt;/a&gt;下载。要运行这个工具，你需要：&lt;/p&gt;
&lt;ol type="1"&gt;
&lt;li&gt;Android 10 或者以上的操作系统&lt;/li&gt;
&lt;li&gt;你的 PC 上安装了 VLC 并且在 path 里面&lt;/li&gt;
&lt;li&gt;你可以 adb 连接你的手机&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;解压 release 的压缩包以后，是运行脚本和一个 apk。主要就是依靠这个 apk 来完成音频转发。使用方法：&lt;/p&gt;
&lt;pre class="shell"&gt;&lt;code&gt;./sndcpy &amp;lt;serial&amp;gt;  # replace &amp;lt;serial&amp;gt; by the device serial&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;运行以后有可能会有报错，无妨，稍等即可。尝试表明，音乐应用等的音频可以转发，但是腾讯会议的音频在目前版本 (v1.1) 无法转发。&lt;/p&gt;
&lt;h1 id="kdeconnect"&gt;kdeconnect&lt;/h1&gt;
&lt;p&gt;在 KDE 上使用 KDE Connect 和手机进行消息通知同步等可以使得你的「多屏协作」体验更好。使用 KDE Connect 需要：&lt;/p&gt;
&lt;ol type="1"&gt;
&lt;li&gt;你的手机和电脑在同一个网络下&lt;/li&gt;
&lt;li&gt;你的手机安装 KDE Connect&lt;/li&gt;
&lt;li&gt;防火墙放行相关端口&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;strong&gt;并不是只有 KDE 才能使用 KDE Connect，Gnome 乃至 Windows 平台都可以享受它&lt;/strong&gt;。在 Gnome 上你可以使用 &lt;a href="https://extensions.gnome.org/extension/1319/gsconnect/"&gt;GSConnect&lt;/a&gt; 来替代，在 Windows上你可以直接在&lt;a href="https://apps.microsoft.com/store/detail/9N93MRMSXBF0?hl=zh-cn&amp;amp;gl=CN"&gt;微软应用商店&lt;/a&gt;下载它。当然，KDE 不可能向国内的手机应用商店交钱上架，所以你需要在 &lt;a href="https://f-droid.org/en/packages/org.kde.kdeconnect_tp/"&gt;F-Droid&lt;/a&gt; 下载最新的手机应用。&lt;/p&gt;
&lt;p&gt;KDE Connect 的使用非常简单，一看就能明白。如果你还是无法检测到设备，检查一下你的 PC 防火墙设置。KDE Connect 使用 UDP 和 TCP 端口 1714-1764，确保你的防火墙放行了它们。&lt;/p&gt;
&lt;pre class="shell"&gt;&lt;code&gt;# 如果你使用 ufw
sudo ufw allow 1714:1764/udp
sudo ufw allow 1714:1764/tcp
sudo ufw reload

# 如果你使用 firewall-cmd
sudo firewall-cmd --permanent --zone=public --add-service=kdeconnect
sudo firewall-cmd --reload

# 如果你非要用 iptables...
sudo iptables -I INPUT -i &amp;lt;yourinterface&amp;gt; -p udp --dport 1714:1764 -m state --state NEW,ESTABLISHED -j ACCEPT
sudo iptables -I INPUT -i &amp;lt;yourinterface&amp;gt; -p tcp --dport 1714:1764 -m state --state NEW,ESTABLISHED -j ACCEPT

sudo iptables -A OUTPUT -o &amp;lt;yourinterface&amp;gt; -p udp --sport 1714:1764 -m state --state NEW,ESTABLISHED -j ACCEPT
sudo iptables -A OUTPUT -o &amp;lt;yourinterface&amp;gt; -p tcp --sport 1714:1764 -m state --state NEW,ESTABLISHED -j ACCEPT&lt;/code&gt;&lt;/pre&gt;
&lt;h1 id="附录scrcpy-快捷键"&gt;附录：scrcpy 快捷键&lt;/h1&gt;
&lt;p&gt;首先，需要设定 &lt;code&gt;mod&lt;/code&gt; 键作为前缀。默认是 &lt;code&gt;lalt, lsuper&lt;/code&gt; 使用 &lt;code&gt;--shortcut-mod key&lt;/code&gt; 来设置。&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class="header"&gt;
&lt;th style="text-align: left;"&gt;序列&lt;/th&gt;
&lt;th style="text-align: left;"&gt;作用&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class="odd"&gt;
&lt;td style="text-align: left;"&gt;&lt;code&gt;Mod + f&lt;/code&gt;&lt;/td&gt;
&lt;td style="text-align: left;"&gt;进入/退出全屏模式&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="even"&gt;
&lt;td style="text-align: left;"&gt;&lt;code&gt;Mod + Left/Right&lt;/code&gt;&lt;/td&gt;
&lt;td style="text-align: left;"&gt;旋转方向&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="odd"&gt;
&lt;td style="text-align: left;"&gt;&lt;code&gt;Mod + h&lt;/code&gt;&lt;/td&gt;
&lt;td style="text-align: left;"&gt;Home 键&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="even"&gt;
&lt;td style="text-align: left;"&gt;&lt;code&gt;Mod + b&lt;/code&gt;&lt;/td&gt;
&lt;td style="text-align: left;"&gt;Back 键盘（右击鼠标亦可）&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="odd"&gt;
&lt;td style="text-align: left;"&gt;&lt;code&gt;Mod + s&lt;/code&gt;&lt;/td&gt;
&lt;td style="text-align: left;"&gt;最近应用列表&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="even"&gt;
&lt;td style="text-align: left;"&gt;&lt;code&gt;Mod + m&lt;/code&gt;&lt;/td&gt;
&lt;td style="text-align: left;"&gt;应用菜单键&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="odd"&gt;
&lt;td style="text-align: left;"&gt;&lt;code&gt;Mod + Up/Down&lt;/code&gt;&lt;/td&gt;
&lt;td style="text-align: left;"&gt;调节音量&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="even"&gt;
&lt;td style="text-align: left;"&gt;&lt;code&gt;Mod + Shift + o&lt;/code&gt;&lt;/td&gt;
&lt;td style="text-align: left;"&gt;关闭屏幕&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="odd"&gt;
&lt;td style="text-align: left;"&gt;&lt;code&gt;Mod + Shift + n&lt;/code&gt;&lt;/td&gt;
&lt;td style="text-align: left;"&gt;下拉系统菜单&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="even"&gt;
&lt;td style="text-align: left;"&gt;&lt;code&gt;Mod + Shift + v&lt;/code&gt;&lt;/td&gt;
&lt;td style="text-align: left;"&gt;从系统剪贴板输入序列&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h1 id="参考"&gt;参考&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://github.com/Genymobile/scrcpy/issues/1413"&gt;scrcpy有关「桌面模式」的 issue&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://github.com/rom1v/sndcpy"&gt;sndcpy 仓库&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://userbase.kde.org/KDEConnect"&gt;KDE Connect 手册&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;br/&gt;
&lt;!--%%REF%%--&gt;
&lt;br/&gt;
&lt;script async="" crossorigin="anonymous" data-category="Announcements" data-category-id="DIC_kwDOJ7Ymy84CX4eg" data-emit-metadata="0" data-input-position="top" data-lang="zh-CN" data-loading="lazy" data-mapping="title" data-reactions-enabled="1" data-repo="izfsk-ium/izfsk-ium.github.io" data-repo-id="R_kgDOJ7Ymyw" data-strict="0" data-theme="preferred_color_scheme" src="https://giscus.app/client.js"&gt;
&lt;/script&gt;
&lt;/main&gt;
&lt;footer&gt;
&lt;p class="signoff"&gt;
&lt;div class="metadata"&gt;
&lt;p class="date"&gt;&lt;time datetime="2022-12-19"&gt;创建日期：2022-12-19&lt;/time&gt;&lt;/p&gt;
&lt;p class="lastmodify"&gt;&lt;time&gt;最后编译：2023-08-10&lt;/time&gt;&lt;/p&gt;
&lt;p class="lastmodify" id="counter-span"&gt;访问次数：&lt;/p&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;/footer&gt;
&lt;script&gt;
    /* These script should run after page load */
    document.querySelectorAll('code.sourceCode').forEach(
      i =&gt; i.insertAdjacentHTML('beforeend', '&lt;div class="copy"&gt;复制&lt;/div&gt;')
    );
    document.querySelectorAll('div.copy').forEach(
      i =&gt; i.addEventListener(
        'click',
        () =&gt; {
          navigator.clipboard.writeText(i.parentElement.innerText.replace('复制', ''));
          i.innerText = '成功';
          setTimeout(() =&gt; {
            i.innerText = '复制';
          }, 1000);
        }
      )
    );

    if (location.href.includes("127.0.0.1:8080")) {
      document.getElementById("counter-span").innerHTML = "[[development mode]]";
    } else {
      const uuid = document.getElementById("article-uuid").innerText;
      const target = document.getElementById("counter-span");
      const last = localStorage.getItem("lastVisit-" + uuid);
      const shouldIncrease = last === null || new Date().getTime() - parseInt(last) &gt;= (1000 * 60 * 15);

      fetch(shouldIncrease ? ("https://counter.izfsk.top/counter/" + uuid) : ("https://counter.izfsk.top/readOnly/" + uuid))
        .then(r =&gt; r.text())
        .then(d =&gt; {
          if (!d.startsWith("Too"))
            document.getElementById("counter-span").innerText = "访问次数：" + d.toString();
          else
            document.getElementById("counter-span").innerHTML = "";
        });

      localStorage.setItem("lastVisit-" + uuid, new Date().getTime());
    }
  &lt;/script&gt;
&lt;script async="" data-website-id="2a1146ab-fa82-4a84-a04f-30e5967357c3" src="https://analytics.umami.is/script.js"&gt;&lt;/script&gt;
&lt;/body&gt;</content:encoded>
      <guid isPermaLink="false">92a3c86b-baca-4a5d-bf87-e4b091adfd74</guid>
      <pubDate>Mon, 19 Dec 2022 00:00:00 +0800</pubDate>
    </item>
    <item>
      <title>Rclone挂载Office365教育版</title>
      <link>https://blog.izfsk.top/articles/Rclone挂载Office365教育版.html</link>
      <description>Rclone挂载Office365教育版</description>
      <content:encoded>&lt;body&gt;
&lt;progress id="content_progress" value="0"&gt;&lt;/progress&gt;
&lt;button id="back-to-top"&gt;
    回页顶
  &lt;/button&gt;
&lt;header&gt;
&lt;small id="article-uuid" style="display: none !important;"&gt;e2e757b5-b9d8-4613-92b4-1bdd12738583&lt;/small&gt;
&lt;h1 class="title"&gt;Rclone挂载Office365教育版&lt;/h1&gt;
&lt;!-- Subtitle --&gt;
&lt;h3 class="subtitle"&gt; &lt;/h3&gt;
&lt;/header&gt;
&lt;nav id="TOC" role="doc-toc"&gt;
&lt;strong&gt;文章归类: &lt;a href="/pages/category.html#备忘录"&gt;备忘录&lt;/a&gt; &lt;/strong&gt;
&lt;input id="contents" type="checkbox"/&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#非教育版帐号" id="toc-非教育版帐号"&gt;非教育版帐号&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#教育版" id="toc-教育版"&gt;教育版&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#注意事项" id="toc-注意事项"&gt;注意事项&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#sftp公钥登录" id="toc-sftp公钥登录"&gt;sftp公钥登录&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#参见" id="toc-参见"&gt;参见：&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#reference"&gt;参考链接&lt;/a&gt;&lt;/li&gt;
&lt;li&gt; &lt;/li&gt;
&lt;li class="tools"&gt;
&lt;span id="backtomain"&gt;
&lt;svg class="bi bi-house" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M8.707 1.5a1 1 0 0 0-1.414 0L.646 8.146a.5.5 0 0 0 .708.708L2 8.207V13.5A1.5 1.5 0 0 0 3.5 15h9a1.5 1.5 0 0 0 1.5-1.5V8.207l.646.647a.5.5 0 0 0 .708-.708L13 5.793V2.5a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v1.293L8.707 1.5ZM13 7.207V13.5a.5.5 0 0 1-.5.5h-9a.5.5 0 0 1-.5-.5V7.207l5-5 5 5Z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="readingmode"&gt;
&lt;svg class="bi bi-book" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M1 2.828c.885-.37 2.154-.769 3.388-.893 1.33-.134 2.458.063 3.112.752v9.746c-.935-.53-2.12-.603-3.213-.493-1.18.12-2.37.461-3.287.811V2.828zm7.5-.141c.654-.689 1.782-.886 3.112-.752 1.234.124 2.503.523 3.388.893v9.923c-.918-.35-2.107-.692-3.287-.81-1.094-.111-2.278-.039-3.213.492V2.687zM8 1.783C7.015.936 5.587.81 4.287.94c-1.514.153-3.042.672-3.994 1.105A.5.5 0 0 0 0 2.5v11a.5.5 0 0 0 .707.455c.882-.4 2.303-.881 3.68-1.02 1.409-.142 2.59.087 3.223.877a.5.5 0 0 0 .78 0c.633-.79 1.814-1.019 3.222-.877 1.378.139 2.8.62 3.681 1.02A.5.5 0 0 0 16 13.5v-11a.5.5 0 0 0-.293-.455c-.952-.433-2.48-.952-3.994-1.105C10.413.809 8.985.936 8 1.783z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="larger"&gt; &lt;/span&gt;
&lt;span id="smaller"&gt;&lt;/span&gt;
&lt;span id="switchfont"&gt;
&lt;svg class="bi bi-fonts" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M12.258 3h-8.51l-.083 2.46h.479c.26-1.544.758-1.783 2.693-1.845l.424-.013v7.827c0 .663-.144.82-1.3.923v.52h4.082v-.52c-1.162-.103-1.306-.26-1.306-.923V3.602l.431.013c1.934.062 2.434.301 2.693 1.846h.479L12.258 3z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="backtotop"&gt;
&lt;svg class="bi bi-arrow-bar-up" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M8 10a.5.5 0 0 0 .5-.5V3.707l2.146 2.147a.5.5 0 0 0 .708-.708l-3-3a.5.5 0 0 0-.708 0l-3 3a.5.5 0 1 0 .708.708L7.5 3.707V9.5a.5.5 0 0 0 .5.5zm-7 2.5a.5.5 0 0 1 .5-.5h13a.5.5 0 0 1 0 1h-13a.5.5 0 0 1-.5-.5z" fill-rule="evenodd"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/nav&gt;
&lt;main&gt;
&lt;p&gt;有时候我还是很羡慕 Windows 用户能在他们的资源管理器里面直接和 OneDrive 交互，我想要在 Linux 上也实现这样的功能。恰好我有 OneDrive 帐号，结合 rclone 即可。&lt;/p&gt;
&lt;h1 id="非教育版帐号"&gt;非教育版帐号&lt;/h1&gt;
&lt;p&gt;很简单。安装 rclone 之后，运行 &lt;code&gt;rclone config&lt;/code&gt; ，按照向导一步步创建配置即可。建议给配置取的名字不要有空格和非英文符号。在创建完毕以后，使用 &lt;code&gt;rclone lsd &amp;lt;config-name&amp;gt;:&lt;/code&gt; 测试即可。 &lt;strong&gt;注意配置名称后面的那个冒号不要漏掉&lt;/strong&gt;。&lt;/p&gt;
&lt;p&gt;至于集成在系统里面很简单。可以直接挂载成 FUSE 文件系统给各个程序无缝使用：&lt;/p&gt;
&lt;pre class="shell"&gt;&lt;code&gt;$ rclone mount remote:path /local/path&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;但是如果网络不稳定那就会带来很多奇怪问题，所以参考&lt;a href="https://imbearchild.cyou/archives/2021/12/onedrive-and-rclone-on-linux/#comment-44"&gt;这篇文章&lt;/a&gt;使用 Webdav 方法挂载：&lt;/p&gt;
&lt;pre class="shell"&gt;&lt;code&gt;$ rclone serve webdav --addr=127.0.0.1:11451 --user=user --pass=114514 --vfs-cache-mode=full &amp;lt;config-name&amp;gt;:&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;让 rclone 作为 WebDav 服务器运行。如果你使用 KDE 的话，在 Dolphin 中添加一个远程即可：&lt;/p&gt;
&lt;figure&gt;
&lt;img alt="dolphin" src="./assets/dolphin.webp"/&gt;
&lt;figcaption aria-hidden="true"&gt;dolphin&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;然后你就可以在右侧的 Remote 中找到 OneDrive 了。第一次点开可能需要你输入用户名和密码，这个用户名和密码是 rclone webdav 服务器的，不是你的微软帐号。&lt;/p&gt;
&lt;p&gt;如下图，上面的教育版，下面的是个人帐号。&lt;/p&gt;
&lt;figure&gt;
&lt;img alt="accounts" src="./assets/account.webp"/&gt;
&lt;figcaption aria-hidden="true"&gt;accounts&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;h1 id="教育版"&gt;教育版&lt;/h1&gt;
&lt;p&gt;很遗憾，教育版本不能使用这个方法登录。如果你尝试在浏览器验证，那么会得到 &lt;code&gt;error=invalid_client&lt;/code&gt; 的消息。&lt;code&gt;rclone&lt;/code&gt; 如果要接管你的教育版 OneDrive，需要得到域管理员的同意。除非你能够说服学校负责人，否则不能连接第三方应用。所以必须使用其他方法。&lt;/p&gt;
&lt;p&gt;Office365 有个功能叫 SharePoint，而这个玩意可以作为 WebDav 操作。对微软复杂的产品我不很了解，但这个 WebDav 是可以直接用 rclone 挂载的。&lt;/p&gt;
&lt;ol type="1"&gt;
&lt;li&gt;&lt;p&gt;首先，你需要网页版进入你的 OneDrive，网址应该是以 &lt;code&gt;https://&amp;lt;你的组织名称&amp;gt;-my.sharepoint.com/personal/&amp;lt;你的帐号名称&amp;gt;/....&lt;/code&gt; 这样的模式开头。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;在 OneDrive 的根目录创建一个 &lt;code&gt;Documents&lt;/code&gt; 目录，当然其他名称也可以。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;按照这个模式拼接出 SharePoint 地址：&lt;/p&gt;
&lt;pre class="url"&gt;&lt;code&gt;https://&amp;lt;你的组织名称&amp;gt;-my.sharepoint.com/personal/&amp;lt;你的账户名称&amp;gt;/Documents&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;其实也就是直接复制网址，把后面的多余部分清除，再加上 Documents。账户名称里面的下划线不要改动。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;创建 rclone 配置，选择类型是 WebDAV，输入第四步创建的 URL，再选择 &lt;code&gt;Sharepoint Online, authenticated by Microsoft account&lt;/code&gt; 作为 vendor，接着输入&lt;strong&gt;你的账户名和密码&lt;/strong&gt;，也就是你用来登录网页版 OneDrive 的账户名(你的学校邮箱)和密码。&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;最后的结果应该是这样的：&lt;/p&gt;
&lt;pre class="shell"&gt;&lt;code&gt;Configuration complete.
Options:
- type: webdav
- url: https://&amp;lt;你的组织名称&amp;gt;-my.sharepoint.com/personal/&amp;lt;你的账户名称&amp;gt;/Documents
- vendor: sharepoint
- user: 你的账户
- pass: *** ENCRYPTED ***&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;接下来使用 &lt;code&gt;rclone lsd &amp;lt;config-name&amp;gt;:&lt;/code&gt; 测试即可。挂载集成和之前一样，开一个 rclone 的 WebDav 再转手一次。&lt;/p&gt;
&lt;h2 id="注意事项"&gt;注意事项&lt;/h2&gt;
&lt;ol type="1"&gt;
&lt;li&gt;虽然配置的 url 是 Documents，但是实际挂载的就是整个网盘，url 路径和挂载无关，但必须要有一个，不能是根目录。&lt;/li&gt;
&lt;li&gt;如果你的 OneDrive 网页版还登录着，那么 Dolphin 中挂载的 SharePoint 就是只读的，必须把其他 session 全部退出再重新挂载才能读写。&lt;/li&gt;
&lt;li&gt;如果你碰到了 &lt;code&gt;Failed to create file system for "xxx:": :  ()&lt;/code&gt; 这样的问题，就是你的账户名和密码不对，检测一遍。&lt;strong&gt;username 就是你的邮箱，不是 「Domain」 的格式，也不要把点号替换成 url 里面的下划线&lt;/strong&gt;。&lt;/li&gt;
&lt;/ol&gt;
&lt;h1 id="sftp公钥登录"&gt;sftp公钥登录&lt;/h1&gt;
&lt;p&gt;Dolphin 支持的远程协议很多，包括 sftp，如果你有个服务器的话挂载在本地似乎也不错。直接在 Dolphin 新建，输入 &lt;code&gt;sftp://&amp;lt;username&amp;gt;@&amp;lt;ip&amp;gt;&lt;/code&gt; 创建配置。&lt;/p&gt;
&lt;p&gt;但是，如果你的服务器是公钥登录，就会失败， Dolphin 不会让你输入公钥。你需要修改 &lt;code&gt;~/.ssh/config&lt;/code&gt;，添加条目来做到自动连接。格式如下：&lt;/p&gt;
&lt;div class="sourceCode" id="cb5"&gt;&lt;pre class="sourceCode ini"&gt;&lt;code class="sourceCode ini"&gt;&lt;span id="cb5-1"&gt;&lt;a aria-hidden="true" href="#cb5-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="dt"&gt;Host 114.51.41.191&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb5-2"&gt;&lt;a aria-hidden="true" href="#cb5-2" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="dt"&gt;  HostName 114.51.41.191&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb5-3"&gt;&lt;a aria-hidden="true" href="#cb5-3" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="dt"&gt;  IdentityFile ~/path/of/keyfile&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb5-4"&gt;&lt;a aria-hidden="true" href="#cb5-4" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="dt"&gt;  User username&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;然后就能正常连接了。&lt;/p&gt;
&lt;h1 id="参见"&gt;参见：&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://imbearchild.cyou/archives/2021/12/onedrive-and-rclone-on-linux/#comment-44"&gt;Linux 版 OneDrive 与 Rclone 食用指南 by IMBEARCHILD&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;br/&gt;
&lt;!--%%REF%%--&gt;
&lt;br/&gt;
&lt;script async="" crossorigin="anonymous" data-category="Announcements" data-category-id="DIC_kwDOJ7Ymy84CX4eg" data-emit-metadata="0" data-input-position="top" data-lang="zh-CN" data-loading="lazy" data-mapping="title" data-reactions-enabled="1" data-repo="izfsk-ium/izfsk-ium.github.io" data-repo-id="R_kgDOJ7Ymyw" data-strict="0" data-theme="preferred_color_scheme" src="https://giscus.app/client.js"&gt;
&lt;/script&gt;
&lt;/main&gt;
&lt;footer&gt;
&lt;p class="signoff"&gt;
&lt;div class="metadata"&gt;
&lt;p class="date"&gt;&lt;time datetime="2022-12-20"&gt;创建日期：2022-12-20&lt;/time&gt;&lt;/p&gt;
&lt;p class="lastmodify"&gt;&lt;time&gt;最后编译：2023-08-10&lt;/time&gt;&lt;/p&gt;
&lt;p class="lastmodify" id="counter-span"&gt;访问次数：&lt;/p&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;/footer&gt;
&lt;script&gt;
    /* These script should run after page load */
    document.querySelectorAll('code.sourceCode').forEach(
      i =&gt; i.insertAdjacentHTML('beforeend', '&lt;div class="copy"&gt;复制&lt;/div&gt;')
    );
    document.querySelectorAll('div.copy').forEach(
      i =&gt; i.addEventListener(
        'click',
        () =&gt; {
          navigator.clipboard.writeText(i.parentElement.innerText.replace('复制', ''));
          i.innerText = '成功';
          setTimeout(() =&gt; {
            i.innerText = '复制';
          }, 1000);
        }
      )
    );

    if (location.href.includes("127.0.0.1:8080")) {
      document.getElementById("counter-span").innerHTML = "[[development mode]]";
    } else {
      const uuid = document.getElementById("article-uuid").innerText;
      const target = document.getElementById("counter-span");
      const last = localStorage.getItem("lastVisit-" + uuid);
      const shouldIncrease = last === null || new Date().getTime() - parseInt(last) &gt;= (1000 * 60 * 15);

      fetch(shouldIncrease ? ("https://counter.izfsk.top/counter/" + uuid) : ("https://counter.izfsk.top/readOnly/" + uuid))
        .then(r =&gt; r.text())
        .then(d =&gt; {
          if (!d.startsWith("Too"))
            document.getElementById("counter-span").innerText = "访问次数：" + d.toString();
          else
            document.getElementById("counter-span").innerHTML = "";
        });

      localStorage.setItem("lastVisit-" + uuid, new Date().getTime());
    }
  &lt;/script&gt;
&lt;script async="" data-website-id="2a1146ab-fa82-4a84-a04f-30e5967357c3" src="https://analytics.umami.is/script.js"&gt;&lt;/script&gt;
&lt;/body&gt;</content:encoded>
      <guid isPermaLink="false">e2e757b5-b9d8-4613-92b4-1bdd12738583</guid>
      <pubDate>Tue, 20 Dec 2022 00:00:00 +0800</pubDate>
    </item>
    <item>
      <title>ELF文件结构解析</title>
      <link>https://blog.izfsk.top/articles/ELF文件结构解析.html</link>
      <description>ELF文件结构解析</description>
      <content:encoded>&lt;body&gt;
&lt;progress id="content_progress" value="0"&gt;&lt;/progress&gt;
&lt;button id="back-to-top"&gt;
    回页顶
  &lt;/button&gt;
&lt;header&gt;
&lt;small id="article-uuid" style="display: none !important;"&gt;5b68c30c-b953-4bee-a7e9-51aa7f2a30e8&lt;/small&gt;
&lt;h1 class="title"&gt;ELF文件结构解析&lt;/h1&gt;
&lt;!-- Subtitle --&gt;
&lt;h3 class="subtitle"&gt; &lt;/h3&gt;
&lt;/header&gt;
&lt;nav id="TOC" role="doc-toc"&gt;
&lt;strong&gt;文章归类: &lt;a href="/pages/category.html#学习"&gt;学习&lt;/a&gt; &lt;/strong&gt;
&lt;input id="contents" type="checkbox"/&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#elf-文件" id="toc-elf-文件"&gt;ELF 文件&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#读取和解析-elf-文件" id="toc-读取和解析-elf-文件"&gt;读取和解析 ELF 文件&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#使用-readelf-工具" id="toc-使用-readelf-工具"&gt;使用 readelf 工具&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#reference"&gt;参考链接&lt;/a&gt;&lt;/li&gt;
&lt;li&gt; &lt;/li&gt;
&lt;li class="tools"&gt;
&lt;span id="backtomain"&gt;
&lt;svg class="bi bi-house" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M8.707 1.5a1 1 0 0 0-1.414 0L.646 8.146a.5.5 0 0 0 .708.708L2 8.207V13.5A1.5 1.5 0 0 0 3.5 15h9a1.5 1.5 0 0 0 1.5-1.5V8.207l.646.647a.5.5 0 0 0 .708-.708L13 5.793V2.5a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v1.293L8.707 1.5ZM13 7.207V13.5a.5.5 0 0 1-.5.5h-9a.5.5 0 0 1-.5-.5V7.207l5-5 5 5Z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="readingmode"&gt;
&lt;svg class="bi bi-book" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M1 2.828c.885-.37 2.154-.769 3.388-.893 1.33-.134 2.458.063 3.112.752v9.746c-.935-.53-2.12-.603-3.213-.493-1.18.12-2.37.461-3.287.811V2.828zm7.5-.141c.654-.689 1.782-.886 3.112-.752 1.234.124 2.503.523 3.388.893v9.923c-.918-.35-2.107-.692-3.287-.81-1.094-.111-2.278-.039-3.213.492V2.687zM8 1.783C7.015.936 5.587.81 4.287.94c-1.514.153-3.042.672-3.994 1.105A.5.5 0 0 0 0 2.5v11a.5.5 0 0 0 .707.455c.882-.4 2.303-.881 3.68-1.02 1.409-.142 2.59.087 3.223.877a.5.5 0 0 0 .78 0c.633-.79 1.814-1.019 3.222-.877 1.378.139 2.8.62 3.681 1.02A.5.5 0 0 0 16 13.5v-11a.5.5 0 0 0-.293-.455c-.952-.433-2.48-.952-3.994-1.105C10.413.809 8.985.936 8 1.783z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="larger"&gt; &lt;/span&gt;
&lt;span id="smaller"&gt;&lt;/span&gt;
&lt;span id="switchfont"&gt;
&lt;svg class="bi bi-fonts" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M12.258 3h-8.51l-.083 2.46h.479c.26-1.544.758-1.783 2.693-1.845l.424-.013v7.827c0 .663-.144.82-1.3.923v.52h4.082v-.52c-1.162-.103-1.306-.26-1.306-.923V3.602l.431.013c1.934.062 2.434.301 2.693 1.846h.479L12.258 3z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="backtotop"&gt;
&lt;svg class="bi bi-arrow-bar-up" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M8 10a.5.5 0 0 0 .5-.5V3.707l2.146 2.147a.5.5 0 0 0 .708-.708l-3-3a.5.5 0 0 0-.708 0l-3 3a.5.5 0 1 0 .708.708L7.5 3.707V9.5a.5.5 0 0 0 .5.5zm-7 2.5a.5.5 0 0 1 .5-.5h13a.5.5 0 0 1 0 1h-13a.5.5 0 0 1-.5-.5z" fill-rule="evenodd"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/nav&gt;
&lt;main&gt;
&lt;blockquote&gt;
&lt;p&gt;「所谓文件就是一大袋子字节，而它的含义则取决于程序怎么解释它。」&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h1 id="elf-文件"&gt;ELF 文件&lt;/h1&gt;
&lt;p&gt;ELF 的全称是「Executable and Linkable Format」。是最常见的可执行文件格式。其源自于 SystemV UNIX R3 版本的 COFF 格式，后来微软基于 COFF 发展了 PE 格式，SystemV UNIX R4 基于 COFF 发展了 ELF 格式。&lt;/p&gt;
&lt;p&gt;ELF 文件也就是一个普通的文件。它包含一个文件头和若干个段。段的数量是任意的，头只能用一个。每个段都有一个字符串名称，一般以「.」开头的段名称，诸如 &lt;code&gt;.text&lt;/code&gt;, &lt;code&gt;.bss&lt;/code&gt; 等是编辑器保留的名称。所有的段名对于操作系统来讲没有意义，只有这些段的属性，诸如「可执行」，「只读」等有意义。&lt;/p&gt;
&lt;p&gt;要解析 ELF 格式，其目标实际上就是精确的得到各个段的位置和它们的名字。&lt;/p&gt;
&lt;h1 id="读取和解析-elf-文件"&gt;读取和解析 ELF 文件&lt;/h1&gt;
&lt;p&gt;读取 ELF 文件需要获得几个重要的结构，此处以 x86-64 系统为例，需要获取的分别是 ELF 文件头，保存该文件所以段的信息（不是段本身的内容）的数组，以及保存段表字符串表的字符数组。其中：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;ELF 文件头。&lt;/p&gt;
&lt;p&gt;结构名称为 &lt;code&gt;Elf64_Ehdr&lt;/code&gt;。每一个 ELF 文件只有一个。保存了关于这个文件的属性信息，和用来定位段表位置的 &lt;code&gt;e_phentsize&lt;/code&gt; 和用来获取段表字符串表在段表中的下标的 &lt;code&gt;e_shstrndx&lt;/code&gt;。&lt;/p&gt;
&lt;div class="sourceCode" id="cb1"&gt;&lt;pre class="sourceCode c"&gt;&lt;code class="sourceCode c"&gt;&lt;span id="cb1-1"&gt;&lt;a aria-hidden="true" href="#cb1-1" tabindex="-1"&gt;&lt;/a&gt;  &lt;span class="kw"&gt;typedef&lt;/span&gt; &lt;span class="kw"&gt;struct&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-2"&gt;&lt;a aria-hidden="true" href="#cb1-2" tabindex="-1"&gt;&lt;/a&gt;  &lt;span class="op"&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-3"&gt;&lt;a aria-hidden="true" href="#cb1-3" tabindex="-1"&gt;&lt;/a&gt;      &lt;span class="dt"&gt;unsigned&lt;/span&gt; &lt;span class="dt"&gt;char&lt;/span&gt;   e_ident&lt;span class="op"&gt;[&lt;/span&gt;EI_NIDENT&lt;span class="op"&gt;];&lt;/span&gt; &lt;span class="co"&gt;/* Magic number and other info */&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-4"&gt;&lt;a aria-hidden="true" href="#cb1-4" tabindex="-1"&gt;&lt;/a&gt;      Elf64_Half  e_type&lt;span class="op"&gt;;&lt;/span&gt;         &lt;span class="co"&gt;/* Object file type */&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-5"&gt;&lt;a aria-hidden="true" href="#cb1-5" tabindex="-1"&gt;&lt;/a&gt;      Elf64_Half  e_machine&lt;span class="op"&gt;;&lt;/span&gt;      &lt;span class="co"&gt;/* Architecture */&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-6"&gt;&lt;a aria-hidden="true" href="#cb1-6" tabindex="-1"&gt;&lt;/a&gt;      Elf64_Word  e_version&lt;span class="op"&gt;;&lt;/span&gt;      &lt;span class="co"&gt;/* Object file version */&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-7"&gt;&lt;a aria-hidden="true" href="#cb1-7" tabindex="-1"&gt;&lt;/a&gt;      Elf64_Addr  e_entry&lt;span class="op"&gt;;&lt;/span&gt;        &lt;span class="co"&gt;/* Entry point virtual address */&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-8"&gt;&lt;a aria-hidden="true" href="#cb1-8" tabindex="-1"&gt;&lt;/a&gt;      Elf64_Off   e_phoff&lt;span class="op"&gt;;&lt;/span&gt;        &lt;span class="co"&gt;/* Program header table file offset */&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-9"&gt;&lt;a aria-hidden="true" href="#cb1-9" tabindex="-1"&gt;&lt;/a&gt;      Elf64_Off   e_shoff&lt;span class="op"&gt;;&lt;/span&gt;        &lt;span class="co"&gt;/* Section header table file offset */&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-10"&gt;&lt;a aria-hidden="true" href="#cb1-10" tabindex="-1"&gt;&lt;/a&gt;      Elf64_Word  e_flags&lt;span class="op"&gt;;&lt;/span&gt;        &lt;span class="co"&gt;/* Processor-specific flags */&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-11"&gt;&lt;a aria-hidden="true" href="#cb1-11" tabindex="-1"&gt;&lt;/a&gt;      Elf64_Half  e_ehsize&lt;span class="op"&gt;;&lt;/span&gt;       &lt;span class="co"&gt;/* ELF header size in bytes */&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-12"&gt;&lt;a aria-hidden="true" href="#cb1-12" tabindex="-1"&gt;&lt;/a&gt;      Elf64_Half  e_phentsize&lt;span class="op"&gt;;&lt;/span&gt;        &lt;span class="co"&gt;/* Program header table entry size */&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-13"&gt;&lt;a aria-hidden="true" href="#cb1-13" tabindex="-1"&gt;&lt;/a&gt;      Elf64_Half  e_phnum&lt;span class="op"&gt;;&lt;/span&gt;        &lt;span class="co"&gt;/* Program header table entry count */&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-14"&gt;&lt;a aria-hidden="true" href="#cb1-14" tabindex="-1"&gt;&lt;/a&gt;      Elf64_Half  e_shentsize&lt;span class="op"&gt;;&lt;/span&gt;        &lt;span class="co"&gt;/* Section header table entry size */&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-15"&gt;&lt;a aria-hidden="true" href="#cb1-15" tabindex="-1"&gt;&lt;/a&gt;      Elf64_Half  e_shnum&lt;span class="op"&gt;;&lt;/span&gt;        &lt;span class="co"&gt;/* Section header table entry count */&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-16"&gt;&lt;a aria-hidden="true" href="#cb1-16" tabindex="-1"&gt;&lt;/a&gt;      Elf64_Half  e_shstrndx&lt;span class="op"&gt;;&lt;/span&gt;     &lt;span class="co"&gt;/* Section header string table index */&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-17"&gt;&lt;a aria-hidden="true" href="#cb1-17" tabindex="-1"&gt;&lt;/a&gt;  &lt;span class="op"&gt;}&lt;/span&gt; Elf64_Ehdr&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;读取方式可以是：&lt;/p&gt;
&lt;div class="sourceCode" id="cb2"&gt;&lt;pre class="sourceCode c"&gt;&lt;code class="sourceCode c"&gt;&lt;span id="cb2-1"&gt;&lt;a aria-hidden="true" href="#cb2-1" tabindex="-1"&gt;&lt;/a&gt;Elf64_Ehdr &lt;span class="op"&gt;*&lt;/span&gt;header &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="op"&gt;(&lt;/span&gt;Elf64_Ehdr &lt;span class="op"&gt;*)&lt;/span&gt;malloc&lt;span class="op"&gt;(&lt;/span&gt;&lt;span class="kw"&gt;sizeof&lt;/span&gt;&lt;span class="op"&gt;(&lt;/span&gt;Elf64_Ehdr&lt;span class="op"&gt;));&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-2"&gt;&lt;a aria-hidden="true" href="#cb2-2" tabindex="-1"&gt;&lt;/a&gt;fread&lt;span class="op"&gt;(&lt;/span&gt;header&lt;span class="op"&gt;,&lt;/span&gt; &lt;span class="kw"&gt;sizeof&lt;/span&gt;&lt;span class="op"&gt;(&lt;/span&gt;Elf64_Ehdr&lt;span class="op"&gt;),&lt;/span&gt; &lt;span class="dv"&gt;1&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt; fp_elf&lt;span class="op"&gt;);&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;段表。&lt;/p&gt;
&lt;p&gt;段表是一个 &lt;code&gt;Elf64_Shdr&lt;/code&gt; 构成的数组。每一个元素保存了这个段在文件中的偏移，以及这个段的属性。其中 &lt;code&gt;sh_name&lt;/code&gt; 是用来定位这个段的名字在段表字符串表中的下标。这个段表的偏移在文件头中，大小可以用「每段长度 * 段的数量」确定。两者都在文件头中给出。&lt;/p&gt;
&lt;div class="sourceCode" id="cb3"&gt;&lt;pre class="sourceCode c"&gt;&lt;code class="sourceCode c"&gt;&lt;span id="cb3-1"&gt;&lt;a aria-hidden="true" href="#cb3-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;typedef&lt;/span&gt; &lt;span class="kw"&gt;struct&lt;/span&gt; &lt;span class="op"&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb3-2"&gt;&lt;a aria-hidden="true" href="#cb3-2" tabindex="-1"&gt;&lt;/a&gt;    Elf64_Word  sh_name&lt;span class="op"&gt;;&lt;/span&gt;        &lt;span class="co"&gt;/* Section name (string tbl index) */&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb3-3"&gt;&lt;a aria-hidden="true" href="#cb3-3" tabindex="-1"&gt;&lt;/a&gt;    Elf64_Word  sh_type&lt;span class="op"&gt;;&lt;/span&gt;        &lt;span class="co"&gt;/* Section type */&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb3-4"&gt;&lt;a aria-hidden="true" href="#cb3-4" tabindex="-1"&gt;&lt;/a&gt;    Elf64_Xword sh_flags&lt;span class="op"&gt;;&lt;/span&gt;       &lt;span class="co"&gt;/* Section flags */&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb3-5"&gt;&lt;a aria-hidden="true" href="#cb3-5" tabindex="-1"&gt;&lt;/a&gt;    Elf64_Addr  sh_addr&lt;span class="op"&gt;;&lt;/span&gt;        &lt;span class="co"&gt;/* Section virtual addr at execution */&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb3-6"&gt;&lt;a aria-hidden="true" href="#cb3-6" tabindex="-1"&gt;&lt;/a&gt;    Elf64_Off   sh_offset&lt;span class="op"&gt;;&lt;/span&gt;      &lt;span class="co"&gt;/* Section file offset */&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb3-7"&gt;&lt;a aria-hidden="true" href="#cb3-7" tabindex="-1"&gt;&lt;/a&gt;    Elf64_Xword sh_size&lt;span class="op"&gt;;&lt;/span&gt;        &lt;span class="co"&gt;/* Section size in bytes */&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb3-8"&gt;&lt;a aria-hidden="true" href="#cb3-8" tabindex="-1"&gt;&lt;/a&gt;    Elf64_Word  sh_link&lt;span class="op"&gt;;&lt;/span&gt;        &lt;span class="co"&gt;/* Link to another section */&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb3-9"&gt;&lt;a aria-hidden="true" href="#cb3-9" tabindex="-1"&gt;&lt;/a&gt;    Elf64_Word  sh_info&lt;span class="op"&gt;;&lt;/span&gt;        &lt;span class="co"&gt;/* Additional section information */&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb3-10"&gt;&lt;a aria-hidden="true" href="#cb3-10" tabindex="-1"&gt;&lt;/a&gt;    Elf64_Xword sh_addralign&lt;span class="op"&gt;;&lt;/span&gt;       &lt;span class="co"&gt;/* Section alignment */&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb3-11"&gt;&lt;a aria-hidden="true" href="#cb3-11" tabindex="-1"&gt;&lt;/a&gt;    Elf64_Xword sh_entsize&lt;span class="op"&gt;;&lt;/span&gt;     &lt;span class="co"&gt;/* Entry size if section holds table */&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb3-12"&gt;&lt;a aria-hidden="true" href="#cb3-12" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="op"&gt;}&lt;/span&gt; Elf64_Shdr&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;获取整个段表可以是：&lt;/p&gt;
&lt;div class="sourceCode" id="cb4"&gt;&lt;pre class="sourceCode c"&gt;&lt;code class="sourceCode c"&gt;&lt;span id="cb4-1"&gt;&lt;a aria-hidden="true" href="#cb4-1" tabindex="-1"&gt;&lt;/a&gt;Elf_Shdr &lt;span class="op"&gt;*&lt;/span&gt;section_table &lt;span class="op"&gt;=&lt;/span&gt; malloc&lt;span class="op"&gt;(&lt;/span&gt;header&lt;span class="op"&gt;.&lt;/span&gt;e_shnum &lt;span class="op"&gt;*&lt;/span&gt; &lt;span class="kw"&gt;sizeof&lt;/span&gt;&lt;span class="op"&gt;(&lt;/span&gt;Elf64_Shdr&lt;span class="op"&gt;)&lt;/span&gt; &lt;span class="op"&gt;);&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb4-2"&gt;&lt;a aria-hidden="true" href="#cb4-2" tabindex="-1"&gt;&lt;/a&gt;fseek&lt;span class="op"&gt;(&lt;/span&gt;file&lt;span class="op"&gt;,&lt;/span&gt; header&lt;span class="op"&gt;.&lt;/span&gt;e_shoff&lt;span class="op"&gt;,&lt;/span&gt; &lt;span class="dv"&gt;0&lt;/span&gt;&lt;span class="op"&gt;);&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb4-3"&gt;&lt;a aria-hidden="true" href="#cb4-3" tabindex="-1"&gt;&lt;/a&gt;fread&lt;span class="op"&gt;(&lt;/span&gt;section_table&lt;span class="op"&gt;,&lt;/span&gt; &lt;span class="kw"&gt;sizeof&lt;/span&gt;&lt;span class="op"&gt;(&lt;/span&gt;Elf64_Shdr&lt;span class="op"&gt;),&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb4-4"&gt;&lt;a aria-hidden="true" href="#cb4-4" tabindex="-1"&gt;&lt;/a&gt;        header&lt;span class="op"&gt;.&lt;/span&gt;e_shnum&lt;span class="op"&gt;,&lt;/span&gt; file&lt;span class="op"&gt;);&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;strong&gt;注意&lt;/strong&gt;：段表的第一项所有项目都是 NULL 。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;段表字符串表&lt;/p&gt;
&lt;p&gt;段表字符串表是保存所有段的名称字符串的单独段，假设一个 ELF 文件有 &lt;code&gt;.text&lt;/code&gt;，&lt;code&gt;.bss&lt;/code&gt;，&lt;code&gt;.data&lt;/code&gt; 三个段（不包括段表和段表字符串表），那么段表字符串表的内容可以是：&lt;/p&gt;
&lt;figure&gt;
&lt;img alt="部分内容" src="./assets/table.webp"/&gt;
&lt;figcaption aria-hidden="true"&gt;部分内容&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;那么，&lt;code&gt;.text&lt;/code&gt; 在段表中的数据中 &lt;code&gt;sh_name&lt;/code&gt; 的指向就是 2 ，即等宽的那一项。它的段名一直到最近的 「\0」。&lt;/p&gt;
&lt;p&gt;要获取段表字符串表，直接在段表中找到对应下标的项目即可。这个下标也就是文件头中的 &lt;code&gt;e_shstrndx&lt;/code&gt;。&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id="使用-readelf-工具"&gt;使用 readelf 工具&lt;/h1&gt;
&lt;p&gt;可以直接使用 &lt;code&gt;readelf&lt;/code&gt; 工具打印出 ELF 文件的信息。一般使用 &lt;code&gt;-S&lt;/code&gt; 参数，打印出所有段的信息，起始位置等等。&lt;/p&gt;
&lt;br/&gt;
&lt;!--%%REF%%--&gt;
&lt;br/&gt;
&lt;script async="" crossorigin="anonymous" data-category="Announcements" data-category-id="DIC_kwDOJ7Ymy84CX4eg" data-emit-metadata="0" data-input-position="top" data-lang="zh-CN" data-loading="lazy" data-mapping="title" data-reactions-enabled="1" data-repo="izfsk-ium/izfsk-ium.github.io" data-repo-id="R_kgDOJ7Ymyw" data-strict="0" data-theme="preferred_color_scheme" src="https://giscus.app/client.js"&gt;
&lt;/script&gt;
&lt;/main&gt;
&lt;footer&gt;
&lt;p class="signoff"&gt;
&lt;div class="metadata"&gt;
&lt;p class="date"&gt;&lt;time datetime="2022-12-25"&gt;创建日期：2022-12-25&lt;/time&gt;&lt;/p&gt;
&lt;p class="lastmodify"&gt;&lt;time&gt;最后编译：2023-08-10&lt;/time&gt;&lt;/p&gt;
&lt;p class="lastmodify" id="counter-span"&gt;访问次数：&lt;/p&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;/footer&gt;
&lt;script&gt;
    /* These script should run after page load */
    document.querySelectorAll('code.sourceCode').forEach(
      i =&gt; i.insertAdjacentHTML('beforeend', '&lt;div class="copy"&gt;复制&lt;/div&gt;')
    );
    document.querySelectorAll('div.copy').forEach(
      i =&gt; i.addEventListener(
        'click',
        () =&gt; {
          navigator.clipboard.writeText(i.parentElement.innerText.replace('复制', ''));
          i.innerText = '成功';
          setTimeout(() =&gt; {
            i.innerText = '复制';
          }, 1000);
        }
      )
    );

    if (location.href.includes("127.0.0.1:8080")) {
      document.getElementById("counter-span").innerHTML = "[[development mode]]";
    } else {
      const uuid = document.getElementById("article-uuid").innerText;
      const target = document.getElementById("counter-span");
      const last = localStorage.getItem("lastVisit-" + uuid);
      const shouldIncrease = last === null || new Date().getTime() - parseInt(last) &gt;= (1000 * 60 * 15);

      fetch(shouldIncrease ? ("https://counter.izfsk.top/counter/" + uuid) : ("https://counter.izfsk.top/readOnly/" + uuid))
        .then(r =&gt; r.text())
        .then(d =&gt; {
          if (!d.startsWith("Too"))
            document.getElementById("counter-span").innerText = "访问次数：" + d.toString();
          else
            document.getElementById("counter-span").innerHTML = "";
        });

      localStorage.setItem("lastVisit-" + uuid, new Date().getTime());
    }
  &lt;/script&gt;
&lt;script async="" data-website-id="2a1146ab-fa82-4a84-a04f-30e5967357c3" src="https://analytics.umami.is/script.js"&gt;&lt;/script&gt;
&lt;/body&gt;</content:encoded>
      <guid isPermaLink="false">5b68c30c-b953-4bee-a7e9-51aa7f2a30e8</guid>
      <pubDate>Sun, 25 Dec 2022 00:00:00 +0800</pubDate>
    </item>
    <item>
      <title>Firefox启动速度缓慢的排查</title>
      <link>https://blog.izfsk.top/articles/Firefox启动速度缓慢的排查.html</link>
      <description>Firefox启动速度缓慢的排查</description>
      <content:encoded>&lt;body&gt;
&lt;progress id="content_progress" value="0"&gt;&lt;/progress&gt;
&lt;button id="back-to-top"&gt;
    回页顶
  &lt;/button&gt;
&lt;header&gt;
&lt;small id="article-uuid" style="display: none !important;"&gt;1e64ae1f-5c22-43eb-a3f1-6a5a0162052b&lt;/small&gt;
&lt;h1 class="title"&gt;Firefox启动速度缓慢的排查&lt;/h1&gt;
&lt;!-- Subtitle --&gt;
&lt;h3 class="subtitle"&gt; &lt;/h3&gt;
&lt;/header&gt;
&lt;main&gt;
&lt;p&gt;&lt;strong&gt;TL；DR&lt;/strong&gt;：直接在 &lt;code&gt;/etc/hosts&lt;/code&gt; 里增加一行记录，把本机主机名指向 &lt;code&gt;127.0.0.1&lt;/code&gt; 即可。&lt;/p&gt;
&lt;p&gt;一般 Linux 发行版的默认浏览器都是 Firefox, 但是我在 openSUSE 上的 Firefox 启动每一次都需要很久，而且每次等待的时间还不一样，多则 10 秒，少则 3-4 秒，很是折磨人。这个问题之前用其他发行版的时候都遇到过，可以确定不是操作系统的原因，我不想因为这个原因就放弃 Firefox 使用 Chrome，所以打算彻底调查一下问题的原因。&lt;/p&gt;
&lt;p&gt;首先我尝试着使用安全模式打开 Firefox, 在命令行启动时加上 &lt;code&gt;--safe-mode&lt;/code&gt;, 但是依旧没有效果，所以可以排除是扩展插件的问题。我遂怀疑是 Firefox 在寻找某个文件的时候出了故障，用 &lt;code&gt;strace&lt;/code&gt; 追踪一下系统调用，加上时间戳，找到间隔好几秒的断层，看看它到底在访问什么文件：&lt;/p&gt;
&lt;pre class="shell"&gt;&lt;code&gt;strace -tt -o log2 -e trace=file firefox&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;code&gt;-tt&lt;/code&gt; 是加上时间戳，&lt;code&gt;-o&lt;/code&gt; 输出为文件，&lt;code&gt;-e trace=&lt;/code&gt; 增加过滤器。&lt;/p&gt;
&lt;p&gt;结果发现了这个：&lt;/p&gt;
&lt;figure&gt;
&lt;img alt="第一次追踪" src="./assets/trace1.webp"/&gt;
&lt;figcaption aria-hidden="true"&gt;第一次追踪&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;Firefox 在尝试访问 &lt;code&gt;/etc/resolv.conf&lt;/code&gt; 这个文件。但是系统调用是成功的，而且我查看文件内容也没有毛病。这个文件本身是本机 DNS 解析的配置文件，Firefox 访问它想必和 DNS 解析有些关系。那么我想用可能是因为 Firefox 试图访问一个被墙了的网站，超时导致延迟。那么就要捕获所有的 DNS 解析尝试，我想到了使用 &lt;code&gt;proxychain&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;虽然 &lt;code&gt;proxychain&lt;/code&gt; 是一个代理工具，但是它会在控制台显示被代理的程序的互联网访问记录，我尝试了一下，可是一无所获。&lt;/p&gt;
&lt;p&gt;上网搜索了一下，发现有一位仁兄在 8 年前于 Bugzilla 上提了一个差不多的问题，标号是 &lt;a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1189705"&gt;Bug 1189705&lt;/a&gt;. 他的分析是，Firefox 启动时会对本机进行一次 DNS 查询，导致超时。所以按照这个思路，我只需要过滤出所有的网络相关系统调用，看看有没有我自己的主机名即可：&lt;/p&gt;
&lt;pre class="shell"&gt;&lt;code&gt;strace -o log -e trace=network firefox &lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;自己的主机名称在 &lt;code&gt;/etc/hostname&lt;/code&gt;，过滤可以看到：&lt;/p&gt;
&lt;figure&gt;
&lt;img alt="第二次追踪，黑色处为主机名" src="./assets/trace2.webp"/&gt;
&lt;figcaption aria-hidden="true"&gt;第二次追踪，黑色处为主机名&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;&lt;strong&gt;果然&lt;/strong&gt;。&lt;/p&gt;
&lt;p&gt;那么，只要让 DNS 访问直接指向本机即可，解决方案很简单，直接在 &lt;code&gt;/etc/hosts&lt;/code&gt; 里增加一行记录，把本机主机名指向 &lt;code&gt;127.0.0.1&lt;/code&gt; 即可。再次尝试打开 Firefox, 启动速度稳定保持在 2 秒左右。&lt;/p&gt;
&lt;p&gt;现在想起来，应该是自己自定义主机名时，把原来主机名后面的 &lt;code&gt;.localhost&lt;/code&gt; 去掉了，导致 DNS 解析不出来。&lt;/p&gt;
&lt;br/&gt;
&lt;!--%%REF%%--&gt;
&lt;br/&gt;
&lt;script async="" crossorigin="anonymous" data-category="Announcements" data-category-id="DIC_kwDOJ7Ymy84CX4eg" data-emit-metadata="0" data-input-position="top" data-lang="zh-CN" data-loading="lazy" data-mapping="title" data-reactions-enabled="1" data-repo="izfsk-ium/izfsk-ium.github.io" data-repo-id="R_kgDOJ7Ymyw" data-strict="0" data-theme="preferred_color_scheme" src="https://giscus.app/client.js"&gt;
&lt;/script&gt;
&lt;/main&gt;
&lt;footer&gt;
&lt;p class="signoff"&gt;
&lt;div class="metadata"&gt;
&lt;p class="date"&gt;&lt;time datetime="2022-12-26"&gt;创建日期：2022-12-26&lt;/time&gt;&lt;/p&gt;
&lt;p class="lastmodify"&gt;&lt;time&gt;最后编译：2023-08-10&lt;/time&gt;&lt;/p&gt;
&lt;p class="lastmodify" id="counter-span"&gt;访问次数：&lt;/p&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;/footer&gt;
&lt;script&gt;
    /* These script should run after page load */
    document.querySelectorAll('code.sourceCode').forEach(
      i =&gt; i.insertAdjacentHTML('beforeend', '&lt;div class="copy"&gt;复制&lt;/div&gt;')
    );
    document.querySelectorAll('div.copy').forEach(
      i =&gt; i.addEventListener(
        'click',
        () =&gt; {
          navigator.clipboard.writeText(i.parentElement.innerText.replace('复制', ''));
          i.innerText = '成功';
          setTimeout(() =&gt; {
            i.innerText = '复制';
          }, 1000);
        }
      )
    );

    if (location.href.includes("127.0.0.1:8080")) {
      document.getElementById("counter-span").innerHTML = "[[development mode]]";
    } else {
      const uuid = document.getElementById("article-uuid").innerText;
      const target = document.getElementById("counter-span");
      const last = localStorage.getItem("lastVisit-" + uuid);
      const shouldIncrease = last === null || new Date().getTime() - parseInt(last) &gt;= (1000 * 60 * 15);

      fetch(shouldIncrease ? ("https://counter.izfsk.top/counter/" + uuid) : ("https://counter.izfsk.top/readOnly/" + uuid))
        .then(r =&gt; r.text())
        .then(d =&gt; {
          if (!d.startsWith("Too"))
            document.getElementById("counter-span").innerText = "访问次数：" + d.toString();
          else
            document.getElementById("counter-span").innerHTML = "";
        });

      localStorage.setItem("lastVisit-" + uuid, new Date().getTime());
    }
  &lt;/script&gt;
&lt;script async="" data-website-id="2a1146ab-fa82-4a84-a04f-30e5967357c3" src="https://analytics.umami.is/script.js"&gt;&lt;/script&gt;
&lt;/body&gt;</content:encoded>
      <guid isPermaLink="false">1e64ae1f-5c22-43eb-a3f1-6a5a0162052b</guid>
      <pubDate>Mon, 26 Dec 2022 00:00:00 +0800</pubDate>
    </item>
    <item>
      <title>Chrome文件伪装摄像头</title>
      <link>https://blog.izfsk.top/articles/Chrome文件伪装摄像头.html</link>
      <description>Chrome文件伪装摄像头</description>
      <content:encoded>&lt;body&gt;
&lt;progress id="content_progress" value="0"&gt;&lt;/progress&gt;
&lt;button id="back-to-top"&gt;
    回页顶
  &lt;/button&gt;
&lt;header&gt;
&lt;small id="article-uuid" style="display: none !important;"&gt;6f21a5a7-d7da-48e5-8afc-54d5644d73bf&lt;/small&gt;
&lt;h1 class="title"&gt;Chrome文件伪装摄像头&lt;/h1&gt;
&lt;!-- Subtitle --&gt;
&lt;h3 class="subtitle"&gt; &lt;/h3&gt;
&lt;/header&gt;
&lt;nav id="TOC" role="doc-toc"&gt;
&lt;strong&gt;文章归类: &lt;a href="/pages/category.html#备忘录"&gt;备忘录&lt;/a&gt; &lt;/strong&gt;
&lt;input id="contents" type="checkbox"/&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#文件准备" id="toc-文件准备"&gt;文件准备&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#开启选项" id="toc-开启选项"&gt;开启选项&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#检测和注意事项" id="toc-检测和注意事项"&gt;检测和注意事项&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#参考" id="toc-参考"&gt;参考&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#reference"&gt;参考链接&lt;/a&gt;&lt;/li&gt;
&lt;li&gt; &lt;/li&gt;
&lt;li class="tools"&gt;
&lt;span id="backtomain"&gt;
&lt;svg class="bi bi-house" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M8.707 1.5a1 1 0 0 0-1.414 0L.646 8.146a.5.5 0 0 0 .708.708L2 8.207V13.5A1.5 1.5 0 0 0 3.5 15h9a1.5 1.5 0 0 0 1.5-1.5V8.207l.646.647a.5.5 0 0 0 .708-.708L13 5.793V2.5a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v1.293L8.707 1.5ZM13 7.207V13.5a.5.5 0 0 1-.5.5h-9a.5.5 0 0 1-.5-.5V7.207l5-5 5 5Z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="readingmode"&gt;
&lt;svg class="bi bi-book" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M1 2.828c.885-.37 2.154-.769 3.388-.893 1.33-.134 2.458.063 3.112.752v9.746c-.935-.53-2.12-.603-3.213-.493-1.18.12-2.37.461-3.287.811V2.828zm7.5-.141c.654-.689 1.782-.886 3.112-.752 1.234.124 2.503.523 3.388.893v9.923c-.918-.35-2.107-.692-3.287-.81-1.094-.111-2.278-.039-3.213.492V2.687zM8 1.783C7.015.936 5.587.81 4.287.94c-1.514.153-3.042.672-3.994 1.105A.5.5 0 0 0 0 2.5v11a.5.5 0 0 0 .707.455c.882-.4 2.303-.881 3.68-1.02 1.409-.142 2.59.087 3.223.877a.5.5 0 0 0 .78 0c.633-.79 1.814-1.019 3.222-.877 1.378.139 2.8.62 3.681 1.02A.5.5 0 0 0 16 13.5v-11a.5.5 0 0 0-.293-.455c-.952-.433-2.48-.952-3.994-1.105C10.413.809 8.985.936 8 1.783z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="larger"&gt; &lt;/span&gt;
&lt;span id="smaller"&gt;&lt;/span&gt;
&lt;span id="switchfont"&gt;
&lt;svg class="bi bi-fonts" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M12.258 3h-8.51l-.083 2.46h.479c.26-1.544.758-1.783 2.693-1.845l.424-.013v7.827c0 .663-.144.82-1.3.923v.52h4.082v-.52c-1.162-.103-1.306-.26-1.306-.923V3.602l.431.013c1.934.062 2.434.301 2.693 1.846h.479L12.258 3z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="backtotop"&gt;
&lt;svg class="bi bi-arrow-bar-up" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M8 10a.5.5 0 0 0 .5-.5V3.707l2.146 2.147a.5.5 0 0 0 .708-.708l-3-3a.5.5 0 0 0-.708 0l-3 3a.5.5 0 1 0 .708.708L7.5 3.707V9.5a.5.5 0 0 0 .5.5zm-7 2.5a.5.5 0 0 1 .5-.5h13a.5.5 0 0 1 0 1h-13a.5.5 0 0 1-.5-.5z" fill-rule="evenodd"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/nav&gt;
&lt;main&gt;
&lt;p&gt;有时候需要用到伪装摄像头的功能，特别是使用某些网课平台考试的时候，有的建议是使用 OBS Studio 模拟一个摄像头，但是其实 Chrome 浏览器就可以把文件作为摄像头的视频来源采集。&lt;/p&gt;
&lt;h1 id="文件准备"&gt;文件准备&lt;/h1&gt;
&lt;p&gt;首先你需要有视频或者图片文件，但一般的 mp4, mkv 之类的格式是不行的。关于 Chrome 支持什么格式，手册页里面没有说明，但是源代码里面有：&lt;/p&gt;
&lt;div class="sourceCode" id="cb1"&gt;&lt;pre class="sourceCode cpp"&gt;&lt;code class="sourceCode cpp"&gt;&lt;span id="cb1-1"&gt;&lt;a aria-hidden="true" href="#cb1-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="co"&gt;// https://chromium.googlesource.com/chromium/src/+/3015459a9bf07f62ab7a8816ff88824568d87c04/media/capture/video/file_video_capture_device.cc&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-2"&gt;&lt;a aria-hidden="true" href="#cb1-2" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="co"&gt;// line 286&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-3"&gt;&lt;a aria-hidden="true" href="#cb1-3" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="cf"&gt;if&lt;/span&gt; &lt;span class="op"&gt;(&lt;/span&gt;base&lt;span class="op"&gt;::&lt;/span&gt;EndsWith&lt;span class="op"&gt;(&lt;/span&gt;file_name&lt;span class="op"&gt;,&lt;/span&gt; &lt;span class="st"&gt;"y4m"&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-4"&gt;&lt;a aria-hidden="true" href="#cb1-4" tabindex="-1"&gt;&lt;/a&gt;                     base&lt;span class="op"&gt;::&lt;/span&gt;CompareCase&lt;span class="op"&gt;::&lt;/span&gt;INSENSITIVE_ASCII&lt;span class="op"&gt;))&lt;/span&gt; &lt;span class="op"&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-5"&gt;&lt;a aria-hidden="true" href="#cb1-5" tabindex="-1"&gt;&lt;/a&gt;    file_parser&lt;span class="op"&gt;.&lt;/span&gt;reset&lt;span class="op"&gt;(&lt;/span&gt;&lt;span class="kw"&gt;new&lt;/span&gt; Y4mFileParser&lt;span class="op"&gt;(&lt;/span&gt;file_path&lt;span class="op"&gt;));&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-6"&gt;&lt;a aria-hidden="true" href="#cb1-6" tabindex="-1"&gt;&lt;/a&gt;  &lt;span class="op"&gt;}&lt;/span&gt; &lt;span class="cf"&gt;else&lt;/span&gt; &lt;span class="cf"&gt;if&lt;/span&gt; &lt;span class="op"&gt;(&lt;/span&gt;base&lt;span class="op"&gt;::&lt;/span&gt;EndsWith&lt;span class="op"&gt;(&lt;/span&gt;file_name&lt;span class="op"&gt;,&lt;/span&gt; &lt;span class="st"&gt;"mjpeg"&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-7"&gt;&lt;a aria-hidden="true" href="#cb1-7" tabindex="-1"&gt;&lt;/a&gt;                            base&lt;span class="op"&gt;::&lt;/span&gt;CompareCase&lt;span class="op"&gt;::&lt;/span&gt;INSENSITIVE_ASCII&lt;span class="op"&gt;))&lt;/span&gt; &lt;span class="op"&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-8"&gt;&lt;a aria-hidden="true" href="#cb1-8" tabindex="-1"&gt;&lt;/a&gt;    file_parser&lt;span class="op"&gt;.&lt;/span&gt;reset&lt;span class="op"&gt;(&lt;/span&gt;&lt;span class="kw"&gt;new&lt;/span&gt; MjpegFileParser&lt;span class="op"&gt;(&lt;/span&gt;file_path&lt;span class="op"&gt;));&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-9"&gt;&lt;a aria-hidden="true" href="#cb1-9" tabindex="-1"&gt;&lt;/a&gt;  &lt;span class="op"&gt;}&lt;/span&gt; &lt;span class="cf"&gt;else&lt;/span&gt; &lt;span class="op"&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-10"&gt;&lt;a aria-hidden="true" href="#cb1-10" tabindex="-1"&gt;&lt;/a&gt;    LOG&lt;span class="op"&gt;(&lt;/span&gt;ERROR&lt;span class="op"&gt;)&lt;/span&gt; &lt;span class="op"&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class="st"&gt;"Unsupported file format."&lt;/span&gt;&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-11"&gt;&lt;a aria-hidden="true" href="#cb1-11" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="cf"&gt;return&lt;/span&gt; file_parser&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-12"&gt;&lt;a aria-hidden="true" href="#cb1-12" tabindex="-1"&gt;&lt;/a&gt;  &lt;span class="op"&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;要作为流的来源你需要 y4m 或者 mjpeg 格式的视频。使用 ffmpeg 可以转换。&lt;/p&gt;
&lt;pre class="shell"&gt;&lt;code&gt;$ ffmpeg -i input.mp4 output.y4m&lt;/code&gt;&lt;/pre&gt;
&lt;h1 id="开启选项"&gt;开启选项&lt;/h1&gt;
&lt;p&gt;接下来你需要使用命令行参数启动 Chrome 浏览器，加上你的文件：&lt;/p&gt;
&lt;pre class="shell"&gt;&lt;code&gt;$ google-chrome --use-fake-device-for-media-stream --use-file-for-fake-video-capture=test.y4m &lt;/code&gt;&lt;/pre&gt;
&lt;h1 id="检测和注意事项"&gt;检测和注意事项&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;y4m 格式是很大的，一分钟不到的视频都可能达到 700 MB。&lt;/li&gt;
&lt;li&gt;可以使用&lt;a href="https://webcamtests.com/"&gt;这个网站&lt;/a&gt;来测试。&lt;/li&gt;
&lt;li&gt;网页检测到的「摄像头硬件名称」将会是你的文件名，注意起一个正常的名字。&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id="参考"&gt;参考&lt;/h1&gt;
&lt;ol type="1"&gt;
&lt;li&gt;&lt;a href="https://stackoverflow.com/questions/52095416/how-can-i-correctly-provide-a-mock-webcam-video-to-chrome"&gt;How can I correctly provide a mock webcam video to Chrome?&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;br/&gt;
&lt;!--%%REF%%--&gt;
&lt;br/&gt;
&lt;script async="" crossorigin="anonymous" data-category="Announcements" data-category-id="DIC_kwDOJ7Ymy84CX4eg" data-emit-metadata="0" data-input-position="top" data-lang="zh-CN" data-loading="lazy" data-mapping="title" data-reactions-enabled="1" data-repo="izfsk-ium/izfsk-ium.github.io" data-repo-id="R_kgDOJ7Ymyw" data-strict="0" data-theme="preferred_color_scheme" src="https://giscus.app/client.js"&gt;
&lt;/script&gt;
&lt;/main&gt;
&lt;footer&gt;
&lt;p class="signoff"&gt;
&lt;div class="metadata"&gt;
&lt;p class="date"&gt;&lt;time datetime="2022-12-31"&gt;创建日期：2022-12-31&lt;/time&gt;&lt;/p&gt;
&lt;p class="lastmodify"&gt;&lt;time&gt;最后编译：2023-08-10&lt;/time&gt;&lt;/p&gt;
&lt;p class="lastmodify" id="counter-span"&gt;访问次数：&lt;/p&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;/footer&gt;
&lt;script&gt;
    /* These script should run after page load */
    document.querySelectorAll('code.sourceCode').forEach(
      i =&gt; i.insertAdjacentHTML('beforeend', '&lt;div class="copy"&gt;复制&lt;/div&gt;')
    );
    document.querySelectorAll('div.copy').forEach(
      i =&gt; i.addEventListener(
        'click',
        () =&gt; {
          navigator.clipboard.writeText(i.parentElement.innerText.replace('复制', ''));
          i.innerText = '成功';
          setTimeout(() =&gt; {
            i.innerText = '复制';
          }, 1000);
        }
      )
    );

    if (location.href.includes("127.0.0.1:8080")) {
      document.getElementById("counter-span").innerHTML = "[[development mode]]";
    } else {
      const uuid = document.getElementById("article-uuid").innerText;
      const target = document.getElementById("counter-span");
      const last = localStorage.getItem("lastVisit-" + uuid);
      const shouldIncrease = last === null || new Date().getTime() - parseInt(last) &gt;= (1000 * 60 * 15);

      fetch(shouldIncrease ? ("https://counter.izfsk.top/counter/" + uuid) : ("https://counter.izfsk.top/readOnly/" + uuid))
        .then(r =&gt; r.text())
        .then(d =&gt; {
          if (!d.startsWith("Too"))
            document.getElementById("counter-span").innerText = "访问次数：" + d.toString();
          else
            document.getElementById("counter-span").innerHTML = "";
        });

      localStorage.setItem("lastVisit-" + uuid, new Date().getTime());
    }
  &lt;/script&gt;
&lt;script async="" data-website-id="2a1146ab-fa82-4a84-a04f-30e5967357c3" src="https://analytics.umami.is/script.js"&gt;&lt;/script&gt;
&lt;/body&gt;</content:encoded>
      <guid isPermaLink="false">6f21a5a7-d7da-48e5-8afc-54d5644d73bf</guid>
      <pubDate>Sat, 31 Dec 2022 00:00:00 +0800</pubDate>
    </item>
    <item>
      <title>雨课堂考试系统分析</title>
      <link>https://blog.izfsk.top/articles/雨课堂考试系统分析.html</link>
      <description>雨课堂考试系统分析</description>
      <content:encoded>&lt;body&gt;
&lt;progress id="content_progress" value="0"&gt;&lt;/progress&gt;
&lt;button id="back-to-top"&gt;
    回页顶
  &lt;/button&gt;
&lt;header&gt;
&lt;small id="article-uuid" style="display: none !important;"&gt;4ca67c26-00b4-4c79-bbac-65f9a7a434b5&lt;/small&gt;
&lt;h1 class="title"&gt;雨课堂考试系统分析&lt;/h1&gt;
&lt;!-- Subtitle --&gt;
&lt;h3 class="subtitle"&gt; &lt;/h3&gt;
&lt;/header&gt;
&lt;nav id="TOC" role="doc-toc"&gt;
&lt;strong&gt;文章归类: &lt;a href="/pages/category.html#技术"&gt;技术&lt;/a&gt; &lt;/strong&gt;
&lt;input id="contents" type="checkbox"/&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#简介" id="toc-简介"&gt;简介&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#各个功能分析" id="toc-各个功能分析"&gt;各个功能分析&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#获取试卷内容" id="toc-获取试卷内容"&gt;获取试卷内容&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#时间同步" id="toc-时间同步"&gt;时间同步&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#反调试" id="toc-反调试"&gt;反调试&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#检测打开调试工具" id="toc-检测打开调试工具"&gt;检测打开调试工具&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#切屏检测" id="toc-切屏检测"&gt;切屏检测&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#自动截屏" id="toc-自动截屏"&gt;自动截屏&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#数据上报" id="toc-数据上报"&gt;数据上报&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#水印" id="toc-水印"&gt;水印&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#绕过思路" id="toc-绕过思路"&gt;绕过思路&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#参考" id="toc-参考"&gt;参考&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#reference"&gt;参考链接&lt;/a&gt;&lt;/li&gt;
&lt;li&gt; &lt;/li&gt;
&lt;li class="tools"&gt;
&lt;span id="backtomain"&gt;
&lt;svg class="bi bi-house" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M8.707 1.5a1 1 0 0 0-1.414 0L.646 8.146a.5.5 0 0 0 .708.708L2 8.207V13.5A1.5 1.5 0 0 0 3.5 15h9a1.5 1.5 0 0 0 1.5-1.5V8.207l.646.647a.5.5 0 0 0 .708-.708L13 5.793V2.5a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v1.293L8.707 1.5ZM13 7.207V13.5a.5.5 0 0 1-.5.5h-9a.5.5 0 0 1-.5-.5V7.207l5-5 5 5Z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="readingmode"&gt;
&lt;svg class="bi bi-book" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M1 2.828c.885-.37 2.154-.769 3.388-.893 1.33-.134 2.458.063 3.112.752v9.746c-.935-.53-2.12-.603-3.213-.493-1.18.12-2.37.461-3.287.811V2.828zm7.5-.141c.654-.689 1.782-.886 3.112-.752 1.234.124 2.503.523 3.388.893v9.923c-.918-.35-2.107-.692-3.287-.81-1.094-.111-2.278-.039-3.213.492V2.687zM8 1.783C7.015.936 5.587.81 4.287.94c-1.514.153-3.042.672-3.994 1.105A.5.5 0 0 0 0 2.5v11a.5.5 0 0 0 .707.455c.882-.4 2.303-.881 3.68-1.02 1.409-.142 2.59.087 3.223.877a.5.5 0 0 0 .78 0c.633-.79 1.814-1.019 3.222-.877 1.378.139 2.8.62 3.681 1.02A.5.5 0 0 0 16 13.5v-11a.5.5 0 0 0-.293-.455c-.952-.433-2.48-.952-3.994-1.105C10.413.809 8.985.936 8 1.783z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="larger"&gt; &lt;/span&gt;
&lt;span id="smaller"&gt;&lt;/span&gt;
&lt;span id="switchfont"&gt;
&lt;svg class="bi bi-fonts" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M12.258 3h-8.51l-.083 2.46h.479c.26-1.544.758-1.783 2.693-1.845l.424-.013v7.827c0 .663-.144.82-1.3.923v.52h4.082v-.52c-1.162-.103-1.306-.26-1.306-.923V3.602l.431.013c1.934.062 2.434.301 2.693 1.846h.479L12.258 3z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="backtotop"&gt;
&lt;svg class="bi bi-arrow-bar-up" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M8 10a.5.5 0 0 0 .5-.5V3.707l2.146 2.147a.5.5 0 0 0 .708-.708l-3-3a.5.5 0 0 0-.708 0l-3 3a.5.5 0 1 0 .708.708L7.5 3.707V9.5a.5.5 0 0 0 .5.5zm-7 2.5a.5.5 0 0 1 .5-.5h13a.5.5 0 0 1 0 1h-13a.5.5 0 0 1-.5-.5z" fill-rule="evenodd"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/nav&gt;
&lt;main&gt;
&lt;p&gt;最近需要用到雨课堂来在线考试，向来讨厌这种考试方式，又听说它有截屏，切屏上报等等功能，正好有认识的老师愿意把他的帐号借给我，就简单分析了一下。&lt;/p&gt;
&lt;h1 id="简介"&gt;简介&lt;/h1&gt;
&lt;p&gt;雨课堂的网页端考试系统用的是 Vue 用到的框架/库有 Element UI, Sentry, MathJax, core-js, Clipboard.js ，存储采用自己 cdn + 阿里云 + 七牛云的混合存储，前端文件用 Webpack + Babel 打包，所有接口 API 地址都暴露在全局空间 &lt;code&gt;window.API&lt;/code&gt; 中。判断浏览器环境采用 UA 字符串匹配，可以用虚假 UA 绕过，但会导致出现问题。每隔 3 分钟自动截取屏幕和摄像头上传。&lt;/p&gt;
&lt;h1 id="各个功能分析"&gt;各个功能分析&lt;/h1&gt;
&lt;h2 id="获取试卷内容"&gt;获取试卷内容&lt;/h2&gt;
&lt;p&gt;没有花里胡哨的加密，很朴实的获得试卷内容，并逐个放到 vuex store 里面，接着渲染。接口明确给出的，就是 &lt;code&gt;/exam_room/show_paper?exam_id=&lt;/code&gt; ，你甚至可以重放 xhr (&lt;/p&gt;
&lt;p&gt;当然，获取试卷内容需要一个名为 &lt;code&gt;x-access-token&lt;/code&gt; 的 cookie，是一个 HS256 JWT Token，内容形式是&lt;/p&gt;
&lt;div class="sourceCode" id="cb1"&gt;&lt;pre class="sourceCode typescript"&gt;&lt;code class="sourceCode typescript"&gt;&lt;span id="cb1-1"&gt;&lt;a aria-hidden="true" href="#cb1-1" tabindex="-1"&gt;&lt;/a&gt;{&lt;/span&gt;
&lt;span id="cb1-2"&gt;&lt;a aria-hidden="true" href="#cb1-2" tabindex="-1"&gt;&lt;/a&gt;  &lt;span class="st"&gt;"uid"&lt;/span&gt;&lt;span class="op"&gt;:&lt;/span&gt; &lt;span class="dt"&gt;number&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt;    &lt;span class="co"&gt;// 用户 UID&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-3"&gt;&lt;a aria-hidden="true" href="#cb1-3" tabindex="-1"&gt;&lt;/a&gt;  &lt;span class="st"&gt;"eid"&lt;/span&gt;&lt;span class="op"&gt;:&lt;/span&gt; &lt;span class="dt"&gt;number&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt;    &lt;span class="co"&gt;// 试卷编号&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-4"&gt;&lt;a aria-hidden="true" href="#cb1-4" tabindex="-1"&gt;&lt;/a&gt;  &lt;span class="st"&gt;"cid"&lt;/span&gt;&lt;span class="op"&gt;:&lt;/span&gt; &lt;span class="dt"&gt;string&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt;    &lt;span class="co"&gt;// classroom_id，班级号&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-5"&gt;&lt;a aria-hidden="true" href="#cb1-5" tabindex="-1"&gt;&lt;/a&gt;  &lt;span class="st"&gt;"exp"&lt;/span&gt;&lt;span class="op"&gt;:&lt;/span&gt; &lt;span class="dt"&gt;number&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt;    &lt;span class="co"&gt;// 时间戳&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-6"&gt;&lt;a aria-hidden="true" href="#cb1-6" tabindex="-1"&gt;&lt;/a&gt;  &lt;span class="st"&gt;"ro"&lt;/span&gt;&lt;span class="op"&gt;:&lt;/span&gt; &lt;span class="dv"&gt;0&lt;/span&gt; &lt;span class="op"&gt;|&lt;/span&gt; &lt;span class="dv"&gt;1&lt;/span&gt;       &lt;span class="co"&gt;// 是否是只读试卷&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-7"&gt;&lt;a aria-hidden="true" href="#cb1-7" tabindex="-1"&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;获取时只校验 token，不管 UA。这个 Token 在进入考试时获取，甚至没有设置 HttpOnly。&lt;/p&gt;
&lt;h2 id="时间同步"&gt;时间同步&lt;/h2&gt;
&lt;p&gt;每隔一段事件会和服务器同步数据，使用 setintervel + xhr 方式，防止通过修改本地事件作弊。&lt;/p&gt;
&lt;h2 id="反调试"&gt;反调试&lt;/h2&gt;
&lt;p&gt;在整个 HTML 文档的开头，有检测是否有禁用切屏的代码，被 eval 混淆了。&lt;/p&gt;
&lt;figure&gt;
&lt;img alt="混淆的代码" src="./assets/eval.png.webp"/&gt;
&lt;figcaption aria-hidden="true"&gt;混淆的代码&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;&lt;strong&gt;搞笑的是，雨课堂的前端似乎真的只是在网上&lt;a href="https://www.sojson.com/js.html"&gt;随便找了一个&lt;/a&gt;「在线混淆工具」就拿来用了&lt;/strong&gt;，解密之：&lt;/p&gt;
&lt;div class="sourceCode" id="cb2"&gt;&lt;pre class="sourceCode js"&gt;&lt;code class="sourceCode javascript"&gt;&lt;span id="cb2-1"&gt;&lt;a aria-hidden="true" href="#cb2-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;function&lt;/span&gt; &lt;span class="fu"&gt;getEventListeners&lt;/span&gt;() {&lt;/span&gt;
&lt;span id="cb2-2"&gt;&lt;a aria-hidden="true" href="#cb2-2" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="cf"&gt;try&lt;/span&gt; {&lt;/span&gt;
&lt;span id="cb2-3"&gt;&lt;a aria-hidden="true" href="#cb2-3" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="kw"&gt;var&lt;/span&gt; e &lt;span class="op"&gt;=&lt;/span&gt; sessionStorage&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="at"&gt;setItem&lt;/span&gt;&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-4"&gt;&lt;a aria-hidden="true" href="#cb2-4" tabindex="-1"&gt;&lt;/a&gt;        sessionStorage&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="at"&gt;setItem&lt;/span&gt; &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="kw"&gt;function&lt;/span&gt;(t&lt;span class="op"&gt;,&lt;/span&gt; s) {&lt;/span&gt;
&lt;span id="cb2-5"&gt;&lt;a aria-hidden="true" href="#cb2-5" tabindex="-1"&gt;&lt;/a&gt;            &lt;span class="kw"&gt;var&lt;/span&gt; n &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="kw"&gt;new&lt;/span&gt; &lt;span class="bu"&gt;Event&lt;/span&gt;(&lt;span class="st"&gt;"setItemEvent"&lt;/span&gt;)&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-6"&gt;&lt;a aria-hidden="true" href="#cb2-6" tabindex="-1"&gt;&lt;/a&gt;            n&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="at"&gt;newValue&lt;/span&gt; &lt;span class="op"&gt;=&lt;/span&gt; s&lt;span class="op"&gt;,&lt;/span&gt; &lt;span class="bu"&gt;window&lt;/span&gt;&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;dispatchEvent&lt;/span&gt;(n)&lt;span class="op"&gt;,&lt;/span&gt; e&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;apply&lt;/span&gt;(&lt;span class="kw"&gt;this&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt; &lt;span class="kw"&gt;arguments&lt;/span&gt;)&lt;/span&gt;
&lt;span id="cb2-7"&gt;&lt;a aria-hidden="true" href="#cb2-7" tabindex="-1"&gt;&lt;/a&gt;        }&lt;span class="op"&gt;,&lt;/span&gt; sessionStorage&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;setItem&lt;/span&gt;(&lt;span class="st"&gt;"hasBlocked"&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt; &lt;span class="dv"&gt;1&lt;/span&gt;)&lt;/span&gt;
&lt;span id="cb2-8"&gt;&lt;a aria-hidden="true" href="#cb2-8" tabindex="-1"&gt;&lt;/a&gt;    } &lt;span class="cf"&gt;catch&lt;/span&gt; (e) {&lt;/span&gt;
&lt;span id="cb2-9"&gt;&lt;a aria-hidden="true" href="#cb2-9" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="bu"&gt;console&lt;/span&gt;&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;log&lt;/span&gt;(&lt;span class="st"&gt;"检测到切屏被屏蔽"&lt;/span&gt;)&lt;/span&gt;
&lt;span id="cb2-10"&gt;&lt;a aria-hidden="true" href="#cb2-10" tabindex="-1"&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id="cb2-11"&gt;&lt;a aria-hidden="true" href="#cb2-11" tabindex="-1"&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;可以看到这个函数的作用是把「sessionStorage.setItem」包装了一层，添加了一个新的「setItemEvent」事件。用来检查和反馈「检测到你已禁用切屏监测功能，该行为已记录并上报老师，请立即停止异常行为！」了。虽然十分的奇怪（&lt;/p&gt;
&lt;h2 id="检测打开调试工具"&gt;检测打开调试工具&lt;/h2&gt;
&lt;p&gt;如果学生打开控制台，会提示「检测到你已禁用切屏监测功能，该行为已记录并上报老师，请立即停止异常行为！」，这个提示只在 &lt;code&gt;getExamData&lt;/code&gt; 的时候显示一次，之后不再重复显示。&lt;/p&gt;
&lt;p&gt;检测的方法没有仔细探究，但注意到它覆盖了原来的 console.log 方法并包装了一层，以前看到过类似的检测思路，但似乎并不是&lt;a href="https://juejin.cn/post/6844903857227726856"&gt;这样&lt;/a&gt;的方法。&lt;/p&gt;
&lt;p&gt;&lt;img src="./assets/consol.png.webp"/&gt;&lt;/p&gt;
&lt;h2 id="切屏检测"&gt;切屏检测&lt;/h2&gt;
&lt;p&gt;使用的是非常常见的方法，即 &lt;code&gt;window.addEventListener("visibilitychange", callback)&lt;/code&gt; 的方法。直接搜索就可以找到源码位置，打断点，看 call stack 保存一份引用，就能把 callback 去掉了。直接 &lt;code&gt;window.removeEventListener("visibilitychange", callback, !0)&lt;/code&gt;。&lt;/p&gt;
&lt;figure&gt;
&lt;img alt="绑定事件处理" src="./assets/addcb.png.webp"/&gt;
&lt;figcaption aria-hidden="true"&gt;绑定事件处理&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;figure&gt;
&lt;img alt="回调函数位置" src="./assets/OnChange%E5%9B%9E%E8%B0%83.png.webp"/&gt;
&lt;figcaption aria-hidden="true"&gt;回调函数位置&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;另外，也可以直接拦截 addEventListener 的调用，很简单就能够阻止 callback 的绑定。&lt;/p&gt;
&lt;div class="sourceCode" id="cb3"&gt;&lt;pre class="sourceCode js"&gt;&lt;code class="sourceCode javascript"&gt;&lt;span id="cb3-1"&gt;&lt;a aria-hidden="true" href="#cb3-1" tabindex="-1"&gt;&lt;/a&gt;(&lt;span class="kw"&gt;function&lt;/span&gt;() {&lt;/span&gt;
&lt;span id="cb3-2"&gt;&lt;a aria-hidden="true" href="#cb3-2" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="kw"&gt;const&lt;/span&gt; ___raw &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="bu"&gt;window&lt;/span&gt;&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;addEventListener&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb3-3"&gt;&lt;a aria-hidden="true" href="#cb3-3" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb3-4"&gt;&lt;a aria-hidden="true" href="#cb3-4" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="bu"&gt;window&lt;/span&gt;&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;addEventListener&lt;/span&gt; &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="kw"&gt;function&lt;/span&gt; (&lt;span class="bu"&gt;event&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt; cb&lt;span class="op"&gt;,&lt;/span&gt; options) {&lt;/span&gt;
&lt;span id="cb3-5"&gt;&lt;a aria-hidden="true" href="#cb3-5" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="bu"&gt;event&lt;/span&gt; &lt;span class="op"&gt;===&lt;/span&gt; &lt;span class="st"&gt;"visibilitychange"&lt;/span&gt; &lt;/span&gt;
&lt;span id="cb3-6"&gt;&lt;a aria-hidden="true" href="#cb3-6" tabindex="-1"&gt;&lt;/a&gt;            &lt;span class="op"&gt;?&lt;/span&gt; &lt;span class="bu"&gt;console&lt;/span&gt;&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;log&lt;/span&gt;(&lt;span class="st"&gt;"Refused."&lt;/span&gt;) &lt;/span&gt;
&lt;span id="cb3-7"&gt;&lt;a aria-hidden="true" href="#cb3-7" tabindex="-1"&gt;&lt;/a&gt;            &lt;span class="op"&gt;:&lt;/span&gt; &lt;span class="fu"&gt;___raw&lt;/span&gt;(&lt;span class="bu"&gt;event&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt; cb&lt;span class="op"&gt;,&lt;/span&gt; options)&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb3-8"&gt;&lt;a aria-hidden="true" href="#cb3-8" tabindex="-1"&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id="cb3-9"&gt;&lt;a aria-hidden="true" href="#cb3-9" tabindex="-1"&gt;&lt;/a&gt;})()&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id="自动截屏"&gt;自动截屏&lt;/h2&gt;
&lt;p&gt;雨课堂考试的监考，并不是实时传输屏幕的数据，而是每隔一段时间（一般是 3 分钟）截取一张样本上传，同时设置 sessionStorage 的 &lt;code&gt;captureTime&lt;/code&gt; 项目保存时间戳。上传的目标服务器是根据地区选择的，都是七牛云的服务器。&lt;/p&gt;
&lt;div class="sourceCode" id="cb4"&gt;&lt;pre class="sourceCode js"&gt;&lt;code class="sourceCode javascript"&gt;&lt;span id="cb4-1"&gt;&lt;a aria-hidden="true" href="#cb4-1" tabindex="-1"&gt;&lt;/a&gt;e&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="at"&gt;regionUphostMap&lt;/span&gt; &lt;span class="op"&gt;=&lt;/span&gt; {&lt;/span&gt;
&lt;span id="cb4-2"&gt;&lt;a aria-hidden="true" href="#cb4-2" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="dt"&gt;z0&lt;/span&gt;&lt;span class="op"&gt;:&lt;/span&gt; {&lt;/span&gt;
&lt;span id="cb4-3"&gt;&lt;a aria-hidden="true" href="#cb4-3" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="dt"&gt;srcUphost&lt;/span&gt;&lt;span class="op"&gt;:&lt;/span&gt; &lt;span class="st"&gt;"up.qiniup.com"&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb4-4"&gt;&lt;a aria-hidden="true" href="#cb4-4" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="dt"&gt;cdnUphost&lt;/span&gt;&lt;span class="op"&gt;:&lt;/span&gt; &lt;span class="st"&gt;"upload.qiniup.com"&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb4-5"&gt;&lt;a aria-hidden="true" href="#cb4-5" tabindex="-1"&gt;&lt;/a&gt;    }&lt;span class="op"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb4-6"&gt;&lt;a aria-hidden="true" href="#cb4-6" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="dt"&gt;z1&lt;/span&gt;&lt;span class="op"&gt;:&lt;/span&gt; {&lt;/span&gt;
&lt;span id="cb4-7"&gt;&lt;a aria-hidden="true" href="#cb4-7" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="dt"&gt;srcUphost&lt;/span&gt;&lt;span class="op"&gt;:&lt;/span&gt; &lt;span class="st"&gt;"up-z1.qiniup.com"&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb4-8"&gt;&lt;a aria-hidden="true" href="#cb4-8" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="dt"&gt;cdnUphost&lt;/span&gt;&lt;span class="op"&gt;:&lt;/span&gt; &lt;span class="st"&gt;"upload-z1.qiniup.com"&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb4-9"&gt;&lt;a aria-hidden="true" href="#cb4-9" tabindex="-1"&gt;&lt;/a&gt;    }&lt;span class="op"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb4-10"&gt;&lt;a aria-hidden="true" href="#cb4-10" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="dt"&gt;z2&lt;/span&gt;&lt;span class="op"&gt;:&lt;/span&gt; {&lt;/span&gt;
&lt;span id="cb4-11"&gt;&lt;a aria-hidden="true" href="#cb4-11" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="dt"&gt;srcUphost&lt;/span&gt;&lt;span class="op"&gt;:&lt;/span&gt; &lt;span class="st"&gt;"up-z2.qiniup.com"&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb4-12"&gt;&lt;a aria-hidden="true" href="#cb4-12" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="dt"&gt;cdnUphost&lt;/span&gt;&lt;span class="op"&gt;:&lt;/span&gt; &lt;span class="st"&gt;"upload-z2.qiniup.com"&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb4-13"&gt;&lt;a aria-hidden="true" href="#cb4-13" tabindex="-1"&gt;&lt;/a&gt;    }&lt;span class="op"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb4-14"&gt;&lt;a aria-hidden="true" href="#cb4-14" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="dt"&gt;na0&lt;/span&gt;&lt;span class="op"&gt;:&lt;/span&gt; {&lt;/span&gt;
&lt;span id="cb4-15"&gt;&lt;a aria-hidden="true" href="#cb4-15" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="dt"&gt;srcUphost&lt;/span&gt;&lt;span class="op"&gt;:&lt;/span&gt; &lt;span class="st"&gt;"up-na0.qiniup.com"&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb4-16"&gt;&lt;a aria-hidden="true" href="#cb4-16" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="dt"&gt;cdnUphost&lt;/span&gt;&lt;span class="op"&gt;:&lt;/span&gt; &lt;span class="st"&gt;"upload-na0.qiniup.com"&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb4-17"&gt;&lt;a aria-hidden="true" href="#cb4-17" tabindex="-1"&gt;&lt;/a&gt;    }&lt;span class="op"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb4-18"&gt;&lt;a aria-hidden="true" href="#cb4-18" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="dt"&gt;as0&lt;/span&gt;&lt;span class="op"&gt;:&lt;/span&gt; {&lt;/span&gt;
&lt;span id="cb4-19"&gt;&lt;a aria-hidden="true" href="#cb4-19" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="dt"&gt;srcUphost&lt;/span&gt;&lt;span class="op"&gt;:&lt;/span&gt; &lt;span class="st"&gt;"up-as0.qiniup.com"&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb4-20"&gt;&lt;a aria-hidden="true" href="#cb4-20" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="dt"&gt;cdnUphost&lt;/span&gt;&lt;span class="op"&gt;:&lt;/span&gt; &lt;span class="st"&gt;"upload-as0.qiniup.com"&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb4-21"&gt;&lt;a aria-hidden="true" href="#cb4-21" tabindex="-1"&gt;&lt;/a&gt;       }&lt;/span&gt;
&lt;span id="cb4-22"&gt;&lt;a aria-hidden="true" href="#cb4-22" tabindex="-1"&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id="数据上报"&gt;数据上报&lt;/h2&gt;
&lt;p&gt;数据上报分两种，一种是常规数据的上报，也就是本地事件同步和间隔截屏的数据。第二种是检测到切屏，打开调试工具后的事件上报，通常还会顺便提交截屏作为「证据」。&lt;/p&gt;
&lt;p&gt;第一种上报，就是 setintervel，使用了&lt;a href="https://github.com/qiniu/js-sdk#usage"&gt;七牛的官方 SDK&lt;/a&gt;，retryCount 设置是 3 ，也就是最多尝试上传 3 次。整个流程先在雨课堂的 API 获取 token，再上传。&lt;/p&gt;
&lt;p&gt;&lt;img src="./assets/cap.png.webp"/&gt;&lt;/p&gt;
&lt;p&gt;第二种是对于考试事件的检测和上报，和以前的版本不同，现在雨课堂不再使用单独的 API 地址来上报，而是使用和提交答案一样的 API，上报的内容依旧是 json 文本，格式如下：&lt;/p&gt;
&lt;div class="sourceCode" id="cb5"&gt;&lt;pre class="sourceCode typescript"&gt;&lt;code class="sourceCode typescript"&gt;&lt;span id="cb5-1"&gt;&lt;a aria-hidden="true" href="#cb5-1" tabindex="-1"&gt;&lt;/a&gt;{&lt;/span&gt;
&lt;span id="cb5-2"&gt;&lt;a aria-hidden="true" href="#cb5-2" tabindex="-1"&gt;&lt;/a&gt;    action&lt;span class="op"&gt;:&lt;/span&gt; &lt;span class="dt"&gt;number&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb5-3"&gt;&lt;a aria-hidden="true" href="#cb5-3" tabindex="-1"&gt;&lt;/a&gt;    exam_id&lt;span class="op"&gt;:&lt;/span&gt; &lt;span class="dt"&gt;string&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb5-4"&gt;&lt;a aria-hidden="true" href="#cb5-4" tabindex="-1"&gt;&lt;/a&gt;    t&lt;span class="op"&gt;:&lt;/span&gt; &lt;span class="st"&gt;"t"&lt;/span&gt; &lt;span class="op"&gt;|&lt;/span&gt; &lt;span class="st"&gt;"f"&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb5-5"&gt;&lt;a aria-hidden="true" href="#cb5-5" tabindex="-1"&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;其中 &lt;code&gt;action&lt;/code&gt; 即为事件的编号。切出当前页面是 12，切回则是 16。更新答案选择（即自动保存答案）使用同一个 API，但数据格式不同。&lt;/p&gt;
&lt;p&gt;令人啧啧称奇的是，这个汇报情况的 API 没有速率限制，你可以用一个简单的脚本把自己的切屏次数刷到很离谱的数量。&lt;/p&gt;
&lt;h2 id="水印"&gt;水印&lt;/h2&gt;
&lt;p&gt;水印通过 CSS 背景图片实现，选择器为 &lt;code&gt;.el-color-predefine__color-selector.is-alpha&lt;/code&gt;，base64 编码 png 格式。&lt;/p&gt;
&lt;h1 id="绕过思路"&gt;绕过思路&lt;/h1&gt;
&lt;p&gt;如果你想硬核绕过，不是很难&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;对于切屏检测，直接把监听器移除。&lt;/li&gt;
&lt;li&gt;对于文件上传，老方法，屏蔽七牛云的服务器即可。&lt;strong&gt;但是这样一来，一开始上传证件照会失效&lt;/strong&gt;。&lt;/li&gt;
&lt;li&gt;对于事件上传，大条的方法是用 uBlock 之类的工具屏蔽特定 xhr 请求，但是会影响自动答案保存。&lt;/li&gt;
&lt;li&gt;如果你想要硬核的，proxy 劫持整个 XHR 对象原型，但是注意雨课堂已经用 &lt;code&gt;Sentry&lt;/code&gt; 包装了一层。&lt;/li&gt;
&lt;li&gt;对于水印，CSS 覆盖就完事了。&lt;/li&gt;
&lt;li&gt;摄像头，可以使用 Chrome 的虚拟摄像头功能。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;但是，如果你真的要和它对着干，不建议和它在同一个层次作战。更加稳妥的方法是使用虚拟机。&lt;/p&gt;
&lt;h1 id="参考"&gt;参考&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="/articles/Chrome文件伪装摄像头/index.html"&gt;文件伪装摄像头&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://github.com/qiniu/js-sdk#usage"&gt;七牛 SDK&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://github.com/ltgcgo/minuette"&gt;一个调试工具&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://github.com/gorhill/uBlock/wiki/Dynamic-URL-filtering"&gt;Dynamic URL filtering&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;br/&gt;
&lt;!--%%REF%%--&gt;
&lt;br/&gt;
&lt;script async="" crossorigin="anonymous" data-category="Announcements" data-category-id="DIC_kwDOJ7Ymy84CX4eg" data-emit-metadata="0" data-input-position="top" data-lang="zh-CN" data-loading="lazy" data-mapping="title" data-reactions-enabled="1" data-repo="izfsk-ium/izfsk-ium.github.io" data-repo-id="R_kgDOJ7Ymyw" data-strict="0" data-theme="preferred_color_scheme" src="https://giscus.app/client.js"&gt;
&lt;/script&gt;
&lt;/main&gt;
&lt;footer&gt;
&lt;p class="signoff"&gt;
&lt;div class="metadata"&gt;
&lt;p class="date"&gt;&lt;time datetime="2023-01-04"&gt;创建日期：2023-01-04&lt;/time&gt;&lt;/p&gt;
&lt;p class="lastmodify"&gt;&lt;time&gt;最后编译：2023-08-10&lt;/time&gt;&lt;/p&gt;
&lt;p class="lastmodify" id="counter-span"&gt;访问次数：&lt;/p&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;/footer&gt;
&lt;script&gt;
    /* These script should run after page load */
    document.querySelectorAll('code.sourceCode').forEach(
      i =&gt; i.insertAdjacentHTML('beforeend', '&lt;div class="copy"&gt;复制&lt;/div&gt;')
    );
    document.querySelectorAll('div.copy').forEach(
      i =&gt; i.addEventListener(
        'click',
        () =&gt; {
          navigator.clipboard.writeText(i.parentElement.innerText.replace('复制', ''));
          i.innerText = '成功';
          setTimeout(() =&gt; {
            i.innerText = '复制';
          }, 1000);
        }
      )
    );

    if (location.href.includes("127.0.0.1:8080")) {
      document.getElementById("counter-span").innerHTML = "[[development mode]]";
    } else {
      const uuid = document.getElementById("article-uuid").innerText;
      const target = document.getElementById("counter-span");
      const last = localStorage.getItem("lastVisit-" + uuid);
      const shouldIncrease = last === null || new Date().getTime() - parseInt(last) &gt;= (1000 * 60 * 15);

      fetch(shouldIncrease ? ("https://counter.izfsk.top/counter/" + uuid) : ("https://counter.izfsk.top/readOnly/" + uuid))
        .then(r =&gt; r.text())
        .then(d =&gt; {
          if (!d.startsWith("Too"))
            document.getElementById("counter-span").innerText = "访问次数：" + d.toString();
          else
            document.getElementById("counter-span").innerHTML = "";
        });

      localStorage.setItem("lastVisit-" + uuid, new Date().getTime());
    }
  &lt;/script&gt;
&lt;script async="" data-website-id="2a1146ab-fa82-4a84-a04f-30e5967357c3" src="https://analytics.umami.is/script.js"&gt;&lt;/script&gt;
&lt;/body&gt;</content:encoded>
      <guid isPermaLink="false">4ca67c26-00b4-4c79-bbac-65f9a7a434b5</guid>
      <pubDate>Wed, 04 Jan 2023 00:00:00 +0800</pubDate>
    </item>
    <item>
      <title>Portacle的使用</title>
      <link>https://blog.izfsk.top/articles/Portacle的使用.html</link>
      <description>Portacle的使用</description>
      <content:encoded>&lt;body&gt;
&lt;progress id="content_progress" value="0"&gt;&lt;/progress&gt;
&lt;button id="back-to-top"&gt;
    回页顶
  &lt;/button&gt;
&lt;header&gt;
&lt;small id="article-uuid" style="display: none !important;"&gt;9886aba7-4b9c-4070-9ce3-1e30734b757b&lt;/small&gt;
&lt;h1 class="title"&gt;Portacle的使用&lt;/h1&gt;
&lt;!-- Subtitle --&gt;
&lt;h3 class="subtitle"&gt; &lt;/h3&gt;
&lt;/header&gt;
&lt;nav id="TOC" role="doc-toc"&gt;
&lt;strong&gt;文章归类: &lt;a href="/pages/category.html#备忘录"&gt;备忘录&lt;/a&gt; &lt;/strong&gt;
&lt;input id="contents" type="checkbox"/&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#安装配置" id="toc-安装配置"&gt;安装配置&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#基本操作" id="toc-基本操作"&gt;基本操作&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#emacs-相关" id="toc-emacs-相关"&gt;Emacs 相关&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#光标操作" id="toc-光标操作"&gt;光标操作&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#撤销重做" id="toc-撤销重做"&gt;撤销重做&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#删除" id="toc-删除"&gt;删除&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#复制粘贴" id="toc-复制粘贴"&gt;复制粘贴&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#在-buff-之间切换" id="toc-在-buff-之间切换"&gt;在 buff 之间切换&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#文件操作" id="toc-文件操作"&gt;文件操作&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#搜索和替换" id="toc-搜索和替换"&gt;搜索和替换&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#slime-相关" id="toc-slime-相关"&gt;SLIME 相关&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#slime-selector" id="toc-slime-selector"&gt;slime-selector&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#执行" id="toc-执行"&gt;执行&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#编译" id="toc-编译"&gt;编译&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#寻找定义" id="toc-寻找定义"&gt;寻找定义&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#获取文档" id="toc-获取文档"&gt;获取文档&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#错误处理" id="toc-错误处理"&gt;错误处理&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#其他问题" id="toc-其他问题"&gt;其他问题&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#参见" id="toc-参见"&gt;参见&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#reference"&gt;参考链接&lt;/a&gt;&lt;/li&gt;
&lt;li&gt; &lt;/li&gt;
&lt;li class="tools"&gt;
&lt;span id="backtomain"&gt;
&lt;svg class="bi bi-house" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M8.707 1.5a1 1 0 0 0-1.414 0L.646 8.146a.5.5 0 0 0 .708.708L2 8.207V13.5A1.5 1.5 0 0 0 3.5 15h9a1.5 1.5 0 0 0 1.5-1.5V8.207l.646.647a.5.5 0 0 0 .708-.708L13 5.793V2.5a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v1.293L8.707 1.5ZM13 7.207V13.5a.5.5 0 0 1-.5.5h-9a.5.5 0 0 1-.5-.5V7.207l5-5 5 5Z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="readingmode"&gt;
&lt;svg class="bi bi-book" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M1 2.828c.885-.37 2.154-.769 3.388-.893 1.33-.134 2.458.063 3.112.752v9.746c-.935-.53-2.12-.603-3.213-.493-1.18.12-2.37.461-3.287.811V2.828zm7.5-.141c.654-.689 1.782-.886 3.112-.752 1.234.124 2.503.523 3.388.893v9.923c-.918-.35-2.107-.692-3.287-.81-1.094-.111-2.278-.039-3.213.492V2.687zM8 1.783C7.015.936 5.587.81 4.287.94c-1.514.153-3.042.672-3.994 1.105A.5.5 0 0 0 0 2.5v11a.5.5 0 0 0 .707.455c.882-.4 2.303-.881 3.68-1.02 1.409-.142 2.59.087 3.223.877a.5.5 0 0 0 .78 0c.633-.79 1.814-1.019 3.222-.877 1.378.139 2.8.62 3.681 1.02A.5.5 0 0 0 16 13.5v-11a.5.5 0 0 0-.293-.455c-.952-.433-2.48-.952-3.994-1.105C10.413.809 8.985.936 8 1.783z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="larger"&gt; &lt;/span&gt;
&lt;span id="smaller"&gt;&lt;/span&gt;
&lt;span id="switchfont"&gt;
&lt;svg class="bi bi-fonts" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M12.258 3h-8.51l-.083 2.46h.479c.26-1.544.758-1.783 2.693-1.845l.424-.013v7.827c0 .663-.144.82-1.3.923v.52h4.082v-.52c-1.162-.103-1.306-.26-1.306-.923V3.602l.431.013c1.934.062 2.434.301 2.693 1.846h.479L12.258 3z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="backtotop"&gt;
&lt;svg class="bi bi-arrow-bar-up" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M8 10a.5.5 0 0 0 .5-.5V3.707l2.146 2.147a.5.5 0 0 0 .708-.708l-3-3a.5.5 0 0 0-.708 0l-3 3a.5.5 0 1 0 .708.708L7.5 3.707V9.5a.5.5 0 0 0 .5.5zm-7 2.5a.5.5 0 0 1 .5-.5h13a.5.5 0 0 1 0 1h-13a.5.5 0 0 1-.5-.5z" fill-rule="evenodd"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/nav&gt;
&lt;main&gt;
&lt;p&gt;Portacle 是一个 CommonLisp 运行时和开发环境，没有复杂的安装流程，更没有附带各种恶心限制的许可证(&lt;del&gt;说的就是你 LispWorks&lt;/del&gt;)，使用方便。基于 Emacs 构建，自带 SBCL，busybox，Quicklisp，git，SLIME。&lt;/p&gt;
&lt;h1 id="安装配置"&gt;安装配置&lt;/h1&gt;
&lt;p&gt;在&lt;a href="https://portacle.github.io"&gt;官方网站&lt;/a&gt;下载 tar.xz 包，然后解压到希望安装的目录下。运行即可。加载配置文件需要一小会儿，之后就能看见主界面了。&lt;/p&gt;
&lt;p&gt;第一次运行需要先进行用户配置，按 &lt;code&gt;Alt + X&lt;/code&gt; 输入 &lt;code&gt;portacle-configure&lt;/code&gt; 回车，按照提示进行初次配置。&lt;/p&gt;
&lt;figure&gt;
&lt;img alt="主界面" src="./assets/Screenshot_20230106_211912.png"/&gt;
&lt;figcaption aria-hidden="true"&gt;主界面&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;主界面默认上下分栏，上面的是 &lt;code&gt;scratch&lt;/code&gt; 区域，用来编辑运行环境里面的 Lisp 代码，下面的是 &lt;code&gt;slime-repl&lt;/code&gt;，用来和 Lisp 解释器交互。Portacle 有一个现代 IDE 应该有的功能，包括自动补全，文档提示，自动格式化代码，错误提示等等。&lt;/p&gt;
&lt;h1 id="基本操作"&gt;基本操作&lt;/h1&gt;
&lt;p&gt;由于 Portacle 是基于 Emacs 的，所以掌握 Emacs 的基本操作也就是掌握 Portacle 的基本操作。&lt;/p&gt;
&lt;h2 id="emacs-相关"&gt;Emacs 相关&lt;/h2&gt;
&lt;p&gt;按照一般的写法，&lt;code&gt;Ctrl + 按键&lt;/code&gt; 就写成 &lt;code&gt;C-按键&lt;/code&gt;，&lt;code&gt;Meta + 按键&lt;/code&gt; 就写成 &lt;code&gt;M-按键&lt;/code&gt;。在标准键盘上，Meta 键就是 &lt;code&gt;Alt&lt;/code&gt; 键。&lt;/p&gt;
&lt;p&gt;如果你键入一半的快捷键不想操作了，狠狠的摁几下 &lt;code&gt;C-g&lt;/code&gt; 即可。&lt;/p&gt;
&lt;h3 id="光标操作"&gt;光标操作&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class="header"&gt;
&lt;th style="text-align: center;"&gt;键位&lt;/th&gt;
&lt;th style="text-align: center;"&gt;操作&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class="odd"&gt;
&lt;td style="text-align: center;"&gt;&lt;code&gt;C-p&lt;/code&gt;&lt;/td&gt;
&lt;td style="text-align: center;"&gt;光标向上移动&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="even"&gt;
&lt;td style="text-align: center;"&gt;&lt;code&gt;C-n&lt;/code&gt;&lt;/td&gt;
&lt;td style="text-align: center;"&gt;光标向下移动&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="odd"&gt;
&lt;td style="text-align: center;"&gt;&lt;code&gt;C-b&lt;/code&gt;&lt;/td&gt;
&lt;td style="text-align: center;"&gt;光标向左移动&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="even"&gt;
&lt;td style="text-align: center;"&gt;&lt;code&gt;C-f&lt;/code&gt;&lt;/td&gt;
&lt;td style="text-align: center;"&gt;光标向右移动&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="odd"&gt;
&lt;td style="text-align: center;"&gt;&lt;code&gt;M-f&lt;/code&gt;&lt;/td&gt;
&lt;td style="text-align: center;"&gt;向前跳一个字&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="even"&gt;
&lt;td style="text-align: center;"&gt;&lt;code&gt;M-b&lt;/code&gt;&lt;/td&gt;
&lt;td style="text-align: center;"&gt;向后跳一个字&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="odd"&gt;
&lt;td style="text-align: center;"&gt;&lt;code&gt;C-a&lt;/code&gt;&lt;/td&gt;
&lt;td style="text-align: center;"&gt;到一行开头&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="even"&gt;
&lt;td style="text-align: center;"&gt;&lt;code&gt;C-e&lt;/code&gt;&lt;/td&gt;
&lt;td style="text-align: center;"&gt;到一行结尾&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="odd"&gt;
&lt;td style="text-align: center;"&gt;&lt;code&gt;M-a&lt;/code&gt;&lt;/td&gt;
&lt;td style="text-align: center;"&gt;到段落开头(函数/宏定义开头)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="even"&gt;
&lt;td style="text-align: center;"&gt;&lt;code&gt;M-e&lt;/code&gt;&lt;/td&gt;
&lt;td style="text-align: center;"&gt;到段落结尾(函数/宏定义结尾)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="odd"&gt;
&lt;td style="text-align: center;"&gt;&lt;code&gt;C-v&lt;/code&gt;&lt;/td&gt;
&lt;td style="text-align: center;"&gt;向下一页&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="even"&gt;
&lt;td style="text-align: center;"&gt;&lt;code&gt;M-v&lt;/code&gt;&lt;/td&gt;
&lt;td style="text-align: center;"&gt;向上一页&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="撤销重做"&gt;撤销重做&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class="header"&gt;
&lt;th style="text-align: center;"&gt;键位&lt;/th&gt;
&lt;th style="text-align: center;"&gt;操作&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class="odd"&gt;
&lt;td style="text-align: center;"&gt;&lt;code&gt;C-x u&lt;/code&gt;&lt;/td&gt;
&lt;td style="text-align: center;"&gt;撤销上一个行为&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="删除"&gt;删除&lt;/h3&gt;
&lt;p&gt;被按行/句为单位删除的会被保留在剪切环中，之后可以取回来。&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class="header"&gt;
&lt;th style="text-align: center;"&gt;键位&lt;/th&gt;
&lt;th style="text-align: center;"&gt;操作&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class="odd"&gt;
&lt;td style="text-align: center;"&gt;&lt;code&gt;C-d&lt;/code&gt;&lt;/td&gt;
&lt;td style="text-align: center;"&gt;删除一个字&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="even"&gt;
&lt;td style="text-align: center;"&gt;&lt;code&gt;M-Backspace&lt;/code&gt;&lt;/td&gt;
&lt;td style="text-align: center;"&gt;向后删除一个词&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="odd"&gt;
&lt;td style="text-align: center;"&gt;&lt;code&gt;M-d&lt;/code&gt;&lt;/td&gt;
&lt;td style="text-align: center;"&gt;向前删除一个词&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="even"&gt;
&lt;td style="text-align: center;"&gt;&lt;code&gt;C-k&lt;/code&gt;&lt;/td&gt;
&lt;td style="text-align: center;"&gt;删除到行尾&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="odd"&gt;
&lt;td style="text-align: center;"&gt;&lt;code&gt;M-k&lt;/code&gt;&lt;/td&gt;
&lt;td style="text-align: center;"&gt;删除到句点&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="复制粘贴"&gt;复制粘贴&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;对于删除掉的保存在剪贴环中的内容，使用 &lt;code&gt;C-y&lt;/code&gt; 取得。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;使用以下操作进行任意选区的复制粘贴：&lt;/p&gt;
&lt;ol type="1"&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;C-Shift-2&lt;/code&gt; 进入 &lt;code&gt;Mark&lt;/code&gt; 模式；&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;移动光标选取需要的内容；&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;M-w&lt;/code&gt; 复制到剪贴环；&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;C-y&lt;/code&gt; 粘贴。&lt;/p&gt;
&lt;p&gt;也可以直接使用鼠标选取区域。&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="在-buff-之间切换"&gt;在 buff 之间切换&lt;/h3&gt;
&lt;p&gt;可以把 buff 理解成是标签页，一个 Emacs 可以打开很多 buff，你需要在不同的 buff 之间辗转挪移。&lt;/p&gt;
&lt;figure&gt;
&lt;img alt="好多 buff 呀！" src="./assets/somanybuffers.png"/&gt;
&lt;figcaption aria-hidden="true"&gt;好多 buff 呀！&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;table&gt;
&lt;colgroup&gt;
&lt;col style="width: 30%"/&gt;
&lt;col style="width: 69%"/&gt;
&lt;/colgroup&gt;
&lt;thead&gt;
&lt;tr class="header"&gt;
&lt;th style="text-align: center;"&gt;键位&lt;/th&gt;
&lt;th style="text-align: center;"&gt;操作&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class="odd"&gt;
&lt;td style="text-align: center;"&gt;&lt;code&gt;C-x b name&lt;/code&gt;&lt;/td&gt;
&lt;td style="text-align: center;"&gt;创建一个空 buff&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="even"&gt;
&lt;td style="text-align: center;"&gt;&lt;code&gt;C-x left/right&lt;/code&gt;&lt;/td&gt;
&lt;td style="text-align: center;"&gt;上一个/下一个 buff，left 和 right 就是小键盘的方向键&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="odd"&gt;
&lt;td style="text-align: center;"&gt;&lt;code&gt;C-x C-b&lt;/code&gt;&lt;/td&gt;
&lt;td style="text-align: center;"&gt;列出所有 buff&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="even"&gt;
&lt;td style="text-align: center;"&gt;&lt;code&gt;C-x C-q&lt;/code&gt;&lt;/td&gt;
&lt;td style="text-align: center;"&gt;设置这个 buff 的只读状态&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="odd"&gt;
&lt;td style="text-align: center;"&gt;&lt;code&gt;C-x k&lt;/code&gt;&lt;/td&gt;
&lt;td style="text-align: center;"&gt;关闭 buff&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="even"&gt;
&lt;td style="text-align: center;"&gt;&lt;code&gt;M-x kill-some-buffers&lt;/code&gt;&lt;/td&gt;
&lt;td style="text-align: center;"&gt;交互式的一个个提示关闭&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="文件操作"&gt;文件操作&lt;/h3&gt;
&lt;p&gt;你在 scratch 里面的文件虽然加载到了 Lisp 环境里面，但并没有保存！&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class="header"&gt;
&lt;th style="text-align: center;"&gt;键位&lt;/th&gt;
&lt;th style="text-align: center;"&gt;操作&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class="odd"&gt;
&lt;td style="text-align: center;"&gt;&lt;code&gt;C-x C-f&lt;/code&gt;&lt;/td&gt;
&lt;td style="text-align: center;"&gt;打开一个文件&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="even"&gt;
&lt;td style="text-align: center;"&gt;&lt;code&gt;C-x C-s&lt;/code&gt;&lt;/td&gt;
&lt;td style="text-align: center;"&gt;&lt;strong&gt;保存文件&lt;/strong&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="odd"&gt;
&lt;td style="text-align: center;"&gt;&lt;code&gt;C-x i&lt;/code&gt;&lt;/td&gt;
&lt;td style="text-align: center;"&gt;在光标处插入指定文件内容&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="even"&gt;
&lt;td style="text-align: center;"&gt;&lt;code&gt;C-x s&lt;/code&gt;&lt;/td&gt;
&lt;td style="text-align: center;"&gt;全部保存&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;另外，如果你要直接载入 Lisp 代码，需要在 Slime 里面执行：&lt;/p&gt;
&lt;p&gt;&lt;code&gt;(load xxx.lisp)&lt;/code&gt; 来载入代码。&lt;/p&gt;
&lt;p&gt;另一种加载文件的方法是，先用 COMPILE-FILE 编译，然后再用 LOAD 加载编译后产生 的文件,也就是 FASL 文件。前者将返回 FASL 文件的名字,所以可以在 REPL 进行编译加载:&lt;/p&gt;
&lt;div class="sourceCode" id="cb1"&gt;&lt;pre class="sourceCode lisp"&gt;&lt;code class="sourceCode commonlisp"&gt;&lt;span id="cb1-1"&gt;&lt;a aria-hidden="true" href="#cb1-1" tabindex="-1"&gt;&lt;/a&gt;(&lt;span class="kw"&gt;load&lt;/span&gt; (&lt;span class="kw"&gt;compile-file&lt;/span&gt; &lt;span class="st"&gt;"hello.lisp"&lt;/span&gt;))&lt;/span&gt;
&lt;span id="cb1-2"&gt;&lt;a aria-hidden="true" href="#cb1-2" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="co"&gt;;;; Compiling file hello.lisp&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-3"&gt;&lt;a aria-hidden="true" href="#cb1-3" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="co"&gt;;;; Writing fasl file hello.fasl&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-4"&gt;&lt;a aria-hidden="true" href="#cb1-4" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="co"&gt;;;; Fasl write complete&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-5"&gt;&lt;a aria-hidden="true" href="#cb1-5" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="co"&gt;; Fast loading /home/xxxx/my-lisp-programs/hello.fasl&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;最后，在一个源代码缓冲区的时候,可以使用 &lt;code&gt;C-c C-l&lt;/code&gt; 调用命令 &lt;code&gt;slime-load-file&lt;/code&gt; 来加载文件。Emacs 将会提示你给出要加载的文件名,同时将当前的文件名作为默认值，直接回车就可以了。&lt;/p&gt;
&lt;h3 id="搜索和替换"&gt;搜索和替换&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class="header"&gt;
&lt;th style="text-align: center;"&gt;键位&lt;/th&gt;
&lt;th style="text-align: center;"&gt;操作&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class="odd"&gt;
&lt;td style="text-align: center;"&gt;&lt;code&gt;C-r&lt;/code&gt;&lt;/td&gt;
&lt;td style="text-align: center;"&gt;光标向上移动&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="even"&gt;
&lt;td style="text-align: center;"&gt;&lt;code&gt;C-s&lt;/code&gt;&lt;/td&gt;
&lt;td style="text-align: center;"&gt;向前搜索&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="odd"&gt;
&lt;td style="text-align: center;"&gt;&lt;code&gt;C-g&lt;/code&gt;&lt;/td&gt;
&lt;td style="text-align: center;"&gt;向后搜索&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="even"&gt;
&lt;td style="text-align: center;"&gt;&lt;code&gt;C-x C-x&lt;/code&gt;&lt;/td&gt;
&lt;td style="text-align: center;"&gt;回到搜索执行的地方&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="odd"&gt;
&lt;td style="text-align: center;"&gt;&lt;code&gt;M-Shift-5&lt;/code&gt;&lt;/td&gt;
&lt;td style="text-align: center;"&gt;交互式替换&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id="slime-相关"&gt;SLIME 相关&lt;/h2&gt;
&lt;p&gt;默认下面的 buff 就是 slime 的 repl，你可以在这里执行 lisp 。&lt;strong&gt;注意，这个 lisp 不是 Emacs 内置的 EmacsLisp，而是 CommonLisp&lt;/strong&gt;！&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;repl 中使用 &lt;code&gt;C-&amp;lt;up&amp;gt;&lt;/code&gt; &lt;code&gt;C-&amp;lt;down&amp;gt;&lt;/code&gt; 来编辑历史命令！&lt;/strong&gt;&lt;/p&gt;
&lt;h3 id="slime-selector"&gt;slime-selector&lt;/h3&gt;
&lt;p&gt;这个 slime-selector 可以快捷的在各个不同的 slime buff 之间跳转，相当于是给各个 buff 定义了快捷键。默认情况不绑定，需要手动绑定以下。&lt;/p&gt;
&lt;p&gt;打开按照目录的 &lt;code&gt;config/user.el&lt;/code&gt; 在最后加上按键绑定 &lt;code&gt;(global-set-key "\C-cs" 'slime-selector)&lt;/code&gt; 之后重启即可，之后就可以使用 &lt;code&gt;C-c s &amp;lt;按键&amp;gt;&lt;/code&gt; 来快捷到达某个 buff。&lt;/p&gt;
&lt;p&gt;常见的选项：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;? 查看帮助&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;r 进入 SLIME 的 repl buff，也就是默认界面下面的 buff&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;d 最近一次激活的 debugger buff&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;l 最近一次访问的 lisp-mode 源码 buff.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;s &lt;em&gt;slime-scratch&lt;/em&gt; buffer，也就是默认界面上面的那个 buff&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;所以，在任何时候想要去 repl 只要 &lt;code&gt;C-c s r&lt;/code&gt; 即可。&lt;/p&gt;
&lt;h3 id="执行"&gt;执行&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class="header"&gt;
&lt;th style="text-align: center;"&gt;键位&lt;/th&gt;
&lt;th style="text-align: center;"&gt;操作&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class="odd"&gt;
&lt;td style="text-align: center;"&gt;&lt;code&gt;C-x C-e&lt;/code&gt;&lt;/td&gt;
&lt;td style="text-align: center;"&gt;执行上一个语句&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="编译"&gt;编译&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class="header"&gt;
&lt;th style="text-align: center;"&gt;键位&lt;/th&gt;
&lt;th style="text-align: center;"&gt;操作&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class="odd"&gt;
&lt;td style="text-align: center;"&gt;&lt;code&gt;C-c C-c&lt;/code&gt;&lt;/td&gt;
&lt;td style="text-align: center;"&gt;编译函数，被编译的对象会被高亮显示&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="even"&gt;
&lt;td style="text-align: center;"&gt;&lt;code&gt;C-c C-l&lt;/code&gt;&lt;/td&gt;
&lt;td style="text-align: center;"&gt;加载文件&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="odd"&gt;
&lt;td style="text-align: center;"&gt;&lt;code&gt;C-c C-k&lt;/code&gt;&lt;/td&gt;
&lt;td style="text-align: center;"&gt;加载并编译文件&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="寻找定义"&gt;寻找定义&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class="header"&gt;
&lt;th style="text-align: center;"&gt;键位&lt;/th&gt;
&lt;th style="text-align: center;"&gt;操作&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class="odd"&gt;
&lt;td style="text-align: center;"&gt;&lt;code&gt;M-.&lt;/code&gt;&lt;/td&gt;
&lt;td style="text-align: center;"&gt;跳转到目前光标所在位置的定义&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="even"&gt;
&lt;td style="text-align: center;"&gt;&lt;code&gt;M-,&lt;/code&gt;&lt;/td&gt;
&lt;td style="text-align: center;"&gt;返回寻找时的位置&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="odd"&gt;
&lt;td style="text-align: center;"&gt;&lt;code&gt;C-x 4 .&lt;/code&gt;&lt;/td&gt;
&lt;td style="text-align: center;"&gt;打开新的窗口编辑目标定义&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="获取文档"&gt;获取文档&lt;/h3&gt;
&lt;figure&gt;
&lt;img alt="自动帮助" src="./assets/help.webp"/&gt;
&lt;figcaption aria-hidden="true"&gt;自动帮助&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class="header"&gt;
&lt;th style="text-align: center;"&gt;键位&lt;/th&gt;
&lt;th style="text-align: center;"&gt;操作&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class="odd"&gt;
&lt;td style="text-align: center;"&gt;&lt;code&gt;C-c C-d d&lt;/code&gt;&lt;/td&gt;
&lt;td style="text-align: center;"&gt;描述光标处的定义&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="even"&gt;
&lt;td style="text-align: center;"&gt;&lt;code&gt;C-c C-d A&lt;/code&gt;&lt;/td&gt;
&lt;td style="text-align: center;"&gt;slime-apropos&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="错误处理"&gt;错误处理&lt;/h3&gt;
&lt;p&gt;&lt;img src="./assets/slbd.png"/&gt;&lt;/p&gt;
&lt;p&gt;有时候你的 Lisp 代码出错了，Slime 会打开一个临时 buff 来处理出错，你可以直接按 &lt;code&gt;q&lt;/code&gt; 关闭这个 buff。&lt;/p&gt;
&lt;h1 id="其他问题"&gt;其他问题&lt;/h1&gt;
&lt;p&gt;中文字体似乎很是难看，我尝试了这样配置：&lt;/p&gt;
&lt;pre class="elisp"&gt;&lt;code&gt;(set-fontset-font t '(#x2ff0 . #x9ffc) 
    (font-spec :family "Sarasa Mono Slab SC" :size 18 :weight 'bold))&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;但是无效:-(&lt;/p&gt;
&lt;p&gt;&lt;img src="./assets/bad.png"/&gt;&lt;/p&gt;
&lt;h1 id="参见"&gt;参见&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://mirrors.sjtug.sjtu.edu.cn/emacs-elpa/nongnu-devel/doc/slime.html"&gt;SLIME User Manual, version 2.24&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://scc.ustc.edu.cn/zlsc/czxt/200910/W020100308601210472906.pdf"&gt;Emacs 使用手册&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://portacle.github.io"&gt;Portacle 网站&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;br/&gt;
&lt;!--%%REF%%--&gt;
&lt;br/&gt;
&lt;script async="" crossorigin="anonymous" data-category="Announcements" data-category-id="DIC_kwDOJ7Ymy84CX4eg" data-emit-metadata="0" data-input-position="top" data-lang="zh-CN" data-loading="lazy" data-mapping="title" data-reactions-enabled="1" data-repo="izfsk-ium/izfsk-ium.github.io" data-repo-id="R_kgDOJ7Ymyw" data-strict="0" data-theme="preferred_color_scheme" src="https://giscus.app/client.js"&gt;
&lt;/script&gt;
&lt;/main&gt;
&lt;footer&gt;
&lt;p class="signoff"&gt;
&lt;div class="metadata"&gt;
&lt;p class="date"&gt;&lt;time datetime="2023-01-06"&gt;创建日期：2023-01-06&lt;/time&gt;&lt;/p&gt;
&lt;p class="lastmodify"&gt;&lt;time&gt;最后编译：2023-08-10&lt;/time&gt;&lt;/p&gt;
&lt;p class="lastmodify" id="counter-span"&gt;访问次数：&lt;/p&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;/footer&gt;
&lt;script&gt;
    /* These script should run after page load */
    document.querySelectorAll('code.sourceCode').forEach(
      i =&gt; i.insertAdjacentHTML('beforeend', '&lt;div class="copy"&gt;复制&lt;/div&gt;')
    );
    document.querySelectorAll('div.copy').forEach(
      i =&gt; i.addEventListener(
        'click',
        () =&gt; {
          navigator.clipboard.writeText(i.parentElement.innerText.replace('复制', ''));
          i.innerText = '成功';
          setTimeout(() =&gt; {
            i.innerText = '复制';
          }, 1000);
        }
      )
    );

    if (location.href.includes("127.0.0.1:8080")) {
      document.getElementById("counter-span").innerHTML = "[[development mode]]";
    } else {
      const uuid = document.getElementById("article-uuid").innerText;
      const target = document.getElementById("counter-span");
      const last = localStorage.getItem("lastVisit-" + uuid);
      const shouldIncrease = last === null || new Date().getTime() - parseInt(last) &gt;= (1000 * 60 * 15);

      fetch(shouldIncrease ? ("https://counter.izfsk.top/counter/" + uuid) : ("https://counter.izfsk.top/readOnly/" + uuid))
        .then(r =&gt; r.text())
        .then(d =&gt; {
          if (!d.startsWith("Too"))
            document.getElementById("counter-span").innerText = "访问次数：" + d.toString();
          else
            document.getElementById("counter-span").innerHTML = "";
        });

      localStorage.setItem("lastVisit-" + uuid, new Date().getTime());
    }
  &lt;/script&gt;
&lt;script async="" data-website-id="2a1146ab-fa82-4a84-a04f-30e5967357c3" src="https://analytics.umami.is/script.js"&gt;&lt;/script&gt;
&lt;/body&gt;</content:encoded>
      <guid isPermaLink="false">9886aba7-4b9c-4070-9ce3-1e30734b757b</guid>
      <pubDate>Fri, 06 Jan 2023 00:00:00 +0800</pubDate>
    </item>
    <item>
      <title>Python协程的使用</title>
      <link>https://blog.izfsk.top/articles/Python协程的使用.html</link>
      <description>Python协程的使用</description>
      <content:encoded>&lt;body&gt;
&lt;progress id="content_progress" value="0"&gt;&lt;/progress&gt;
&lt;button id="back-to-top"&gt;
    回页顶
  &lt;/button&gt;
&lt;header&gt;
&lt;small id="article-uuid" style="display: none !important;"&gt;4798069b-f6d7-48df-ab8c-a64c0da7739d&lt;/small&gt;
&lt;h1 class="title"&gt;Python协程的使用&lt;/h1&gt;
&lt;!-- Subtitle --&gt;
&lt;h3 class="subtitle"&gt; &lt;/h3&gt;
&lt;/header&gt;
&lt;nav id="TOC" role="doc-toc"&gt;
&lt;strong&gt;文章归类: &lt;a href="/pages/category.html#学习"&gt;学习&lt;/a&gt; &lt;/strong&gt;
&lt;input id="contents" type="checkbox"/&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#基本行为" id="toc-基本行为"&gt;基本行为&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#传出数据" id="toc-传出数据"&gt;传出数据&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#接收数据" id="toc-接收数据"&gt;接收数据&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#只用来控制流程" id="toc-只用来控制流程"&gt;只用来控制流程&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#yield-from" id="toc-yield-from"&gt;yield from&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#自动初始化" id="toc-自动初始化"&gt;自动初始化&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#应用" id="toc-应用"&gt;应用&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#分发器" id="toc-分发器"&gt;分发器&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#reference"&gt;参考链接&lt;/a&gt;&lt;/li&gt;
&lt;li&gt; &lt;/li&gt;
&lt;li class="tools"&gt;
&lt;span id="backtomain"&gt;
&lt;svg class="bi bi-house" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M8.707 1.5a1 1 0 0 0-1.414 0L.646 8.146a.5.5 0 0 0 .708.708L2 8.207V13.5A1.5 1.5 0 0 0 3.5 15h9a1.5 1.5 0 0 0 1.5-1.5V8.207l.646.647a.5.5 0 0 0 .708-.708L13 5.793V2.5a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v1.293L8.707 1.5ZM13 7.207V13.5a.5.5 0 0 1-.5.5h-9a.5.5 0 0 1-.5-.5V7.207l5-5 5 5Z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="readingmode"&gt;
&lt;svg class="bi bi-book" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M1 2.828c.885-.37 2.154-.769 3.388-.893 1.33-.134 2.458.063 3.112.752v9.746c-.935-.53-2.12-.603-3.213-.493-1.18.12-2.37.461-3.287.811V2.828zm7.5-.141c.654-.689 1.782-.886 3.112-.752 1.234.124 2.503.523 3.388.893v9.923c-.918-.35-2.107-.692-3.287-.81-1.094-.111-2.278-.039-3.213.492V2.687zM8 1.783C7.015.936 5.587.81 4.287.94c-1.514.153-3.042.672-3.994 1.105A.5.5 0 0 0 0 2.5v11a.5.5 0 0 0 .707.455c.882-.4 2.303-.881 3.68-1.02 1.409-.142 2.59.087 3.223.877a.5.5 0 0 0 .78 0c.633-.79 1.814-1.019 3.222-.877 1.378.139 2.8.62 3.681 1.02A.5.5 0 0 0 16 13.5v-11a.5.5 0 0 0-.293-.455c-.952-.433-2.48-.952-3.994-1.105C10.413.809 8.985.936 8 1.783z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="larger"&gt; &lt;/span&gt;
&lt;span id="smaller"&gt;&lt;/span&gt;
&lt;span id="switchfont"&gt;
&lt;svg class="bi bi-fonts" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M12.258 3h-8.51l-.083 2.46h.479c.26-1.544.758-1.783 2.693-1.845l.424-.013v7.827c0 .663-.144.82-1.3.923v.52h4.082v-.52c-1.162-.103-1.306-.26-1.306-.923V3.602l.431.013c1.934.062 2.434.301 2.693 1.846h.479L12.258 3z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="backtotop"&gt;
&lt;svg class="bi bi-arrow-bar-up" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M8 10a.5.5 0 0 0 .5-.5V3.707l2.146 2.147a.5.5 0 0 0 .708-.708l-3-3a.5.5 0 0 0-.708 0l-3 3a.5.5 0 1 0 .708.708L7.5 3.707V9.5a.5.5 0 0 0 .5.5zm-7 2.5a.5.5 0 0 1 .5-.5h13a.5.5 0 0 1 0 1h-13a.5.5 0 0 1-.5-.5z" fill-rule="evenodd"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/nav&gt;
&lt;main&gt;
&lt;p&gt;「协程」看它的名字不是个很好理解的词语，其英文 Coroutine 的定义是「Computer program components that generalize subroutines for non-preemptive multitasking, by allowing execution to be suspended and resumed.」它与普通的子例程的区别在于「allowing execution to be suspended and resumed」，通俗的来讲，就是一个「可以暂停和恢复的，同时能够保存一些信息的子例程」。在 Python 中，&lt;code&gt;yield&lt;/code&gt;，&lt;code&gt;yield from&lt;/code&gt;，&lt;code&gt;async&lt;/code&gt;，&lt;code&gt;await&lt;/code&gt; 关键字都能够用来做协程处理。&lt;/p&gt;
&lt;h1 id="基本行为"&gt;基本行为&lt;/h1&gt;
&lt;p&gt;一个协程基本上是一个特殊的函数，不过与普通的函数不同，协程可以保存内部的状态，将控制流程转移出去，同时在运行时接收外界进一步的信息。假如有函数 &lt;code&gt;a&lt;/code&gt;，&lt;code&gt;b&lt;/code&gt; 和协程 &lt;code&gt;c&lt;/code&gt;，那么控制流程可以是这样的：&lt;/p&gt;
&lt;div class="sourceCode" id="cb1"&gt;&lt;pre class="sourceCode erlang"&gt;&lt;code class="sourceCode erlang"&gt;&lt;span id="cb1-1"&gt;&lt;a aria-hidden="true" href="#cb1-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="ch"&gt;main&lt;/span&gt; &lt;span class="op"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="ch"&gt;a&lt;/span&gt; &lt;span class="op"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="ch"&gt;b&lt;/span&gt; &lt;span class="op"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="ch"&gt;done&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-2"&gt;&lt;a aria-hidden="true" href="#cb1-2" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="op"&gt;//&lt;/span&gt; 按照次序调用 &lt;span class="ch"&gt;a&lt;/span&gt; 和 &lt;span class="ch"&gt;b&lt;/span&gt;，在 &lt;span class="ch"&gt;a&lt;/span&gt; 和 &lt;span class="ch"&gt;b&lt;/span&gt; 运行的过程中并不能打断&lt;/span&gt;
&lt;span id="cb1-3"&gt;&lt;a aria-hidden="true" href="#cb1-3" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb1-4"&gt;&lt;a aria-hidden="true" href="#cb1-4" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="ch"&gt;main&lt;/span&gt; &lt;span class="op"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="ch"&gt;c&lt;/span&gt; &lt;span class="op"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="ch"&gt;main&lt;/span&gt; &lt;span class="op"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="ch"&gt;c&lt;/span&gt; &lt;span class="op"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="ch"&gt;main&lt;/span&gt; &lt;span class="op"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="ch"&gt;done&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-5"&gt;&lt;a aria-hidden="true" href="#cb1-5" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="op"&gt;//&lt;/span&gt; 调用 &lt;span class="ch"&gt;c&lt;/span&gt; 运行到其内部的 &lt;span class="ch"&gt;yield&lt;/span&gt; 时保存内部状态，控制器还给调用者&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;举例来说明:&lt;/p&gt;
&lt;div class="sourceCode" id="cb2"&gt;&lt;pre class="sourceCode python"&gt;&lt;code class="sourceCode python"&gt;&lt;span id="cb2-1"&gt;&lt;a aria-hidden="true" href="#cb2-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;def&lt;/span&gt; coro():&lt;/span&gt;
&lt;span id="cb2-2"&gt;&lt;a aria-hidden="true" href="#cb2-2" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="cf"&gt;yield&lt;/span&gt; &lt;span class="dv"&gt;1&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-3"&gt;&lt;a aria-hidden="true" href="#cb2-3" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="cf"&gt;yield&lt;/span&gt; &lt;span class="dv"&gt;2&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-4"&gt;&lt;a aria-hidden="true" href="#cb2-4" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="cf"&gt;yield&lt;/span&gt; &lt;span class="dv"&gt;3&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-5"&gt;&lt;a aria-hidden="true" href="#cb2-5" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb2-6"&gt;&lt;a aria-hidden="true" href="#cb2-6" tabindex="-1"&gt;&lt;/a&gt;a &lt;span class="op"&gt;=&lt;/span&gt; coro()&lt;/span&gt;
&lt;span id="cb2-7"&gt;&lt;a aria-hidden="true" href="#cb2-7" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="bu"&gt;print&lt;/span&gt;(a.&lt;span class="fu"&gt;__next__&lt;/span&gt;())&lt;/span&gt;
&lt;span id="cb2-8"&gt;&lt;a aria-hidden="true" href="#cb2-8" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="bu"&gt;print&lt;/span&gt;(a.&lt;span class="fu"&gt;__next__&lt;/span&gt;())&lt;/span&gt;
&lt;span id="cb2-9"&gt;&lt;a aria-hidden="true" href="#cb2-9" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="bu"&gt;print&lt;/span&gt;(a.&lt;span class="fu"&gt;__next__&lt;/span&gt;())&lt;/span&gt;
&lt;span id="cb2-10"&gt;&lt;a aria-hidden="true" href="#cb2-10" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="bu"&gt;print&lt;/span&gt;(a.&lt;span class="fu"&gt;__next__&lt;/span&gt;()) &lt;span class="co"&gt;# Exception !&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;在这个简单的例子中，&lt;code&gt;coro&lt;/code&gt; 只是按照次序返回 1，2，3。其实，a 的类型是一个 &lt;code&gt;Generator[Literal[1, 2, 3], None, None]&lt;/code&gt;，也就是生成器类型。使用其 &lt;code&gt;__next__&lt;/code&gt; 方法，或者调用 &lt;code&gt;next(a)&lt;/code&gt; 可以获得一个值，同时协程返还控制权，直到所以值被消耗完毕，抛出 &lt;code&gt;StopIteration&lt;/code&gt; 异常为止。&lt;/p&gt;
&lt;p&gt;协程和普通函数最大的区别在于其不使用 &lt;code&gt;return&lt;/code&gt; 而是使用 &lt;code&gt;yield&lt;/code&gt;，说句老实话，我觉得「协程」这个词倒不如换成「yield 函数」之类的说法，&lt;del&gt;当然语言律师和专家们可能会大皱眉头。&lt;/del&gt;&lt;/p&gt;
&lt;h2 id="传出数据"&gt;传出数据&lt;/h2&gt;
&lt;p&gt;最简单的方法就是用 &lt;code&gt;yield&lt;/code&gt; 来传出数据。&lt;/p&gt;
&lt;div class="sourceCode" id="cb3"&gt;&lt;pre class="sourceCode python"&gt;&lt;code class="sourceCode python"&gt;&lt;span id="cb3-1"&gt;&lt;a aria-hidden="true" href="#cb3-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;def&lt;/span&gt; generator(stop: &lt;span class="bu"&gt;int&lt;/span&gt; &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="dv"&gt;3&lt;/span&gt;):&lt;/span&gt;
&lt;span id="cb3-2"&gt;&lt;a aria-hidden="true" href="#cb3-2" tabindex="-1"&gt;&lt;/a&gt;    number: &lt;span class="bu"&gt;int&lt;/span&gt; &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="dv"&gt;0&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb3-3"&gt;&lt;a aria-hidden="true" href="#cb3-3" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="cf"&gt;for&lt;/span&gt; i &lt;span class="kw"&gt;in&lt;/span&gt; &lt;span class="bu"&gt;range&lt;/span&gt;(stop):&lt;/span&gt;
&lt;span id="cb3-4"&gt;&lt;a aria-hidden="true" href="#cb3-4" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="cf"&gt;yield&lt;/span&gt; number&lt;/span&gt;
&lt;span id="cb3-5"&gt;&lt;a aria-hidden="true" href="#cb3-5" tabindex="-1"&gt;&lt;/a&gt;        number &lt;span class="op"&gt;+=&lt;/span&gt; &lt;span class="dv"&gt;1&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb3-6"&gt;&lt;a aria-hidden="true" href="#cb3-6" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb3-7"&gt;&lt;a aria-hidden="true" href="#cb3-7" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="cf"&gt;for&lt;/span&gt; i &lt;span class="kw"&gt;in&lt;/span&gt; generator(&lt;span class="dv"&gt;3&lt;/span&gt;):&lt;/span&gt;
&lt;span id="cb3-8"&gt;&lt;a aria-hidden="true" href="#cb3-8" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="bu"&gt;print&lt;/span&gt;(i)&lt;/span&gt;
&lt;span id="cb3-9"&gt;&lt;a aria-hidden="true" href="#cb3-9" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb3-10"&gt;&lt;a aria-hidden="true" href="#cb3-10" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="co"&gt;# 0，1，2&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;由于是一个 Generator，可以直接在循环内使用它，可以看到，协程函数保存了 number 变量，在重入时依旧使用它。当然，这么简单的任务直接使用列表生成式即可：&lt;code&gt;(i for i in range(3))&lt;/code&gt; 得到的也是一个 &lt;code&gt;generator object &amp;lt;genexpr&amp;gt;&lt;/code&gt;。&lt;/p&gt;
&lt;h2 id="接收数据"&gt;接收数据&lt;/h2&gt;
&lt;p&gt;要发挥协程的作用，需要让协程能够「获取」数据，也就是在每次交换控制权的时候给协程发送数据。对于一个协程，使用 &lt;code&gt;send()&lt;/code&gt; 可以向它发送数据，并交换控制权。&lt;strong&gt;在第一次发送数据之前，需要预先激活它&lt;/strong&gt;，即使用 &lt;code&gt;next(coro)&lt;/code&gt; 来预激。&lt;/p&gt;
&lt;p&gt;举例&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-0"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-0" type="checkbox"&gt;&lt;span class="sidenote"&gt;这个例子的来源是「流畅的 Python」一书，书中举的例子是「使用协程计算移动平均值」。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/input&gt;&lt;/span&gt; 来讲：&lt;/p&gt;
&lt;div class="sourceCode" id="cb4"&gt;&lt;pre class="sourceCode python"&gt;&lt;code class="sourceCode python"&gt;&lt;span id="cb4-1"&gt;&lt;a aria-hidden="true" href="#cb4-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;def&lt;/span&gt; simple_coro2(a):&lt;/span&gt;
&lt;span id="cb4-2"&gt;&lt;a aria-hidden="true" href="#cb4-2" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="bu"&gt;print&lt;/span&gt;(&lt;span class="st"&gt;"-&amp;gt; Started: a ="&lt;/span&gt;, a)&lt;/span&gt;
&lt;span id="cb4-3"&gt;&lt;a aria-hidden="true" href="#cb4-3" tabindex="-1"&gt;&lt;/a&gt;    b &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="cf"&gt;yield&lt;/span&gt; a&lt;/span&gt;
&lt;span id="cb4-4"&gt;&lt;a aria-hidden="true" href="#cb4-4" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="bu"&gt;print&lt;/span&gt;(&lt;span class="st"&gt;"-&amp;gt; Received: b ="&lt;/span&gt;, b)&lt;/span&gt;
&lt;span id="cb4-5"&gt;&lt;a aria-hidden="true" href="#cb4-5" tabindex="-1"&gt;&lt;/a&gt;    c &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="cf"&gt;yield&lt;/span&gt; a &lt;span class="op"&gt;+&lt;/span&gt; b&lt;/span&gt;
&lt;span id="cb4-6"&gt;&lt;a aria-hidden="true" href="#cb4-6" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="bu"&gt;print&lt;/span&gt;(&lt;span class="st"&gt;"-&amp;gt; Received: c ="&lt;/span&gt;, c)&lt;/span&gt;
&lt;span id="cb4-7"&gt;&lt;a aria-hidden="true" href="#cb4-7" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb4-8"&gt;&lt;a aria-hidden="true" href="#cb4-8" tabindex="-1"&gt;&lt;/a&gt;i &lt;span class="op"&gt;=&lt;/span&gt; simple_coro2(&lt;span class="dv"&gt;0&lt;/span&gt;)&lt;/span&gt;
&lt;span id="cb4-9"&gt;&lt;a aria-hidden="true" href="#cb4-9" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="bu"&gt;next&lt;/span&gt;(i)&lt;/span&gt;
&lt;span id="cb4-10"&gt;&lt;a aria-hidden="true" href="#cb4-10" tabindex="-1"&gt;&lt;/a&gt;i.send(&lt;span class="dv"&gt;10&lt;/span&gt;)&lt;/span&gt;
&lt;span id="cb4-11"&gt;&lt;a aria-hidden="true" href="#cb4-11" tabindex="-1"&gt;&lt;/a&gt;i.send(&lt;span class="dv"&gt;30&lt;/span&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;得到的结果是：&lt;/p&gt;
&lt;div class="sourceCode" id="cb5"&gt;&lt;pre class="sourceCode python"&gt;&lt;code class="sourceCode python"&gt;&lt;span id="cb5-1"&gt;&lt;a aria-hidden="true" href="#cb5-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="op"&gt;-&amp;gt;&lt;/span&gt; Started: a &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="dv"&gt;0&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb5-2"&gt;&lt;a aria-hidden="true" href="#cb5-2" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="op"&gt;-&amp;gt;&lt;/span&gt; Received: b &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="dv"&gt;10&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb5-3"&gt;&lt;a aria-hidden="true" href="#cb5-3" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="op"&gt;-&amp;gt;&lt;/span&gt; Received: c &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="dv"&gt;30&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb5-4"&gt;&lt;a aria-hidden="true" href="#cb5-4" tabindex="-1"&gt;&lt;/a&gt;Traceback (most recent call last):&lt;/span&gt;
&lt;span id="cb5-5"&gt;&lt;a aria-hidden="true" href="#cb5-5" tabindex="-1"&gt;&lt;/a&gt;  File &lt;span class="st"&gt;"demo.py"&lt;/span&gt;, line &lt;span class="dv"&gt;12&lt;/span&gt;, &lt;span class="kw"&gt;in&lt;/span&gt; &lt;span class="op"&gt;&amp;lt;&lt;/span&gt;module&lt;span class="op"&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb5-6"&gt;&lt;a aria-hidden="true" href="#cb5-6" tabindex="-1"&gt;&lt;/a&gt;    i.send(&lt;span class="dv"&gt;30&lt;/span&gt;)&lt;/span&gt;
&lt;span id="cb5-7"&gt;&lt;a aria-hidden="true" href="#cb5-7" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="pp"&gt;StopIteration&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;各个阶段都在 yield 表达式中结束，而且下一个阶段都从那一行代码开始,然后再把 yield 表达式的值赋给变量。图示如下：&lt;/p&gt;
&lt;figure&gt;
&lt;img alt="详细过程" src="./assets/d.png"/&gt;
&lt;figcaption aria-hidden="true"&gt;详细过程&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;再举一个不一样的例子，经典的「计算斐波纳契数列」：&lt;/p&gt;
&lt;div class="sourceCode" id="cb6"&gt;&lt;pre class="sourceCode python"&gt;&lt;code class="sourceCode python"&gt;&lt;span id="cb6-1"&gt;&lt;a aria-hidden="true" href="#cb6-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;def&lt;/span&gt; fib(stop: &lt;span class="bu"&gt;int&lt;/span&gt;):&lt;/span&gt;
&lt;span id="cb6-2"&gt;&lt;a aria-hidden="true" href="#cb6-2" tabindex="-1"&gt;&lt;/a&gt;    a, b &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="dv"&gt;1&lt;/span&gt;, &lt;span class="dv"&gt;1&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb6-3"&gt;&lt;a aria-hidden="true" href="#cb6-3" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="cf"&gt;yield&lt;/span&gt; a&lt;/span&gt;
&lt;span id="cb6-4"&gt;&lt;a aria-hidden="true" href="#cb6-4" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="cf"&gt;for&lt;/span&gt; i &lt;span class="kw"&gt;in&lt;/span&gt; &lt;span class="bu"&gt;range&lt;/span&gt;(stop):&lt;/span&gt;
&lt;span id="cb6-5"&gt;&lt;a aria-hidden="true" href="#cb6-5" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="cf"&gt;yield&lt;/span&gt; a&lt;/span&gt;
&lt;span id="cb6-6"&gt;&lt;a aria-hidden="true" href="#cb6-6" tabindex="-1"&gt;&lt;/a&gt;        c &lt;span class="op"&gt;=&lt;/span&gt; a &lt;span class="op"&gt;+&lt;/span&gt; b&lt;/span&gt;
&lt;span id="cb6-7"&gt;&lt;a aria-hidden="true" href="#cb6-7" tabindex="-1"&gt;&lt;/a&gt;        a &lt;span class="op"&gt;=&lt;/span&gt; b&lt;/span&gt;
&lt;span id="cb6-8"&gt;&lt;a aria-hidden="true" href="#cb6-8" tabindex="-1"&gt;&lt;/a&gt;        b &lt;span class="op"&gt;=&lt;/span&gt; c&lt;/span&gt;
&lt;span id="cb6-9"&gt;&lt;a aria-hidden="true" href="#cb6-9" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb6-10"&gt;&lt;a aria-hidden="true" href="#cb6-10" tabindex="-1"&gt;&lt;/a&gt;x &lt;span class="op"&gt;=&lt;/span&gt; fib(&lt;span class="dv"&gt;10&lt;/span&gt;)&lt;/span&gt;
&lt;span id="cb6-11"&gt;&lt;a aria-hidden="true" href="#cb6-11" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="bu"&gt;next&lt;/span&gt;(x)&lt;/span&gt;
&lt;span id="cb6-12"&gt;&lt;a aria-hidden="true" href="#cb6-12" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="cf"&gt;for&lt;/span&gt; i &lt;span class="kw"&gt;in&lt;/span&gt; x:&lt;/span&gt;
&lt;span id="cb6-13"&gt;&lt;a aria-hidden="true" href="#cb6-13" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="bu"&gt;print&lt;/span&gt;(i)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;再来一个经典版本：&lt;/p&gt;
&lt;div class="sourceCode" id="cb7"&gt;&lt;pre class="sourceCode python"&gt;&lt;code class="sourceCode python"&gt;&lt;span id="cb7-1"&gt;&lt;a aria-hidden="true" href="#cb7-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;def&lt;/span&gt; recur_fib(n):&lt;/span&gt;
&lt;span id="cb7-2"&gt;&lt;a aria-hidden="true" href="#cb7-2" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="cf"&gt;if&lt;/span&gt; n &lt;span class="op"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="dv"&gt;1&lt;/span&gt;:&lt;/span&gt;
&lt;span id="cb7-3"&gt;&lt;a aria-hidden="true" href="#cb7-3" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="cf"&gt;return&lt;/span&gt; n&lt;/span&gt;
&lt;span id="cb7-4"&gt;&lt;a aria-hidden="true" href="#cb7-4" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="cf"&gt;else&lt;/span&gt;:&lt;/span&gt;
&lt;span id="cb7-5"&gt;&lt;a aria-hidden="true" href="#cb7-5" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="cf"&gt;return&lt;/span&gt; recur_fib(n &lt;span class="op"&gt;-&lt;/span&gt; &lt;span class="dv"&gt;1&lt;/span&gt;) &lt;span class="op"&gt;+&lt;/span&gt; recur_fib(n &lt;span class="op"&gt;-&lt;/span&gt; &lt;span class="dv"&gt;2&lt;/span&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;pre&gt;&lt;code&gt;% time python3 demo.py
14930352
python3 demo.py  2.60s user 0.00s system 99% cpu 2.598 total&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;相比之下协程版本只需要 0.012 秒。&lt;/p&gt;
&lt;h2 id="只用来控制流程"&gt;只用来控制流程&lt;/h2&gt;
&lt;p&gt;如果 &lt;code&gt;yield&lt;/code&gt; 前后都没有东西，那就仅仅是用来切换控制流程，比如一个计数器：&lt;/p&gt;
&lt;div class="sourceCode" id="cb9"&gt;&lt;pre class="sourceCode python"&gt;&lt;code class="sourceCode python"&gt;&lt;span id="cb9-1"&gt;&lt;a aria-hidden="true" href="#cb9-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;def&lt;/span&gt; customer_counter():&lt;/span&gt;
&lt;span id="cb9-2"&gt;&lt;a aria-hidden="true" href="#cb9-2" tabindex="-1"&gt;&lt;/a&gt;    counter: &lt;span class="bu"&gt;int&lt;/span&gt; &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="dv"&gt;0&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb9-3"&gt;&lt;a aria-hidden="true" href="#cb9-3" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="cf"&gt;while&lt;/span&gt; &lt;span class="va"&gt;True&lt;/span&gt;:&lt;/span&gt;
&lt;span id="cb9-4"&gt;&lt;a aria-hidden="true" href="#cb9-4" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="cf"&gt;yield&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb9-5"&gt;&lt;a aria-hidden="true" href="#cb9-5" tabindex="-1"&gt;&lt;/a&gt;        counter &lt;span class="op"&gt;+=&lt;/span&gt; &lt;span class="dv"&gt;1&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb9-6"&gt;&lt;a aria-hidden="true" href="#cb9-6" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="bu"&gt;print&lt;/span&gt;(&lt;span class="ss"&gt;f"&lt;/span&gt;&lt;span class="sc"&gt;{&lt;/span&gt;counter&lt;span class="sc"&gt;}&lt;/span&gt;&lt;span class="ss"&gt; "&lt;/span&gt;, end&lt;span class="op"&gt;=&lt;/span&gt;&lt;span class="st"&gt;""&lt;/span&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id="yield-from"&gt;yield from&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;yield from&lt;/code&gt; 可以说是一个比较难懂的玩意。简单的来讲，这个 &lt;code&gt;yield from&lt;/code&gt; 的作用就是「再一个协程中获取其他协程的内容，并统一发送回来」。&lt;/p&gt;
&lt;p&gt;例如，打平一个嵌套的列表：&lt;/p&gt;
&lt;div class="sourceCode" id="cb10"&gt;&lt;pre class="sourceCode python"&gt;&lt;code class="sourceCode python"&gt;&lt;span id="cb10-1"&gt;&lt;a aria-hidden="true" href="#cb10-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;def&lt;/span&gt; flat(raw, result&lt;span class="op"&gt;=&lt;/span&gt;[]):&lt;/span&gt;
&lt;span id="cb10-2"&gt;&lt;a aria-hidden="true" href="#cb10-2" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="cf"&gt;if&lt;/span&gt; &lt;span class="bu"&gt;type&lt;/span&gt;(raw) &lt;span class="op"&gt;==&lt;/span&gt; &lt;span class="bu"&gt;list&lt;/span&gt;:&lt;/span&gt;
&lt;span id="cb10-3"&gt;&lt;a aria-hidden="true" href="#cb10-3" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="cf"&gt;for&lt;/span&gt; i &lt;span class="kw"&gt;in&lt;/span&gt; raw:&lt;/span&gt;
&lt;span id="cb10-4"&gt;&lt;a aria-hidden="true" href="#cb10-4" tabindex="-1"&gt;&lt;/a&gt;            &lt;span class="cf"&gt;yield&lt;/span&gt; &lt;span class="cf"&gt;from&lt;/span&gt; flat(i, result)&lt;/span&gt;
&lt;span id="cb10-5"&gt;&lt;a aria-hidden="true" href="#cb10-5" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="cf"&gt;else&lt;/span&gt;:&lt;/span&gt;
&lt;span id="cb10-6"&gt;&lt;a aria-hidden="true" href="#cb10-6" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="cf"&gt;yield&lt;/span&gt; raw&lt;/span&gt;
&lt;span id="cb10-7"&gt;&lt;a aria-hidden="true" href="#cb10-7" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="cf"&gt;return&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;em&gt;当然，更好的实现是例如 more-itertools 模块中的 &lt;code&gt;collapse&lt;/code&gt; 或者 &lt;code&gt;Python Cookbook&lt;/code&gt; 中的 flatten 函数&lt;/em&gt;&lt;/p&gt;
&lt;h1 id="自动初始化"&gt;自动初始化&lt;/h1&gt;
&lt;p&gt;每一次运行协程之前，需要手动 &lt;code&gt;next(coro)&lt;/code&gt; 来预先激活它达到第一次 yield 的位置，否则你就会遇到&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;TypeError: can't send non-None value to a just-started generator&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;这一步当然可以自动化。比如，可以写一个专门创建的函数包装它：&lt;/p&gt;
&lt;div class="sourceCode" id="cb12"&gt;&lt;pre class="sourceCode python"&gt;&lt;code class="sourceCode python"&gt;&lt;span id="cb12-1"&gt;&lt;a aria-hidden="true" href="#cb12-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;def&lt;/span&gt; coro_creator(raw, &lt;span class="op"&gt;*&lt;/span&gt;args):&lt;/span&gt;
&lt;span id="cb12-2"&gt;&lt;a aria-hidden="true" href="#cb12-2" tabindex="-1"&gt;&lt;/a&gt;    coro &lt;span class="op"&gt;=&lt;/span&gt; raw(&lt;span class="op"&gt;*&lt;/span&gt;args)&lt;/span&gt;
&lt;span id="cb12-3"&gt;&lt;a aria-hidden="true" href="#cb12-3" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="bu"&gt;next&lt;/span&gt;(coro)&lt;/span&gt;
&lt;span id="cb12-4"&gt;&lt;a aria-hidden="true" href="#cb12-4" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="cf"&gt;return&lt;/span&gt; coro&lt;/span&gt;
&lt;span id="cb12-5"&gt;&lt;a aria-hidden="true" href="#cb12-5" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb12-6"&gt;&lt;a aria-hidden="true" href="#cb12-6" tabindex="-1"&gt;&lt;/a&gt;i &lt;span class="op"&gt;=&lt;/span&gt; coro_creator(fib, &lt;span class="dv"&gt;16&lt;/span&gt;)&lt;/span&gt;
&lt;span id="cb12-7"&gt;&lt;a aria-hidden="true" href="#cb12-7" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="bu"&gt;print&lt;/span&gt;(i.send(&lt;span class="dv"&gt;10&lt;/span&gt;))&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;更好的方法是使用装饰器：&lt;/p&gt;
&lt;div class="sourceCode" id="cb13"&gt;&lt;pre class="sourceCode python"&gt;&lt;code class="sourceCode python"&gt;&lt;span id="cb13-1"&gt;&lt;a aria-hidden="true" href="#cb13-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="im"&gt;from&lt;/span&gt; functools &lt;span class="im"&gt;import&lt;/span&gt; wraps&lt;/span&gt;
&lt;span id="cb13-2"&gt;&lt;a aria-hidden="true" href="#cb13-2" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb13-3"&gt;&lt;a aria-hidden="true" href="#cb13-3" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;def&lt;/span&gt; coroutine(func):&lt;/span&gt;
&lt;span id="cb13-4"&gt;&lt;a aria-hidden="true" href="#cb13-4" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="at"&gt;@wraps&lt;/span&gt;(func)&lt;/span&gt;
&lt;span id="cb13-5"&gt;&lt;a aria-hidden="true" href="#cb13-5" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="kw"&gt;def&lt;/span&gt; primer(&lt;span class="op"&gt;*&lt;/span&gt;args, &lt;span class="op"&gt;**&lt;/span&gt;kwargs):&lt;/span&gt;
&lt;span id="cb13-6"&gt;&lt;a aria-hidden="true" href="#cb13-6" tabindex="-1"&gt;&lt;/a&gt;        gen &lt;span class="op"&gt;=&lt;/span&gt; func(&lt;span class="op"&gt;*&lt;/span&gt;args, &lt;span class="op"&gt;**&lt;/span&gt;kwargs)&lt;/span&gt;
&lt;span id="cb13-7"&gt;&lt;a aria-hidden="true" href="#cb13-7" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="cf"&gt;try&lt;/span&gt;:&lt;/span&gt;
&lt;span id="cb13-8"&gt;&lt;a aria-hidden="true" href="#cb13-8" tabindex="-1"&gt;&lt;/a&gt;            &lt;span class="bu"&gt;next&lt;/span&gt;(gen)&lt;/span&gt;
&lt;span id="cb13-9"&gt;&lt;a aria-hidden="true" href="#cb13-9" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="cf"&gt;except&lt;/span&gt; &lt;span class="pp"&gt;Exception&lt;/span&gt;:&lt;/span&gt;
&lt;span id="cb13-10"&gt;&lt;a aria-hidden="true" href="#cb13-10" tabindex="-1"&gt;&lt;/a&gt;            &lt;span class="cf"&gt;pass&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb13-11"&gt;&lt;a aria-hidden="true" href="#cb13-11" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="cf"&gt;return&lt;/span&gt; gen&lt;/span&gt;
&lt;span id="cb13-12"&gt;&lt;a aria-hidden="true" href="#cb13-12" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb13-13"&gt;&lt;a aria-hidden="true" href="#cb13-13" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="cf"&gt;return&lt;/span&gt; primer&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;那么对于需要作为协程的函数，添加一个 &lt;code&gt;@coroutine&lt;/code&gt; 装饰器即可。&lt;/p&gt;
&lt;h1 id="应用"&gt;应用&lt;/h1&gt;
&lt;h2 id="分发器"&gt;分发器&lt;/h2&gt;
&lt;p&gt;对于一个数据来源，把它「分发」给不同的消费者：&lt;/p&gt;
&lt;div class="sourceCode" id="cb14"&gt;&lt;pre class="sourceCode python"&gt;&lt;code class="sourceCode python"&gt;&lt;span id="cb14-1"&gt;&lt;a aria-hidden="true" href="#cb14-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="at"&gt;@coroutine&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb14-2"&gt;&lt;a aria-hidden="true" href="#cb14-2" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;def&lt;/span&gt; fib(stop: &lt;span class="bu"&gt;int&lt;/span&gt;):&lt;/span&gt;
&lt;span id="cb14-3"&gt;&lt;a aria-hidden="true" href="#cb14-3" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="co"&gt;# 同上的 fib 函数&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb14-4"&gt;&lt;a aria-hidden="true" href="#cb14-4" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="cf"&gt;pass&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb14-5"&gt;&lt;a aria-hidden="true" href="#cb14-5" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb14-6"&gt;&lt;a aria-hidden="true" href="#cb14-6" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="at"&gt;@coroutine&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb14-7"&gt;&lt;a aria-hidden="true" href="#cb14-7" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;def&lt;/span&gt; customer_sum():&lt;/span&gt;
&lt;span id="cb14-8"&gt;&lt;a aria-hidden="true" href="#cb14-8" tabindex="-1"&gt;&lt;/a&gt;    total: &lt;span class="bu"&gt;int&lt;/span&gt; &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="dv"&gt;0&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb14-9"&gt;&lt;a aria-hidden="true" href="#cb14-9" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="cf"&gt;while&lt;/span&gt; &lt;span class="va"&gt;True&lt;/span&gt;:&lt;/span&gt;
&lt;span id="cb14-10"&gt;&lt;a aria-hidden="true" href="#cb14-10" tabindex="-1"&gt;&lt;/a&gt;        number: &lt;span class="bu"&gt;int&lt;/span&gt; &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="cf"&gt;yield&lt;/span&gt; total&lt;/span&gt;
&lt;span id="cb14-11"&gt;&lt;a aria-hidden="true" href="#cb14-11" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="bu"&gt;print&lt;/span&gt;(&lt;span class="ss"&gt;f" SUM &lt;/span&gt;&lt;span class="sc"&gt;{&lt;/span&gt;total&lt;span class="sc"&gt;}&lt;/span&gt;&lt;span class="ss"&gt;"&lt;/span&gt;, end&lt;span class="op"&gt;=&lt;/span&gt;&lt;span class="st"&gt;""&lt;/span&gt;)&lt;/span&gt;
&lt;span id="cb14-12"&gt;&lt;a aria-hidden="true" href="#cb14-12" tabindex="-1"&gt;&lt;/a&gt;        total &lt;span class="op"&gt;+=&lt;/span&gt; number&lt;/span&gt;
&lt;span id="cb14-13"&gt;&lt;a aria-hidden="true" href="#cb14-13" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb14-14"&gt;&lt;a aria-hidden="true" href="#cb14-14" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="at"&gt;@coroutine&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb14-15"&gt;&lt;a aria-hidden="true" href="#cb14-15" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;def&lt;/span&gt; customer_print():&lt;/span&gt;
&lt;span id="cb14-16"&gt;&lt;a aria-hidden="true" href="#cb14-16" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="cf"&gt;while&lt;/span&gt; &lt;span class="va"&gt;True&lt;/span&gt;:&lt;/span&gt;
&lt;span id="cb14-17"&gt;&lt;a aria-hidden="true" href="#cb14-17" tabindex="-1"&gt;&lt;/a&gt;        number &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="cf"&gt;yield&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb14-18"&gt;&lt;a aria-hidden="true" href="#cb14-18" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="bu"&gt;print&lt;/span&gt;(&lt;span class="ss"&gt;f"Number : &lt;/span&gt;&lt;span class="sc"&gt;{&lt;/span&gt;number&lt;span class="sc"&gt;}&lt;/span&gt;&lt;span class="ss"&gt; "&lt;/span&gt;, end&lt;span class="op"&gt;=&lt;/span&gt;&lt;span class="st"&gt;""&lt;/span&gt;)&lt;/span&gt;
&lt;span id="cb14-19"&gt;&lt;a aria-hidden="true" href="#cb14-19" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb14-20"&gt;&lt;a aria-hidden="true" href="#cb14-20" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="at"&gt;@coroutine&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb14-21"&gt;&lt;a aria-hidden="true" href="#cb14-21" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;def&lt;/span&gt; customer_avg():&lt;/span&gt;
&lt;span id="cb14-22"&gt;&lt;a aria-hidden="true" href="#cb14-22" tabindex="-1"&gt;&lt;/a&gt;    total: &lt;span class="bu"&gt;int&lt;/span&gt; &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="dv"&gt;0&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb14-23"&gt;&lt;a aria-hidden="true" href="#cb14-23" tabindex="-1"&gt;&lt;/a&gt;    count: &lt;span class="bu"&gt;int&lt;/span&gt; &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="dv"&gt;0&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb14-24"&gt;&lt;a aria-hidden="true" href="#cb14-24" tabindex="-1"&gt;&lt;/a&gt;    avg: &lt;span class="bu"&gt;float&lt;/span&gt; &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="fl"&gt;0.0&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb14-25"&gt;&lt;a aria-hidden="true" href="#cb14-25" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="cf"&gt;while&lt;/span&gt; &lt;span class="va"&gt;True&lt;/span&gt;:&lt;/span&gt;
&lt;span id="cb14-26"&gt;&lt;a aria-hidden="true" href="#cb14-26" tabindex="-1"&gt;&lt;/a&gt;        number: &lt;span class="bu"&gt;int&lt;/span&gt; &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="cf"&gt;yield&lt;/span&gt; avg&lt;/span&gt;
&lt;span id="cb14-27"&gt;&lt;a aria-hidden="true" href="#cb14-27" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="bu"&gt;print&lt;/span&gt;(&lt;span class="ss"&gt;f" AVG &lt;/span&gt;&lt;span class="sc"&gt;{&lt;/span&gt;avg&lt;span class="sc"&gt;}&lt;/span&gt;&lt;span class="ss"&gt;"&lt;/span&gt;, end&lt;span class="op"&gt;=&lt;/span&gt;&lt;span class="st"&gt;"&lt;/span&gt;&lt;span class="ch"&gt;\n&lt;/span&gt;&lt;span class="st"&gt;"&lt;/span&gt;)&lt;/span&gt;
&lt;span id="cb14-28"&gt;&lt;a aria-hidden="true" href="#cb14-28" tabindex="-1"&gt;&lt;/a&gt;        count &lt;span class="op"&gt;+=&lt;/span&gt; &lt;span class="dv"&gt;1&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb14-29"&gt;&lt;a aria-hidden="true" href="#cb14-29" tabindex="-1"&gt;&lt;/a&gt;        total &lt;span class="op"&gt;+=&lt;/span&gt; number&lt;/span&gt;
&lt;span id="cb14-30"&gt;&lt;a aria-hidden="true" href="#cb14-30" tabindex="-1"&gt;&lt;/a&gt;        avg &lt;span class="op"&gt;=&lt;/span&gt; total &lt;span class="op"&gt;/&lt;/span&gt; count&lt;/span&gt;
&lt;span id="cb14-31"&gt;&lt;a aria-hidden="true" href="#cb14-31" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb14-32"&gt;&lt;a aria-hidden="true" href="#cb14-32" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="at"&gt;@coroutine&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb14-33"&gt;&lt;a aria-hidden="true" href="#cb14-33" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;def&lt;/span&gt; customer_counter():&lt;/span&gt;
&lt;span id="cb14-34"&gt;&lt;a aria-hidden="true" href="#cb14-34" tabindex="-1"&gt;&lt;/a&gt;    counter: &lt;span class="bu"&gt;int&lt;/span&gt; &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="dv"&gt;0&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb14-35"&gt;&lt;a aria-hidden="true" href="#cb14-35" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="cf"&gt;while&lt;/span&gt; &lt;span class="va"&gt;True&lt;/span&gt;:&lt;/span&gt;
&lt;span id="cb14-36"&gt;&lt;a aria-hidden="true" href="#cb14-36" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="cf"&gt;yield&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb14-37"&gt;&lt;a aria-hidden="true" href="#cb14-37" tabindex="-1"&gt;&lt;/a&gt;        counter &lt;span class="op"&gt;+=&lt;/span&gt; &lt;span class="dv"&gt;1&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb14-38"&gt;&lt;a aria-hidden="true" href="#cb14-38" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="bu"&gt;print&lt;/span&gt;(&lt;span class="ss"&gt;f"&lt;/span&gt;&lt;span class="sc"&gt;{&lt;/span&gt;counter&lt;span class="sc"&gt;}&lt;/span&gt;&lt;span class="ss"&gt; "&lt;/span&gt;, end&lt;span class="op"&gt;=&lt;/span&gt;&lt;span class="st"&gt;""&lt;/span&gt;)&lt;/span&gt;
&lt;span id="cb14-39"&gt;&lt;a aria-hidden="true" href="#cb14-39" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb14-40"&gt;&lt;a aria-hidden="true" href="#cb14-40" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="at"&gt;@coroutine&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb14-41"&gt;&lt;a aria-hidden="true" href="#cb14-41" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;def&lt;/span&gt; broadcast(targets, &lt;span class="bu"&gt;input&lt;/span&gt;):&lt;/span&gt;
&lt;span id="cb14-42"&gt;&lt;a aria-hidden="true" href="#cb14-42" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="cf"&gt;for&lt;/span&gt; i &lt;span class="kw"&gt;in&lt;/span&gt; &lt;span class="bu"&gt;input&lt;/span&gt;:&lt;/span&gt;
&lt;span id="cb14-43"&gt;&lt;a aria-hidden="true" href="#cb14-43" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="cf"&gt;for&lt;/span&gt; target &lt;span class="kw"&gt;in&lt;/span&gt; targets:&lt;/span&gt;
&lt;span id="cb14-44"&gt;&lt;a aria-hidden="true" href="#cb14-44" tabindex="-1"&gt;&lt;/a&gt;            target.send(i)&lt;/span&gt;
&lt;span id="cb14-45"&gt;&lt;a aria-hidden="true" href="#cb14-45" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb14-46"&gt;&lt;a aria-hidden="true" href="#cb14-46" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="cf"&gt;if&lt;/span&gt; &lt;span class="va"&gt;__name__&lt;/span&gt; &lt;span class="op"&gt;==&lt;/span&gt; &lt;span class="st"&gt;"__main__"&lt;/span&gt;:&lt;/span&gt;
&lt;span id="cb14-47"&gt;&lt;a aria-hidden="true" href="#cb14-47" tabindex="-1"&gt;&lt;/a&gt;    broadcast(&lt;/span&gt;
&lt;span id="cb14-48"&gt;&lt;a aria-hidden="true" href="#cb14-48" tabindex="-1"&gt;&lt;/a&gt;        [customer_counter(), customer_print(), customer_sum(), customer_avg()], fib(&lt;span class="dv"&gt;24&lt;/span&gt;)&lt;/span&gt;
&lt;span id="cb14-49"&gt;&lt;a aria-hidden="true" href="#cb14-49" tabindex="-1"&gt;&lt;/a&gt;    )&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;得到的结果是：&lt;/p&gt;
&lt;p&gt;&lt;img src="./assets/2.png"/&gt;&lt;/p&gt;
&lt;br/&gt;
&lt;!--%%REF%%--&gt;
&lt;br/&gt;
&lt;script async="" crossorigin="anonymous" data-category="Announcements" data-category-id="DIC_kwDOJ7Ymy84CX4eg" data-emit-metadata="0" data-input-position="top" data-lang="zh-CN" data-loading="lazy" data-mapping="title" data-reactions-enabled="1" data-repo="izfsk-ium/izfsk-ium.github.io" data-repo-id="R_kgDOJ7Ymyw" data-strict="0" data-theme="preferred_color_scheme" src="https://giscus.app/client.js"&gt;
&lt;/script&gt;
&lt;/main&gt;
&lt;footer&gt;
&lt;p class="signoff"&gt;
&lt;div class="metadata"&gt;
&lt;p class="date"&gt;&lt;time datetime="2023-01-09"&gt;创建日期：2023-01-09&lt;/time&gt;&lt;/p&gt;
&lt;p class="lastmodify"&gt;&lt;time&gt;最后编译：2023-08-10&lt;/time&gt;&lt;/p&gt;
&lt;p class="lastmodify" id="counter-span"&gt;访问次数：&lt;/p&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;/footer&gt;
&lt;script&gt;
    /* These script should run after page load */
    document.querySelectorAll('code.sourceCode').forEach(
      i =&gt; i.insertAdjacentHTML('beforeend', '&lt;div class="copy"&gt;复制&lt;/div&gt;')
    );
    document.querySelectorAll('div.copy').forEach(
      i =&gt; i.addEventListener(
        'click',
        () =&gt; {
          navigator.clipboard.writeText(i.parentElement.innerText.replace('复制', ''));
          i.innerText = '成功';
          setTimeout(() =&gt; {
            i.innerText = '复制';
          }, 1000);
        }
      )
    );

    if (location.href.includes("127.0.0.1:8080")) {
      document.getElementById("counter-span").innerHTML = "[[development mode]]";
    } else {
      const uuid = document.getElementById("article-uuid").innerText;
      const target = document.getElementById("counter-span");
      const last = localStorage.getItem("lastVisit-" + uuid);
      const shouldIncrease = last === null || new Date().getTime() - parseInt(last) &gt;= (1000 * 60 * 15);

      fetch(shouldIncrease ? ("https://counter.izfsk.top/counter/" + uuid) : ("https://counter.izfsk.top/readOnly/" + uuid))
        .then(r =&gt; r.text())
        .then(d =&gt; {
          if (!d.startsWith("Too"))
            document.getElementById("counter-span").innerText = "访问次数：" + d.toString();
          else
            document.getElementById("counter-span").innerHTML = "";
        });

      localStorage.setItem("lastVisit-" + uuid, new Date().getTime());
    }
  &lt;/script&gt;
&lt;script async="" data-website-id="2a1146ab-fa82-4a84-a04f-30e5967357c3" src="https://analytics.umami.is/script.js"&gt;&lt;/script&gt;
&lt;/body&gt;</content:encoded>
      <guid isPermaLink="false">4798069b-f6d7-48df-ab8c-a64c0da7739d</guid>
      <pubDate>Mon, 09 Jan 2023 00:00:00 +0800</pubDate>
    </item>
    <item>
      <title>CommonLisp基础-基本概念</title>
      <link>https://blog.izfsk.top/articles/CommonLisp基础-基本概念.html</link>
      <description>CommonLisp基础-基本概念</description>
      <content:encoded>&lt;body&gt;
&lt;progress id="content_progress" value="0"&gt;&lt;/progress&gt;
&lt;button id="back-to-top"&gt;
    回页顶
  &lt;/button&gt;
&lt;header&gt;
&lt;small id="article-uuid" style="display: none !important;"&gt;f7127a84-86a8-41dc-8fdc-893cd1118438&lt;/small&gt;
&lt;h1 class="title"&gt;CommonLisp基础-基本概念&lt;/h1&gt;
&lt;!-- Subtitle --&gt;
&lt;h3 class="subtitle"&gt; &lt;/h3&gt;
&lt;/header&gt;
&lt;nav id="TOC" role="doc-toc"&gt;
&lt;strong&gt;文章归类: &lt;a href="/pages/category.html#学习"&gt;学习&lt;/a&gt; &lt;/strong&gt;
&lt;input id="contents" type="checkbox"/&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#历史" id="toc-历史"&gt;历史&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#概念" id="toc-概念"&gt;概念&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#基本类型" id="toc-基本类型"&gt;基本类型&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#真和假" id="toc-真和假"&gt;真和假&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#数字" id="toc-数字"&gt;数字&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#字符串" id="toc-字符串"&gt;字符串&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#字符" id="toc-字符"&gt;字符&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#字符串-1" id="toc-字符串-1"&gt;字符串&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#函数类型" id="toc-函数类型"&gt;函数类型&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#集合类型" id="toc-集合类型"&gt;集合类型&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#列表list" id="toc-列表list"&gt;列表（list）&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#排序和映射" id="toc-排序和映射"&gt;排序和映射&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#树" id="toc-树"&gt;树&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#集合" id="toc-集合"&gt;集合&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#栈" id="toc-栈"&gt;栈&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#变量和常量" id="toc-变量和常量"&gt;变量和常量&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#使用-let-来引入局部变量" id="toc-使用-let-来引入局部变量"&gt;使用 &lt;code&gt;let&lt;/code&gt; 来引入局部变量&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#使用-defparameter-和-defvar-来引入全局变量" id="toc-使用-defparameter-和-defvar-来引入全局变量"&gt;使用 &lt;code&gt;defparameter&lt;/code&gt; 和 &lt;code&gt;defvar&lt;/code&gt; 来引入全局变量&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#使用-defconstant-来引入全局常量" id="toc-使用-defconstant-来引入全局常量"&gt;使用 &lt;code&gt;defconstant&lt;/code&gt; 来引入全局常量&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#使用-setf-来赋值" id="toc-使用-setf-来赋值"&gt;使用 &lt;code&gt;setf&lt;/code&gt; 来赋值&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#注释" id="toc-注释"&gt;注释&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#函数" id="toc-函数"&gt;函数&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#参数" id="toc-参数"&gt;参数&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#必要形参" id="toc-必要形参"&gt;必要形参&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#可选形参" id="toc-可选形参"&gt;可选形参&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#剩余形参" id="toc-剩余形参"&gt;剩余形参&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#关键字形参" id="toc-关键字形参"&gt;关键字形参&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#reference"&gt;参考链接&lt;/a&gt;&lt;/li&gt;
&lt;li&gt; &lt;/li&gt;
&lt;li class="tools"&gt;
&lt;span id="backtomain"&gt;
&lt;svg class="bi bi-house" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M8.707 1.5a1 1 0 0 0-1.414 0L.646 8.146a.5.5 0 0 0 .708.708L2 8.207V13.5A1.5 1.5 0 0 0 3.5 15h9a1.5 1.5 0 0 0 1.5-1.5V8.207l.646.647a.5.5 0 0 0 .708-.708L13 5.793V2.5a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v1.293L8.707 1.5ZM13 7.207V13.5a.5.5 0 0 1-.5.5h-9a.5.5 0 0 1-.5-.5V7.207l5-5 5 5Z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="readingmode"&gt;
&lt;svg class="bi bi-book" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M1 2.828c.885-.37 2.154-.769 3.388-.893 1.33-.134 2.458.063 3.112.752v9.746c-.935-.53-2.12-.603-3.213-.493-1.18.12-2.37.461-3.287.811V2.828zm7.5-.141c.654-.689 1.782-.886 3.112-.752 1.234.124 2.503.523 3.388.893v9.923c-.918-.35-2.107-.692-3.287-.81-1.094-.111-2.278-.039-3.213.492V2.687zM8 1.783C7.015.936 5.587.81 4.287.94c-1.514.153-3.042.672-3.994 1.105A.5.5 0 0 0 0 2.5v11a.5.5 0 0 0 .707.455c.882-.4 2.303-.881 3.68-1.02 1.409-.142 2.59.087 3.223.877a.5.5 0 0 0 .78 0c.633-.79 1.814-1.019 3.222-.877 1.378.139 2.8.62 3.681 1.02A.5.5 0 0 0 16 13.5v-11a.5.5 0 0 0-.293-.455c-.952-.433-2.48-.952-3.994-1.105C10.413.809 8.985.936 8 1.783z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="larger"&gt; &lt;/span&gt;
&lt;span id="smaller"&gt;&lt;/span&gt;
&lt;span id="switchfont"&gt;
&lt;svg class="bi bi-fonts" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M12.258 3h-8.51l-.083 2.46h.479c.26-1.544.758-1.783 2.693-1.845l.424-.013v7.827c0 .663-.144.82-1.3.923v.52h4.082v-.52c-1.162-.103-1.306-.26-1.306-.923V3.602l.431.013c1.934.062 2.434.301 2.693 1.846h.479L12.258 3z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="backtotop"&gt;
&lt;svg class="bi bi-arrow-bar-up" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M8 10a.5.5 0 0 0 .5-.5V3.707l2.146 2.147a.5.5 0 0 0 .708-.708l-3-3a.5.5 0 0 0-.708 0l-3 3a.5.5 0 1 0 .708.708L7.5 3.707V9.5a.5.5 0 0 0 .5.5zm-7 2.5a.5.5 0 0 1 .5-.5h13a.5.5 0 0 1 0 1h-13a.5.5 0 0 1-.5-.5z" fill-rule="evenodd"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/nav&gt;
&lt;main&gt;
&lt;p&gt;本文整理作为一门编程语言的 CommonLisp 的基本元素，以便「能够用它写出程序来」。&lt;/p&gt;
&lt;h1 id="历史"&gt;历史&lt;/h1&gt;
&lt;p&gt;&lt;a href="http://zh.wikipedia.org/zh-cn/%E7%BA%A6%E7%BF%B0%C2%B7%E9%BA%A6%E5%8D%A1%E9%94%A1"&gt;约翰麦卡锡&lt;/a&gt;和他的学生于 1958 年展开 Lisp 的初次实现工作。 Lisp 是继 FORTRAN 之后，仍在使用的最古老的程序语言。 Lisp 是计算机科学领域的「经典语言」之一，完全是一门现代通用语言,其设计反映了尽可能高效和可靠地求解实际问题的实用主义观点。&lt;/p&gt;
&lt;h1 id="概念"&gt;概念&lt;/h1&gt;
&lt;p&gt;Lisp 是一门交互式语言。有一个叫做「顶层」的环境运行 Lisp 代码。&lt;/p&gt;
&lt;p&gt;所有的 Lisp 代码都是「S-表达式」，但并不是所有的 S-表达式都是合法的 Lisp 代码。宏给了语言的用户一种扩展其语法的方式，把任意的 S-表达式转换成合法的 Lisp 代码。&lt;/p&gt;
&lt;p&gt;使用 &lt;code&gt;quote&lt;/code&gt; 可以防止表达式被求值。例如：&lt;/p&gt;
&lt;div class="sourceCode" id="cb1"&gt;&lt;pre class="sourceCode lisp"&gt;&lt;code class="sourceCode commonlisp"&gt;&lt;span id="cb1-1"&gt;&lt;a aria-hidden="true" href="#cb1-1" tabindex="-1"&gt;&lt;/a&gt;'(&lt;span class="op"&gt;+&lt;/span&gt; &lt;span class="dv"&gt;1&lt;/span&gt; &lt;span class="dv"&gt;2&lt;/span&gt; &lt;span class="dv"&gt;3&lt;/span&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h1 id="基本类型"&gt;基本类型&lt;/h1&gt;
&lt;h2 id="真和假"&gt;真和假&lt;/h2&gt;
&lt;p&gt;符号 &lt;code&gt;NIL&lt;/code&gt; 是唯一的假值,其他所有的都是真值，符号 &lt;code&gt;T&lt;/code&gt; 是标准的真值。&lt;/p&gt;
&lt;p&gt;测试相等性有四种方法：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;EQ&lt;/code&gt;：测试「对象标识」，两个对象是同一个东西时才等价。&lt;strong&gt;移植性差，避免使用&lt;/strong&gt;。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;EQL&lt;/code&gt;：类似 &lt;code&gt;EQ&lt;/code&gt;， 保证当相同类型的两个对象代表相同的数字或字符值的时候是等价的。所以 &lt;code&gt;(eql 1 1)&lt;/code&gt; 确保是真的。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;EQUAL&lt;/code&gt; ：将具有递归相同结构和内容的列表视为等价。&lt;code&gt;(eql '(1 2 3) '(1 2 3)&lt;/code&gt; 为 &lt;code&gt;NIL&lt;/code&gt;，而 &lt;code&gt;(equal '(1 2 3) '(1 2 3)'&lt;/code&gt; 为 &lt;code&gt;T&lt;/code&gt;。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;EQUALP&lt;/code&gt;：更加宽松的相等。&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;测试：&lt;/p&gt;
&lt;div class="sourceCode" id="cb2"&gt;&lt;pre class="sourceCode lisp"&gt;&lt;code class="sourceCode commonlisp"&gt;&lt;span id="cb2-1"&gt;&lt;a aria-hidden="true" href="#cb2-1" tabindex="-1"&gt;&lt;/a&gt;(&lt;span class="kw"&gt;defun&lt;/span&gt;&lt;span class="fu"&gt; test-eq &lt;/span&gt;(a b)&lt;/span&gt;
&lt;span id="cb2-2"&gt;&lt;a aria-hidden="true" href="#cb2-2" tabindex="-1"&gt;&lt;/a&gt;  (&lt;span class="kw"&gt;progn&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-3"&gt;&lt;a aria-hidden="true" href="#cb2-3" tabindex="-1"&gt;&lt;/a&gt;    (&lt;span class="kw"&gt;print&lt;/span&gt; (&lt;span class="kw"&gt;eq&lt;/span&gt; a b))&lt;/span&gt;
&lt;span id="cb2-4"&gt;&lt;a aria-hidden="true" href="#cb2-4" tabindex="-1"&gt;&lt;/a&gt;    (&lt;span class="kw"&gt;print&lt;/span&gt; (&lt;span class="kw"&gt;eql&lt;/span&gt; a b))&lt;/span&gt;
&lt;span id="cb2-5"&gt;&lt;a aria-hidden="true" href="#cb2-5" tabindex="-1"&gt;&lt;/a&gt;    (&lt;span class="kw"&gt;print&lt;/span&gt; (&lt;span class="kw"&gt;equal&lt;/span&gt; a b))&lt;/span&gt;
&lt;span id="cb2-6"&gt;&lt;a aria-hidden="true" href="#cb2-6" tabindex="-1"&gt;&lt;/a&gt;    (&lt;span class="kw"&gt;print&lt;/span&gt; (&lt;span class="kw"&gt;equalp&lt;/span&gt; a b))))&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class="header"&gt;
&lt;th&gt;&lt;/th&gt;
&lt;th&gt;a=1,b=1&lt;/th&gt;
&lt;th&gt;a=1,b=1.0&lt;/th&gt;
&lt;th&gt;a=“hi”,b=“hi”&lt;/th&gt;
&lt;th&gt;a=‘(),b=’()&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class="odd"&gt;
&lt;td&gt;&lt;code&gt;eq&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;T&lt;/td&gt;
&lt;td&gt;NIL&lt;/td&gt;
&lt;td&gt;NIL&lt;/td&gt;
&lt;td&gt;T&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="even"&gt;
&lt;td&gt;&lt;code&gt;eql&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;T&lt;/td&gt;
&lt;td&gt;NIL&lt;/td&gt;
&lt;td&gt;NIL&lt;/td&gt;
&lt;td&gt;T&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="odd"&gt;
&lt;td&gt;&lt;code&gt;equal&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;T&lt;/td&gt;
&lt;td&gt;NIL&lt;/td&gt;
&lt;td&gt;T&lt;/td&gt;
&lt;td&gt;T&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="even"&gt;
&lt;td&gt;&lt;code&gt;equalp&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;T&lt;/td&gt;
&lt;td&gt;T&lt;/td&gt;
&lt;td&gt;T&lt;/td&gt;
&lt;td&gt;T&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id="数字"&gt;数字&lt;/h2&gt;
&lt;p&gt;CommonLisp 支持整数，浮点数，复数等。&lt;/p&gt;
&lt;p&gt;&lt;img src="https://acl.readthedocs.io/en/latest/_images/Figure-9.1.png"/&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;整数：&lt;/p&gt;
&lt;p&gt;可以使用常规的写法，也可以使用任意进制写法：&lt;/p&gt;
&lt;p&gt;常规写法：&lt;code&gt;10&lt;/code&gt;，&lt;code&gt;22/2&lt;/code&gt;，&lt;code&gt;-14&lt;/code&gt;，&lt;code&gt;-17&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;任意进制写法：二进制：&lt;code&gt;#b101001&lt;/code&gt;，八进制：&lt;code&gt;#o777&lt;/code&gt;，使用 &lt;code&gt;#nR&lt;/code&gt; 以 2 到 36 的其他进制书写有理数&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;浮点数：&lt;/p&gt;
&lt;p&gt;同样可以使用多种写法：&lt;code&gt;1.0&lt;/code&gt;，&lt;code&gt;1e0&lt;/code&gt;，&lt;code&gt;0.114514&lt;/code&gt;，&lt;code&gt;124E-3&lt;/code&gt;，&lt;code&gt;195d23&lt;/code&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;四则运算的截断和舍入：&lt;/p&gt;
&lt;ol type="1"&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;ceiling&lt;/code&gt;：向正无穷截断，&lt;strong&gt;返回大于或等于参数的最小整数。&lt;/strong&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;truncate&lt;/code&gt;：向零截断。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;round&lt;/code&gt;：舍入到最接近的整数上。如果参数刚好位于两个整数之间它舍入到最接近的偶数上。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;floor&lt;/code&gt;：向负无穷方向截断，&lt;strong&gt;返回小于或等于参数的最大整数。&lt;/strong&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;模和余数：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;模：&lt;code&gt;(mod number divisor)&lt;/code&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;余数：&lt;code&gt;(rem number divisor)&lt;/code&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;变量的增减：&lt;code&gt;incf&lt;/code&gt;，&lt;code&gt;decf&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;其他：&lt;code&gt;min&lt;/code&gt;，&lt;code&gt;max&lt;/code&gt;，&lt;code&gt;evenp&lt;/code&gt;（检测偶数），&lt;code&gt;oddp&lt;/code&gt;（检测奇数）&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;数字的比较使用 &lt;code&gt;=&lt;/code&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;h2 id="字符串"&gt;字符串&lt;/h2&gt;
&lt;h3 id="字符"&gt;字符&lt;/h3&gt;
&lt;p&gt;字符和数字是不同类型的对象，字符的表示：&lt;code&gt;#\+字符&lt;/code&gt;，例如字符 &lt;code&gt;H&lt;/code&gt;：&lt;code&gt;#\H&lt;/code&gt;，字符&lt;code&gt;和&lt;/code&gt;：&lt;code&gt;#\和&lt;/code&gt;（&lt;code&gt;#\U548C&lt;/code&gt;）,特定字符的替代语法是 # 后跟该字符的名字。例如 &lt;code&gt;#\Tab&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;字符不是数字，不能使用数值比较函数。使用 &lt;code&gt;char-equal&lt;/code&gt;。它接受任一数量的参数并 只在它们全是相同字符时返回真，相应的还有 &lt;code&gt;char-not-equal&lt;/code&gt;，&lt;code&gt;char-lessp&lt;/code&gt;，&lt;code&gt;char-not-lessp&lt;/code&gt;，&lt;code&gt;char-greaterp&lt;/code&gt;等对应 &lt;code&gt;&amp;gt;&lt;/code&gt;，&lt;code&gt;&amp;lt;&lt;/code&gt;等。&lt;/p&gt;
&lt;h3 id="字符串-1"&gt;字符串&lt;/h3&gt;
&lt;p&gt;字符串是字符的一维数组，字面字符串写在闭合的双引号里，使用斜杠来转引 &lt;code&gt;\&lt;/code&gt; 和 &lt;code&gt;"&lt;/code&gt; 符号。字符串的比较使用 &lt;code&gt;string-equal&lt;/code&gt; 系列函数，简单地来讲就是把字符比较系列中的 &lt;code&gt;char&lt;/code&gt; 替换为 &lt;code&gt;string&lt;/code&gt;。&lt;/p&gt;
&lt;div class="sourceCode" id="cb3"&gt;&lt;pre class="sourceCode lisp"&gt;&lt;code class="sourceCode commonlisp"&gt;&lt;span id="cb3-1"&gt;&lt;a aria-hidden="true" href="#cb3-1" tabindex="-1"&gt;&lt;/a&gt;(&lt;span class="kw"&gt;string-equal&lt;/span&gt; &lt;/span&gt;
&lt;span id="cb3-2"&gt;&lt;a aria-hidden="true" href="#cb3-2" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="st"&gt;"foobarbaz"&lt;/span&gt; &lt;span class="st"&gt;"quuxbarfoo"&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb3-3"&gt;&lt;a aria-hidden="true" href="#cb3-3" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="bu"&gt;:start1&lt;/span&gt; &lt;span class="dv"&gt;3&lt;/span&gt; &lt;span class="bu"&gt;:end1&lt;/span&gt; &lt;span class="dv"&gt;6&lt;/span&gt; &lt;span class="bu"&gt;:start2&lt;/span&gt; &lt;span class="dv"&gt;4&lt;/span&gt; &lt;span class="bu"&gt;:end2&lt;/span&gt; &lt;span class="dv"&gt;7&lt;/span&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id="函数类型"&gt;函数类型&lt;/h2&gt;
&lt;p&gt;把函数的名字传给 function ，它会返回相关联的对象，用 &lt;code&gt;#'&lt;/code&gt; 作为 function 的缩写。&lt;/p&gt;
&lt;p&gt;使用 &lt;code&gt;lambda&lt;/code&gt; 定义匿名函数：&lt;code&gt;(lambda (x) (+ x 100))&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;lambda&lt;/code&gt; 函数：&lt;code&gt;(lambda (parameters) body)&lt;/code&gt;&lt;/p&gt;
&lt;h2 id="集合类型"&gt;集合类型&lt;/h2&gt;
&lt;p&gt;列表和向量的区别应该可以类比为 C++ 中标准库容器和 C array 的区别(？)&lt;/p&gt;
&lt;h3 id="列表list"&gt;列表（list）&lt;/h3&gt;
&lt;p&gt;列表使用括号直接创建：&lt;code&gt;'()&lt;/code&gt;，也可以使用 &lt;code&gt;make-list&lt;/code&gt; 来创建。列表是序列的子类型。列表是最常见的数据结构，可以用来模拟树，下推栈等数据结构。&lt;/p&gt;
&lt;p&gt;列表的基本元素是 Cons，一个 Cons 可以看作是由一个保存元素的单元和指向下一个元素的指针， &lt;code&gt;CONS&lt;/code&gt; 最初是动词 construct 的简称，除非第二个值是 NIL 或是另一个点对单元,否则一个点对将被打印两个值在括号中用一个点所分隔的形式，前面一个元素叫做 &lt;code&gt;car&lt;/code&gt;，后面一个元素叫做 &lt;code&gt;cdr&lt;/code&gt;。所以，一个包含 1，2 的列表类似于：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;[O|O]---&amp;gt;[O|null]
 |        |
 1        2&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;它事实上是 &lt;code&gt;(cons 1 (cons 2 nil))&lt;/code&gt; ，简单写作 &lt;code&gt;(list 1 2)&lt;/code&gt;。&lt;/p&gt;
&lt;p&gt;取出列表元素的基本函数是 car/first 和 cdr/rest 。对列表取 car 返回第一个元素，而对列表取 cdr 返回第一个元素之后的所有元素，你可以使用 setf 来设置一个 cons 单元的 car 或者 cdr：&lt;/p&gt;
&lt;div class="sourceCode" id="cb5"&gt;&lt;pre class="sourceCode lisp"&gt;&lt;code class="sourceCode commonlisp"&gt;&lt;span id="cb5-1"&gt;&lt;a aria-hidden="true" href="#cb5-1" tabindex="-1"&gt;&lt;/a&gt;(&lt;span class="kw"&gt;defparameter&lt;/span&gt;&lt;span class="fu"&gt; *cons* &lt;/span&gt;(&lt;span class="kw"&gt;cons&lt;/span&gt; &lt;span class="dv"&gt;1&lt;/span&gt; &lt;span class="dv"&gt;2&lt;/span&gt;))&lt;/span&gt;
&lt;span id="cb5-2"&gt;&lt;a aria-hidden="true" href="#cb5-2" tabindex="-1"&gt;&lt;/a&gt;(&lt;span class="kw"&gt;setf&lt;/span&gt; (&lt;span class="kw"&gt;car&lt;/span&gt; *cons*) &lt;span class="dv"&gt;10&lt;/span&gt;) &lt;/span&gt;
&lt;span id="cb5-3"&gt;&lt;a aria-hidden="true" href="#cb5-3" tabindex="-1"&gt;&lt;/a&gt;(&lt;span class="kw"&gt;setf&lt;/span&gt; (&lt;span class="kw"&gt;cdr&lt;/span&gt; *cons*) &lt;span class="dv"&gt;20&lt;/span&gt;) &lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;常用函数：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;reverse&lt;/code&gt;：翻转列表：&lt;code&gt;(reverse "hi!")&lt;/code&gt; -&amp;gt; &lt;code&gt;"!ih"&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;second&lt;/code&gt; 到 &lt;code&gt;tenth&lt;/code&gt;：获得某个元素。&lt;/li&gt;
&lt;li&gt;&lt;code&gt;nth&lt;/code&gt;：接受两个参数,一个索引和一个列表,并返回列表中第 n 个(从 0 开始)元素&lt;/li&gt;
&lt;li&gt;复合 &lt;code&gt;car/cdr&lt;/code&gt; 函数：例如：&lt;code&gt;(cadadr list) ≡ (car (cdr (car (cdr list))))&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;参见：&lt;a href="https://lispcookbook.github.io/cl-cookbook/data-structures.html"&gt;The Common Lisp Cookbook – Data structures&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;副作用和「破坏性操作」：&lt;/p&gt;
&lt;p&gt;纯粹的「函数」是说函数完全基于其参数的值来计算结果，比如 &lt;code&gt;(+ 5 6)&lt;/code&gt; 是完全「函数式」的。修改已有对象的操作被称作是破坏性的，原来的那个对象的状态改变来了。&lt;/p&gt;
&lt;h3 id="排序和映射"&gt;排序和映射&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;排序使用 &lt;code&gt;sort&lt;/code&gt; 和 &lt;code&gt;stable-sort&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;两者会破坏序列。参数是序列和谓词函数。例如：&lt;code&gt;(sort '(1 2 3 71 29) #'&amp;lt;)&lt;/code&gt;，对一个序列排序并赋值一般使用 &lt;code&gt;(setf my-sequence (sort my-sequence #'string&amp;lt;))&lt;/code&gt; 的形式。 可以使用关键词参数 &lt;code&gt;:key&lt;/code&gt; 来指定复杂数据结构中用来排序的元素。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;映射&lt;/p&gt;
&lt;p&gt;映射是对高阶函数的使用。有六个用于列表的 map 函数，最常用的是这两个：&lt;/p&gt;
&lt;ol type="1"&gt;
&lt;li&gt;&lt;code&gt;mapcar&lt;/code&gt;：&lt;code&gt;(mapcar #'+ (list 1 2 3) (list 10 20 30)) → (11 22 33)&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;maplist&lt;/code&gt;：将列表的渐进的下一个 cdr 传入函数。 &lt;code&gt;(maplist #'(lambda (x y) (list (first x) (first y))) '(1 2 3 4) '(1 2 3 4)&lt;/code&gt; -&amp;gt; &lt;code&gt;((1 1) (2 2) (3 3) (4 4))&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="树"&gt;树&lt;/h3&gt;
&lt;p&gt;Cons 对象可以想成是二叉树， car 代表左子树，而 cdr 代表右子树，Common Lisp 有几个内置的操作树的函数。copy-tree 接受一个树，并返回一份副本。&lt;/p&gt;
&lt;h3 id="集合"&gt;集合&lt;/h3&gt;
&lt;p&gt;CommonLisp 的列表可以看作是一个集合，使用一系列函数来把列表作为集合操作：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;pushnew&lt;/code&gt;：向一个集合添加元素。&lt;/li&gt;
&lt;li&gt;&lt;code&gt;member&lt;/code&gt; 和 &lt;code&gt;member-if&lt;/code&gt;：测试是否在集合中&lt;/li&gt;
&lt;li&gt;&lt;code&gt;INTERSECTION&lt;/code&gt; 、 &lt;code&gt;UNION&lt;/code&gt; 、及 &lt;code&gt;SET-EXCLUSIVE-OR&lt;/code&gt;：集合论相关操作（交集，并集，异或）。&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="栈"&gt;栈&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;(push x y)&lt;/code&gt; 把 x 放入列表 y 的前端。而 &lt;code&gt;(pop x)&lt;/code&gt; 则是将列表 x 的第一个元素移除，并返回这个元素。&lt;/p&gt;
&lt;h1 id="变量和常量"&gt;变量和常量&lt;/h1&gt;
&lt;h2 id="使用-let-来引入局部变量"&gt;使用 &lt;code&gt;let&lt;/code&gt; 来引入局部变量&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;let&lt;/code&gt; 的一般形式是：&lt;/p&gt;
&lt;div class="sourceCode" id="cb6"&gt;&lt;pre class="sourceCode lisp"&gt;&lt;code class="sourceCode commonlisp"&gt;&lt;span id="cb6-1"&gt;&lt;a aria-hidden="true" href="#cb6-1" tabindex="-1"&gt;&lt;/a&gt;(&lt;span class="kw"&gt;let&lt;/span&gt; (variable*) body-form*)&lt;/span&gt;
&lt;span id="cb6-2"&gt;&lt;a aria-hidden="true" href="#cb6-2" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="co"&gt;;;举例&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb6-3"&gt;&lt;a aria-hidden="true" href="#cb6-3" tabindex="-1"&gt;&lt;/a&gt;(&lt;span class="kw"&gt;let&lt;/span&gt; ((x &lt;span class="dv"&gt;1&lt;/span&gt;) (y &lt;span class="dv"&gt;2&lt;/span&gt;) z)  &lt;span class="co"&gt;;; z 是 nil&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb6-4"&gt;&lt;a aria-hidden="true" href="#cb6-4" tabindex="-1"&gt;&lt;/a&gt;   (&lt;span class="op"&gt;+&lt;/span&gt; x y))&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;局部变量不会「污染」外部的变量，它们只在特定的上下文里有效，嵌套绑定同名变量，那么最内层的变量绑定将覆盖外层的绑定，所有的绑定形式都将引入词法作用域变量。&lt;/p&gt;
&lt;h2 id="使用-defparameter-和-defvar-来引入全局变量"&gt;使用 &lt;code&gt;defparameter&lt;/code&gt; 和 &lt;code&gt;defvar&lt;/code&gt; 来引入全局变量&lt;/h2&gt;
&lt;p&gt;**命名约定：全局变量使用信号「*」包围起来。**，例如 &lt;code&gt;*global-counter*&lt;/code&gt;。参数：变量名，初始值和文档字符串。其中文档字符串可选。&lt;code&gt;DEFPARAMETER&lt;/code&gt; 总是将初始值赋给命名的变量,而 &lt;code&gt;DEFVAR&lt;/code&gt; 只有当变量未定义时才这样做。&lt;/p&gt;
&lt;div class="sourceCode" id="cb7"&gt;&lt;pre class="sourceCode lisp"&gt;&lt;code class="sourceCode commonlisp"&gt;&lt;span id="cb7-1"&gt;&lt;a aria-hidden="true" href="#cb7-1" tabindex="-1"&gt;&lt;/a&gt;(&lt;span class="kw"&gt;defvar&lt;/span&gt;&lt;span class="fu"&gt; *count* &lt;/span&gt;&lt;span class="dv"&gt;0&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb7-2"&gt;&lt;a aria-hidden="true" href="#cb7-2" tabindex="-1"&gt;&lt;/a&gt;  &lt;span class="st"&gt;"Count of something."&lt;/span&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id="使用-defconstant-来引入全局常量"&gt;使用 &lt;code&gt;defconstant&lt;/code&gt; 来引入全局常量&lt;/h2&gt;
&lt;p&gt;和 &lt;code&gt;defparameter&lt;/code&gt; 类似：&lt;code&gt;(defconstant name initial-value-form [ documentation-string ])&lt;/code&gt;，一些常量是预先定义的，例如 π 的值：&lt;code&gt;pi&lt;/code&gt;。&lt;/p&gt;
&lt;h2 id="使用-setf-来赋值"&gt;使用 &lt;code&gt;setf&lt;/code&gt; 来赋值&lt;/h2&gt;
&lt;p&gt;可以用来给全局或局部变量赋值，类似其他语言的 &lt;code&gt;=&lt;/code&gt;。&lt;/p&gt;
&lt;div class="sourceCode" id="cb8"&gt;&lt;pre class="sourceCode lisp"&gt;&lt;code class="sourceCode commonlisp"&gt;&lt;span id="cb8-1"&gt;&lt;a aria-hidden="true" href="#cb8-1" tabindex="-1"&gt;&lt;/a&gt;(&lt;span class="kw"&gt;setf&lt;/span&gt; x (&lt;span class="kw"&gt;setf&lt;/span&gt; y (&lt;span class="kw"&gt;random&lt;/span&gt; &lt;span class="dv"&gt;10&lt;/span&gt;)))&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h1 id="注释"&gt;注释&lt;/h1&gt;
&lt;p&gt;注释使用 &lt;code&gt;;&lt;/code&gt; 来开头。&lt;/p&gt;
&lt;p&gt;;;;; 四个分号用于文件头注释。&lt;/p&gt;
&lt;p&gt;;;; 一个带有三个分号的注释将通常作为段落注释应用到接下来的 ;;; 一大段代码上。&lt;/p&gt;
&lt;p&gt;;; 两个分号说明该注释应用于接下来的代码上。&lt;/p&gt;
&lt;p&gt;; 一个分号仅用于本行&lt;/p&gt;
&lt;p&gt;另外可以使用「文档字符串」功能。&lt;/p&gt;
&lt;h1 id="函数"&gt;函数&lt;/h1&gt;
&lt;p&gt;所有 Lisp 程序的三个最基本组成部分是函数、变量和宏。要定义一个函数，使用 &lt;code&gt;defun&lt;/code&gt;。&lt;code&gt;defun&lt;/code&gt; 是一个宏。&lt;/p&gt;
&lt;div class="sourceCode" id="cb9"&gt;&lt;pre class="sourceCode lisp"&gt;&lt;code class="sourceCode commonlisp"&gt;&lt;span id="cb9-1"&gt;&lt;a aria-hidden="true" href="#cb9-1" tabindex="-1"&gt;&lt;/a&gt;(&lt;span class="kw"&gt;defun&lt;/span&gt;&lt;span class="fu"&gt; name &lt;/span&gt;(parameter*)&lt;/span&gt;
&lt;span id="cb9-2"&gt;&lt;a aria-hidden="true" href="#cb9-2" tabindex="-1"&gt;&lt;/a&gt;  &lt;span class="st"&gt;"Optional documentation string."&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb9-3"&gt;&lt;a aria-hidden="true" href="#cb9-3" tabindex="-1"&gt;&lt;/a&gt;  body-form*)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id="参数"&gt;参数&lt;/h2&gt;
&lt;h3 id="必要形参"&gt;必要形参&lt;/h3&gt;
&lt;p&gt;必要形式参数和预期的一样工作，按照传入的次序绑定。不能多也不能少。&lt;/p&gt;
&lt;div class="sourceCode" id="cb10"&gt;&lt;pre class="sourceCode lisp"&gt;&lt;code class="sourceCode commonlisp"&gt;&lt;span id="cb10-1"&gt;&lt;a aria-hidden="true" href="#cb10-1" tabindex="-1"&gt;&lt;/a&gt;(&lt;span class="kw"&gt;defun&lt;/span&gt;&lt;span class="fu"&gt; say-hello &lt;/span&gt;(name age)&lt;/span&gt;
&lt;span id="cb10-2"&gt;&lt;a aria-hidden="true" href="#cb10-2" tabindex="-1"&gt;&lt;/a&gt;  (&lt;span class="kw"&gt;format&lt;/span&gt; &lt;span class="kw"&gt;t&lt;/span&gt; &lt;span class="st"&gt;"Hello ! ~s ~d."&lt;/span&gt; name age))&lt;/span&gt;
&lt;span id="cb10-3"&gt;&lt;a aria-hidden="true" href="#cb10-3" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb10-4"&gt;&lt;a aria-hidden="true" href="#cb10-4" tabindex="-1"&gt;&lt;/a&gt;(say-hello &lt;span class="st"&gt;"izfsk"&lt;/span&gt; &lt;span class="dv"&gt;10&lt;/span&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id="可选形参"&gt;可选形参&lt;/h3&gt;
&lt;p&gt;可选形参为调用者提供了一个默认的值，而关系它们的人可以提供一个指定的值。定义方法是在必要参数的名字之后放置符号&amp;amp;optional，后接可选形参的名字。默认的缺省值为 &lt;code&gt;nil&lt;/code&gt;，将形参名替换成一个含有名字跟一个表达式的列表来指定该缺省值。&lt;/p&gt;
&lt;div class="sourceCode" id="cb11"&gt;&lt;pre class="sourceCode lisp"&gt;&lt;code class="sourceCode commonlisp"&gt;&lt;span id="cb11-1"&gt;&lt;a aria-hidden="true" href="#cb11-1" tabindex="-1"&gt;&lt;/a&gt;(&lt;span class="kw"&gt;defun&lt;/span&gt;&lt;span class="fu"&gt; optional-arguments &lt;/span&gt;(a b &amp;amp;optional (c &lt;span class="dv"&gt;100&lt;/span&gt;) (d &lt;span class="dv"&gt;100&lt;/span&gt;) (e (&lt;span class="op"&gt;+&lt;/span&gt; a &lt;span class="dv"&gt;1&lt;/span&gt;)))&lt;/span&gt;
&lt;span id="cb11-2"&gt;&lt;a aria-hidden="true" href="#cb11-2" tabindex="-1"&gt;&lt;/a&gt;  (&lt;span class="op"&gt;*&lt;/span&gt; a b c d e))&lt;/span&gt;
&lt;span id="cb11-3"&gt;&lt;a aria-hidden="true" href="#cb11-3" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb11-4"&gt;&lt;a aria-hidden="true" href="#cb11-4" tabindex="-1"&gt;&lt;/a&gt;(optional-arguments &lt;span class="dv"&gt;1&lt;/span&gt; &lt;span class="dv"&gt;2&lt;/span&gt; &lt;span class="dv"&gt;3&lt;/span&gt; &lt;span class="dv"&gt;4&lt;/span&gt; &lt;span class="dv"&gt;5&lt;/span&gt;)&lt;/span&gt;
&lt;span id="cb11-5"&gt;&lt;a aria-hidden="true" href="#cb11-5" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="co"&gt;;; 120&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb11-6"&gt;&lt;a aria-hidden="true" href="#cb11-6" tabindex="-1"&gt;&lt;/a&gt;(optional-arguments &lt;span class="dv"&gt;1&lt;/span&gt; &lt;span class="dv"&gt;2&lt;/span&gt; &lt;span class="dv"&gt;3&lt;/span&gt; &lt;span class="dv"&gt;4&lt;/span&gt;)&lt;/span&gt;
&lt;span id="cb11-7"&gt;&lt;a aria-hidden="true" href="#cb11-7" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="co"&gt;;; 48&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb11-8"&gt;&lt;a aria-hidden="true" href="#cb11-8" tabindex="-1"&gt;&lt;/a&gt;(optional-arguments &lt;span class="dv"&gt;1&lt;/span&gt; &lt;span class="dv"&gt;2&lt;/span&gt;)&lt;/span&gt;
&lt;span id="cb11-9"&gt;&lt;a aria-hidden="true" href="#cb11-9" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="co"&gt;;; 40000&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;可选形参表达式可以绑定第三个参数，用来判断这个参数是用户提供的还是默认的，例如 &lt;code&gt;(argument "default" argument-not-default)&lt;/code&gt; 中的 &lt;code&gt;argument-not-default&lt;/code&gt; 将会在用户指定值时为 &lt;code&gt;T&lt;/code&gt;，否则为 &lt;code&gt;nil&lt;/code&gt;。&lt;/p&gt;
&lt;h3 id="剩余形参"&gt;剩余形参&lt;/h3&gt;
&lt;p&gt;在符号 &lt;code&gt;&amp;amp;rest&lt;/code&gt; 之后包括一个一揽子形参。如果一个函数带有一个 &lt;code&gt;&amp;amp;rest&lt;/code&gt; 形参,任何满足了必要和可选形参之后的其余所有参数将被收集到一个列表里成为该 &lt;code&gt;&amp;amp;rest&lt;/code&gt; 形参。&lt;/p&gt;
&lt;div class="sourceCode" id="cb12"&gt;&lt;pre class="sourceCode lisp"&gt;&lt;code class="sourceCode commonlisp"&gt;&lt;span id="cb12-1"&gt;&lt;a aria-hidden="true" href="#cb12-1" tabindex="-1"&gt;&lt;/a&gt;(&lt;span class="kw"&gt;defun&lt;/span&gt;&lt;span class="fu"&gt; many-arguments &lt;/span&gt;(&amp;amp;&lt;span class="kw"&gt;rest&lt;/span&gt; numbers)&lt;/span&gt;
&lt;span id="cb12-2"&gt;&lt;a aria-hidden="true" href="#cb12-2" tabindex="-1"&gt;&lt;/a&gt;  (&lt;span class="kw"&gt;format&lt;/span&gt; &lt;span class="kw"&gt;t&lt;/span&gt; &lt;span class="st"&gt;"There are ~d arguments."&lt;/span&gt; (&lt;span class="kw"&gt;length&lt;/span&gt; numbers)))&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id="关键字形参"&gt;关键字形参&lt;/h3&gt;
&lt;p&gt;在任何必要的 &lt;code&gt;&amp;amp;optional&lt;/code&gt; 和 &lt;code&gt;&amp;amp;rest&lt;/code&gt; 形参之后可以加上符号 &lt;code&gt;&amp;amp;key&lt;/code&gt; 以及任意数量的关键字形参标识符。&lt;/p&gt;
&lt;div class="sourceCode" id="cb13"&gt;&lt;pre class="sourceCode lisp"&gt;&lt;code class="sourceCode commonlisp"&gt;&lt;span id="cb13-1"&gt;&lt;a aria-hidden="true" href="#cb13-1" tabindex="-1"&gt;&lt;/a&gt;(&lt;span class="kw"&gt;defun&lt;/span&gt;&lt;span class="fu"&gt; foo &lt;/span&gt;(&amp;amp;&lt;span class="kw"&gt;rest&lt;/span&gt; &lt;span class="kw"&gt;rest&lt;/span&gt; &amp;amp;key a b c) (&lt;span class="kw"&gt;list&lt;/span&gt; &lt;span class="kw"&gt;rest&lt;/span&gt; a b c))&lt;/span&gt;
&lt;span id="cb13-2"&gt;&lt;a aria-hidden="true" href="#cb13-2" tabindex="-1"&gt;&lt;/a&gt;(foo :a &lt;span class="dv"&gt;1&lt;/span&gt; :b &lt;span class="dv"&gt;2&lt;/span&gt; :c &lt;span class="dv"&gt;3&lt;/span&gt;) &lt;span class="co"&gt;; ((:A 1 :B 2 :C 3) 1 2 3)&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;参数声明的顺序是：&lt;strong&gt;首先是必要形参,其次是可选形参,再次是剩余形参,最后是关键字形参。&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;正常情况下，函数的最后一行会作为返回值返回，如果需要在控制流程中返回，使用 &lt;code&gt;return-from&lt;/code&gt;。&lt;/p&gt;
&lt;br/&gt;
&lt;!--%%REF%%--&gt;
&lt;br/&gt;
&lt;script async="" crossorigin="anonymous" data-category="Announcements" data-category-id="DIC_kwDOJ7Ymy84CX4eg" data-emit-metadata="0" data-input-position="top" data-lang="zh-CN" data-loading="lazy" data-mapping="title" data-reactions-enabled="1" data-repo="izfsk-ium/izfsk-ium.github.io" data-repo-id="R_kgDOJ7Ymyw" data-strict="0" data-theme="preferred_color_scheme" src="https://giscus.app/client.js"&gt;
&lt;/script&gt;
&lt;/main&gt;
&lt;footer&gt;
&lt;p class="signoff"&gt;
&lt;div class="metadata"&gt;
&lt;p class="date"&gt;&lt;time datetime="2023-01-18"&gt;创建日期：2023-01-18&lt;/time&gt;&lt;/p&gt;
&lt;p class="lastmodify"&gt;&lt;time&gt;最后编译：2023-08-10&lt;/time&gt;&lt;/p&gt;
&lt;p class="lastmodify" id="counter-span"&gt;访问次数：&lt;/p&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;/footer&gt;
&lt;script&gt;
    /* These script should run after page load */
    document.querySelectorAll('code.sourceCode').forEach(
      i =&gt; i.insertAdjacentHTML('beforeend', '&lt;div class="copy"&gt;复制&lt;/div&gt;')
    );
    document.querySelectorAll('div.copy').forEach(
      i =&gt; i.addEventListener(
        'click',
        () =&gt; {
          navigator.clipboard.writeText(i.parentElement.innerText.replace('复制', ''));
          i.innerText = '成功';
          setTimeout(() =&gt; {
            i.innerText = '复制';
          }, 1000);
        }
      )
    );

    if (location.href.includes("127.0.0.1:8080")) {
      document.getElementById("counter-span").innerHTML = "[[development mode]]";
    } else {
      const uuid = document.getElementById("article-uuid").innerText;
      const target = document.getElementById("counter-span");
      const last = localStorage.getItem("lastVisit-" + uuid);
      const shouldIncrease = last === null || new Date().getTime() - parseInt(last) &gt;= (1000 * 60 * 15);

      fetch(shouldIncrease ? ("https://counter.izfsk.top/counter/" + uuid) : ("https://counter.izfsk.top/readOnly/" + uuid))
        .then(r =&gt; r.text())
        .then(d =&gt; {
          if (!d.startsWith("Too"))
            document.getElementById("counter-span").innerText = "访问次数：" + d.toString();
          else
            document.getElementById("counter-span").innerHTML = "";
        });

      localStorage.setItem("lastVisit-" + uuid, new Date().getTime());
    }
  &lt;/script&gt;
&lt;script async="" data-website-id="2a1146ab-fa82-4a84-a04f-30e5967357c3" src="https://analytics.umami.is/script.js"&gt;&lt;/script&gt;
&lt;/body&gt;</content:encoded>
      <guid isPermaLink="false">f7127a84-86a8-41dc-8fdc-893cd1118438</guid>
      <pubDate>Wed, 18 Jan 2023 00:00:00 +0800</pubDate>
    </item>
    <item>
      <title>CommonLisp基础-分支和循环</title>
      <link>https://blog.izfsk.top/articles/CommonLisp基础-分支和循环.html</link>
      <description>CommonLisp基础-分支和循环</description>
      <content:encoded>&lt;body&gt;
&lt;progress id="content_progress" value="0"&gt;&lt;/progress&gt;
&lt;button id="back-to-top"&gt;
    回页顶
  &lt;/button&gt;
&lt;header&gt;
&lt;small id="article-uuid" style="display: none !important;"&gt;41a43b0c-279b-438f-9ee6-dbe98965ce46&lt;/small&gt;
&lt;h1 class="title"&gt;CommonLisp基础-分支和循环&lt;/h1&gt;
&lt;!-- Subtitle --&gt;
&lt;h3 class="subtitle"&gt; &lt;/h3&gt;
&lt;/header&gt;
&lt;nav id="TOC" role="doc-toc"&gt;
&lt;strong&gt;文章归类: &lt;a href="/pages/category.html#学习"&gt;学习&lt;/a&gt; &lt;/strong&gt;
&lt;input id="contents" type="checkbox"/&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#分支" id="toc-分支"&gt;分支&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#if-when-和-cond" id="toc-if-when-和-cond"&gt;&lt;code&gt;if&lt;/code&gt;, &lt;code&gt;when&lt;/code&gt;, 和 &lt;code&gt;cond&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#cond" id="toc-cond"&gt;&lt;code&gt;cond&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#循环" id="toc-循环"&gt;循环&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#dolist-和-dotimes" id="toc-dolist-和-dotimes"&gt;&lt;code&gt;dolist&lt;/code&gt; 和 &lt;code&gt;dotimes&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#do" id="toc-do"&gt;&lt;code&gt;do&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#loop" id="toc-loop"&gt;&lt;code&gt;loop&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#reference"&gt;参考链接&lt;/a&gt;&lt;/li&gt;
&lt;li&gt; &lt;/li&gt;
&lt;li class="tools"&gt;
&lt;span id="backtomain"&gt;
&lt;svg class="bi bi-house" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M8.707 1.5a1 1 0 0 0-1.414 0L.646 8.146a.5.5 0 0 0 .708.708L2 8.207V13.5A1.5 1.5 0 0 0 3.5 15h9a1.5 1.5 0 0 0 1.5-1.5V8.207l.646.647a.5.5 0 0 0 .708-.708L13 5.793V2.5a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v1.293L8.707 1.5ZM13 7.207V13.5a.5.5 0 0 1-.5.5h-9a.5.5 0 0 1-.5-.5V7.207l5-5 5 5Z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="readingmode"&gt;
&lt;svg class="bi bi-book" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M1 2.828c.885-.37 2.154-.769 3.388-.893 1.33-.134 2.458.063 3.112.752v9.746c-.935-.53-2.12-.603-3.213-.493-1.18.12-2.37.461-3.287.811V2.828zm7.5-.141c.654-.689 1.782-.886 3.112-.752 1.234.124 2.503.523 3.388.893v9.923c-.918-.35-2.107-.692-3.287-.81-1.094-.111-2.278-.039-3.213.492V2.687zM8 1.783C7.015.936 5.587.81 4.287.94c-1.514.153-3.042.672-3.994 1.105A.5.5 0 0 0 0 2.5v11a.5.5 0 0 0 .707.455c.882-.4 2.303-.881 3.68-1.02 1.409-.142 2.59.087 3.223.877a.5.5 0 0 0 .78 0c.633-.79 1.814-1.019 3.222-.877 1.378.139 2.8.62 3.681 1.02A.5.5 0 0 0 16 13.5v-11a.5.5 0 0 0-.293-.455c-.952-.433-2.48-.952-3.994-1.105C10.413.809 8.985.936 8 1.783z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="larger"&gt; &lt;/span&gt;
&lt;span id="smaller"&gt;&lt;/span&gt;
&lt;span id="switchfont"&gt;
&lt;svg class="bi bi-fonts" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M12.258 3h-8.51l-.083 2.46h.479c.26-1.544.758-1.783 2.693-1.845l.424-.013v7.827c0 .663-.144.82-1.3.923v.52h4.082v-.52c-1.162-.103-1.306-.26-1.306-.923V3.602l.431.013c1.934.062 2.434.301 2.693 1.846h.479L12.258 3z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="backtotop"&gt;
&lt;svg class="bi bi-arrow-bar-up" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M8 10a.5.5 0 0 0 .5-.5V3.707l2.146 2.147a.5.5 0 0 0 .708-.708l-3-3a.5.5 0 0 0-.708 0l-3 3a.5.5 0 1 0 .708.708L7.5 3.707V9.5a.5.5 0 0 0 .5.5zm-7 2.5a.5.5 0 0 1 .5-.5h13a.5.5 0 0 1 0 1h-13a.5.5 0 0 1-.5-.5z" fill-rule="evenodd"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/nav&gt;
&lt;main&gt;
&lt;h1 id="分支"&gt;分支&lt;/h1&gt;
&lt;h2 id="if-when-和-cond"&gt;&lt;code&gt;if&lt;/code&gt;, &lt;code&gt;when&lt;/code&gt;, 和 &lt;code&gt;cond&lt;/code&gt;&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;if&lt;/code&gt; 的作用和效果和一般常识一致，其形式为 &lt;code&gt;(if condition then-form [else-form])&lt;/code&gt;，使用 &lt;code&gt;and&lt;/code&gt; &lt;code&gt;not&lt;/code&gt; &lt;code&gt;or&lt;/code&gt; 组合判断：&lt;/p&gt;
&lt;div class="sourceCode" id="cb1"&gt;&lt;pre class="sourceCode lisp"&gt;&lt;code class="sourceCode commonlisp"&gt;&lt;span id="cb1-1"&gt;&lt;a aria-hidden="true" href="#cb1-1" tabindex="-1"&gt;&lt;/a&gt;(&lt;span class="kw"&gt;defun&lt;/span&gt;&lt;span class="fu"&gt; guess-name &lt;/span&gt;(name)&lt;/span&gt;
&lt;span id="cb1-2"&gt;&lt;a aria-hidden="true" href="#cb1-2" tabindex="-1"&gt;&lt;/a&gt;  (&lt;span class="kw"&gt;if&lt;/span&gt; (&lt;span class="kw"&gt;equalp&lt;/span&gt; name &lt;span class="st"&gt;"izfsk"&lt;/span&gt;)&lt;/span&gt;
&lt;span id="cb1-3"&gt;&lt;a aria-hidden="true" href="#cb1-3" tabindex="-1"&gt;&lt;/a&gt;      (&lt;span class="kw"&gt;print&lt;/span&gt; &lt;span class="st"&gt;"Yes!"&lt;/span&gt;)&lt;/span&gt;
&lt;span id="cb1-4"&gt;&lt;a aria-hidden="true" href="#cb1-4" tabindex="-1"&gt;&lt;/a&gt;      (&lt;span class="kw"&gt;print&lt;/span&gt; &lt;span class="st"&gt;"No!"&lt;/span&gt;)))&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;但是，&lt;code&gt;if&lt;/code&gt; 只能执行一个表达式，所以如果需要组合执行很多任务，需要使用 &lt;code&gt;progn&lt;/code&gt; 代码块：&lt;/p&gt;
&lt;div class="sourceCode" id="cb2"&gt;&lt;pre class="sourceCode lisp"&gt;&lt;code class="sourceCode commonlisp"&gt;&lt;span id="cb2-1"&gt;&lt;a aria-hidden="true" href="#cb2-1" tabindex="-1"&gt;&lt;/a&gt;(&lt;span class="kw"&gt;if&lt;/span&gt; (is-target thing)&lt;/span&gt;
&lt;span id="cb2-2"&gt;&lt;a aria-hidden="true" href="#cb2-2" tabindex="-1"&gt;&lt;/a&gt;    (&lt;span class="kw"&gt;progn&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-3"&gt;&lt;a aria-hidden="true" href="#cb2-3" tabindex="-1"&gt;&lt;/a&gt;        (do-something)&lt;/span&gt;
&lt;span id="cb2-4"&gt;&lt;a aria-hidden="true" href="#cb2-4" tabindex="-1"&gt;&lt;/a&gt;        (do-another thing)))&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;这个逻辑可以使用 &lt;code&gt;when&lt;/code&gt; 宏重写：&lt;/p&gt;
&lt;div class="sourceCode" id="cb3"&gt;&lt;pre class="sourceCode lisp"&gt;&lt;code class="sourceCode commonlisp"&gt;&lt;span id="cb3-1"&gt;&lt;a aria-hidden="true" href="#cb3-1" tabindex="-1"&gt;&lt;/a&gt;(&lt;span class="kw"&gt;when&lt;/span&gt; (is-target thing)&lt;/span&gt;
&lt;span id="cb3-2"&gt;&lt;a aria-hidden="true" href="#cb3-2" tabindex="-1"&gt;&lt;/a&gt;    (do-something)&lt;/span&gt;
&lt;span id="cb3-3"&gt;&lt;a aria-hidden="true" href="#cb3-3" tabindex="-1"&gt;&lt;/a&gt;    (do-another thing))&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;code&gt;unless&lt;/code&gt; 是 &lt;code&gt;when&lt;/code&gt; 的反过来版本。两者是建立在 &lt;code&gt;if&lt;/code&gt; 上的宏。而 &lt;code&gt;if&lt;/code&gt; 是&lt;strong&gt;特殊操作符&lt;/strong&gt;。&lt;/p&gt;
&lt;h2 id="cond"&gt;&lt;code&gt;cond&lt;/code&gt;&lt;/h2&gt;
&lt;p&gt;类似于 C 中的 &lt;code&gt;switch...case...&lt;/code&gt; 但是没有 &lt;code&gt;fallthrouth&lt;/code&gt; 也不限制 int 类型：&lt;/p&gt;
&lt;div class="sourceCode" id="cb4"&gt;&lt;pre class="sourceCode lisp"&gt;&lt;code class="sourceCode commonlisp"&gt;&lt;span id="cb4-1"&gt;&lt;a aria-hidden="true" href="#cb4-1" tabindex="-1"&gt;&lt;/a&gt;(&lt;span class="kw"&gt;cond&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb4-2"&gt;&lt;a aria-hidden="true" href="#cb4-2" tabindex="-1"&gt;&lt;/a&gt;    (test-1 form*)&lt;/span&gt;
&lt;span id="cb4-3"&gt;&lt;a aria-hidden="true" href="#cb4-3" tabindex="-1"&gt;&lt;/a&gt;    ...&lt;/span&gt;
&lt;span id="cb4-4"&gt;&lt;a aria-hidden="true" href="#cb4-4" tabindex="-1"&gt;&lt;/a&gt;    ...&lt;/span&gt;
&lt;span id="cb4-5"&gt;&lt;a aria-hidden="true" href="#cb4-5" tabindex="-1"&gt;&lt;/a&gt;    (test-N form*))&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h1 id="循环"&gt;循环&lt;/h1&gt;
&lt;p&gt;&lt;code&gt;lisp&lt;/code&gt; 的循环可以很复杂，所有的循环操作宏都建立在底层的 &lt;code&gt;goto&lt;/code&gt; 之上。&lt;/p&gt;
&lt;h2 id="dolist-和-dotimes"&gt;&lt;code&gt;dolist&lt;/code&gt; 和 &lt;code&gt;dotimes&lt;/code&gt;&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;dotimes&lt;/code&gt; 类似 &lt;code&gt;for (int i=0;i&amp;lt;100;i++)&lt;/code&gt; 这样：&lt;/p&gt;
&lt;div class="sourceCode" id="cb5"&gt;&lt;pre class="sourceCode lisp"&gt;&lt;code class="sourceCode commonlisp"&gt;&lt;span id="cb5-1"&gt;&lt;a aria-hidden="true" href="#cb5-1" tabindex="-1"&gt;&lt;/a&gt;(&lt;span class="kw"&gt;defun&lt;/span&gt;&lt;span class="fu"&gt; multiples-of-3-or-5 &lt;/span&gt;()&lt;/span&gt;
&lt;span id="cb5-2"&gt;&lt;a aria-hidden="true" href="#cb5-2" tabindex="-1"&gt;&lt;/a&gt;(&lt;span class="kw"&gt;let&lt;/span&gt; ((all-sum &lt;span class="dv"&gt;0&lt;/span&gt;))&lt;/span&gt;
&lt;span id="cb5-3"&gt;&lt;a aria-hidden="true" href="#cb5-3" tabindex="-1"&gt;&lt;/a&gt;    (&lt;span class="kw"&gt;dotimes&lt;/span&gt; (i &lt;span class="dv"&gt;1000&lt;/span&gt;)&lt;/span&gt;
&lt;span id="cb5-4"&gt;&lt;a aria-hidden="true" href="#cb5-4" tabindex="-1"&gt;&lt;/a&gt;    (&lt;span class="kw"&gt;if&lt;/span&gt; (&lt;span class="kw"&gt;or&lt;/span&gt; (&lt;span class="op"&gt;=&lt;/span&gt; (&lt;span class="kw"&gt;rem&lt;/span&gt; i &lt;span class="dv"&gt;3&lt;/span&gt;) &lt;span class="dv"&gt;0&lt;/span&gt;) (&lt;span class="op"&gt;=&lt;/span&gt; (&lt;span class="kw"&gt;rem&lt;/span&gt; i &lt;span class="dv"&gt;5&lt;/span&gt;) &lt;span class="dv"&gt;0&lt;/span&gt;))&lt;/span&gt;
&lt;span id="cb5-5"&gt;&lt;a aria-hidden="true" href="#cb5-5" tabindex="-1"&gt;&lt;/a&gt;        (&lt;span class="kw"&gt;setf&lt;/span&gt; all-sum (&lt;span class="op"&gt;+&lt;/span&gt; all-sum i))))&lt;/span&gt;
&lt;span id="cb5-6"&gt;&lt;a aria-hidden="true" href="#cb5-6" tabindex="-1"&gt;&lt;/a&gt;    (&lt;span class="kw"&gt;print&lt;/span&gt; all-sum)))&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;dolist&lt;/code&gt; 则类似 &lt;code&gt;for i in elements:&lt;/code&gt; 这样：&lt;/p&gt;
&lt;div class="sourceCode" id="cb6"&gt;&lt;pre class="sourceCode lisp"&gt;&lt;code class="sourceCode commonlisp"&gt;&lt;span id="cb6-1"&gt;&lt;a aria-hidden="true" href="#cb6-1" tabindex="-1"&gt;&lt;/a&gt; (&lt;span class="kw"&gt;dolist&lt;/span&gt; (x '(&lt;span class="dv"&gt;1&lt;/span&gt; &lt;span class="dv"&gt;2&lt;/span&gt; &lt;span class="dv"&gt;3&lt;/span&gt;)) (&lt;span class="kw"&gt;print&lt;/span&gt; x))&lt;/span&gt;
&lt;span id="cb6-2"&gt;&lt;a aria-hidden="true" href="#cb6-2" tabindex="-1"&gt;&lt;/a&gt; &lt;span class="co"&gt;; 使用 return 中断：&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb6-3"&gt;&lt;a aria-hidden="true" href="#cb6-3" tabindex="-1"&gt;&lt;/a&gt; (&lt;span class="kw"&gt;dolist&lt;/span&gt; (x '(&lt;span class="dv"&gt;1&lt;/span&gt; &lt;span class="dv"&gt;2&lt;/span&gt; &lt;span class="dv"&gt;3&lt;/span&gt;)) (&lt;span class="kw"&gt;print&lt;/span&gt; x) (&lt;span class="kw"&gt;if&lt;/span&gt; (&lt;span class="kw"&gt;evenp&lt;/span&gt; x) (&lt;span class="kw"&gt;return&lt;/span&gt;)))&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="do"&gt;&lt;code&gt;do&lt;/code&gt;&lt;/h2&gt;
&lt;p&gt;最基本的迭代操作符是 &lt;code&gt;do&lt;/code&gt;，它可以同时迭代多个值，其基本形式如下：&lt;/p&gt;
&lt;div class="sourceCode" id="cb7"&gt;&lt;pre class="sourceCode lisp"&gt;&lt;code class="sourceCode commonlisp"&gt;&lt;span id="cb7-1"&gt;&lt;a aria-hidden="true" href="#cb7-1" tabindex="-1"&gt;&lt;/a&gt;(&lt;span class="kw"&gt;do&lt;/span&gt; (variable-definition*)&lt;/span&gt;
&lt;span id="cb7-2"&gt;&lt;a aria-hidden="true" href="#cb7-2" tabindex="-1"&gt;&lt;/a&gt;    (end-test-form result-form*)&lt;/span&gt;
&lt;span id="cb7-3"&gt;&lt;a aria-hidden="true" href="#cb7-3" tabindex="-1"&gt;&lt;/a&gt;    statement*)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;这个 &lt;code&gt;do&lt;/code&gt; 有些晦涩难懂，第一个 &lt;code&gt;variable-defamations&lt;/code&gt; 是一个列表，内容是 &lt;code&gt;(variable  initial  update)&lt;/code&gt;，&lt;code&gt;initial&lt;/code&gt; 与 &lt;code&gt;update&lt;/code&gt; 形式是选择性的。若 &lt;code&gt;update&lt;/code&gt; 形式忽略时，每次迭代时不会更新变量。若 &lt;code&gt;initial&lt;/code&gt; 形式也忽略时，变量会使用 &lt;code&gt;nil&lt;/code&gt; 来初始化。,例如：&lt;/p&gt;
&lt;div class="sourceCode" id="cb8"&gt;&lt;pre class="sourceCode lisp"&gt;&lt;code class="sourceCode commonlisp"&gt;&lt;span id="cb8-1"&gt;&lt;a aria-hidden="true" href="#cb8-1" tabindex="-1"&gt;&lt;/a&gt;( &lt;/span&gt;
&lt;span id="cb8-2"&gt;&lt;a aria-hidden="true" href="#cb8-2" tabindex="-1"&gt;&lt;/a&gt;    (x &lt;span class="dv"&gt;1&lt;/span&gt; (&lt;span class="kw"&gt;incf&lt;/span&gt; x))  &lt;span class="co"&gt;; 初始值 1&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb8-3"&gt;&lt;a aria-hidden="true" href="#cb8-3" tabindex="-1"&gt;&lt;/a&gt;    (y &lt;span class="dv"&gt;10&lt;/span&gt; (&lt;span class="kw"&gt;decf&lt;/span&gt; y)) &lt;span class="co"&gt;; 初始值 10&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb8-4"&gt;&lt;a aria-hidden="true" href="#cb8-4" tabindex="-1"&gt;&lt;/a&gt;    (z &lt;span class="dv"&gt;0&lt;/span&gt; (&lt;span class="op"&gt;*&lt;/span&gt; x y))   &lt;span class="co"&gt;; 初始值 0&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb8-5"&gt;&lt;a aria-hidden="true" href="#cb8-5" tabindex="-1"&gt;&lt;/a&gt;    (i) &lt;span class="co"&gt;; 初始值 nil&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb8-6"&gt;&lt;a aria-hidden="true" href="#cb8-6" tabindex="-1"&gt;&lt;/a&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;这就定义了三个变量。接下来是 &lt;code&gt;end-test-form&lt;/code&gt; 中止条件，它也许要被括号括起来，因此，一个类似这样的 c 代码：&lt;/p&gt;
&lt;div class="sourceCode" id="cb9"&gt;&lt;pre class="sourceCode c"&gt;&lt;code class="sourceCode c"&gt;&lt;span id="cb9-1"&gt;&lt;a aria-hidden="true" href="#cb9-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="pp"&gt;#include &lt;/span&gt;&lt;span class="im"&gt;&amp;lt;stdio.h&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb9-2"&gt;&lt;a aria-hidden="true" href="#cb9-2" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb9-3"&gt;&lt;a aria-hidden="true" href="#cb9-3" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="dt"&gt;int&lt;/span&gt; func&lt;span class="op"&gt;(&lt;/span&gt;&lt;span class="dt"&gt;int&lt;/span&gt; target&lt;span class="op"&gt;){&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb9-4"&gt;&lt;a aria-hidden="true" href="#cb9-4" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="dt"&gt;int&lt;/span&gt; sum &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="dv"&gt;0&lt;/span&gt;&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb9-5"&gt;&lt;a aria-hidden="true" href="#cb9-5" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="cf"&gt;for&lt;/span&gt; &lt;span class="op"&gt;(&lt;/span&gt;&lt;span class="dt"&gt;int&lt;/span&gt; i&lt;span class="op"&gt;=&lt;/span&gt;&lt;span class="dv"&gt;0&lt;/span&gt;&lt;span class="op"&gt;;&lt;/span&gt;i&lt;span class="op"&gt;&amp;lt;&lt;/span&gt;target&lt;span class="op"&gt;;&lt;/span&gt;i&lt;span class="op"&gt;++){&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb9-6"&gt;&lt;a aria-hidden="true" href="#cb9-6" tabindex="-1"&gt;&lt;/a&gt;        sum &lt;span class="op"&gt;+=&lt;/span&gt; i&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb9-7"&gt;&lt;a aria-hidden="true" href="#cb9-7" tabindex="-1"&gt;&lt;/a&gt;        printf&lt;span class="op"&gt;(&lt;/span&gt;&lt;span class="st"&gt;"&lt;/span&gt;&lt;span class="sc"&gt;%d\n&lt;/span&gt;&lt;span class="st"&gt;"&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt; i&lt;span class="op"&gt;);&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb9-8"&gt;&lt;a aria-hidden="true" href="#cb9-8" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="op"&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb9-9"&gt;&lt;a aria-hidden="true" href="#cb9-9" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="cf"&gt;return&lt;/span&gt; sum&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb9-10"&gt;&lt;a aria-hidden="true" href="#cb9-10" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="op"&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;可以写成：&lt;/p&gt;
&lt;div class="sourceCode" id="cb10"&gt;&lt;pre class="sourceCode lisp"&gt;&lt;code class="sourceCode commonlisp"&gt;&lt;span id="cb10-1"&gt;&lt;a aria-hidden="true" href="#cb10-1" tabindex="-1"&gt;&lt;/a&gt;(&lt;span class="kw"&gt;defun&lt;/span&gt;&lt;span class="fu"&gt; func &lt;/span&gt;(target)&lt;/span&gt;
&lt;span id="cb10-2"&gt;&lt;a aria-hidden="true" href="#cb10-2" tabindex="-1"&gt;&lt;/a&gt;  (&lt;span class="kw"&gt;do&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb10-3"&gt;&lt;a aria-hidden="true" href="#cb10-3" tabindex="-1"&gt;&lt;/a&gt;   &lt;span class="co"&gt;;; variable-definitions&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb10-4"&gt;&lt;a aria-hidden="true" href="#cb10-4" tabindex="-1"&gt;&lt;/a&gt;   ((i &lt;span class="dv"&gt;0&lt;/span&gt; (&lt;span class="kw"&gt;incf&lt;/span&gt; i))(sum &lt;span class="dv"&gt;0&lt;/span&gt; (&lt;span class="op"&gt;+&lt;/span&gt; i sum)))&lt;/span&gt;
&lt;span id="cb10-5"&gt;&lt;a aria-hidden="true" href="#cb10-5" tabindex="-1"&gt;&lt;/a&gt;   &lt;span class="co"&gt;;; end-test-form and result-form&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb10-6"&gt;&lt;a aria-hidden="true" href="#cb10-6" tabindex="-1"&gt;&lt;/a&gt;   ((&lt;span class="op"&gt;=&lt;/span&gt; i target) sum)&lt;/span&gt;
&lt;span id="cb10-7"&gt;&lt;a aria-hidden="true" href="#cb10-7" tabindex="-1"&gt;&lt;/a&gt;   &lt;span class="co"&gt;;; no statements&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb10-8"&gt;&lt;a aria-hidden="true" href="#cb10-8" tabindex="-1"&gt;&lt;/a&gt;   (&lt;span class="kw"&gt;format&lt;/span&gt; &lt;span class="kw"&gt;t&lt;/span&gt; &lt;span class="st"&gt;"~d"&lt;/span&gt; i)&lt;/span&gt;
&lt;span id="cb10-9"&gt;&lt;a aria-hidden="true" href="#cb10-9" tabindex="-1"&gt;&lt;/a&gt;   ))&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;记住 do 需要三个部分即可，&lt;strong&gt;哪怕其中没有需要操作的表达式&lt;/strong&gt;：&lt;/p&gt;
&lt;div class="sourceCode" id="cb11"&gt;&lt;pre class="sourceCode lisp"&gt;&lt;code class="sourceCode commonlisp"&gt;&lt;span id="cb11-1"&gt;&lt;a aria-hidden="true" href="#cb11-1" tabindex="-1"&gt;&lt;/a&gt; (&lt;span class="kw"&gt;do&lt;/span&gt; () ((&lt;span class="op"&gt;=&lt;/span&gt; (&lt;span class="kw"&gt;random&lt;/span&gt; &lt;span class="dv"&gt;10&lt;/span&gt;) (&lt;span class="kw"&gt;random&lt;/span&gt; &lt;span class="dv"&gt;10&lt;/span&gt;))) (&lt;span class="kw"&gt;print&lt;/span&gt; &lt;span class="st"&gt;""&lt;/span&gt;))&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;简单来一个鸡兔同笼：&lt;/p&gt;
&lt;div class="sourceCode" id="cb12"&gt;&lt;pre class="sourceCode lisp"&gt;&lt;code class="sourceCode commonlisp"&gt;&lt;span id="cb12-1"&gt;&lt;a aria-hidden="true" href="#cb12-1" tabindex="-1"&gt;&lt;/a&gt;(&lt;span class="kw"&gt;defun&lt;/span&gt;&lt;span class="fu"&gt; solve &lt;/span&gt;()&lt;/span&gt;
&lt;span id="cb12-2"&gt;&lt;a aria-hidden="true" href="#cb12-2" tabindex="-1"&gt;&lt;/a&gt;  (&lt;span class="kw"&gt;do&lt;/span&gt; ((chicken &lt;span class="dv"&gt;1&lt;/span&gt; (&lt;span class="kw"&gt;incf&lt;/span&gt; chicken))&lt;/span&gt;
&lt;span id="cb12-3"&gt;&lt;a aria-hidden="true" href="#cb12-3" tabindex="-1"&gt;&lt;/a&gt;       (rabbit &lt;span class="dv"&gt;34&lt;/span&gt; (&lt;span class="kw"&gt;decf&lt;/span&gt; rabbit)))&lt;/span&gt;
&lt;span id="cb12-4"&gt;&lt;a aria-hidden="true" href="#cb12-4" tabindex="-1"&gt;&lt;/a&gt;      ((&lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="dv"&gt;94&lt;/span&gt; (&lt;span class="op"&gt;+&lt;/span&gt; (&lt;span class="op"&gt;*&lt;/span&gt; chicken &lt;span class="dv"&gt;2&lt;/span&gt;) (&lt;span class="op"&gt;*&lt;/span&gt; rabbit &lt;span class="dv"&gt;4&lt;/span&gt;)))&lt;/span&gt;
&lt;span id="cb12-5"&gt;&lt;a aria-hidden="true" href="#cb12-5" tabindex="-1"&gt;&lt;/a&gt;       (&lt;span class="kw"&gt;list&lt;/span&gt; :chicken chicken :rabbit rabbit))))&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;再举一例，计算斐波纳契数列：&lt;/p&gt;
&lt;div class="sourceCode" id="cb13"&gt;&lt;pre class="sourceCode lisp"&gt;&lt;code class="sourceCode commonlisp"&gt;&lt;span id="cb13-1"&gt;&lt;a aria-hidden="true" href="#cb13-1" tabindex="-1"&gt;&lt;/a&gt;(&lt;span class="kw"&gt;defun&lt;/span&gt;&lt;span class="fu"&gt; fib &lt;/span&gt;(stop)&lt;/span&gt;
&lt;span id="cb13-2"&gt;&lt;a aria-hidden="true" href="#cb13-2" tabindex="-1"&gt;&lt;/a&gt;  (&lt;span class="kw"&gt;do&lt;/span&gt; ((n &lt;span class="dv"&gt;0&lt;/span&gt; (&lt;span class="op"&gt;+&lt;/span&gt; &lt;span class="dv"&gt;1&lt;/span&gt; n))&lt;/span&gt;
&lt;span id="cb13-3"&gt;&lt;a aria-hidden="true" href="#cb13-3" tabindex="-1"&gt;&lt;/a&gt;       (cur &lt;span class="dv"&gt;0&lt;/span&gt; next)&lt;/span&gt;
&lt;span id="cb13-4"&gt;&lt;a aria-hidden="true" href="#cb13-4" tabindex="-1"&gt;&lt;/a&gt;       (next &lt;span class="dv"&gt;1&lt;/span&gt; (&lt;span class="op"&gt;+&lt;/span&gt; cur next)))&lt;/span&gt;
&lt;span id="cb13-5"&gt;&lt;a aria-hidden="true" href="#cb13-5" tabindex="-1"&gt;&lt;/a&gt;      ((&lt;span class="op"&gt;=&lt;/span&gt; stop n) cur)&lt;/span&gt;
&lt;span id="cb13-6"&gt;&lt;a aria-hidden="true" href="#cb13-6" tabindex="-1"&gt;&lt;/a&gt;    (&lt;span class="kw"&gt;print&lt;/span&gt; cur)))&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id="loop"&gt;&lt;code&gt;loop&lt;/code&gt;&lt;/h2&gt;
&lt;p&gt;很少有人能够真的搞懂 &lt;code&gt;loop&lt;/code&gt; 的全部，这玩意是属于「高阶魔法」，比如， &lt;code&gt;loop&lt;/code&gt; 可以写成这样的形式：&lt;/p&gt;
&lt;div class="sourceCode" id="cb14"&gt;&lt;pre class="sourceCode lisp"&gt;&lt;code class="sourceCode commonlisp"&gt;&lt;span id="cb14-1"&gt;&lt;a aria-hidden="true" href="#cb14-1" tabindex="-1"&gt;&lt;/a&gt; (&lt;span class="kw"&gt;loop&lt;/span&gt; for i from &lt;span class="dv"&gt;1&lt;/span&gt; to &lt;span class="dv"&gt;10&lt;/span&gt; collecting i)&lt;/span&gt;
&lt;span id="cb14-2"&gt;&lt;a aria-hidden="true" href="#cb14-2" tabindex="-1"&gt;&lt;/a&gt; (&lt;span class="kw"&gt;loop&lt;/span&gt; for x across &lt;span class="st"&gt;"the quick brown fox jumps over the lazy dog"&lt;/span&gt; counting (&lt;span class="kw"&gt;find&lt;/span&gt; x &lt;span class="st"&gt;"aeiou"&lt;/span&gt;))&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;code&gt;loop&lt;/code&gt; 提供了诸如「&lt;code&gt;across&lt;/code&gt;、 &lt;code&gt;and&lt;/code&gt; 、 &lt;code&gt;below&lt;/code&gt; 、 &lt;code&gt;collecting&lt;/code&gt; 、 &lt;code&gt;counting&lt;/code&gt; 、 &lt;code&gt;finally&lt;/code&gt; 、 &lt;code&gt;for&lt;/code&gt; 、 &lt;code&gt;from&lt;/code&gt; 、 &lt;code&gt;summing&lt;/code&gt; 、 &lt;code&gt;then&lt;/code&gt;」这样的关键字，实际上是一个专门用来写循环迭代的新的语言。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;如果你是曾经计划某天要理解 loop 怎么工作的许多 Lisp 程序员之一，有一些好消息与坏消息。好消息是你并不孤单：几乎没有人理解它。坏消息是你永远不会理解它，因为 ANSI 标准实际上并没有给出它行为的正式规范。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;这个宏唯一的实际定义是它的实现方式，而唯一可以理解它（如果有人可以理解的话）的方法是通过实例。ANSI 标准讨论 loop 的章节大部分由例子组成&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-0"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-0" type="checkbox"&gt;&lt;span class="sidenote"&gt;这段评价的来源是 《ANSI Common Lisp 中文版》 第十四章：进阶议题&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/input&gt;&lt;/span&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;最基础的 &lt;code&gt;loop&lt;/code&gt; 句法是 &lt;code&gt;for&lt;/code&gt; 句法，示例：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;遍历一个列表：&lt;/p&gt;
&lt;p&gt;&lt;code&gt;(loop for i in '(1 2 3 4) do (print i))&lt;/code&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;遍历多个范围：&lt;/p&gt;
&lt;p&gt;&lt;code&gt;(loop for i from 1 to 10 for j from 1 to 10 do (print i))&lt;/code&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;控制起始和更新形式：&lt;/p&gt;
&lt;div class="sourceCode" id="cb15"&gt;&lt;pre class="sourceCode lisp"&gt;&lt;code class="sourceCode commonlisp"&gt;&lt;span id="cb15-1"&gt;&lt;a aria-hidden="true" href="#cb15-1" tabindex="-1"&gt;&lt;/a&gt;(&lt;span class="kw"&gt;loop&lt;/span&gt; for x &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="dv"&gt;8&lt;/span&gt; then (&lt;span class="op"&gt;/&lt;/span&gt; x &lt;span class="dv"&gt;2&lt;/span&gt;)&lt;/span&gt;
&lt;span id="cb15-2"&gt;&lt;a aria-hidden="true" href="#cb15-2" tabindex="-1"&gt;&lt;/a&gt;    until (&lt;span class="op"&gt;&amp;lt;&lt;/span&gt; x &lt;span class="dv"&gt;1&lt;/span&gt;)&lt;/span&gt;
&lt;span id="cb15-3"&gt;&lt;a aria-hidden="true" href="#cb15-3" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="kw"&gt;do&lt;/span&gt; (&lt;span class="kw"&gt;princ&lt;/span&gt; x))&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;各种谓词：&lt;/p&gt;
&lt;div class="sourceCode" id="cb16"&gt;&lt;pre class="sourceCode lisp"&gt;&lt;code class="sourceCode commonlisp"&gt;&lt;span id="cb16-1"&gt;&lt;a aria-hidden="true" href="#cb16-1" tabindex="-1"&gt;&lt;/a&gt;(&lt;span class="kw"&gt;loop&lt;/span&gt; for i from &lt;span class="dv"&gt;0&lt;/span&gt; downto -10 collect i)&lt;/span&gt;
&lt;span id="cb16-2"&gt;&lt;a aria-hidden="true" href="#cb16-2" tabindex="-1"&gt;&lt;/a&gt;(&lt;span class="kw"&gt;loop&lt;/span&gt; for i from &lt;span class="dv"&gt;10&lt;/span&gt; to &lt;span class="dv"&gt;20&lt;/span&gt; collect i)&lt;/span&gt;
&lt;span id="cb16-3"&gt;&lt;a aria-hidden="true" href="#cb16-3" tabindex="-1"&gt;&lt;/a&gt;(&lt;span class="kw"&gt;loop&lt;/span&gt; for i downfrom &lt;span class="dv"&gt;20&lt;/span&gt; to &lt;span class="dv"&gt;10&lt;/span&gt; &lt;span class="kw"&gt;do&lt;/span&gt; (&lt;span class="kw"&gt;print&lt;/span&gt; i))&lt;/span&gt;
&lt;span id="cb16-4"&gt;&lt;a aria-hidden="true" href="#cb16-4" tabindex="-1"&gt;&lt;/a&gt;(&lt;span class="kw"&gt;loop&lt;/span&gt; for x in '(&lt;span class="dv"&gt;1&lt;/span&gt; &lt;span class="dv"&gt;2&lt;/span&gt; &lt;span class="dv"&gt;3&lt;/span&gt; &lt;span class="dv"&gt;4&lt;/span&gt; &lt;span class="dv"&gt;5&lt;/span&gt;)&lt;/span&gt;
&lt;span id="cb16-5"&gt;&lt;a aria-hidden="true" href="#cb16-5" tabindex="-1"&gt;&lt;/a&gt;  while (&lt;span class="op"&gt;&amp;lt;&lt;/span&gt; x &lt;span class="dv"&gt;4&lt;/span&gt;)&lt;/span&gt;
&lt;span id="cb16-6"&gt;&lt;a aria-hidden="true" href="#cb16-6" tabindex="-1"&gt;&lt;/a&gt;  collect x)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;列表的过滤：&lt;/p&gt;
&lt;div class="sourceCode" id="cb17"&gt;&lt;pre class="sourceCode lisp"&gt;&lt;code class="sourceCode commonlisp"&gt;&lt;span id="cb17-1"&gt;&lt;a aria-hidden="true" href="#cb17-1" tabindex="-1"&gt;&lt;/a&gt;(&lt;span class="kw"&gt;loop&lt;/span&gt; for i in (&lt;span class="kw"&gt;list&lt;/span&gt; &lt;span class="dv"&gt;10&lt;/span&gt; &lt;span class="dv"&gt;20&lt;/span&gt; &lt;span class="dv"&gt;30&lt;/span&gt; &lt;span class="dv"&gt;40&lt;/span&gt;) by &lt;span class="op"&gt;#'&lt;/span&gt;cddr collect i) -&amp;gt; (&lt;span class="dv"&gt;10&lt;/span&gt; &lt;span class="dv"&gt;30&lt;/span&gt;)&lt;/span&gt;
&lt;span id="cb17-2"&gt;&lt;a aria-hidden="true" href="#cb17-2" tabindex="-1"&gt;&lt;/a&gt;(&lt;span class="kw"&gt;loop&lt;/span&gt; for x on (&lt;span class="kw"&gt;list&lt;/span&gt; &lt;span class="dv"&gt;10&lt;/span&gt; &lt;span class="dv"&gt;20&lt;/span&gt; &lt;span class="dv"&gt;30&lt;/span&gt;) collect x) -&amp;gt; ((&lt;span class="dv"&gt;10&lt;/span&gt; &lt;span class="dv"&gt;20&lt;/span&gt; &lt;span class="dv"&gt;30&lt;/span&gt;) (&lt;span class="dv"&gt;20&lt;/span&gt; &lt;span class="dv"&gt;30&lt;/span&gt;) (&lt;span class="dv"&gt;30&lt;/span&gt;))&lt;/span&gt;
&lt;span id="cb17-3"&gt;&lt;a aria-hidden="true" href="#cb17-3" tabindex="-1"&gt;&lt;/a&gt;(&lt;span class="kw"&gt;loop&lt;/span&gt; for x on (&lt;span class="kw"&gt;list&lt;/span&gt; &lt;span class="dv"&gt;10&lt;/span&gt; &lt;span class="dv"&gt;20&lt;/span&gt; &lt;span class="dv"&gt;30&lt;/span&gt; &lt;span class="dv"&gt;40&lt;/span&gt;) by &lt;span class="op"&gt;#'&lt;/span&gt;cddr collect x) -&amp;gt; ((&lt;span class="dv"&gt;10&lt;/span&gt; &lt;span class="dv"&gt;20&lt;/span&gt; &lt;span class="dv"&gt;30&lt;/span&gt; &lt;span class="dv"&gt;40&lt;/span&gt;) (&lt;span class="dv"&gt;30&lt;/span&gt; &lt;span class="dv"&gt;40&lt;/span&gt;))&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;解构：&lt;/p&gt;
&lt;div class="sourceCode" id="cb18"&gt;&lt;pre class="sourceCode lisp"&gt;&lt;code class="sourceCode commonlisp"&gt;&lt;span id="cb18-1"&gt;&lt;a aria-hidden="true" href="#cb18-1" tabindex="-1"&gt;&lt;/a&gt;  (&lt;span class="kw"&gt;loop&lt;/span&gt; for (a &lt;span class="kw"&gt;nil&lt;/span&gt;) in '((&lt;span class="dv"&gt;1&lt;/span&gt; &lt;span class="dv"&gt;2&lt;/span&gt;) (&lt;span class="dv"&gt;3&lt;/span&gt; &lt;span class="dv"&gt;4&lt;/span&gt;) (&lt;span class="dv"&gt;5&lt;/span&gt; &lt;span class="dv"&gt;6&lt;/span&gt;)) collect a) →(&lt;span class="dv"&gt;1&lt;/span&gt; &lt;span class="dv"&gt;3&lt;/span&gt; &lt;span class="dv"&gt;5&lt;/span&gt;)&lt;/span&gt;
&lt;span id="cb18-2"&gt;&lt;a aria-hidden="true" href="#cb18-2" tabindex="-1"&gt;&lt;/a&gt;  (&lt;span class="kw"&gt;loop&lt;/span&gt; for (a b) in '((&lt;span class="dv"&gt;1&lt;/span&gt; &lt;span class="dv"&gt;2&lt;/span&gt;) (&lt;span class="dv"&gt;3&lt;/span&gt; &lt;span class="dv"&gt;4&lt;/span&gt;) (&lt;span class="dv"&gt;5&lt;/span&gt; &lt;span class="dv"&gt;6&lt;/span&gt;)) &lt;span class="kw"&gt;do&lt;/span&gt; (&lt;span class="kw"&gt;format&lt;/span&gt; &lt;span class="kw"&gt;t&lt;/span&gt; &lt;span class="st"&gt;"a: ~a; b: ~a~%"&lt;/span&gt; a b))&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;条件执行：&lt;/p&gt;
&lt;div class="sourceCode" id="cb19"&gt;&lt;pre class="sourceCode lisp"&gt;&lt;code class="sourceCode commonlisp"&gt;&lt;span id="cb19-1"&gt;&lt;a aria-hidden="true" href="#cb19-1" tabindex="-1"&gt;&lt;/a&gt;(&lt;span class="kw"&gt;loop&lt;/span&gt; for i from &lt;span class="dv"&gt;1&lt;/span&gt; to &lt;span class="dv"&gt;10&lt;/span&gt; &lt;span class="kw"&gt;do&lt;/span&gt; (&lt;span class="kw"&gt;when&lt;/span&gt; (&lt;span class="kw"&gt;evenp&lt;/span&gt; i) (&lt;span class="kw"&gt;print&lt;/span&gt; i)))&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;学 &lt;code&gt;loop&lt;/code&gt; 要多用它（&lt;/p&gt;
&lt;br/&gt;
&lt;!--%%REF%%--&gt;
&lt;br/&gt;
&lt;script async="" crossorigin="anonymous" data-category="Announcements" data-category-id="DIC_kwDOJ7Ymy84CX4eg" data-emit-metadata="0" data-input-position="top" data-lang="zh-CN" data-loading="lazy" data-mapping="title" data-reactions-enabled="1" data-repo="izfsk-ium/izfsk-ium.github.io" data-repo-id="R_kgDOJ7Ymyw" data-strict="0" data-theme="preferred_color_scheme" src="https://giscus.app/client.js"&gt;
&lt;/script&gt;
&lt;/main&gt;
&lt;footer&gt;
&lt;p class="signoff"&gt;
&lt;div class="metadata"&gt;
&lt;p class="date"&gt;&lt;time datetime="2023-01-19"&gt;创建日期：2023-01-19&lt;/time&gt;&lt;/p&gt;
&lt;p class="lastmodify"&gt;&lt;time&gt;最后编译：2023-08-10&lt;/time&gt;&lt;/p&gt;
&lt;p class="lastmodify" id="counter-span"&gt;访问次数：&lt;/p&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;/footer&gt;
&lt;script&gt;
    /* These script should run after page load */
    document.querySelectorAll('code.sourceCode').forEach(
      i =&gt; i.insertAdjacentHTML('beforeend', '&lt;div class="copy"&gt;复制&lt;/div&gt;')
    );
    document.querySelectorAll('div.copy').forEach(
      i =&gt; i.addEventListener(
        'click',
        () =&gt; {
          navigator.clipboard.writeText(i.parentElement.innerText.replace('复制', ''));
          i.innerText = '成功';
          setTimeout(() =&gt; {
            i.innerText = '复制';
          }, 1000);
        }
      )
    );

    if (location.href.includes("127.0.0.1:8080")) {
      document.getElementById("counter-span").innerHTML = "[[development mode]]";
    } else {
      const uuid = document.getElementById("article-uuid").innerText;
      const target = document.getElementById("counter-span");
      const last = localStorage.getItem("lastVisit-" + uuid);
      const shouldIncrease = last === null || new Date().getTime() - parseInt(last) &gt;= (1000 * 60 * 15);

      fetch(shouldIncrease ? ("https://counter.izfsk.top/counter/" + uuid) : ("https://counter.izfsk.top/readOnly/" + uuid))
        .then(r =&gt; r.text())
        .then(d =&gt; {
          if (!d.startsWith("Too"))
            document.getElementById("counter-span").innerText = "访问次数：" + d.toString();
          else
            document.getElementById("counter-span").innerHTML = "";
        });

      localStorage.setItem("lastVisit-" + uuid, new Date().getTime());
    }
  &lt;/script&gt;
&lt;script async="" data-website-id="2a1146ab-fa82-4a84-a04f-30e5967357c3" src="https://analytics.umami.is/script.js"&gt;&lt;/script&gt;
&lt;/body&gt;</content:encoded>
      <guid isPermaLink="false">41a43b0c-279b-438f-9ee6-dbe98965ce46</guid>
      <pubDate>Thu, 19 Jan 2023 00:00:00 +0800</pubDate>
    </item>
    <item>
      <title>CommonLisp基础-常见操作</title>
      <link>https://blog.izfsk.top/articles/CommonLisp基础-常见操作.html</link>
      <description>CommonLisp基础-常见操作</description>
      <content:encoded>&lt;body&gt;
&lt;progress id="content_progress" value="0"&gt;&lt;/progress&gt;
&lt;button id="back-to-top"&gt;
    回页顶
  &lt;/button&gt;
&lt;header&gt;
&lt;small id="article-uuid" style="display: none !important;"&gt;704f2611-4448-4f94-a4c1-7b797aad7a43&lt;/small&gt;
&lt;h1 class="title"&gt;CommonLisp基础-常见操作&lt;/h1&gt;
&lt;!-- Subtitle --&gt;
&lt;h3 class="subtitle"&gt; &lt;/h3&gt;
&lt;/header&gt;
&lt;nav id="TOC" role="doc-toc"&gt;
&lt;strong&gt;文章归类: &lt;a href="/pages/category.html#学习"&gt;学习&lt;/a&gt; &lt;/strong&gt;
&lt;input id="contents" type="checkbox"/&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#字符串操作" id="toc-字符串操作"&gt;字符串操作&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#创建字符串" id="toc-创建字符串"&gt;创建字符串&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#字符串切片" id="toc-字符串切片"&gt;字符串切片&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#获取单个字符" id="toc-获取单个字符"&gt;获取单个字符&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#获取字符的码位" id="toc-获取字符的码位"&gt;获取字符的码位&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#更改字符串" id="toc-更改字符串"&gt;更改字符串&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#移除和替换" id="toc-移除和替换"&gt;移除和替换&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#字符串拼接" id="toc-字符串拼接"&gt;字符串拼接&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#大小写" id="toc-大小写"&gt;大小写&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#去除空格" id="toc-去除空格"&gt;去除空格&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#寻找和搜索" id="toc-寻找和搜索"&gt;寻找和搜索&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#类型转换" id="toc-类型转换"&gt;类型转换&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#字符串切分" id="toc-字符串切分"&gt;字符串切分&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#输入输出" id="toc-输入输出"&gt;输入输出&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#format" id="toc-format"&gt;&lt;code&gt;format&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#文件" id="toc-文件"&gt;文件&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#参考" id="toc-参考"&gt;参考&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#reference"&gt;参考链接&lt;/a&gt;&lt;/li&gt;
&lt;li&gt; &lt;/li&gt;
&lt;li class="tools"&gt;
&lt;span id="backtomain"&gt;
&lt;svg class="bi bi-house" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M8.707 1.5a1 1 0 0 0-1.414 0L.646 8.146a.5.5 0 0 0 .708.708L2 8.207V13.5A1.5 1.5 0 0 0 3.5 15h9a1.5 1.5 0 0 0 1.5-1.5V8.207l.646.647a.5.5 0 0 0 .708-.708L13 5.793V2.5a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v1.293L8.707 1.5ZM13 7.207V13.5a.5.5 0 0 1-.5.5h-9a.5.5 0 0 1-.5-.5V7.207l5-5 5 5Z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="readingmode"&gt;
&lt;svg class="bi bi-book" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M1 2.828c.885-.37 2.154-.769 3.388-.893 1.33-.134 2.458.063 3.112.752v9.746c-.935-.53-2.12-.603-3.213-.493-1.18.12-2.37.461-3.287.811V2.828zm7.5-.141c.654-.689 1.782-.886 3.112-.752 1.234.124 2.503.523 3.388.893v9.923c-.918-.35-2.107-.692-3.287-.81-1.094-.111-2.278-.039-3.213.492V2.687zM8 1.783C7.015.936 5.587.81 4.287.94c-1.514.153-3.042.672-3.994 1.105A.5.5 0 0 0 0 2.5v11a.5.5 0 0 0 .707.455c.882-.4 2.303-.881 3.68-1.02 1.409-.142 2.59.087 3.223.877a.5.5 0 0 0 .78 0c.633-.79 1.814-1.019 3.222-.877 1.378.139 2.8.62 3.681 1.02A.5.5 0 0 0 16 13.5v-11a.5.5 0 0 0-.293-.455c-.952-.433-2.48-.952-3.994-1.105C10.413.809 8.985.936 8 1.783z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="larger"&gt; &lt;/span&gt;
&lt;span id="smaller"&gt;&lt;/span&gt;
&lt;span id="switchfont"&gt;
&lt;svg class="bi bi-fonts" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M12.258 3h-8.51l-.083 2.46h.479c.26-1.544.758-1.783 2.693-1.845l.424-.013v7.827c0 .663-.144.82-1.3.923v.52h4.082v-.52c-1.162-.103-1.306-.26-1.306-.923V3.602l.431.013c1.934.062 2.434.301 2.693 1.846h.479L12.258 3z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="backtotop"&gt;
&lt;svg class="bi bi-arrow-bar-up" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M8 10a.5.5 0 0 0 .5-.5V3.707l2.146 2.147a.5.5 0 0 0 .708-.708l-3-3a.5.5 0 0 0-.708 0l-3 3a.5.5 0 1 0 .708.708L7.5 3.707V9.5a.5.5 0 0 0 .5.5zm-7 2.5a.5.5 0 0 1 .5-.5h13a.5.5 0 0 1 0 1h-13a.5.5 0 0 1-.5-.5z" fill-rule="evenodd"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/nav&gt;
&lt;main&gt;
&lt;p&gt;本文记录 CommonLisp 的一些常见操作，记住，&lt;strong&gt;&lt;a href="https://quickdocs.org/uiop"&gt;UIOP&lt;/a&gt; 是你的好朋友&lt;/strong&gt;！&lt;/p&gt;
&lt;h1 id="字符串操作"&gt;字符串操作&lt;/h1&gt;
&lt;p&gt;首先，在 CommonLisp 中，字符串既是 array 也是 sequence。所以，适用于它们的操作也适用于字符串。因此可以使用相应的操作：&lt;/p&gt;
&lt;div class="sourceCode" id="cb1"&gt;&lt;pre class="sourceCode lisp"&gt;&lt;code class="sourceCode commonlisp"&gt;&lt;span id="cb1-1"&gt;&lt;a aria-hidden="true" href="#cb1-1" tabindex="-1"&gt;&lt;/a&gt;(&lt;span class="kw"&gt;length&lt;/span&gt; &lt;span class="st"&gt;"Hello!"&lt;/span&gt;) &lt;span class="co"&gt;;; 6&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-2"&gt;&lt;a aria-hidden="true" href="#cb1-2" tabindex="-1"&gt;&lt;/a&gt;(&lt;span class="kw"&gt;elt&lt;/span&gt; &lt;span class="st"&gt;"Hello!"&lt;/span&gt; &lt;span class="dv"&gt;0&lt;/span&gt;) &lt;span class="co"&gt;;; #\h&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-3"&gt;&lt;a aria-hidden="true" href="#cb1-3" tabindex="-1"&gt;&lt;/a&gt;(&lt;span class="kw"&gt;remove&lt;/span&gt; &lt;span class="ch"&gt;#\a&lt;/span&gt; &lt;span class="st"&gt;"alpha"&lt;/span&gt;) &lt;span class="co"&gt;;; "lph"&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-4"&gt;&lt;a aria-hidden="true" href="#cb1-4" tabindex="-1"&gt;&lt;/a&gt;(&lt;span class="kw"&gt;count-if&lt;/span&gt; &lt;span class="op"&gt;#'&lt;/span&gt;digit-char-p &lt;span class="st"&gt;"Hello!114514"&lt;/span&gt;) &lt;span class="co"&gt;;; 6&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;因此，字符串的拼接：&lt;/p&gt;
&lt;div class="sourceCode" id="cb2"&gt;&lt;pre class="sourceCode lisp"&gt;&lt;code class="sourceCode commonlisp"&gt;&lt;span id="cb2-1"&gt;&lt;a aria-hidden="true" href="#cb2-1" tabindex="-1"&gt;&lt;/a&gt; (&lt;span class="kw"&gt;concatenate&lt;/span&gt; &lt;span class="dt"&gt;'string&lt;/span&gt; &lt;span class="st"&gt;"hello"&lt;/span&gt; &lt;span class="st"&gt;" "&lt;/span&gt; &lt;span class="st"&gt;"world"&lt;/span&gt;) &lt;span class="co"&gt;;; "hello world"&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;其他 String 类型专有的操作：&lt;/p&gt;
&lt;h2 id="创建字符串"&gt;创建字符串&lt;/h2&gt;
&lt;p&gt;使用双引号创建字符串，除此以外，使用 &lt;code&gt;format nil&lt;/code&gt; 返回一个新的字符串，使用 &lt;code&gt;make-string&lt;/code&gt; 创建一个给定长度的字符串，如果需要从一个字符串创建字符，使用 &lt;code&gt;coerce&lt;/code&gt;，反之使用 &lt;code&gt;string&lt;/code&gt;：&lt;/p&gt;
&lt;div class="sourceCode" id="cb3"&gt;&lt;pre class="sourceCode lisp"&gt;&lt;code class="sourceCode commonlisp"&gt;&lt;span id="cb3-1"&gt;&lt;a aria-hidden="true" href="#cb3-1" tabindex="-1"&gt;&lt;/a&gt;(&lt;span class="kw"&gt;string&lt;/span&gt; &lt;span class="st"&gt;"Hello world"&lt;/span&gt;)&lt;/span&gt;
&lt;span id="cb3-2"&gt;&lt;a aria-hidden="true" href="#cb3-2" tabindex="-1"&gt;&lt;/a&gt;(&lt;span class="kw"&gt;format&lt;/span&gt; &lt;span class="kw"&gt;nil&lt;/span&gt; &lt;span class="st"&gt;"Hello!"&lt;/span&gt;) &lt;span class="co"&gt;;; "Hello!"&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb3-3"&gt;&lt;a aria-hidden="true" href="#cb3-3" tabindex="-1"&gt;&lt;/a&gt;(&lt;span class="kw"&gt;coerce&lt;/span&gt; &lt;span class="st"&gt;"a"&lt;/span&gt;) &lt;span class="co"&gt;;; #\a&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb3-4"&gt;&lt;a aria-hidden="true" href="#cb3-4" tabindex="-1"&gt;&lt;/a&gt;(&lt;span class="kw"&gt;make-string&lt;/span&gt; &lt;span class="dv"&gt;3&lt;/span&gt; &lt;span class="bu"&gt;:initial-element&lt;/span&gt; &lt;span class="ch"&gt;#\a&lt;/span&gt;) &lt;span class="co"&gt;;; "aaa" &lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id="字符串切片"&gt;字符串切片&lt;/h2&gt;
&lt;p&gt;使用 &lt;code&gt;subseq&lt;/code&gt; 来获取字符串切片，格式为：&lt;code&gt;(subseq string start end)&lt;/code&gt; ：&lt;/p&gt;
&lt;div class="sourceCode" id="cb4"&gt;&lt;pre class="sourceCode lisp"&gt;&lt;code class="sourceCode commonlisp"&gt;&lt;span id="cb4-1"&gt;&lt;a aria-hidden="true" href="#cb4-1" tabindex="-1"&gt;&lt;/a&gt;(&lt;span class="kw"&gt;subseq&lt;/span&gt; &lt;span class="st"&gt;"hello!"&lt;/span&gt; &lt;span class="dv"&gt;2&lt;/span&gt; &lt;span class="dv"&gt;4&lt;/span&gt;) &lt;span class="co"&gt;;; "ll"&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id="获取单个字符"&gt;获取单个字符&lt;/h2&gt;
&lt;p&gt;除了 &lt;code&gt;elt&lt;/code&gt; 以外也可以使用 &lt;code&gt;char&lt;/code&gt; ，&lt;code&gt;schar&lt;/code&gt;来获取字符串的单个字符，结合 &lt;code&gt;setf&lt;/code&gt; 来做到类似 &lt;code&gt;target[0] = 'A'&lt;/code&gt; 这样的替换：&lt;/p&gt;
&lt;div class="sourceCode" id="cb5"&gt;&lt;pre class="sourceCode lisp"&gt;&lt;code class="sourceCode commonlisp"&gt;&lt;span id="cb5-1"&gt;&lt;a aria-hidden="true" href="#cb5-1" tabindex="-1"&gt;&lt;/a&gt;(&lt;span class="kw"&gt;char&lt;/span&gt; &lt;span class="st"&gt;"你好"&lt;/span&gt; &lt;span class="dv"&gt;0&lt;/span&gt;) &lt;span class="co"&gt;;; #\U4F60&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb5-2"&gt;&lt;a aria-hidden="true" href="#cb5-2" tabindex="-1"&gt;&lt;/a&gt;(&lt;span class="kw"&gt;setf&lt;/span&gt; (&lt;span class="kw"&gt;char&lt;/span&gt; *some-string* &lt;span class="dv"&gt;6&lt;/span&gt;) &lt;span class="ch"&gt;#\a&lt;/span&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id="获取字符的码位"&gt;获取字符的码位&lt;/h2&gt;
&lt;p&gt;每一个字符都有一个数字和它对应，具体的数字与实现相关，一般就是 Unicode 。&lt;code&gt;code-char&lt;/code&gt; 和 &lt;code&gt;char-code&lt;/code&gt; 类似于 Python 中的 &lt;code&gt;chr&lt;/code&gt; 和 &lt;code&gt;ord&lt;/code&gt; 函数：&lt;/p&gt;
&lt;div class="sourceCode" id="cb6"&gt;&lt;pre class="sourceCode lisp"&gt;&lt;code class="sourceCode commonlisp"&gt;&lt;span id="cb6-1"&gt;&lt;a aria-hidden="true" href="#cb6-1" tabindex="-1"&gt;&lt;/a&gt;(&lt;span class="kw"&gt;code-char&lt;/span&gt; &lt;span class="dv"&gt;124&lt;/span&gt;) &lt;span class="co"&gt;;; #\|&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb6-2"&gt;&lt;a aria-hidden="true" href="#cb6-2" tabindex="-1"&gt;&lt;/a&gt;(&lt;span class="kw"&gt;char-code&lt;/span&gt; &lt;span class="ch"&gt;#\和&lt;/span&gt;) &lt;span class="co"&gt;;; 21644&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id="更改字符串"&gt;更改字符串&lt;/h2&gt;
&lt;h3 id="移除和替换"&gt;移除和替换&lt;/h3&gt;
&lt;p&gt;序列类型的标准操作，可以使用以下操作对字符串进行：&lt;/p&gt;
&lt;div class="sourceCode" id="cb7"&gt;&lt;pre class="sourceCode lisp"&gt;&lt;code class="sourceCode commonlisp"&gt;&lt;span id="cb7-1"&gt;&lt;a aria-hidden="true" href="#cb7-1" tabindex="-1"&gt;&lt;/a&gt;(&lt;span class="kw"&gt;remove&lt;/span&gt; &lt;span class="ch"&gt;#\0&lt;/span&gt; &lt;span class="bu"&gt;:start&lt;/span&gt; &lt;span class="dv"&gt;2&lt;/span&gt; &lt;span class="st"&gt;"0000001"&lt;/span&gt;) &lt;span class="co"&gt;;; "001"&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb7-2"&gt;&lt;a aria-hidden="true" href="#cb7-2" tabindex="-1"&gt;&lt;/a&gt;(&lt;span class="kw"&gt;substitute&lt;/span&gt; &lt;span class="ch"&gt;#\a&lt;/span&gt; &lt;span class="ch"&gt;#\b&lt;/span&gt; &lt;span class="st"&gt;"aaaabbb"&lt;/span&gt;) &lt;span class="co"&gt;;; "aaaaaaa"&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id="字符串拼接"&gt;字符串拼接&lt;/h3&gt;
&lt;p&gt;使用 &lt;code&gt;concatenate&lt;/code&gt; 来拼接字符串，&lt;strong&gt;需要提供结果类型 &lt;code&gt;string&lt;/code&gt;&lt;/strong&gt;：&lt;/p&gt;
&lt;div class="sourceCode" id="cb8"&gt;&lt;pre class="sourceCode lisp"&gt;&lt;code class="sourceCode commonlisp"&gt;&lt;span id="cb8-1"&gt;&lt;a aria-hidden="true" href="#cb8-1" tabindex="-1"&gt;&lt;/a&gt;(&lt;span class="kw"&gt;concatenate&lt;/span&gt; &lt;span class="dt"&gt;'string&lt;/span&gt; &lt;span class="st"&gt;"hello"&lt;/span&gt; &lt;span class="st"&gt;"world"&lt;/span&gt;) &lt;span class="co"&gt;;; "helloworld"&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;如果你有 &lt;code&gt;UIOP&lt;/code&gt; ，使用 &lt;code&gt;uiop:strcat&lt;/code&gt; 亦可，除此以外，不要忘记 &lt;code&gt;format&lt;/code&gt; 可以用来应对复杂的拼接和格式化操作。&lt;/p&gt;
&lt;h2 id="大小写"&gt;大小写&lt;/h2&gt;
&lt;div class="sourceCode" id="cb9"&gt;&lt;pre class="sourceCode lisp"&gt;&lt;code class="sourceCode commonlisp"&gt;&lt;span id="cb9-1"&gt;&lt;a aria-hidden="true" href="#cb9-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="op"&gt;*&lt;/span&gt; (&lt;span class="kw"&gt;string-upcase&lt;/span&gt; &lt;span class="st"&gt;"cool"&lt;/span&gt;)    &lt;span class="co"&gt;;; "COOL"&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb9-2"&gt;&lt;a aria-hidden="true" href="#cb9-2" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="op"&gt;*&lt;/span&gt; (&lt;span class="kw"&gt;string-upcase&lt;/span&gt; &lt;span class="st"&gt;"Cool"&lt;/span&gt;)    &lt;span class="co"&gt;;; "COOL"&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb9-3"&gt;&lt;a aria-hidden="true" href="#cb9-3" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="op"&gt;*&lt;/span&gt; (&lt;span class="kw"&gt;string-downcase&lt;/span&gt; &lt;span class="st"&gt;"COOL"&lt;/span&gt;)    &lt;span class="co"&gt;;; "cool"&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb9-4"&gt;&lt;a aria-hidden="true" href="#cb9-4" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="op"&gt;*&lt;/span&gt; (&lt;span class="kw"&gt;string-downcase&lt;/span&gt; &lt;span class="st"&gt;"Cool"&lt;/span&gt;)    &lt;span class="co"&gt;;;"cool"&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb9-5"&gt;&lt;a aria-hidden="true" href="#cb9-5" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="op"&gt;*&lt;/span&gt; (&lt;span class="kw"&gt;string-capitalize&lt;/span&gt; &lt;span class="st"&gt;"cool"&lt;/span&gt;)    &lt;span class="co"&gt;;;"Cool"&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb9-6"&gt;&lt;a aria-hidden="true" href="#cb9-6" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="op"&gt;*&lt;/span&gt; (&lt;span class="kw"&gt;string-capitalize&lt;/span&gt; &lt;span class="st"&gt;"cool example"&lt;/span&gt;)    &lt;span class="co"&gt;;;"Cool Example"&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;所有这些函数接收 &lt;code&gt;:start&lt;/code&gt; 和 &lt;code&gt;:end&lt;/code&gt; 参数指示开始和结束的位置。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;注意&lt;/strong&gt;：&lt;code&gt;STRING-UPCASE&lt;/code&gt;, &lt;code&gt;STRING-DOWNCASE&lt;/code&gt; 和 &lt;code&gt;STRING-CAPITALIZE&lt;/code&gt; 不会修改原来的字符串。但是，如果字符串中没有字符需要转换，则结果可能是字符串或其副本，由实现自行决定。&lt;/p&gt;
&lt;h2 id="去除空格"&gt;去除空格&lt;/h2&gt;
&lt;div class="sourceCode" id="cb10"&gt;&lt;pre class="sourceCode lisp"&gt;&lt;code class="sourceCode commonlisp"&gt;&lt;span id="cb10-1"&gt;&lt;a aria-hidden="true" href="#cb10-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="op"&gt;*&lt;/span&gt; (&lt;span class="kw"&gt;string-trim&lt;/span&gt; &lt;span class="st"&gt;" "&lt;/span&gt; &lt;span class="st"&gt;" trim me "&lt;/span&gt;)    &lt;span class="co"&gt;;; "trim me"&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb10-2"&gt;&lt;a aria-hidden="true" href="#cb10-2" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="op"&gt;*&lt;/span&gt; (&lt;span class="kw"&gt;string-trim&lt;/span&gt; &lt;span class="st"&gt;" et"&lt;/span&gt; &lt;span class="st"&gt;" trim me "&lt;/span&gt;)    &lt;span class="co"&gt;;; "rim m"&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb10-3"&gt;&lt;a aria-hidden="true" href="#cb10-3" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="op"&gt;*&lt;/span&gt; (&lt;span class="kw"&gt;string-left-trim&lt;/span&gt; &lt;span class="st"&gt;" et"&lt;/span&gt; &lt;span class="st"&gt;" trim me "&lt;/span&gt;)    &lt;span class="co"&gt;;; "rim me "&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb10-4"&gt;&lt;a aria-hidden="true" href="#cb10-4" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="op"&gt;*&lt;/span&gt; (&lt;span class="kw"&gt;string-right-trim&lt;/span&gt; &lt;span class="st"&gt;" et"&lt;/span&gt; &lt;span class="st"&gt;" trim me "&lt;/span&gt;)    &lt;span class="co"&gt;;; " trim m"&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb10-5"&gt;&lt;a aria-hidden="true" href="#cb10-5" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="op"&gt;*&lt;/span&gt; (&lt;span class="kw"&gt;string-right-trim&lt;/span&gt; '(&lt;span class="ch"&gt;#\S&lt;/span&gt;pace &lt;span class="ch"&gt;#\e&lt;/span&gt; &lt;span class="ch"&gt;#\t&lt;/span&gt;) &lt;span class="st"&gt;" trim me "&lt;/span&gt;)    &lt;span class="co"&gt;;; " trim m"&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id="寻找和搜索"&gt;寻找和搜索&lt;/h2&gt;
&lt;p&gt;在一个字符串中寻找特定字符和在序列中寻找元素类似。使用 &lt;code&gt;find&lt;/code&gt; &lt;code&gt;find-if&lt;/code&gt; 和 &lt;code&gt;position&lt;/code&gt; 和 &lt;code&gt;position-if&lt;/code&gt; 来达到目标，要寻找字符串，使用 &lt;code&gt;search&lt;/code&gt;：&lt;/p&gt;
&lt;div class="sourceCode" id="cb11"&gt;&lt;pre class="sourceCode lisp"&gt;&lt;code class="sourceCode commonlisp"&gt;&lt;span id="cb11-1"&gt;&lt;a aria-hidden="true" href="#cb11-1" tabindex="-1"&gt;&lt;/a&gt;(&lt;span class="kw"&gt;find&lt;/span&gt; &lt;span class="ch"&gt;#\e&lt;/span&gt; &lt;span class="st"&gt;"Hello world!"&lt;/span&gt;) &lt;span class="co"&gt;;; #\e&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb11-2"&gt;&lt;a aria-hidden="true" href="#cb11-2" tabindex="-1"&gt;&lt;/a&gt;(&lt;span class="kw"&gt;find-if&lt;/span&gt; &lt;span class="op"&gt;#'&lt;/span&gt;digit-char-p &lt;span class="st"&gt;"Hello 1000!"&lt;/span&gt;) &lt;span class="co"&gt;;; #\1&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb11-3"&gt;&lt;a aria-hidden="true" href="#cb11-3" tabindex="-1"&gt;&lt;/a&gt;(&lt;span class="kw"&gt;position&lt;/span&gt; &lt;span class="ch"&gt;#\a&lt;/span&gt; &lt;span class="st"&gt;"Hello alpha!"&lt;/span&gt;) &lt;span class="co"&gt;;; 6&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb11-4"&gt;&lt;a aria-hidden="true" href="#cb11-4" tabindex="-1"&gt;&lt;/a&gt;(&lt;span class="kw"&gt;search&lt;/span&gt; &lt;span class="st"&gt;"we"&lt;/span&gt; &lt;span class="st"&gt;"If we can't be free we can at least be cheap"&lt;/span&gt;)    &lt;span class="co"&gt;;; 3&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb11-5"&gt;&lt;a aria-hidden="true" href="#cb11-5" tabindex="-1"&gt;&lt;/a&gt;(&lt;span class="kw"&gt;search&lt;/span&gt; &lt;span class="st"&gt;"FREE"&lt;/span&gt; &lt;span class="st"&gt;"If we can't be free we can at least be cheap"&lt;/span&gt; &lt;span class="bu"&gt;:test&lt;/span&gt; &lt;span class="op"&gt;#'&lt;/span&gt;char-equal)    &lt;span class="co"&gt;;; 15&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id="类型转换"&gt;类型转换&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;string -&amp;gt; integer&lt;/p&gt;
&lt;p&gt;使用 &lt;code&gt;parse-integer&lt;/code&gt; 来转换，使用 &lt;code&gt;junk-allowed&lt;/code&gt; 来允许垃圾：&lt;/p&gt;
&lt;div class="sourceCode" id="cb12"&gt;&lt;pre class="sourceCode lisp"&gt;&lt;code class="sourceCode commonlisp"&gt;&lt;span id="cb12-1"&gt;&lt;a aria-hidden="true" href="#cb12-1" tabindex="-1"&gt;&lt;/a&gt;(&lt;span class="kw"&gt;parse-integer&lt;/span&gt; &lt;span class="st"&gt;"100 is very good"&lt;/span&gt; &lt;span class="bu"&gt;:junk-allowed&lt;/span&gt; &lt;span class="kw"&gt;t&lt;/span&gt;)    &lt;span class="co"&gt;;; 100&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb12-2"&gt;&lt;a aria-hidden="true" href="#cb12-2" tabindex="-1"&gt;&lt;/a&gt;(&lt;span class="kw"&gt;parse-integer&lt;/span&gt; (prompt-read &lt;span class="st"&gt;"Rating"&lt;/span&gt;) &lt;span class="bu"&gt;:junk-allowed&lt;/span&gt; &lt;span class="kw"&gt;t&lt;/span&gt;)    &lt;span class="co"&gt;;; 获取用户输入，转换数字&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;string -&amp;gt; float&lt;/p&gt;
&lt;p&gt;很遗憾，没有内置的方法。外部函数库 &lt;a href="https://github.com/soemraws/parse-float"&gt;parse-float&lt;/a&gt; 可以做到这一点. 它不使用 &lt;code&gt;read-from-string&lt;/code&gt; 所以可以安全使用。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;number -&amp;gt; string&lt;/p&gt;
&lt;p&gt;使用 &lt;code&gt;write-to-string&lt;/code&gt; 来转换，当然也可以使用 &lt;code&gt;format&lt;/code&gt;：&lt;/p&gt;
&lt;div class="sourceCode" id="cb13"&gt;&lt;pre class="sourceCode lisp"&gt;&lt;code class="sourceCode commonlisp"&gt;&lt;span id="cb13-1"&gt;&lt;a aria-hidden="true" href="#cb13-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="op"&gt;*&lt;/span&gt; (&lt;span class="kw"&gt;write-to-string&lt;/span&gt; &lt;span class="dv"&gt;250&lt;/span&gt;)    &lt;span class="co"&gt;;; "250"&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb13-2"&gt;&lt;a aria-hidden="true" href="#cb13-2" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="op"&gt;*&lt;/span&gt; (&lt;span class="kw"&gt;write-to-string&lt;/span&gt; &lt;span class="fl"&gt;250.02&lt;/span&gt;)    &lt;span class="co"&gt;;; "250.02"&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb13-3"&gt;&lt;a aria-hidden="true" href="#cb13-3" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="op"&gt;*&lt;/span&gt; (&lt;span class="kw"&gt;write-to-string&lt;/span&gt; &lt;span class="dv"&gt;250&lt;/span&gt; &lt;span class="bu"&gt;:base&lt;/span&gt; &lt;span class="dv"&gt;5&lt;/span&gt;)    &lt;span class="co"&gt;;;"2000"&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb13-4"&gt;&lt;a aria-hidden="true" href="#cb13-4" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="op"&gt;*&lt;/span&gt; (&lt;span class="kw"&gt;write-to-string&lt;/span&gt; (&lt;span class="op"&gt;/&lt;/span&gt; &lt;span class="dv"&gt;1&lt;/span&gt; &lt;span class="dv"&gt;3&lt;/span&gt;))    &lt;span class="co"&gt;;;"1/3"&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="字符串切分"&gt;字符串切分&lt;/h2&gt;
&lt;p&gt;很遗憾，还是没有，不过 &lt;code&gt;uiop&lt;/code&gt; 中提供了解决方案：&lt;/p&gt;
&lt;div class="sourceCode" id="cb14"&gt;&lt;pre class="sourceCode lisp"&gt;&lt;code class="sourceCode commonlisp"&gt;&lt;span id="cb14-1"&gt;&lt;a aria-hidden="true" href="#cb14-1" tabindex="-1"&gt;&lt;/a&gt; (uiop:split-string &lt;span class="st"&gt;"hello world"&lt;/span&gt; :separator &lt;span class="st"&gt;" "&lt;/span&gt;) &lt;span class="co"&gt;;; ("hello", "world")&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h1 id="输入输出"&gt;输入输出&lt;/h1&gt;
&lt;p&gt;使用 &lt;code&gt;read-line&lt;/code&gt; 来从标准输入读取，使用 &lt;code&gt;write-line&lt;/code&gt; 来输出。除此以外，还可以使用 &lt;code&gt;print&lt;/code&gt; 来打印，&lt;code&gt;format&lt;/code&gt; 来执行复杂的格式化：&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class="header"&gt;
&lt;th&gt;形式&lt;/th&gt;
&lt;th&gt;描述&lt;/th&gt;
&lt;th&gt;举例&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class="odd"&gt;
&lt;td&gt;read-line&lt;/td&gt;
&lt;td&gt;读取一行&lt;/td&gt;
&lt;td&gt;&lt;code&gt;(read-line)&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="even"&gt;
&lt;td&gt;read-char&lt;/td&gt;
&lt;td&gt;读取一个字符，多余丢弃&lt;/td&gt;
&lt;td&gt;&lt;code&gt;(read-char)&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="odd"&gt;
&lt;td&gt;write-line&lt;/td&gt;
&lt;td&gt;输出一行，自动换行&lt;/td&gt;
&lt;td&gt;&lt;code&gt;(write-line "Hello!")&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;没有标准的 &lt;code&gt;prompt&lt;/code&gt; 之类的函数，你可以定义一个：&lt;/p&gt;
&lt;div class="sourceCode" id="cb15"&gt;&lt;pre class="sourceCode lisp"&gt;&lt;code class="sourceCode commonlisp"&gt;&lt;span id="cb15-1"&gt;&lt;a aria-hidden="true" href="#cb15-1" tabindex="-1"&gt;&lt;/a&gt;(&lt;span class="kw"&gt;defun&lt;/span&gt;&lt;span class="fu"&gt; prompt-read &lt;/span&gt;(prompt)&lt;/span&gt;
&lt;span id="cb15-2"&gt;&lt;a aria-hidden="true" href="#cb15-2" tabindex="-1"&gt;&lt;/a&gt;    (&lt;span class="kw"&gt;format&lt;/span&gt; &lt;span class="va"&gt;*query-io*&lt;/span&gt; &lt;span class="st"&gt;"~a: "&lt;/span&gt; prompt)&lt;/span&gt;
&lt;span id="cb15-3"&gt;&lt;a aria-hidden="true" href="#cb15-3" tabindex="-1"&gt;&lt;/a&gt;        (&lt;span class="kw"&gt;force-output&lt;/span&gt; &lt;span class="va"&gt;*query-io*&lt;/span&gt;)&lt;/span&gt;
&lt;span id="cb15-4"&gt;&lt;a aria-hidden="true" href="#cb15-4" tabindex="-1"&gt;&lt;/a&gt;        (&lt;span class="kw"&gt;read-line&lt;/span&gt; &lt;span class="va"&gt;*query-io*&lt;/span&gt;))&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id="format"&gt;&lt;code&gt;format&lt;/code&gt;&lt;/h2&gt;
&lt;p&gt;类似于 &lt;code&gt;C&lt;/code&gt; 中的 &lt;code&gt;printf&lt;/code&gt;，&lt;code&gt;format&lt;/code&gt; 是一个强大的格式化工具。它接受两个必要参数：一个用于输出的目的地,另一个含有字面文本和嵌入指令的控制字符串，紧随其后的是一系列格式化参数。第一个输出目的地是 &lt;code&gt;T&lt;/code&gt;、&lt;code&gt;NIL&lt;/code&gt;、一个流或一个带有填充指针的字符串。如果输出对象是 &lt;code&gt;T&lt;/code&gt;，那么就输出到标准输出，也就是 &lt;code&gt;*STANDARD-OUTPUT*&lt;/code&gt;，如果是 &lt;code&gt;NIL&lt;/code&gt;，直接返回字符串。控制字符串的作用类似于 C 中 &lt;code&gt;printf&lt;/code&gt; 格式字符串的作用，本质上是一个用来描述格式的语言。&lt;del&gt;这就导致了很容易写出类似动物反刍噪音一般无法理解的东西&lt;/del&gt;。&lt;/p&gt;
&lt;p&gt;与 C 不同，&lt;strong&gt;所有的格式指令以 &lt;code&gt;~&lt;/code&gt; 开头，而不是以 &lt;code&gt;%&lt;/code&gt; 开头&lt;/strong&gt;，指令不区分大小写。~之后的是单个英文字符的指令，以及一个可能的前缀，这个前缀可以是多个字符，使用逗号分割。&lt;/p&gt;
&lt;p&gt;常见指令列表：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;~a&lt;/code&gt;：消耗一个格式化参数，转换成&lt;del&gt;它认为人类可读&lt;/del&gt;的形式。例如：&lt;/p&gt;
&lt;div class="sourceCode" id="cb16"&gt;&lt;pre class="sourceCode lisp"&gt;&lt;code class="sourceCode commonlisp"&gt;&lt;span id="cb16-1"&gt;&lt;a aria-hidden="true" href="#cb16-1" tabindex="-1"&gt;&lt;/a&gt;(&lt;span class="kw"&gt;format&lt;/span&gt; &lt;span class="kw"&gt;t&lt;/span&gt; &lt;span class="st"&gt;"~A ~A ~A ~A"&lt;/span&gt; '() &lt;span class="dv"&gt;100&lt;/span&gt; &lt;span class="op"&gt;#'&lt;/span&gt;oddp &lt;span class="st"&gt;"Hello!"&lt;/span&gt;)&lt;/span&gt;
&lt;span id="cb16-2"&gt;&lt;a aria-hidden="true" href="#cb16-2" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="co"&gt;;; NIL 100 #&amp;lt;FUNCTION ODDP&amp;gt; Hello!&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb16-3"&gt;&lt;a aria-hidden="true" href="#cb16-3" tabindex="-1"&gt;&lt;/a&gt;(&lt;span class="kw"&gt;format&lt;/span&gt; &lt;span class="kw"&gt;t&lt;/span&gt; &lt;span class="st"&gt;"~A ~A ~A ~A"&lt;/span&gt; &lt;span class="kw"&gt;nil&lt;/span&gt; (&lt;span class="kw"&gt;list&lt;/span&gt; &lt;span class="dv"&gt;1&lt;/span&gt; &lt;span class="dv"&gt;2&lt;/span&gt; &lt;span class="dv"&gt;3&lt;/span&gt;) &lt;span class="kw"&gt;pi&lt;/span&gt; &lt;span class="ch"&gt;#\💗&lt;/span&gt;)&lt;/span&gt;
&lt;span id="cb16-4"&gt;&lt;a aria-hidden="true" href="#cb16-4" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="co"&gt;;; NIL (1 2 3) 3.141592653589793d0 💗&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;~s&lt;/code&gt;：和 &lt;code&gt;~a&lt;/code&gt; 效果类似，但将输出生成为可被 &lt;code&gt;READ&lt;/code&gt; 读回来的形式：&lt;/p&gt;
&lt;div class="sourceCode" id="cb17"&gt;&lt;pre class="sourceCode lisp"&gt;&lt;code class="sourceCode commonlisp"&gt;&lt;span id="cb17-1"&gt;&lt;a aria-hidden="true" href="#cb17-1" tabindex="-1"&gt;&lt;/a&gt;(&lt;span class="kw"&gt;format&lt;/span&gt; &lt;span class="kw"&gt;t&lt;/span&gt; &lt;span class="st"&gt;"~S ~S ~S ~S"&lt;/span&gt; &lt;span class="kw"&gt;nil&lt;/span&gt; &lt;span class="st"&gt;"Hello!"&lt;/span&gt; &lt;span class="kw"&gt;pi&lt;/span&gt; &lt;span class="ch"&gt;#\💗&lt;/span&gt;)&lt;/span&gt;
&lt;span id="cb17-2"&gt;&lt;a aria-hidden="true" href="#cb17-2" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="co"&gt;;; NIL "Hello!" 3.141592653589793d0 #\GROWING_HEART&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;~%&lt;/code&gt; 和 &lt;code&gt;~&amp;amp;&lt;/code&gt;：产生新行。&lt;code&gt;~%&lt;/code&gt; 总是产生一个换行,而 &lt;code&gt;~&amp;amp;&lt;/code&gt; 只在当前没有位于一行开始处时才产生换行。可以添加前置参数指定要产生的换行的数量。例如：&lt;code&gt;(format t "~5&amp;amp;")&lt;/code&gt; 将会产生 5 个空行。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;~~&lt;/code&gt;：产生波浪线，在之前使用数字控制产生多少个波浪线。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;~c&lt;/code&gt;：字符。&lt;/p&gt;
&lt;p&gt;打印单个字符，可以使用控制字符来控制特殊字符的展开方式：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;直接使用打印字符本身：&lt;code&gt;(format nil "~c" #\SPACE) -&amp;gt; 一个空格&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;使用 &lt;code&gt;:&lt;/code&gt; 修改符号打印特殊字符的名称：&lt;code&gt;(format nil "~:c" #\SPACE) -&amp;gt; Space&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;使用 &lt;code&gt;@&lt;/code&gt; 修改符号打印字符的 lisp 表示方式：&lt;code&gt;(format nil "~@c" #\SPACE) -&amp;gt; #\SPACE&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;:&lt;/code&gt; 和 &lt;code&gt;@&lt;/code&gt; 可以混合使用，并非所有的 Lisp 都实现了 &lt;code&gt;~C&lt;/code&gt; 指令的这个方面。&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;~d&lt;/code&gt;，&lt;code&gt;~x&lt;/code&gt;，&lt;code&gt;~o&lt;/code&gt; 和 &lt;code&gt;~b&lt;/code&gt;：整数输出。&lt;/p&gt;
&lt;p&gt;&lt;code&gt;~d&lt;/code&gt;：添加 &lt;code&gt;:&lt;/code&gt; 在千位数字之间添加逗号；田间 &lt;code&gt;@&lt;/code&gt; 总是显示正负号，第一个前置参数可以指定输出的最小宽度,第二个参数可以指定一个用作占位符的字符，第三个参数是给 &lt;code&gt;:&lt;/code&gt; 作为分割符号的符号，第四个参数是 &lt;code&gt;:&lt;/code&gt; 分割下每一组数字的数量。举例：&lt;/p&gt;
&lt;div class="sourceCode" id="cb18"&gt;&lt;pre class="sourceCode lisp"&gt;&lt;code class="sourceCode commonlisp"&gt;&lt;span id="cb18-1"&gt;&lt;a aria-hidden="true" href="#cb18-1" tabindex="-1"&gt;&lt;/a&gt;(&lt;span class="kw"&gt;format&lt;/span&gt; &lt;span class="kw"&gt;nil&lt;/span&gt; &lt;span class="st"&gt;"~16,'_,'-,2:@d"&lt;/span&gt; &lt;span class="dv"&gt;114514&lt;/span&gt;)&lt;/span&gt;
&lt;span id="cb18-2"&gt;&lt;a aria-hidden="true" href="#cb18-2" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="st"&gt;"_______+11-45-14"&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;参数是 &lt;code&gt;16,'_,'-,2:@&lt;/code&gt;，四个参数分别是 &lt;code&gt;16&lt;/code&gt;，&lt;code&gt;'_&lt;/code&gt;，&lt;code&gt;'-&lt;/code&gt;，&lt;code&gt;2&lt;/code&gt;，以及开关 &lt;code&gt;:&lt;/code&gt; 和 &lt;code&gt;@&lt;/code&gt;。&lt;/p&gt;
&lt;p&gt;另外三个 &lt;code&gt;~x&lt;/code&gt; &lt;code&gt;~o&lt;/code&gt; 和 &lt;code&gt;~b&lt;/code&gt; 和 &lt;code&gt;~d&lt;/code&gt; 类似，但输出分别是 16 进制，8 进制和 2 进制：&lt;/p&gt;
&lt;div class="sourceCode" id="cb19"&gt;&lt;pre class="sourceCode lisp"&gt;&lt;code class="sourceCode commonlisp"&gt;&lt;span id="cb19-1"&gt;&lt;a aria-hidden="true" href="#cb19-1" tabindex="-1"&gt;&lt;/a&gt;(&lt;span class="kw"&gt;format&lt;/span&gt; &lt;span class="kw"&gt;nil&lt;/span&gt; &lt;span class="st"&gt;"~16,'_,'-,2:@b"&lt;/span&gt; &lt;span class="dv"&gt;114514&lt;/span&gt;)&lt;/span&gt;
&lt;span id="cb19-2"&gt;&lt;a aria-hidden="true" href="#cb19-2" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="st"&gt;"+1-10-11-11-11-01-01-00-10"&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;~r&lt;/code&gt;：更加复杂的整数控制。&lt;/p&gt;
&lt;p&gt;&lt;code&gt;~r&lt;/code&gt; 可以输出为 2-36 进制，第一个参数即为输出进制数。其他参数和之前相同，另外，在没有第一个参数时，拼写成英文单词，按照选项的不同，还可以拼写成罗马数字。&lt;/p&gt;
&lt;div class="sourceCode" id="cb20"&gt;&lt;pre class="sourceCode lisp"&gt;&lt;code class="sourceCode commonlisp"&gt;&lt;span id="cb20-1"&gt;&lt;a aria-hidden="true" href="#cb20-1" tabindex="-1"&gt;&lt;/a&gt;(&lt;span class="kw"&gt;format&lt;/span&gt; &lt;span class="kw"&gt;nil&lt;/span&gt; &lt;span class="st"&gt;"~36,8,'-:@r"&lt;/span&gt; &lt;span class="dv"&gt;1000&lt;/span&gt;)&lt;/span&gt;
&lt;span id="cb20-2"&gt;&lt;a aria-hidden="true" href="#cb20-2" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="st"&gt;"-----+RS"&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb20-3"&gt;&lt;a aria-hidden="true" href="#cb20-3" tabindex="-1"&gt;&lt;/a&gt;(&lt;span class="kw"&gt;format&lt;/span&gt; &lt;span class="kw"&gt;nil&lt;/span&gt; &lt;span class="st"&gt;"~@r"&lt;/span&gt; &lt;span class="dv"&gt;1514&lt;/span&gt;)&lt;/span&gt;
&lt;span id="cb20-4"&gt;&lt;a aria-hidden="true" href="#cb20-4" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="st"&gt;"MDXIV"&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb20-5"&gt;&lt;a aria-hidden="true" href="#cb20-5" tabindex="-1"&gt;&lt;/a&gt;(&lt;span class="kw"&gt;format&lt;/span&gt; &lt;span class="kw"&gt;nil&lt;/span&gt; &lt;span class="st"&gt;"~:@r"&lt;/span&gt; &lt;span class="dv"&gt;1514&lt;/span&gt;)&lt;/span&gt;
&lt;span id="cb20-6"&gt;&lt;a aria-hidden="true" href="#cb20-6" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="st"&gt;"MDXIIII"&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb20-7"&gt;&lt;a aria-hidden="true" href="#cb20-7" tabindex="-1"&gt;&lt;/a&gt;(&lt;span class="kw"&gt;format&lt;/span&gt; &lt;span class="kw"&gt;nil&lt;/span&gt; &lt;span class="st"&gt;"~:r"&lt;/span&gt; &lt;span class="dv"&gt;1514&lt;/span&gt;)&lt;/span&gt;
&lt;span id="cb20-8"&gt;&lt;a aria-hidden="true" href="#cb20-8" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="st"&gt;"one thousand five hundred fourteenth"&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb20-9"&gt;&lt;a aria-hidden="true" href="#cb20-9" tabindex="-1"&gt;&lt;/a&gt;(&lt;span class="kw"&gt;format&lt;/span&gt; &lt;span class="kw"&gt;nil&lt;/span&gt; &lt;span class="st"&gt;"~r"&lt;/span&gt; &lt;span class="dv"&gt;1145141919810&lt;/span&gt;)&lt;/span&gt;
&lt;span id="cb20-10"&gt;&lt;a aria-hidden="true" href="#cb20-10" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="st"&gt;"one trillion one hundred forty-five billion one hundred forty-one million nine hundred nineteen thousand eight hundred ten"&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;~f&lt;/code&gt; 和 &lt;code&gt;~e&lt;/code&gt;：浮点数&lt;/p&gt;
&lt;p&gt;&lt;code&gt;~f&lt;/code&gt;：使用计算机科学记数法，十进制输出，第二个参数控制在十进制小数点之后打印的数位个数。&lt;code&gt;@&lt;/code&gt; 选项开启正负号。&lt;/p&gt;
&lt;div class="sourceCode" id="cb21"&gt;&lt;pre class="sourceCode lisp"&gt;&lt;code class="sourceCode commonlisp"&gt;&lt;span id="cb21-1"&gt;&lt;a aria-hidden="true" href="#cb21-1" tabindex="-1"&gt;&lt;/a&gt;(&lt;span class="kw"&gt;format&lt;/span&gt; &lt;span class="kw"&gt;nil&lt;/span&gt; &lt;span class="st"&gt;"~,5@f"&lt;/span&gt; &lt;span class="kw"&gt;pi&lt;/span&gt;)&lt;/span&gt;
&lt;span id="cb21-2"&gt;&lt;a aria-hidden="true" href="#cb21-2" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="st"&gt;"+3.14159"&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;code&gt;~e&lt;/code&gt; 和 &lt;code&gt;~f&lt;/code&gt; 类似，但是输出数字时总是使用科学计数法。&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;除此以外，还有英语指令，生成带有正确复数化单词的消息。使用 &lt;code&gt;~p&lt;/code&gt; 即可，如果对应的参数大于 1 ，输出一个 &lt;code&gt;s&lt;/code&gt;，所以，类似这样的 Python 代码：&lt;/p&gt;
&lt;div class="sourceCode" id="cb22"&gt;&lt;pre class="sourceCode python"&gt;&lt;code class="sourceCode python"&gt;&lt;span id="cb22-1"&gt;&lt;a aria-hidden="true" href="#cb22-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="ss"&gt;f"Total &lt;/span&gt;&lt;span class="sc"&gt;{&lt;/span&gt;number&lt;span class="sc"&gt;}&lt;/span&gt;&lt;span class="ss"&gt; &lt;/span&gt;&lt;span class="sc"&gt;{&lt;/span&gt;&lt;span class="st"&gt;'element'&lt;/span&gt; &lt;span class="cf"&gt;if&lt;/span&gt; number &lt;span class="op"&gt;==&lt;/span&gt; &lt;span class="dv"&gt;1&lt;/span&gt; &lt;span class="cf"&gt;else&lt;/span&gt; &lt;span class="st"&gt;'elements'&lt;/span&gt;&lt;span class="sc"&gt;}&lt;/span&gt;&lt;span class="ss"&gt;"&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb22-2"&gt;&lt;a aria-hidden="true" href="#cb22-2" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="co"&gt;'Total 45 elements'&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;可以是：&lt;/p&gt;
&lt;div class="sourceCode" id="cb23"&gt;&lt;pre class="sourceCode lisp"&gt;&lt;code class="sourceCode commonlisp"&gt;&lt;span id="cb23-1"&gt;&lt;a aria-hidden="true" href="#cb23-1" tabindex="-1"&gt;&lt;/a&gt;(&lt;span class="kw"&gt;format&lt;/span&gt; &lt;span class="kw"&gt;nil&lt;/span&gt; &lt;span class="st"&gt;"Total ~d element~p"&lt;/span&gt; &lt;span class="dv"&gt;14&lt;/span&gt; &lt;span class="dv"&gt;14&lt;/span&gt;)&lt;/span&gt;
&lt;span id="cb23-2"&gt;&lt;a aria-hidden="true" href="#cb23-2" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="st"&gt;"Total 14 elements"&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;可以开启 &lt;code&gt;:&lt;/code&gt; 和 &lt;code&gt;@&lt;/code&gt;，让它重新处理前一个格式化参数，以及自动添加单词的复数：&lt;/p&gt;
&lt;div class="sourceCode" id="cb24"&gt;&lt;pre class="sourceCode lisp"&gt;&lt;code class="sourceCode commonlisp"&gt;&lt;span id="cb24-1"&gt;&lt;a aria-hidden="true" href="#cb24-1" tabindex="-1"&gt;&lt;/a&gt;(&lt;span class="kw"&gt;format&lt;/span&gt; &lt;span class="kw"&gt;nil&lt;/span&gt; &lt;span class="st"&gt;"~r file~:p"&lt;/span&gt; &lt;span class="dv"&gt;1&lt;/span&gt;) → &lt;span class="st"&gt;"one file"&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb24-2"&gt;&lt;a aria-hidden="true" href="#cb24-2" tabindex="-1"&gt;&lt;/a&gt;(&lt;span class="kw"&gt;format&lt;/span&gt; &lt;span class="kw"&gt;nil&lt;/span&gt; &lt;span class="st"&gt;"~r famil~:@p"&lt;/span&gt; &lt;span class="dv"&gt;0&lt;/span&gt;) → &lt;span class="st"&gt;"zero families"&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;对于大小写，可以使用 &lt;code&gt;~( ~)&lt;/code&gt; 处理，它接收 &lt;code&gt;@&lt;/code&gt;，&lt;code&gt;:&lt;/code&gt; 开关：&lt;/p&gt;
&lt;div class="sourceCode" id="cb25"&gt;&lt;pre class="sourceCode lisp"&gt;&lt;code class="sourceCode commonlisp"&gt;&lt;span id="cb25-1"&gt;&lt;a aria-hidden="true" href="#cb25-1" tabindex="-1"&gt;&lt;/a&gt;(&lt;span class="kw"&gt;format&lt;/span&gt; &lt;span class="kw"&gt;nil&lt;/span&gt; &lt;span class="st"&gt;"~(~a~)"&lt;/span&gt; &lt;span class="st"&gt;"tHe Quick BROWN foX"&lt;/span&gt;)   &lt;span class="co"&gt;; =&amp;gt; "the quick brown fox"&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb25-2"&gt;&lt;a aria-hidden="true" href="#cb25-2" tabindex="-1"&gt;&lt;/a&gt;(&lt;span class="kw"&gt;format&lt;/span&gt; &lt;span class="kw"&gt;nil&lt;/span&gt; &lt;span class="st"&gt;"~@(~a~)"&lt;/span&gt; &lt;span class="st"&gt;"tHe Quick BROWN foX"&lt;/span&gt;)  &lt;span class="co"&gt;; =&amp;gt; "The quick brown fox"&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb25-3"&gt;&lt;a aria-hidden="true" href="#cb25-3" tabindex="-1"&gt;&lt;/a&gt;(&lt;span class="kw"&gt;format&lt;/span&gt; &lt;span class="kw"&gt;nil&lt;/span&gt; &lt;span class="st"&gt;"~:(~a~)"&lt;/span&gt; &lt;span class="st"&gt;"tHe Quick BROWN foX"&lt;/span&gt;)  &lt;span class="co"&gt;; =&amp;gt; "The Quick Brown Fox"&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;以及更加复杂的条件格式化，迭代格式化和跳跃格式化。还能够生成表格。&lt;del&gt;希望不要用到它们&lt;/del&gt;&lt;/p&gt;
&lt;h1 id="文件"&gt;文件&lt;/h1&gt;
&lt;p&gt;和很多其他编程语言一样，CommonLisp 也用「流」来表示输入和输出。而想 &lt;code&gt;format&lt;/code&gt; 和 &lt;code&gt;read&lt;/code&gt; 这样的函数，其作用对象也是一个流。读取和写入文件，需要几个函数： &lt;code&gt;open&lt;/code&gt;，&lt;code&gt;make-pathname&lt;/code&gt; 等。&lt;/p&gt;
&lt;p&gt;&lt;code&gt;make-pathname&lt;/code&gt; 制造出合法的文件路径名称，它只接收关键词参数，有六个：&lt;code&gt;host&lt;/code&gt;、&lt;code&gt;device&lt;/code&gt;、&lt;code&gt;directory&lt;/code&gt;、&lt;code&gt;name&lt;/code&gt;、&lt;code&gt;type&lt;/code&gt; 及 &lt;code&gt;version&lt;/code&gt;，返回一个路径名称：&lt;/p&gt;
&lt;div class="sourceCode" id="cb26"&gt;&lt;pre class="sourceCode lisp"&gt;&lt;code class="sourceCode commonlisp"&gt;&lt;span id="cb26-1"&gt;&lt;a aria-hidden="true" href="#cb26-1" tabindex="-1"&gt;&lt;/a&gt;(&lt;span class="kw"&gt;make-pathname&lt;/span&gt; &lt;span class="bu"&gt;:directory&lt;/span&gt; &lt;span class="st"&gt;"/home/izfsk/"&lt;/span&gt; &lt;span class="bu"&gt;:name&lt;/span&gt; &lt;span class="st"&gt;"file"&lt;/span&gt;)&lt;/span&gt;
&lt;span id="cb26-2"&gt;&lt;a aria-hidden="true" href="#cb26-2" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="co"&gt;;; #P"//home/izfsk//file"&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;接下来是打开文件，使用 &lt;code&gt;open&lt;/code&gt; 函数。这个函数很复杂，它接受一个路径名和大量关键字参数，开启成功时返回指向文件的流。常见的关键词参数有 &lt;code&gt;:direction&lt;/code&gt;，决定是写入流还是读取流，选项有 &lt;code&gt;:input&lt;/code&gt;，&lt;code&gt;:output&lt;/code&gt;，&lt;code&gt;:io&lt;/code&gt;，还能够指定文件存在时是否覆盖，使用 &lt;code&gt;:if-exist&lt;/code&gt; 参数，使用 &lt;code&gt;:supersede&lt;/code&gt; 覆盖。打开以后，你就可以使用 &lt;code&gt;format&lt;/code&gt; 等函数写入读取了。在最后要记得使用 &lt;code&gt;close&lt;/code&gt; 关闭流。举例：&lt;/p&gt;
&lt;div class="sourceCode" id="cb27"&gt;&lt;pre class="sourceCode lisp"&gt;&lt;code class="sourceCode commonlisp"&gt;&lt;span id="cb27-1"&gt;&lt;a aria-hidden="true" href="#cb27-1" tabindex="-1"&gt;&lt;/a&gt;(&lt;span class="kw"&gt;let&lt;/span&gt; ((target-file-stream&lt;/span&gt;
&lt;span id="cb27-2"&gt;&lt;a aria-hidden="true" href="#cb27-2" tabindex="-1"&gt;&lt;/a&gt;        (&lt;span class="kw"&gt;open&lt;/span&gt; (&lt;span class="kw"&gt;make-pathname&lt;/span&gt; &lt;span class="bu"&gt;:directory&lt;/span&gt; &lt;span class="st"&gt;"/home/izfsk"&lt;/span&gt; &lt;span class="bu"&gt;:name&lt;/span&gt; &lt;span class="st"&gt;"file"&lt;/span&gt;)&lt;/span&gt;
&lt;span id="cb27-3"&gt;&lt;a aria-hidden="true" href="#cb27-3" tabindex="-1"&gt;&lt;/a&gt;              &lt;span class="bu"&gt;:direction&lt;/span&gt; &lt;span class="bu"&gt;:output&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb27-4"&gt;&lt;a aria-hidden="true" href="#cb27-4" tabindex="-1"&gt;&lt;/a&gt;              :if-exists &lt;span class="bu"&gt;:supersede&lt;/span&gt;)))&lt;/span&gt;
&lt;span id="cb27-5"&gt;&lt;a aria-hidden="true" href="#cb27-5" tabindex="-1"&gt;&lt;/a&gt;  (&lt;span class="kw"&gt;format&lt;/span&gt; target-file-stream &lt;span class="st"&gt;"Hello!"&lt;/span&gt;)&lt;/span&gt;
&lt;span id="cb27-6"&gt;&lt;a aria-hidden="true" href="#cb27-6" tabindex="-1"&gt;&lt;/a&gt;  (&lt;span class="kw"&gt;close&lt;/span&gt; target-file-stream))&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;就像 Python 有上下文管理器，使得你可以写出 &lt;code&gt;with open(file) as fp&lt;/code&gt; 一样， CommonLisp 也有一个宏帮助你管理流，使用 &lt;code&gt;with-open-file&lt;/code&gt; 可以管理，用它重写上面的例子：&lt;/p&gt;
&lt;div class="sourceCode" id="cb28"&gt;&lt;pre class="sourceCode lisp"&gt;&lt;code class="sourceCode commonlisp"&gt;&lt;span id="cb28-1"&gt;&lt;a aria-hidden="true" href="#cb28-1" tabindex="-1"&gt;&lt;/a&gt;(&lt;span class="kw"&gt;with-open-file&lt;/span&gt; (target-file &lt;span class="st"&gt;"/home/izfsk/file"&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb28-2"&gt;&lt;a aria-hidden="true" href="#cb28-2" tabindex="-1"&gt;&lt;/a&gt;                             &lt;span class="bu"&gt;:direction&lt;/span&gt; &lt;span class="bu"&gt;:output&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb28-3"&gt;&lt;a aria-hidden="true" href="#cb28-3" tabindex="-1"&gt;&lt;/a&gt;                             :if-exists &lt;span class="bu"&gt;:supersede&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb28-4"&gt;&lt;a aria-hidden="true" href="#cb28-4" tabindex="-1"&gt;&lt;/a&gt;                             :if-does-not-exist &lt;span class="bu"&gt;:create&lt;/span&gt;)&lt;/span&gt;
&lt;span id="cb28-5"&gt;&lt;a aria-hidden="true" href="#cb28-5" tabindex="-1"&gt;&lt;/a&gt;  (&lt;span class="kw"&gt;format&lt;/span&gt; target-file &lt;span class="st"&gt;"Hello!"&lt;/span&gt;))&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;读取示例：&lt;/p&gt;
&lt;div class="sourceCode" id="cb29"&gt;&lt;pre class="sourceCode lisp"&gt;&lt;code class="sourceCode commonlisp"&gt;&lt;span id="cb29-1"&gt;&lt;a aria-hidden="true" href="#cb29-1" tabindex="-1"&gt;&lt;/a&gt;(&lt;span class="kw"&gt;let&lt;/span&gt; ((in (&lt;span class="kw"&gt;open&lt;/span&gt; &lt;span class="st"&gt;"/some/file/name.txt"&lt;/span&gt;)))&lt;/span&gt;
&lt;span id="cb29-2"&gt;&lt;a aria-hidden="true" href="#cb29-2" tabindex="-1"&gt;&lt;/a&gt;  (&lt;span class="kw"&gt;format&lt;/span&gt; &lt;span class="kw"&gt;t&lt;/span&gt; &lt;span class="st"&gt;"~a~%"&lt;/span&gt; (&lt;span class="kw"&gt;read-line&lt;/span&gt; in))&lt;/span&gt;
&lt;span id="cb29-3"&gt;&lt;a aria-hidden="true" href="#cb29-3" tabindex="-1"&gt;&lt;/a&gt;  (&lt;span class="kw"&gt;close&lt;/span&gt; in))&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h1 id="参考"&gt;参考&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://www.alexeyshmalko.com/20210927132804/"&gt;Common Lisp: Format&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://gigamonkeys.com/book/files-and-file-io.html"&gt;Practical Common Lisp – 14. Files and File I/O&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://lispcookbook.github.io/cl-cookbook/files.html#writing-content-to-a-file"&gt;The Common Lisp Cookbook – Files and Directories&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;br/&gt;
&lt;!--%%REF%%--&gt;
&lt;br/&gt;
&lt;script async="" crossorigin="anonymous" data-category="Announcements" data-category-id="DIC_kwDOJ7Ymy84CX4eg" data-emit-metadata="0" data-input-position="top" data-lang="zh-CN" data-loading="lazy" data-mapping="title" data-reactions-enabled="1" data-repo="izfsk-ium/izfsk-ium.github.io" data-repo-id="R_kgDOJ7Ymyw" data-strict="0" data-theme="preferred_color_scheme" src="https://giscus.app/client.js"&gt;
&lt;/script&gt;
&lt;/main&gt;
&lt;footer&gt;
&lt;p class="signoff"&gt;
&lt;div class="metadata"&gt;
&lt;p class="date"&gt;&lt;time datetime="2023-01-20"&gt;创建日期：2023-01-20&lt;/time&gt;&lt;/p&gt;
&lt;p class="lastmodify"&gt;&lt;time&gt;最后编译：2023-08-10&lt;/time&gt;&lt;/p&gt;
&lt;p class="lastmodify" id="counter-span"&gt;访问次数：&lt;/p&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;/footer&gt;
&lt;script&gt;
    /* These script should run after page load */
    document.querySelectorAll('code.sourceCode').forEach(
      i =&gt; i.insertAdjacentHTML('beforeend', '&lt;div class="copy"&gt;复制&lt;/div&gt;')
    );
    document.querySelectorAll('div.copy').forEach(
      i =&gt; i.addEventListener(
        'click',
        () =&gt; {
          navigator.clipboard.writeText(i.parentElement.innerText.replace('复制', ''));
          i.innerText = '成功';
          setTimeout(() =&gt; {
            i.innerText = '复制';
          }, 1000);
        }
      )
    );

    if (location.href.includes("127.0.0.1:8080")) {
      document.getElementById("counter-span").innerHTML = "[[development mode]]";
    } else {
      const uuid = document.getElementById("article-uuid").innerText;
      const target = document.getElementById("counter-span");
      const last = localStorage.getItem("lastVisit-" + uuid);
      const shouldIncrease = last === null || new Date().getTime() - parseInt(last) &gt;= (1000 * 60 * 15);

      fetch(shouldIncrease ? ("https://counter.izfsk.top/counter/" + uuid) : ("https://counter.izfsk.top/readOnly/" + uuid))
        .then(r =&gt; r.text())
        .then(d =&gt; {
          if (!d.startsWith("Too"))
            document.getElementById("counter-span").innerText = "访问次数：" + d.toString();
          else
            document.getElementById("counter-span").innerHTML = "";
        });

      localStorage.setItem("lastVisit-" + uuid, new Date().getTime());
    }
  &lt;/script&gt;
&lt;script async="" data-website-id="2a1146ab-fa82-4a84-a04f-30e5967357c3" src="https://analytics.umami.is/script.js"&gt;&lt;/script&gt;
&lt;/body&gt;</content:encoded>
      <guid isPermaLink="false">704f2611-4448-4f94-a4c1-7b797aad7a43</guid>
      <pubDate>Fri, 20 Jan 2023 00:00:00 +0800</pubDate>
    </item>
    <item>
      <title>旧式书信整理1</title>
      <link>https://blog.izfsk.top/articles/旧式书信整理1.html</link>
      <description>旧式书信整理1</description>
      <content:encoded>&lt;body&gt;
&lt;progress id="content_progress" value="0"&gt;&lt;/progress&gt;
&lt;button id="back-to-top"&gt;
    回页顶
  &lt;/button&gt;
&lt;header&gt;
&lt;small id="article-uuid" style="display: none !important;"&gt;3b4b4117-f9bc-4a49-937b-5fefbfc12f9c&lt;/small&gt;
&lt;h1 class="title"&gt;旧式书信整理1&lt;/h1&gt;
&lt;!-- Subtitle --&gt;
&lt;h3 class="subtitle"&gt; &lt;/h3&gt;
&lt;/header&gt;
&lt;nav id="TOC" role="doc-toc"&gt;
&lt;strong&gt;文章归类: &lt;a href="/pages/category.html#整理"&gt;整理&lt;/a&gt; &lt;/strong&gt;
&lt;input id="contents" type="checkbox"/&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#学界类" id="toc-学界类"&gt;学界类&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#贺友毕业" id="toc-贺友毕业"&gt;贺友毕业&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#校长辞职" id="toc-校长辞职"&gt;校长辞职&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#托同学续请病假" id="toc-托同学续请病假"&gt;托同学续请病假&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#约友同伴赴校" id="toc-约友同伴赴校"&gt;约友同伴赴校&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#询问女学校应用何种教科书" id="toc-询问女学校应用何种教科书"&gt;询问女学校应用何种教科书&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#报告学校年终考试" id="toc-报告学校年终考试"&gt;报告学校年终考试&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#同学偶犯校规请免黜退" id="toc-同学偶犯校规请免黜退"&gt;同学偶犯校规请免黜退&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#聘请会计员" id="toc-聘请会计员"&gt;聘请会计员&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#教员辞聘再致函劝驾" id="toc-教员辞聘再致函劝驾"&gt;教员辞聘再致函劝驾&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#荐教员" id="toc-荐教员"&gt;荐教员&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#托同学返校时购带书籍" id="toc-托同学返校时购带书籍"&gt;托同学返校时购带书籍&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#reference"&gt;参考链接&lt;/a&gt;&lt;/li&gt;
&lt;li&gt; &lt;/li&gt;
&lt;li class="tools"&gt;
&lt;span id="backtomain"&gt;
&lt;svg class="bi bi-house" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M8.707 1.5a1 1 0 0 0-1.414 0L.646 8.146a.5.5 0 0 0 .708.708L2 8.207V13.5A1.5 1.5 0 0 0 3.5 15h9a1.5 1.5 0 0 0 1.5-1.5V8.207l.646.647a.5.5 0 0 0 .708-.708L13 5.793V2.5a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v1.293L8.707 1.5ZM13 7.207V13.5a.5.5 0 0 1-.5.5h-9a.5.5 0 0 1-.5-.5V7.207l5-5 5 5Z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="readingmode"&gt;
&lt;svg class="bi bi-book" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M1 2.828c.885-.37 2.154-.769 3.388-.893 1.33-.134 2.458.063 3.112.752v9.746c-.935-.53-2.12-.603-3.213-.493-1.18.12-2.37.461-3.287.811V2.828zm7.5-.141c.654-.689 1.782-.886 3.112-.752 1.234.124 2.503.523 3.388.893v9.923c-.918-.35-2.107-.692-3.287-.81-1.094-.111-2.278-.039-3.213.492V2.687zM8 1.783C7.015.936 5.587.81 4.287.94c-1.514.153-3.042.672-3.994 1.105A.5.5 0 0 0 0 2.5v11a.5.5 0 0 0 .707.455c.882-.4 2.303-.881 3.68-1.02 1.409-.142 2.59.087 3.223.877a.5.5 0 0 0 .78 0c.633-.79 1.814-1.019 3.222-.877 1.378.139 2.8.62 3.681 1.02A.5.5 0 0 0 16 13.5v-11a.5.5 0 0 0-.293-.455c-.952-.433-2.48-.952-3.994-1.105C10.413.809 8.985.936 8 1.783z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="larger"&gt; &lt;/span&gt;
&lt;span id="smaller"&gt;&lt;/span&gt;
&lt;span id="switchfont"&gt;
&lt;svg class="bi bi-fonts" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M12.258 3h-8.51l-.083 2.46h.479c.26-1.544.758-1.783 2.693-1.845l.424-.013v7.827c0 .663-.144.82-1.3.923v.52h4.082v-.52c-1.162-.103-1.306-.26-1.306-.923V3.602l.431.013c1.934.062 2.434.301 2.693 1.846h.479L12.258 3z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="backtotop"&gt;
&lt;svg class="bi bi-arrow-bar-up" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M8 10a.5.5 0 0 0 .5-.5V3.707l2.146 2.147a.5.5 0 0 0 .708-.708l-3-3a.5.5 0 0 0-.708 0l-3 3a.5.5 0 1 0 .708.708L7.5 3.707V9.5a.5.5 0 0 0 .5.5zm-7 2.5a.5.5 0 0 1 .5-.5h13a.5.5 0 0 1 0 1h-13a.5.5 0 0 1-.5-.5z" fill-rule="evenodd"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/nav&gt;
&lt;main&gt;
&lt;p&gt;来源：《分类详注新尺牍大全》，袁韬壶 编著，群学出版社，1946 年，OCR + 整理，仅保留文本，简繁转换准确性存疑。&lt;/p&gt;
&lt;h1 id="学界类"&gt;学界类&lt;/h1&gt;
&lt;h2 id="贺友毕业"&gt;贺友毕业&lt;/h2&gt;
&lt;p&gt;&lt;br/&gt;&lt;/p&gt;
&lt;p&gt;某某仁兄伟&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-0"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-0" type="checkbox"&gt;&lt;span class="sidenote"&gt;伟，高大貌。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/input&gt;&lt;/span&gt;鉴。&lt;/p&gt;
&lt;p&gt;正怀&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-1"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-1" type="checkbox"/&gt;&lt;span class="sidenote"&gt;怀，思念也。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;旧雨&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-2"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-2" type="checkbox"/&gt;&lt;span class="sidenote"&gt;旧雨，老友之称（杜诗小序注），旧雨来，今雨不来。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;。忽观朵云&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-3"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-3" type="checkbox"/&gt;&lt;span class="sidenote"&gt;朵云，谓书信也，覩见也。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;。不觉喜从天外飞来。迨启&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-4"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-4" type="checkbox"/&gt;&lt;span class="sidenote"&gt;启，开也，谓开信翻看也。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;封展视。知此次贵校毕业考试。 阁下果居最优等之列。&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-5"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-5" type="checkbox"/&gt;&lt;span class="sidenote"&gt;学科分数，在八十分以上，为最优等。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;令人可钦可慕。素仰阁下才识优&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-6"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-6" type="checkbox"/&gt;&lt;span class="sidenote"&gt;优，美也。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;长。品性醕纯&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-7"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-7" type="checkbox"/&gt;&lt;span class="sidenote"&gt;醕，厚也，纯，正也。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;。将来对于教育前途。定可增&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-8"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-8" type="checkbox"/&gt;&lt;span class="sidenote"&gt;增，加也。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;进无穷幸福。而此时之实至&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-9"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-9" type="checkbox"/&gt;&lt;span class="sidenote"&gt;至，到也，谓做到真实功夫，而名誉自可归之。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;名归。如愿以偿。犹其小焉者耳。年假伊邇&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-10"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-10" type="checkbox"/&gt;&lt;span class="sidenote"&gt;伊邇，近也。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;。想荣旋&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-11"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-11" type="checkbox"/&gt;&lt;span class="sidenote"&gt;称人回里曰荣旋。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;在即。良晤匪遥&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-12"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-12" type="checkbox"/&gt;&lt;span class="sidenote"&gt;谓会面之期不远也。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;。当可共图一番畅叙&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-13"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-13" type="checkbox"/&gt;&lt;span class="sidenote"&gt;相会曰叙，（王羲之兰亭序）亦足以畅叙幽情。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;矣。专此奉达。敬候学祺。并颂文明进步。&lt;/p&gt;
&lt;p style="float:right"&gt;
&lt;span style="font-size:small"&gt;弟&lt;/span&gt;某某手上
    &lt;/p&gt;
&lt;p&gt;&lt;br/&gt;&lt;/p&gt;
&lt;h2 id="校长辞职"&gt;校长辞职&lt;/h2&gt;
&lt;p&gt;&lt;br/&gt;&lt;/p&gt;
&lt;p&gt;某某先生钧鉴。&lt;/p&gt;
&lt;p&gt;日前趋诣台端&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-14"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-14" type="checkbox"/&gt;&lt;span class="sidenote"&gt;谓走 &lt;a href="./assets/unknown1.webp"&gt;??&lt;/a&gt; 处也。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;。適值&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-15"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-15" type="checkbox"/&gt;&lt;span class="sidenote"&gt;適值，正逢也。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;大驾公出。未获面聆教言&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-16"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-16" type="checkbox"/&gt;&lt;span class="sidenote"&gt;未获，不得也，聆，听闻也。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;。怅甚。敬启者，&lt;span style="font-size:small"&gt;某&lt;/span&gt;自承乏某校职务以来&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-17"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-17" type="checkbox"/&gt;&lt;span class="sidenote"&gt;乏，缺也，谦言乏人之故，而我充当此职也。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;。迄今三载。自愧才疏学浅。于事无裨&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-18"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-18" type="checkbox"/&gt;&lt;span class="sidenote"&gt;无裨，无益也。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;。兼近来体弱多病。精力苦于不济&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-19"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-19" type="checkbox"/&gt;&lt;span class="sidenote"&gt;不济，不足也。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;。恐难胜此重任。故不得已自行告退。伏乞俯&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-20"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-20" type="checkbox"/&gt;&lt;span class="sidenote"&gt;俯，垂下貌。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;如所请。另选贤能以重教育而专责任。临颖曷胜悚惶待命之至&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-21"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-21" type="checkbox"/&gt;&lt;span class="sidenote"&gt;笔毫曰颖，临颖，谓临写信时也，悚惶，恐惧不安之貌。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;。专肃。敬请勋祺。诸维崇照。&lt;/p&gt;
&lt;p style="float:right"&gt;
    某某谨启
    &lt;/p&gt;
&lt;p&gt;&lt;br/&gt;&lt;/p&gt;
&lt;h2 id="托同学续请病假"&gt;托同学续请病假&lt;/h2&gt;
&lt;p&gt;&lt;br/&gt;&lt;/p&gt;
&lt;p&gt;某某同学兄大鉴。&lt;/p&gt;
&lt;p&gt;别来倏逾&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-22"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-22" type="checkbox"/&gt;&lt;span class="sidenote"&gt;倏，忽速也，逾，过也。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;三星期矣。迩想文明道德。与时俱&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-23"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-23" type="checkbox"/&gt;&lt;span class="sidenote"&gt;俱，共也。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;进。为颂无量。&lt;span style="font-size:small"&gt;某&lt;/span&gt;为二竖&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-24"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-24" type="checkbox"/&gt;&lt;span class="sidenote"&gt;谓有病也，（左传）晋侯有疾，梦见二竖子。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;所苦。告假返里养疴&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-25"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-25" type="checkbox"/&gt;&lt;span class="sidenote"&gt;返里，回家也，疴，病也。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;。迄今尚未痊愈。时觉困倦乏&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-26"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-26" type="checkbox"/&gt;&lt;span class="sidenote"&gt;乏，缺也。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;力。不克到校。未免旷废课程&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-27"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-27" type="checkbox"/&gt;&lt;span class="sidenote"&gt;课程，即所修之功课。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;。深为焦灼&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-28"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-28" type="checkbox"/&gt;&lt;span class="sidenote"&gt;焦灼，闷烦也。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;。因念目下假期已满。拟再绩&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-29"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-29" type="checkbox"/&gt;&lt;span class="sidenote"&gt;绩，继也。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;假十天。用特耑函奉懇。祈向  校长先生处。转达下忱&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-30"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-30" type="checkbox"/&gt;&lt;span class="sidenote"&gt;忱，心意也。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;。并懇代为请假是感。诸费清神。容当面谢。专此布懇。顺颂学祺。&lt;/p&gt;
&lt;p style="float:right"&gt;
&lt;span style="font-size:small"&gt;弟&lt;/span&gt;某某鞠躬
    &lt;/p&gt;
&lt;p&gt;&lt;br/&gt;&lt;/p&gt;
&lt;h2 id="约友同伴赴校"&gt;约友同伴赴校&lt;/h2&gt;
&lt;p&gt;&lt;br/&gt;&lt;/p&gt;
&lt;p&gt;某某大兄毅&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-31"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-31" type="checkbox"/&gt;&lt;span class="sidenote"&gt;毅，刚决貌。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;鉴。&lt;/p&gt;
&lt;p&gt;连朝风雨。春寒料峭&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-32"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-32" type="checkbox"/&gt;&lt;span class="sidenote"&gt;料峭，尖利貌。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;。每拟出门走访。奈泥泞&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-33"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-33" type="checkbox"/&gt;&lt;span class="sidenote"&gt;泞，深黏貌。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;路滑。行不得也哥哥&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-34"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-34" type="checkbox"/&gt;&lt;span class="sidenote"&gt;此句系鸟语，即鹧鸪之啼声，鸟语中又有脱袴脱袴，姑恶姑恶等类，皆以声像意也。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;。令人闷损殊甚。未识阁下近时作何消遣&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-35"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-35" type="checkbox"/&gt;&lt;span class="sidenote"&gt;消遣，即消空解闷之称。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;。各学校不久即将开课。&lt;span style="font-size:small"&gt;弟&lt;/span&gt;今春仍赴省垣&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-36"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-36" type="checkbox"/&gt;&lt;span class="sidenote"&gt;省城，曰垣。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;某校肄业。与贵校近在咫尺。倘能结伴偕行&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-37"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-37" type="checkbox"/&gt;&lt;span class="sidenote"&gt;偕行，共走也。（诗经）与子偕行。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;。一路携手谈心。诚为快事。如蒙许可&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-38"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-38" type="checkbox"/&gt;&lt;span class="sidenote"&gt;许可，允及也。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;。请先示以行期。俾&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-39"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-39" type="checkbox"/&gt;&lt;span class="sidenote"&gt;俾，使也。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;可预备一切也。专此布达。即颂文祺。&lt;/p&gt;
&lt;p style="float:right"&gt;
&lt;span style="font-size:small"&gt;弟&lt;/span&gt;某某手奏
    &lt;/p&gt;
&lt;p&gt;&lt;br/&gt;&lt;/p&gt;
&lt;h2 id="询问女学校应用何种教科书"&gt;询问女学校应用何种教科书&lt;/h2&gt;
&lt;p&gt;&lt;br/&gt;&lt;/p&gt;
&lt;p&gt;某某先生阁下。&lt;/p&gt;
&lt;p&gt;自违麈教&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-40"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-40" type="checkbox"/&gt;&lt;span class="sidenote"&gt;违，背隔也。称人之谈论曰麈教，注见前。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;。弥切葵忱&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-41"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-41" type="checkbox"/&gt;&lt;span class="sidenote"&gt;弥切，更深也。心意曰忱，谓心意向慕之切如葵藿之向日也。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;。比维荣问日昭&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-42"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-42" type="checkbox"/&gt;&lt;span class="sidenote"&gt;荣问，好声名也。昭，明也。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;。兴居纳福。慰如所颂。启者。&lt;span style="font-size:small"&gt;敝处&lt;/span&gt;地方僻陋&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-43"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-43" type="checkbox"/&gt;&lt;span class="sidenote"&gt;僻陋，偏荒之称。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;。风气尚未开通。小学校已成立者。不过五六所。皆粗具形式&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-44"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-44" type="checkbox"/&gt;&lt;span class="sidenote"&gt;形式，样子也。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;而已。若女子学校。则更付诸阙如。近由同志发起&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-45"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-45" type="checkbox"/&gt;&lt;span class="sidenote"&gt;初倡其事，谓之发起。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;。创办女子初等小学一所。业已组织就绪&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-46"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-46" type="checkbox"/&gt;&lt;span class="sidenote"&gt;谓事已办成也。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;。惟此项初等女学程度尚浅。以何种教科书最为适用&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-47"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-47" type="checkbox"/&gt;&lt;span class="sidenote"&gt;适用，合用也。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;。因念阁下热心教育。富&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-48"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-48" type="checkbox"/&gt;&lt;span class="sidenote"&gt;富，足也。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;有经验。务望不吝&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-49"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-49" type="checkbox"/&gt;&lt;span class="sidenote"&gt;不吝，不鄙惜也。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;赐教。俾得遵循&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-50"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-50" type="checkbox"/&gt;&lt;span class="sidenote"&gt;遵循，依从而行也。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;有自。 曷胜感幸之至。专此布达。敬颂撰祺。诸惟惠照不一。&lt;/p&gt;
&lt;p style="float:right"&gt;
&lt;span style="font-size:small"&gt;弟&lt;/span&gt;某某上言
    &lt;/p&gt;
&lt;p&gt;&lt;br/&gt;&lt;/p&gt;
&lt;h2 id="报告学校年终考试"&gt;报告学校年终考试&lt;/h2&gt;
&lt;p&gt;&lt;br/&gt;&lt;/p&gt;
&lt;p&gt;某某我兄尊右。流光如驶&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-51"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-51" type="checkbox"/&gt;&lt;span class="sidenote"&gt;行船曰驶，谓光阴快速也。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;。转瞬又居残年&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-52"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-52" type="checkbox"/&gt;&lt;span class="sidenote"&gt;谓一眨眼之间，年又将近也。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;。辰维時祉多绥&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-53"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-53" type="checkbox"/&gt;&lt;span class="sidenote"&gt;祉，福也。绥，安也。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;。欣以为颂。启者。&lt;span style="font-size:small"&gt;敝&lt;/span&gt;校下学期。业已发表&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-54"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-54" type="checkbox"/&gt;&lt;span class="sidenote"&gt;事已揭晓，谓之发表。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;。&lt;span style="font-size:small"&gt;弟&lt;/span&gt;各科分数。平均&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-55"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-55" type="checkbox"/&gt;&lt;span class="sidenote"&gt;均，匀也。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;在八十分以上。幸列于最优等。其中以算学国文两门。成绩稍优&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-56"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-56" type="checkbox"/&gt;&lt;span class="sidenote"&gt;功程曰绩，优，美也。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;。盖&lt;span style="font-size:small"&gt;弟&lt;/span&gt;平时所注重者。尤在于斯&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-57"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-57" type="checkbox"/&gt;&lt;span class="sidenote"&gt;尤，更也。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;。此次幸获&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-58"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-58" type="checkbox"/&gt;&lt;span class="sidenote"&gt;获，得也。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;美满之效果。稍慰平时之希望&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-59"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-59" type="checkbox"/&gt;&lt;span class="sidenote"&gt;希望，想望也。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;。想我&lt;/p&gt;
&lt;p&gt;兄闻之。当矣代为欣幸耳。知关垂注&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-60"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-60" type="checkbox"/&gt;&lt;span class="sidenote"&gt;称人俯念之词。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;。谨以报闻。年假在即&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-61"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-61" type="checkbox"/&gt;&lt;span class="sidenote"&gt;即，就近也。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;。不日即欲返里。再当面聆&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-62"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-62" type="checkbox"/&gt;&lt;span class="sidenote"&gt;聆，听也。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;教益。余不琐陈&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-63"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-63" type="checkbox"/&gt;&lt;span class="sidenote"&gt;余，多也。谓余多之言，亦不细碎布告也。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;。专上敬颂文祺。&lt;/p&gt;
&lt;p style="float:right"&gt;
&lt;span style="font-size:small"&gt;弟&lt;/span&gt;某某谨泐
    &lt;/p&gt;
&lt;p&gt;&lt;br/&gt;&lt;/p&gt;
&lt;h2 id="同学偶犯校规请免黜退"&gt;同学偶犯校规请免黜退&lt;/h2&gt;
&lt;p&gt;&lt;br/&gt;&lt;/p&gt;
&lt;p&gt;某某校长先生台鉴。&lt;/p&gt;
&lt;p&gt;迳启者。近因为同学某君某某。以某事偶犯校规&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-64"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-64" type="checkbox"/&gt;&lt;span class="sidenote"&gt;规，法则也。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;。恐未免有黜退&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-65"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-65" type="checkbox"/&gt;&lt;span class="sidenote"&gt;黜退，斥而去之也，（孟子）焉往而不三黜。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;之虑。窃&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-66"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-66" type="checkbox"/&gt;&lt;span class="sidenote"&gt;窃，私也。窃念，云一己之私意也。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;念先生尊重教育。奖惩并施&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-67"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-67" type="checkbox"/&gt;&lt;span class="sidenote"&gt;奖，赏也。惩，罚也。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;。用此不屑之教诲&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-68"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-68" type="checkbox"/&gt;&lt;span class="sidenote"&gt;（孟子）不屑之教诲者，是亦教诲之而已矣。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;。予&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-69"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-69" type="checkbox"/&gt;&lt;span class="sidenote"&gt;予，用也。许与之意。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;以相当之儆诫。此固正当办法。谁曰不宜&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-70"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-70" type="checkbox"/&gt;&lt;span class="sidenote"&gt;谁，何人也。言何人敢说此事为不当也。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;。&lt;span style="font-size:small"&gt;某&lt;/span&gt;等又何敢以不情&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-71"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-71" type="checkbox"/&gt;&lt;span class="sidenote"&gt;不情，谓不合情理也。（苏洵辨奸论）凡事之不近人情者。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;之请。上渎&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-72"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-72" type="checkbox"/&gt;&lt;span class="sidenote"&gt;渎，烦亵也。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;清德。惟&lt;span style="font-size:small"&gt;某&lt;/span&gt;等与某君同学。迄今已越两载有余&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-73"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-73" type="checkbox"/&gt;&lt;span class="sidenote"&gt;迄，至也。越，过也。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;。知其素性戆&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-74"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-74" type="checkbox"/&gt;&lt;span class="sidenote"&gt;（史记）戆哉汲黯也，戆，粗 &lt;a href="./assets/unknown2.png"&gt;??&lt;/a&gt; 貌。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;直。有时或未免失于自检。此次违犯规则。事后彼亦深自追悔。引谴未惶&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-75"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-75" type="checkbox"/&gt;&lt;span class="sidenote"&gt;谓彼亦自认过失也。未，不及也。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;。伏乞先生宽其既往&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-76"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-76" type="checkbox"/&gt;&lt;span class="sidenote"&gt;既往，谓已过去之事。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;。曲予矜全&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-77"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-77" type="checkbox"/&gt;&lt;span class="sidenote"&gt;矜全，成全之意。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;。使某君不致半途&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-78"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-78" type="checkbox"/&gt;&lt;span class="sidenote"&gt;半路，半途也。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;而废。前功尽弃。此则先生成人之美&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-79"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-79" type="checkbox"/&gt;&lt;span class="sidenote"&gt;（论语）君子成人之美。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;。为某等所馨香祷祝者耳。专肃。敬颂教安。诸维崇照。&lt;/p&gt;
&lt;p style="float:right"&gt;
&lt;span style="font-size:small"&gt;学生&lt;/span&gt;某某鞠躬
    &lt;/p&gt;
&lt;p&gt;&lt;br/&gt;&lt;/p&gt;
&lt;h2 id="聘请会计员"&gt;聘请会计员&lt;/h2&gt;
&lt;p&gt;&lt;br/&gt;&lt;/p&gt;
&lt;p&gt;某某先生大鉴。&lt;/p&gt;
&lt;p&gt;久仰芝晖&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-80"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-80" type="checkbox"/&gt;&lt;span class="sidenote"&gt;晖，光也。称人之容度曰芝晖。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;。时殷葭溯&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-81"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-81" type="checkbox"/&gt;&lt;span class="sidenote"&gt;葭溯，思怀之词。（诗经）蒹葭苍苍，（又）溯洄从之。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;。辰维与居曼&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-82"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-82" type="checkbox"/&gt;&lt;span class="sidenote"&gt;曼，长也。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;福。至以为颂。兹启者。&lt;span style="font-size:small"&gt;敝校&lt;/span&gt;会计一席&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-83"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-83" type="checkbox"/&gt;&lt;span class="sidenote"&gt;管理财款事务，谓之会计，即帐房之称。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;。向&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-84"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-84" type="checkbox"/&gt;&lt;span class="sidenote"&gt;向，从前之谓。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;归某君办理。现因病去世&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-85"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-85" type="checkbox"/&gt;&lt;span class="sidenote"&gt;人死曰去世。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;。此席尚付悬如。因悉阁下办事敏捷&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-86"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-86" type="checkbox"/&gt;&lt;span class="sidenote"&gt;敏捷，灵快也。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;。于经济学&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-87"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-87" type="checkbox"/&gt;&lt;span class="sidenote"&gt;经济学，谓理财之事。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;又素有经验。用敢奉屈高材。倘蒙不弃&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-88"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-88" type="checkbox"/&gt;&lt;span class="sidenote"&gt;弃，舍也。（诗经）不我遐弃。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;。乞即翩莅止&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-89"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-89" type="checkbox"/&gt;&lt;span class="sidenote"&gt;请人到来也。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;。是所盼祷。专上。顺颂台安。&lt;/p&gt;
&lt;p style="float:right"&gt;
&lt;span style="font-size:small"&gt;弟&lt;/span&gt;某某鞠躬
    &lt;/p&gt;
&lt;p&gt;&lt;br/&gt;&lt;/p&gt;
&lt;h2 id="教员辞聘再致函劝驾"&gt;教员辞聘再致函劝驾&lt;/h2&gt;
&lt;p&gt;&lt;br/&gt;&lt;/p&gt;
&lt;p&gt;某某先生阁下。前陈芜函&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-90"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-90" type="checkbox"/&gt;&lt;span class="sidenote"&gt;芜函，自谦为荒芜之书信。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;。请秉&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-91"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-91" type="checkbox"/&gt;&lt;span class="sidenote"&gt;秉，持也。请人作教员之词。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;教鞭。正在跂望&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-92"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-92" type="checkbox"/&gt;&lt;span class="sidenote"&gt;跂望，谓翘足而待也。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;时。忽接诵来翰&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-93"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-93" type="checkbox"/&gt;&lt;span class="sidenote"&gt;诵，读也。来翰，谓来信也。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;。具见虚怀若谷&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-94"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-94" type="checkbox"/&gt;&lt;span class="sidenote"&gt;谓谦虚之心，如空谷之能容也。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;。谦而弥光&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-95"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-95" type="checkbox"/&gt;&lt;span class="sidenote"&gt;（易经）谦尊而光。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;。令人益深钦仰。伏念先生品学兼优&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-96"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-96" type="checkbox"/&gt;&lt;span class="sidenote"&gt;兼优，并美也。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;。声华&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-97"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-97" type="checkbox"/&gt;&lt;span class="sidenote"&gt;声华，声容也。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;卓著。夙为学界所推崇。春风化雨&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-98"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-98" type="checkbox"/&gt;&lt;span class="sidenote"&gt;皆称教化之善也。（孟子）如时雨化之者。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;。定能造就人才。还祈俯&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-99"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-99" type="checkbox"/&gt;&lt;span class="sidenote"&gt;俯，垂下貌。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;如所请。慨然出而担任。不但全体学生。一致表示欢迎。且于&lt;span style="font-size:small"&gt;敝校&lt;/span&gt;前途。并可增进无穷幸福。用再专函劝驾&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-100"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-100" type="checkbox"/&gt;&lt;span class="sidenote"&gt;谓再备此信劝其动身到来也。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;。无任翘盼之。至肃此复请撰祺。&lt;/p&gt;
&lt;p style="float:right"&gt;
&lt;span style="font-size:small"&gt;弟&lt;/span&gt;某某谨上
    &lt;/p&gt;
&lt;p&gt;&lt;br/&gt;&lt;/p&gt;
&lt;h2 id="荐教员"&gt;荐教员&lt;/h2&gt;
&lt;p&gt;&lt;br/&gt;&lt;/p&gt;
&lt;p&gt;某某先生大鉴。&lt;/p&gt;
&lt;p&gt;久违光采。时切心仪&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-101"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-101" type="checkbox"/&gt;&lt;span class="sidenote"&gt;仪，景仰之意。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;。比维时祉&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-102"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-102" type="checkbox"/&gt;&lt;span class="sidenote"&gt;祉，福也。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;清嘉。文祺&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-103"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-103" type="checkbox"/&gt;&lt;span class="sidenote"&gt;祺，安也。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;畅达。式符&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-104"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-104" type="checkbox"/&gt;&lt;span class="sidenote"&gt;符，合也，忱，心意也。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;颂忱。昨某君来此。述及阁下提倡&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-105"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-105" type="checkbox"/&gt;&lt;span class="sidenote"&gt;提倡，即兴办之谓。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;教育。筹备经费。拟在某处开办某某学校一所&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-106"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-106" type="checkbox"/&gt;&lt;span class="sidenote"&gt;一所，一处也。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;。欣甚佩甚。惟贵校组织伊始&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-107"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-107" type="checkbox"/&gt;&lt;span class="sidenote"&gt;谓其筹办方初也。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;。各科教员。谅必尚在需&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-108"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-108" type="checkbox"/&gt;&lt;span class="sidenote"&gt;需，待用也。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;人。兹有&lt;span style="font-size:small"&gt;敝友&lt;/span&gt;某君某某。前在某某师范毕业。程度颇优&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-109"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-109" type="checkbox"/&gt;&lt;span class="sidenote"&gt;优，美也。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;。于国文算术等科。尤为擅&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-110"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-110" type="checkbox"/&gt;&lt;span class="sidenote"&gt;擅，专也。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;长。尊处如欲聘&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-111"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-111" type="checkbox"/&gt;&lt;span class="sidenote"&gt;聘，请也。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;用。&lt;span style="font-size:small"&gt;弟&lt;/span&gt;愿代为绍介。如蒙许可。希即示如&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-112"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-112" type="checkbox"/&gt;&lt;span class="sidenote"&gt;希，望也。望其来信示知也。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;。是所感盼。专布。敬颂大安。&lt;/p&gt;
&lt;p style="float:right"&gt;
&lt;span style="font-size:small"&gt;弟&lt;/span&gt;某某手启
    &lt;/p&gt;
&lt;p&gt;&lt;br/&gt;&lt;/p&gt;
&lt;h2 id="托同学返校时购带书籍"&gt;托同学返校时购带书籍&lt;/h2&gt;
&lt;p&gt;&lt;br/&gt;&lt;/p&gt;
&lt;p&gt;某某同学兄毅鉴。&lt;/p&gt;
&lt;p&gt;别经两旬&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-113"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-113" type="checkbox"/&gt;&lt;span class="sidenote"&gt;两旬，二十天也。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;。近况谅佳。知我兄假期将满。想不日即当返校&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-114"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-114" type="checkbox"/&gt;&lt;span class="sidenote"&gt;返，回也。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;。大驾道经沪江时&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-115"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-115" type="checkbox"/&gt;&lt;span class="sidenote"&gt;道经，犹云路过也。沪江，即上海。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;。烦向某书局代购数理精蕴一部&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-116"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-116" type="checkbox"/&gt;&lt;span class="sidenote"&gt;购，买也。数理精蕴，系算学书名。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;。计价若干。恳乞暂为填。俟到校后面奉可也。专此恳托。即颂潭祺。&lt;/p&gt;
&lt;p style="float:right"&gt;
&lt;span style="font-size:small"&gt;小弟&lt;/span&gt;某某手启
    &lt;/p&gt;
&lt;br/&gt;
&lt;!--%%REF%%--&gt;
&lt;br/&gt;
&lt;script async="" crossorigin="anonymous" data-category="Announcements" data-category-id="DIC_kwDOJ7Ymy84CX4eg" data-emit-metadata="0" data-input-position="top" data-lang="zh-CN" data-loading="lazy" data-mapping="title" data-reactions-enabled="1" data-repo="izfsk-ium/izfsk-ium.github.io" data-repo-id="R_kgDOJ7Ymyw" data-strict="0" data-theme="preferred_color_scheme" src="https://giscus.app/client.js"&gt;
&lt;/script&gt;
&lt;/main&gt;
&lt;footer&gt;
&lt;p class="signoff"&gt;
&lt;div class="metadata"&gt;
&lt;p class="date"&gt;&lt;time datetime="2023-01-25"&gt;创建日期：2023-01-25&lt;/time&gt;&lt;/p&gt;
&lt;p class="lastmodify"&gt;&lt;time&gt;最后编译：2023-08-10&lt;/time&gt;&lt;/p&gt;
&lt;p class="lastmodify" id="counter-span"&gt;访问次数：&lt;/p&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;/footer&gt;
&lt;script&gt;
    /* These script should run after page load */
    document.querySelectorAll('code.sourceCode').forEach(
      i =&gt; i.insertAdjacentHTML('beforeend', '&lt;div class="copy"&gt;复制&lt;/div&gt;')
    );
    document.querySelectorAll('div.copy').forEach(
      i =&gt; i.addEventListener(
        'click',
        () =&gt; {
          navigator.clipboard.writeText(i.parentElement.innerText.replace('复制', ''));
          i.innerText = '成功';
          setTimeout(() =&gt; {
            i.innerText = '复制';
          }, 1000);
        }
      )
    );

    if (location.href.includes("127.0.0.1:8080")) {
      document.getElementById("counter-span").innerHTML = "[[development mode]]";
    } else {
      const uuid = document.getElementById("article-uuid").innerText;
      const target = document.getElementById("counter-span");
      const last = localStorage.getItem("lastVisit-" + uuid);
      const shouldIncrease = last === null || new Date().getTime() - parseInt(last) &gt;= (1000 * 60 * 15);

      fetch(shouldIncrease ? ("https://counter.izfsk.top/counter/" + uuid) : ("https://counter.izfsk.top/readOnly/" + uuid))
        .then(r =&gt; r.text())
        .then(d =&gt; {
          if (!d.startsWith("Too"))
            document.getElementById("counter-span").innerText = "访问次数：" + d.toString();
          else
            document.getElementById("counter-span").innerHTML = "";
        });

      localStorage.setItem("lastVisit-" + uuid, new Date().getTime());
    }
  &lt;/script&gt;
&lt;script async="" data-website-id="2a1146ab-fa82-4a84-a04f-30e5967357c3" src="https://analytics.umami.is/script.js"&gt;&lt;/script&gt;
&lt;/body&gt;</content:encoded>
      <guid isPermaLink="false">3b4b4117-f9bc-4a49-937b-5fefbfc12f9c</guid>
      <pubDate>Wed, 25 Jan 2023 00:00:00 +0800</pubDate>
    </item>
    <item>
      <title>旧式书信整理2</title>
      <link>https://blog.izfsk.top/articles/旧式书信整理2.html</link>
      <description>旧式书信整理2</description>
      <content:encoded>&lt;body&gt;
&lt;progress id="content_progress" value="0"&gt;&lt;/progress&gt;
&lt;button id="back-to-top"&gt;
    回页顶
  &lt;/button&gt;
&lt;header&gt;
&lt;small id="article-uuid" style="display: none !important;"&gt;ec07d825-9c76-442d-85f5-7deaf5ab889a&lt;/small&gt;
&lt;h1 class="title"&gt;旧式书信整理2&lt;/h1&gt;
&lt;!-- Subtitle --&gt;
&lt;h3 class="subtitle"&gt; &lt;/h3&gt;
&lt;/header&gt;
&lt;nav id="TOC" role="doc-toc"&gt;
&lt;strong&gt;文章归类: &lt;a href="/pages/category.html#整理"&gt;整理&lt;/a&gt; &lt;/strong&gt;
&lt;input id="contents" type="checkbox"/&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#家书类" id="toc-家书类"&gt;家书类&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#祖谕孙训勉学业规矩" id="toc-祖谕孙训勉学业规矩"&gt;祖谕孙&lt;sub&gt;（训勉学业规矩）&lt;/sub&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#孙禀祖禀告学业事" id="toc-孙禀祖禀告学业事"&gt;孙禀祖&lt;sub&gt;（禀告学业事）&lt;/sub&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#祖母谕孙述近状" id="toc-祖母谕孙述近状"&gt;祖母谕孙&lt;sub&gt;（述近状）&lt;/sub&gt;&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#reference"&gt;参考链接&lt;/a&gt;&lt;/li&gt;
&lt;li&gt; &lt;/li&gt;
&lt;li class="tools"&gt;
&lt;span id="backtomain"&gt;
&lt;svg class="bi bi-house" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M8.707 1.5a1 1 0 0 0-1.414 0L.646 8.146a.5.5 0 0 0 .708.708L2 8.207V13.5A1.5 1.5 0 0 0 3.5 15h9a1.5 1.5 0 0 0 1.5-1.5V8.207l.646.647a.5.5 0 0 0 .708-.708L13 5.793V2.5a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v1.293L8.707 1.5ZM13 7.207V13.5a.5.5 0 0 1-.5.5h-9a.5.5 0 0 1-.5-.5V7.207l5-5 5 5Z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="readingmode"&gt;
&lt;svg class="bi bi-book" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M1 2.828c.885-.37 2.154-.769 3.388-.893 1.33-.134 2.458.063 3.112.752v9.746c-.935-.53-2.12-.603-3.213-.493-1.18.12-2.37.461-3.287.811V2.828zm7.5-.141c.654-.689 1.782-.886 3.112-.752 1.234.124 2.503.523 3.388.893v9.923c-.918-.35-2.107-.692-3.287-.81-1.094-.111-2.278-.039-3.213.492V2.687zM8 1.783C7.015.936 5.587.81 4.287.94c-1.514.153-3.042.672-3.994 1.105A.5.5 0 0 0 0 2.5v11a.5.5 0 0 0 .707.455c.882-.4 2.303-.881 3.68-1.02 1.409-.142 2.59.087 3.223.877a.5.5 0 0 0 .78 0c.633-.79 1.814-1.019 3.222-.877 1.378.139 2.8.62 3.681 1.02A.5.5 0 0 0 16 13.5v-11a.5.5 0 0 0-.293-.455c-.952-.433-2.48-.952-3.994-1.105C10.413.809 8.985.936 8 1.783z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="larger"&gt; &lt;/span&gt;
&lt;span id="smaller"&gt;&lt;/span&gt;
&lt;span id="switchfont"&gt;
&lt;svg class="bi bi-fonts" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M12.258 3h-8.51l-.083 2.46h.479c.26-1.544.758-1.783 2.693-1.845l.424-.013v7.827c0 .663-.144.82-1.3.923v.52h4.082v-.52c-1.162-.103-1.306-.26-1.306-.923V3.602l.431.013c1.934.062 2.434.301 2.693 1.846h.479L12.258 3z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="backtotop"&gt;
&lt;svg class="bi bi-arrow-bar-up" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M8 10a.5.5 0 0 0 .5-.5V3.707l2.146 2.147a.5.5 0 0 0 .708-.708l-3-3a.5.5 0 0 0-.708 0l-3 3a.5.5 0 1 0 .708.708L7.5 3.707V9.5a.5.5 0 0 0 .5.5zm-7 2.5a.5.5 0 0 1 .5-.5h13a.5.5 0 0 1 0 1h-13a.5.5 0 0 1-.5-.5z" fill-rule="evenodd"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/nav&gt;
&lt;main&gt;
&lt;p&gt;来源：《分类详注新尺牍大全》，袁韬壶 编著，群学出版社，1946 年，OCR + 整理，仅保留文本，简繁转换准确性存疑。&lt;/p&gt;
&lt;h1 id="家书类"&gt;家书类&lt;/h1&gt;
&lt;p&gt;&lt;br/&gt;&lt;/p&gt;
&lt;h2 id="祖谕孙训勉学业规矩"&gt;祖谕孙&lt;sub&gt;（训勉学业规矩）&lt;/sub&gt;&lt;/h2&gt;
&lt;p&gt;&lt;br/&gt;&lt;/p&gt;
&lt;p&gt;某孙收阅&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-0"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-0" type="checkbox"&gt;&lt;span class="sidenote"&gt;阅音月，看也。言收看此信也。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/input&gt;&lt;/span&gt;。&lt;/p&gt;
&lt;p&gt;昨接汝来信。知汝已于月之望日&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-1"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-1" type="checkbox"/&gt;&lt;span class="sidenote"&gt;十五日谓之望。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;。进店学业&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-2"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-2" type="checkbox"/&gt;&lt;span class="sidenote"&gt;学生意谓之学业。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;。身体平安如常&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-3"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-3" type="checkbox"/&gt;&lt;span class="sidenote"&gt;如常，同于平时也。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;。深为可慰&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-4"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-4" type="checkbox"/&gt;&lt;span class="sidenote"&gt;慰音尉，宽安也。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;。惟汝学业伊始&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-5"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-5" type="checkbox"/&gt;&lt;span class="sidenote"&gt;伊始，起初也。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;。诸宜勤慎从事&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-6"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-6" type="checkbox"/&gt;&lt;span class="sidenote"&gt;言许多事体，都要勤俭谨慎也。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;。一切店规&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-7"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-7" type="checkbox"/&gt;&lt;span class="sidenote"&gt;店规，店中规矩也。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;。均当恪守&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-8"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-8" type="checkbox"/&gt;&lt;span class="sidenote"&gt;恪音&lt;a href="./assets/140253.png"&gt;??&lt;/a&gt;，恪守，谨守也。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;。凡事须听业师教训&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-9"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-9" type="checkbox"/&gt;&lt;span class="sidenote"&gt;凡事，一切事体也。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;。店中诸位同事先生。及师兄等辈&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-10"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-10" type="checkbox"/&gt;&lt;span class="sidenote"&gt;诸位，众位也。店中朋友，谓之同事。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;。应以恭敬和睦相待。晚间店务有暇&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-11"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-11" type="checkbox"/&gt;&lt;span class="sidenote"&gt;暇，空闲也。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;。须随时学算习字&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-12"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-12" type="checkbox"/&gt;&lt;span class="sidenote"&gt;习常，学也。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;。切不可怠惰疏忽&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-13"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-13" type="checkbox"/&gt;&lt;span class="sidenote"&gt;怠惰，不勤力也。疏忽，不谨慎也。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;。是为至要。余&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-14"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-14" type="checkbox"/&gt;&lt;span class="sidenote"&gt;余，我也。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;在家安好。汝父昨亦有安信&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-15"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-15" type="checkbox"/&gt;&lt;span class="sidenote"&gt;安信，平安家书也。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;寄来。拟下月初旬&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-16"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-16" type="checkbox"/&gt;&lt;span class="sidenote"&gt;初一至初十，谓之上旬。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;。方可回家云云&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-17"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-17" type="checkbox"/&gt;&lt;span class="sidenote"&gt;云云，犹云所话如此也。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;。汝母及弟妹等&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-18"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-18" type="checkbox"/&gt;&lt;span class="sidenote"&gt;等，一切也。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;亦各平顺。毋庸&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-19"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-19" type="checkbox"/&gt;&lt;span class="sidenote"&gt;毋庸，不必也。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;挂念。此付知之。&lt;/p&gt;
&lt;p&gt;&lt;span style="float:right"&gt;祖字&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;br/&gt;&lt;/p&gt;
&lt;h2 id="孙禀祖禀告学业事"&gt;孙禀祖&lt;sub&gt;（禀告学业事）&lt;/sub&gt;&lt;/h2&gt;
&lt;p&gt;&lt;br/&gt;&lt;/p&gt;
&lt;p&gt;祖父大人钧鉴&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-20"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-20" type="checkbox"/&gt;&lt;span class="sidenote"&gt;钧，重也。系尊称之词，或用慈鉴膝前等字亦可。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;。&lt;/p&gt;
&lt;p&gt;敬禀者&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-21"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-21" type="checkbox"/&gt;&lt;span class="sidenote"&gt;凡下辈致信于长辈，须用敬禀者三字，言恭敬禀告也。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;。顷&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-22"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-22" type="checkbox"/&gt;&lt;span class="sidenote"&gt;顷，即刻也。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;接来训。谨已读悉&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-23"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-23" type="checkbox"/&gt;&lt;span class="sidenote"&gt;读悉，读知也。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;。并知大人福体康健&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-24"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-24" type="checkbox"/&gt;&lt;span class="sidenote"&gt;康，安也。健，强也。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;。  母亲及弟妹等。均各平安。不胜欣慰&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-25"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-25" type="checkbox"/&gt;&lt;span class="sidenote"&gt;欣慰，言心中欢喜而宽安也。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;。  父亲处今日亦寄去一禀。免在远地罣念&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-26"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-26" type="checkbox"/&gt;&lt;span class="sidenote"&gt;罣念，与挂念同。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;。在店中。诸事自当勤慎。决不敢稍存怠忽。晚间遇公务&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-27"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-27" type="checkbox"/&gt;&lt;span class="sidenote"&gt;公务，事也。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;闲暇时。字算两项&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-28"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-28" type="checkbox"/&gt;&lt;span class="sidenote"&gt;两项，两件之事也。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;。常在灯下练习&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-29"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-29" type="checkbox"/&gt;&lt;span class="sidenote"&gt;练音理，学习也。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;。并蒙业师某先生随时指教&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-30"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-30" type="checkbox"/&gt;&lt;span class="sidenote"&gt;指教，指示教导也。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;。尤为可感&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-31"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-31" type="checkbox"/&gt;&lt;span class="sidenote"&gt;尤，更也。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;。店中同事诸君。亦均肯照顾。叨益&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-32"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-32" type="checkbox"/&gt;&lt;span class="sidenote"&gt;叨益，受其益处也。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;良多。一切之事。&lt;span style="font-size:small"&gt;孙&lt;/span&gt;当谨遵&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-33"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-33" type="checkbox"/&gt;&lt;span class="sidenote"&gt;谨尊，敬依也。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;大人训谕而行。毋劳慈廑&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-34"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-34" type="checkbox"/&gt;&lt;span class="sidenote"&gt;慈廑，仁慈之思念也。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;。余容后禀。专肃。敬请崇安。&lt;/p&gt;
&lt;p&gt;&lt;span style="float:right"&gt;&lt;span style="font-size:small"&gt;孙儿&lt;/span&gt;某某顿首&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;br/&gt;&lt;/p&gt;
&lt;h2 id="祖母谕孙述近状"&gt;祖母谕孙&lt;sub&gt;（述近状）&lt;/sub&gt;&lt;/h2&gt;
&lt;p&gt;&lt;br/&gt;&lt;/p&gt;
&lt;p&gt;某某孙儿收读&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-35"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-35" type="checkbox"/&gt;&lt;span class="sidenote"&gt;谓收此信而读之也。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;。&lt;/p&gt;
&lt;p&gt;昨由邮局递&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-36"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-36" type="checkbox"/&gt;&lt;span class="sidenote"&gt;递，传送也。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;来一信。并附家用洋拾元。均&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-37"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-37" type="checkbox"/&gt;&lt;span class="sidenote"&gt;均，皆也。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;早收到。知汝在店安好。&lt;span style="font-size:small"&gt;余&lt;/span&gt;及汝母闻之。都觉安心&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-38"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-38" type="checkbox"/&gt;&lt;span class="sidenote"&gt;余，我也，觉，知及也。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;。家乡百物昂贵&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-39"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-39" type="checkbox"/&gt;&lt;span class="sidenote"&gt;昂，高也。言家乡百种货物价目，高贵也。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;。米珠薪桂&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-40"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-40" type="checkbox"/&gt;&lt;span class="sidenote"&gt;米如珠，柴如桂，喻柴米之价甚贵也。薪音新，柴也。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;。世境益&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-41"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-41" type="checkbox"/&gt;&lt;span class="sidenote"&gt;益，更加也。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;觉艰难。持家&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-42"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-42" type="checkbox"/&gt;&lt;span class="sidenote"&gt;持家，管理家务也。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;正非易易。惟有量入为出&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-43"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-43" type="checkbox"/&gt;&lt;span class="sidenote"&gt;量，度也。言只可酌量所入之进款，为用出之数目也。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;。俭省&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-44"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-44" type="checkbox"/&gt;&lt;span class="sidenote"&gt;俭省，不奢用妄费也。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;度日而已。汝母病已步痊&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-45"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-45" type="checkbox"/&gt;&lt;span class="sidenote"&gt;言病已逐步见痊也。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;。胃口亦较前为佳&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-46"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-46" type="checkbox"/&gt;&lt;span class="sidenote"&gt;言吃饭之胃口，亦比从前好些。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;。现仍医药调理&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-47"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-47" type="checkbox"/&gt;&lt;span class="sidenote"&gt;现在仍旧请医服药，以调养其病也。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;。想不日即可痊愈&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-48"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-48" type="checkbox"/&gt;&lt;span class="sidenote"&gt;不日，不多几日也病已退尽曰全愈。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;。无庸挂虑&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-49"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-49" type="checkbox"/&gt;&lt;span class="sidenote"&gt;言不必挂念忧思也。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;。今年店中生意如何。想入冬以来。谅必渐有起色&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-50"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-50" type="checkbox"/&gt;&lt;span class="sidenote"&gt;起色，犹云生色也。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;。汝在外一切冷热。切宜小心为要&lt;span class="sidenote-wrapper"&gt;&lt;label class="margin-toggle sidenote-number" for="sn-51"&gt;&lt;/label&gt;&lt;input class="margin-toggle" id="sn-51" type="checkbox"/&gt;&lt;span class="sidenote"&gt;诸，多也，宜，应当也。&lt;br/&gt;
&lt;br/&gt;
&lt;/span&gt;&lt;/span&gt;。余不多嘱。此复收目。&lt;/p&gt;
&lt;p&gt;&lt;span style="float:right"&gt;祖母字&lt;/span&gt;&lt;/p&gt;
&lt;br/&gt;
&lt;!--%%REF%%--&gt;
&lt;br/&gt;
&lt;script async="" crossorigin="anonymous" data-category="Announcements" data-category-id="DIC_kwDOJ7Ymy84CX4eg" data-emit-metadata="0" data-input-position="top" data-lang="zh-CN" data-loading="lazy" data-mapping="title" data-reactions-enabled="1" data-repo="izfsk-ium/izfsk-ium.github.io" data-repo-id="R_kgDOJ7Ymyw" data-strict="0" data-theme="preferred_color_scheme" src="https://giscus.app/client.js"&gt;
&lt;/script&gt;
&lt;/main&gt;
&lt;footer&gt;
&lt;p class="signoff"&gt;
&lt;div class="metadata"&gt;
&lt;p class="date"&gt;&lt;time datetime="2023-01-28"&gt;创建日期：2023-01-28&lt;/time&gt;&lt;/p&gt;
&lt;p class="lastmodify"&gt;&lt;time&gt;最后编译：2023-08-10&lt;/time&gt;&lt;/p&gt;
&lt;p class="lastmodify" id="counter-span"&gt;访问次数：&lt;/p&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;/footer&gt;
&lt;script&gt;
    /* These script should run after page load */
    document.querySelectorAll('code.sourceCode').forEach(
      i =&gt; i.insertAdjacentHTML('beforeend', '&lt;div class="copy"&gt;复制&lt;/div&gt;')
    );
    document.querySelectorAll('div.copy').forEach(
      i =&gt; i.addEventListener(
        'click',
        () =&gt; {
          navigator.clipboard.writeText(i.parentElement.innerText.replace('复制', ''));
          i.innerText = '成功';
          setTimeout(() =&gt; {
            i.innerText = '复制';
          }, 1000);
        }
      )
    );

    if (location.href.includes("127.0.0.1:8080")) {
      document.getElementById("counter-span").innerHTML = "[[development mode]]";
    } else {
      const uuid = document.getElementById("article-uuid").innerText;
      const target = document.getElementById("counter-span");
      const last = localStorage.getItem("lastVisit-" + uuid);
      const shouldIncrease = last === null || new Date().getTime() - parseInt(last) &gt;= (1000 * 60 * 15);

      fetch(shouldIncrease ? ("https://counter.izfsk.top/counter/" + uuid) : ("https://counter.izfsk.top/readOnly/" + uuid))
        .then(r =&gt; r.text())
        .then(d =&gt; {
          if (!d.startsWith("Too"))
            document.getElementById("counter-span").innerText = "访问次数：" + d.toString();
          else
            document.getElementById("counter-span").innerHTML = "";
        });

      localStorage.setItem("lastVisit-" + uuid, new Date().getTime());
    }
  &lt;/script&gt;
&lt;script async="" data-website-id="2a1146ab-fa82-4a84-a04f-30e5967357c3" src="https://analytics.umami.is/script.js"&gt;&lt;/script&gt;
&lt;/body&gt;</content:encoded>
      <guid isPermaLink="false">ec07d825-9c76-442d-85f5-7deaf5ab889a</guid>
      <pubDate>Sat, 28 Jan 2023 00:00:00 +0800</pubDate>
    </item>
    <item>
      <title>使用 TeXmacs 排版作业</title>
      <link>https://blog.izfsk.top/articles/使用TeXmacs排版作业.html</link>
      <description>使用 TeXmacs 排版作业</description>
      <content:encoded>&lt;body&gt;
&lt;progress id="content_progress" value="0"&gt;&lt;/progress&gt;
&lt;button id="back-to-top"&gt;
    回页顶
  &lt;/button&gt;
&lt;header&gt;
&lt;small id="article-uuid" style="display: none !important;"&gt;ac2beaa1-e98c-4108-9d0c-06f035cbaad3&lt;/small&gt;
&lt;h1 class="title"&gt;使用 TeXmacs 排版作业&lt;/h1&gt;
&lt;!-- Subtitle --&gt;
&lt;h3 class="subtitle"&gt; &lt;/h3&gt;
&lt;/header&gt;
&lt;nav id="TOC" role="doc-toc"&gt;
&lt;strong&gt;文章归类: &lt;a href="/pages/category.html#杂项"&gt;杂项&lt;/a&gt; &lt;/strong&gt;
&lt;input id="contents" type="checkbox"/&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#内置的模板" id="toc-内置的模板"&gt;内置的模板&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#文章结构" id="toc-文章结构"&gt;文章结构&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#文本格式" id="toc-文本格式"&gt;文本格式&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#添加目录" id="toc-添加目录"&gt;添加目录&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#参考文献的添加" id="toc-参考文献的添加"&gt;参考文献的添加&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#公式编辑" id="toc-公式编辑"&gt;公式编辑&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#参考" id="toc-参考"&gt;参考&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#reference"&gt;参考链接&lt;/a&gt;&lt;/li&gt;
&lt;li&gt; &lt;/li&gt;
&lt;li class="tools"&gt;
&lt;span id="backtomain"&gt;
&lt;svg class="bi bi-house" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M8.707 1.5a1 1 0 0 0-1.414 0L.646 8.146a.5.5 0 0 0 .708.708L2 8.207V13.5A1.5 1.5 0 0 0 3.5 15h9a1.5 1.5 0 0 0 1.5-1.5V8.207l.646.647a.5.5 0 0 0 .708-.708L13 5.793V2.5a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v1.293L8.707 1.5ZM13 7.207V13.5a.5.5 0 0 1-.5.5h-9a.5.5 0 0 1-.5-.5V7.207l5-5 5 5Z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="readingmode"&gt;
&lt;svg class="bi bi-book" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M1 2.828c.885-.37 2.154-.769 3.388-.893 1.33-.134 2.458.063 3.112.752v9.746c-.935-.53-2.12-.603-3.213-.493-1.18.12-2.37.461-3.287.811V2.828zm7.5-.141c.654-.689 1.782-.886 3.112-.752 1.234.124 2.503.523 3.388.893v9.923c-.918-.35-2.107-.692-3.287-.81-1.094-.111-2.278-.039-3.213.492V2.687zM8 1.783C7.015.936 5.587.81 4.287.94c-1.514.153-3.042.672-3.994 1.105A.5.5 0 0 0 0 2.5v11a.5.5 0 0 0 .707.455c.882-.4 2.303-.881 3.68-1.02 1.409-.142 2.59.087 3.223.877a.5.5 0 0 0 .78 0c.633-.79 1.814-1.019 3.222-.877 1.378.139 2.8.62 3.681 1.02A.5.5 0 0 0 16 13.5v-11a.5.5 0 0 0-.293-.455c-.952-.433-2.48-.952-3.994-1.105C10.413.809 8.985.936 8 1.783z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="larger"&gt; &lt;/span&gt;
&lt;span id="smaller"&gt;&lt;/span&gt;
&lt;span id="switchfont"&gt;
&lt;svg class="bi bi-fonts" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M12.258 3h-8.51l-.083 2.46h.479c.26-1.544.758-1.783 2.693-1.845l.424-.013v7.827c0 .663-.144.82-1.3.923v.52h4.082v-.52c-1.162-.103-1.306-.26-1.306-.923V3.602l.431.013c1.934.062 2.434.301 2.693 1.846h.479L12.258 3z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="backtotop"&gt;
&lt;svg class="bi bi-arrow-bar-up" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M8 10a.5.5 0 0 0 .5-.5V3.707l2.146 2.147a.5.5 0 0 0 .708-.708l-3-3a.5.5 0 0 0-.708 0l-3 3a.5.5 0 1 0 .708.708L7.5 3.707V9.5a.5.5 0 0 0 .5.5zm-7 2.5a.5.5 0 0 1 .5-.5h13a.5.5 0 0 1 0 1h-13a.5.5 0 0 1-.5-.5z" fill-rule="evenodd"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/nav&gt;
&lt;main&gt;
&lt;style&gt;

    .latex sub {
      vertical-align: -0.1ex;
      margin-left: -0.1667em;
      margin-right: -0.025em;
    }

    .latex sub, .latex sup {
      font-size: 0.9em;
      text-transform:uppercase;

    }
    .latex sup {
      font-size: 0.85em;
      vertical-align: -0.2em;
      margin-left: -0.26em;
      margin-right: -0.05em;
    }

    &lt;/style&gt;
&lt;p&gt;我被 LibreOffice 折磨了五年。&lt;/p&gt;
&lt;p&gt;为了替换它，我尝试了 Markdown，但它的功能太简单了，尝试了 &lt;span class="latex"&gt;L&lt;sup&gt;A&lt;/sup&gt;T&lt;sub&gt;E&lt;/sub&gt;X&lt;/span&gt;，但是首先我没学会，其次我从来没有成功的让它显示中文字符，并且它的大小也太夸张了。最后我找到了 &lt;a href="https://www.texmacs.org/tmweb/home/welcome.en.html"&gt;GNU TeXmacs&lt;/a&gt;。我以前也不是没有听说过，但是受到它的名字的误导，我认为它是一个「使用 Emacs 的 TeX 编辑器」。其实它和两者的关系不大。&lt;/p&gt;
&lt;p&gt;&lt;code&gt;openSUSE&lt;/code&gt; 的软件源里面没有，需要&lt;a href="https://texmacs.org/tmweb/download/linux-packages.en.html#suse"&gt;下载 rpm 包&lt;/a&gt;安装。&lt;/p&gt;
&lt;p&gt;在使用 TeXmacs 之前免不了需要解决一些疑难杂症。都和中文有关。首先是文档语言无法选择中文的问题，你需要在首选项中将界面语言改为中文才行，同样的，如果需要选择日文就把界面语言改为日文，其他各种不能用键盘上的字母表达的语言操作类似。其次是输入中文乱码的问题，在有些系统上，默认的中文字体 &lt;code&gt;sys-chinese&lt;/code&gt; 是没有的，所以会指定到 &lt;code&gt;TeX&lt;/code&gt; 的默认字体，自然无法显示中文。你需要给 TeXmacs 添加字体才行。所幸官网给出了中文字体包：&lt;a href="ftp://ftp.texmacs.org/pub/TeXmacs/fonts/TeXmacs-chinese-fonts.tar.gz"&gt;fireflysung&lt;/a&gt;。你需要把它解压到 &lt;code&gt;~/.TeXmacs/fonts&lt;/code&gt; 里面。最后目录结构应该是这样的:&lt;/p&gt;
&lt;div class="sourceCode" id="cb1"&gt;&lt;pre class="sourceCode erlang"&gt;&lt;code class="sourceCode erlang"&gt;&lt;span id="cb1-1"&gt;&lt;a aria-hidden="true" href="#cb1-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="ch"&gt;fonts&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-2"&gt;&lt;a aria-hidden="true" href="#cb1-2" tabindex="-1"&gt;&lt;/a&gt;├── &lt;span class="ch"&gt;enc&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-3"&gt;&lt;a aria-hidden="true" href="#cb1-3" tabindex="-1"&gt;&lt;/a&gt;├── &lt;span class="ch"&gt;error&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-4"&gt;&lt;a aria-hidden="true" href="#cb1-4" tabindex="-1"&gt;&lt;/a&gt;├── &lt;span class="ch"&gt;font&lt;/span&gt;&lt;span class="op"&gt;-&lt;/span&gt;&lt;span class="ch"&gt;characteristics&lt;/span&gt;&lt;span class="fu"&gt;.&lt;/span&gt;&lt;span class="ch"&gt;scm&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-5"&gt;&lt;a aria-hidden="true" href="#cb1-5" tabindex="-1"&gt;&lt;/a&gt;├── &lt;span class="ch"&gt;font&lt;/span&gt;&lt;span class="op"&gt;-&lt;/span&gt;&lt;span class="ch"&gt;database&lt;/span&gt;&lt;span class="fu"&gt;.&lt;/span&gt;&lt;span class="ch"&gt;scm&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-6"&gt;&lt;a aria-hidden="true" href="#cb1-6" tabindex="-1"&gt;&lt;/a&gt;├── &lt;span class="ch"&gt;font&lt;/span&gt;&lt;span class="op"&gt;-&lt;/span&gt;&lt;span class="ch"&gt;features&lt;/span&gt;&lt;span class="fu"&gt;.&lt;/span&gt;&lt;span class="ch"&gt;scm&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-7"&gt;&lt;a aria-hidden="true" href="#cb1-7" tabindex="-1"&gt;&lt;/a&gt;├── &lt;span class="ch"&gt;pk&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-8"&gt;&lt;a aria-hidden="true" href="#cb1-8" tabindex="-1"&gt;&lt;/a&gt;├── &lt;span class="ch"&gt;tfm&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-9"&gt;&lt;a aria-hidden="true" href="#cb1-9" tabindex="-1"&gt;&lt;/a&gt;├── &lt;span class="ch"&gt;truetype&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-10"&gt;&lt;a aria-hidden="true" href="#cb1-10" tabindex="-1"&gt;&lt;/a&gt;│   ├── &lt;span class="va"&gt;FandolBraille&lt;/span&gt;&lt;span class="op"&gt;-&lt;/span&gt;&lt;span class="va"&gt;Display&lt;/span&gt;&lt;span class="fu"&gt;.&lt;/span&gt;&lt;span class="ch"&gt;otf&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-11"&gt;&lt;a aria-hidden="true" href="#cb1-11" tabindex="-1"&gt;&lt;/a&gt;│   ├── &lt;span class="va"&gt;FandolBraille&lt;/span&gt;&lt;span class="op"&gt;-&lt;/span&gt;&lt;span class="va"&gt;Regular&lt;/span&gt;&lt;span class="fu"&gt;.&lt;/span&gt;&lt;span class="ch"&gt;otf&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-12"&gt;&lt;a aria-hidden="true" href="#cb1-12" tabindex="-1"&gt;&lt;/a&gt;│   ├── &lt;span class="va"&gt;FandolFang&lt;/span&gt;&lt;span class="op"&gt;-&lt;/span&gt;&lt;span class="va"&gt;Regular&lt;/span&gt;&lt;span class="fu"&gt;.&lt;/span&gt;&lt;span class="ch"&gt;otf&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-13"&gt;&lt;a aria-hidden="true" href="#cb1-13" tabindex="-1"&gt;&lt;/a&gt;│   ├── &lt;span class="va"&gt;FandolHei&lt;/span&gt;&lt;span class="op"&gt;-&lt;/span&gt;&lt;span class="va"&gt;Bold&lt;/span&gt;&lt;span class="fu"&gt;.&lt;/span&gt;&lt;span class="ch"&gt;otf&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-14"&gt;&lt;a aria-hidden="true" href="#cb1-14" tabindex="-1"&gt;&lt;/a&gt;│   ├── &lt;span class="va"&gt;FandolHei&lt;/span&gt;&lt;span class="op"&gt;-&lt;/span&gt;&lt;span class="va"&gt;Regular&lt;/span&gt;&lt;span class="fu"&gt;.&lt;/span&gt;&lt;span class="ch"&gt;otf&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-15"&gt;&lt;a aria-hidden="true" href="#cb1-15" tabindex="-1"&gt;&lt;/a&gt;│   ├── &lt;span class="va"&gt;FandolKai&lt;/span&gt;&lt;span class="op"&gt;-&lt;/span&gt;&lt;span class="va"&gt;Regular&lt;/span&gt;&lt;span class="fu"&gt;.&lt;/span&gt;&lt;span class="ch"&gt;otf&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-16"&gt;&lt;a aria-hidden="true" href="#cb1-16" tabindex="-1"&gt;&lt;/a&gt;│   ├── &lt;span class="va"&gt;FandolSong&lt;/span&gt;&lt;span class="op"&gt;-&lt;/span&gt;&lt;span class="va"&gt;Bold&lt;/span&gt;&lt;span class="fu"&gt;.&lt;/span&gt;&lt;span class="ch"&gt;otf&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-17"&gt;&lt;a aria-hidden="true" href="#cb1-17" tabindex="-1"&gt;&lt;/a&gt;│   ├── &lt;span class="va"&gt;FandolSong&lt;/span&gt;&lt;span class="op"&gt;-&lt;/span&gt;&lt;span class="va"&gt;Regular&lt;/span&gt;&lt;span class="fu"&gt;.&lt;/span&gt;&lt;span class="ch"&gt;otf&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-18"&gt;&lt;a aria-hidden="true" href="#cb1-18" tabindex="-1"&gt;&lt;/a&gt;│   └── &lt;span class="ch"&gt;fireflysung&lt;/span&gt;&lt;span class="fu"&gt;.&lt;/span&gt;&lt;span class="ch"&gt;ttf&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-19"&gt;&lt;a aria-hidden="true" href="#cb1-19" tabindex="-1"&gt;&lt;/a&gt;├── &lt;span class="ch"&gt;type1&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-20"&gt;&lt;a aria-hidden="true" href="#cb1-20" tabindex="-1"&gt;&lt;/a&gt;├── &lt;span class="ch"&gt;unpacked&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-21"&gt;&lt;a aria-hidden="true" href="#cb1-21" tabindex="-1"&gt;&lt;/a&gt;└── &lt;span class="ch"&gt;virtual&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;不要忘记添加以后运行 &lt;code&gt;texmacs --delete-font-cache&lt;/code&gt; 清除缓存，然后就可以使用了。另外建议把宋体楷体什么的也安排上，直接用 &lt;a href="https://www.ctan.org/tex-archive/fonts/fandol/"&gt;&lt;code&gt;CTAN&lt;/code&gt;&lt;/a&gt; 的包就行。&lt;/p&gt;
&lt;p&gt;除此以外，在保存时也会遇到问题，焦点会强制集中在一个什么都没有的窗口上，不过不影响后面文件选择窗口的操作，记得&lt;strong&gt;输入文件名&lt;/strong&gt;。它保存的是纯文本文件，内容格式类似于 &lt;code&gt;XML&lt;/code&gt;。&lt;/p&gt;
&lt;p&gt;&lt;img src="./assets/wrong.webp"/&gt;&lt;/p&gt;
&lt;p&gt;下面记录一些常见的操作。&lt;/p&gt;
&lt;h2 id="内置的模板"&gt;内置的模板&lt;/h2&gt;
&lt;p&gt;使用 &lt;code&gt;文档 -&amp;gt; 样式&lt;/code&gt; 来选取预定的样式，直接选择 &lt;code&gt;article&lt;/code&gt; 即可。它包含了标题，作者，摘要之类的东西。可以自己改进，但是它的模板似乎是用类似 scheme 的 dsl 写的…&lt;/p&gt;
&lt;h2 id="文章结构"&gt;文章结构&lt;/h2&gt;
&lt;p&gt;标准的文章结构是标题，摘要，正文等等。&lt;strong&gt;关键词是放在摘要里面的&lt;/strong&gt;，所以在摘要环境的菜单里面选中。&lt;/p&gt;
&lt;p&gt;&lt;img src="./assets/keywords.webp"/&gt;&lt;/p&gt;
&lt;h2 id="文本格式"&gt;文本格式&lt;/h2&gt;
&lt;p&gt;和 &lt;code&gt;Word&lt;/code&gt; 之类的软件类似，菜单上的选项是不言而喻的。不过如果不想离开键盘，还可以使用 &lt;code&gt;tex&lt;/code&gt; 命令。 &lt;code&gt;tex&lt;/code&gt; 命令都以 &lt;code&gt;\&lt;/code&gt; 开头，输入以后可以自动补全。诸如 &lt;code&gt;strong&lt;/code&gt; ，&lt;code&gt;code&lt;/code&gt;，&lt;code&gt;abbr&lt;/code&gt; 之类的文本格式可以直接输入。步骤是输入 &lt;code&gt;\&lt;/code&gt; 再在蓝色尖括号中输入指令，按下回车就行。输入完毕以后移动到块以外。常见的格式如下：&lt;/p&gt;
&lt;p&gt;&lt;img src="./assets/formats.webp"/&gt;&lt;/p&gt;
&lt;p&gt;然后是给文章添加节，同样是使用 &lt;code&gt;TEX&lt;/code&gt; 命令。用 &lt;code&gt;\section&lt;/code&gt; 添加节，&lt;code&gt;\subsection&lt;/code&gt; 添加子节，还有 &lt;code&gt;\subsubsection&lt;/code&gt; 之类。添加以后会自动更新，所以不用担心序号错乱问题。&lt;/p&gt;
&lt;h2 id="添加目录"&gt;添加目录&lt;/h2&gt;
&lt;p&gt;在想要添加目录的地方，使用 &lt;code&gt;\table-of-contents&lt;/code&gt; 命令，接下来按回车，再在 &lt;code&gt;|&lt;/code&gt; 后面输入 &lt;code&gt;toc&lt;/code&gt; 即可。命令看上去是这样的：&lt;code&gt;&amp;lt;\table-of-contents|toc&amp;gt;&lt;/code&gt;。接下来回车就行。但是目录不会自己更新。需要在 &lt;code&gt;文档 -&amp;gt; 更新 -&amp;gt; 目录&lt;/code&gt; 中手动更新一下。&lt;/p&gt;
&lt;h2 id="参考文献的添加"&gt;参考文献的添加&lt;/h2&gt;
&lt;p&gt;首先需要一个 &lt;code&gt;BibTeX&lt;/code&gt; 文件。它算是一个引用数据库，在主文档里面引用它里面的内容即可。比如说有一个 &lt;code&gt;BibTeX&lt;/code&gt; 文件是这样：&lt;/p&gt;
&lt;div class="sourceCode" id="cb2"&gt;&lt;pre class="sourceCode bibtex"&gt;&lt;code class="sourceCode bibtex"&gt;&lt;span id="cb2-1"&gt;&lt;a aria-hidden="true" href="#cb2-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="va"&gt;@misc&lt;/span&gt;{&lt;span class="ot"&gt;hello&lt;/span&gt;,&lt;/span&gt;
&lt;span id="cb2-2"&gt;&lt;a aria-hidden="true" href="#cb2-2" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="dt"&gt;author&lt;/span&gt; = "&lt;span class="st"&gt;Nobody Jr&lt;/span&gt;",&lt;/span&gt;
&lt;span id="cb2-3"&gt;&lt;a aria-hidden="true" href="#cb2-3" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="dt"&gt;title&lt;/span&gt; = "&lt;span class="st"&gt;My Article&lt;/span&gt;",&lt;/span&gt;
&lt;span id="cb2-4"&gt;&lt;a aria-hidden="true" href="#cb2-4" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="dt"&gt;year&lt;/span&gt; = "&lt;span class="st"&gt;2006&lt;/span&gt;" &lt;/span&gt;
&lt;span id="cb2-5"&gt;&lt;a aria-hidden="true" href="#cb2-5" tabindex="-1"&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id="cb2-6"&gt;&lt;a aria-hidden="true" href="#cb2-6" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="va"&gt;@book&lt;/span&gt;{&lt;span class="ot"&gt;pci&lt;/span&gt;,  &lt;/span&gt;
&lt;span id="cb2-7"&gt;&lt;a aria-hidden="true" href="#cb2-7" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="dt"&gt;title&lt;/span&gt; = "&lt;span class="st"&gt;某本书籍&lt;/span&gt;",  &lt;/span&gt;
&lt;span id="cb2-8"&gt;&lt;a aria-hidden="true" href="#cb2-8" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="dt"&gt;author&lt;/span&gt; = "&lt;span class="st"&gt;某个作者&lt;/span&gt;",  &lt;/span&gt;
&lt;span id="cb2-9"&gt;&lt;a aria-hidden="true" href="#cb2-9" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="dt"&gt;year&lt;/span&gt; = "&lt;span class="st"&gt;2007&lt;/span&gt;",  &lt;/span&gt;
&lt;span id="cb2-10"&gt;&lt;a aria-hidden="true" href="#cb2-10" tabindex="-1"&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;然后在 &lt;code&gt;插入自动生生成的内容 -&amp;gt; 参考文献&lt;/code&gt; 中选择这个文件。注意：&lt;strong&gt;bibtex 文件必须在同一个目录！&lt;/strong&gt;。接下来在需要引用的地方使用 &lt;code&gt;&amp;lt;\cite|name&amp;gt;&lt;/code&gt; ，然后刷新&lt;strong&gt;两次&lt;/strong&gt;即可。&lt;/p&gt;
&lt;p&gt;注意事项：&lt;/p&gt;
&lt;ol type="1"&gt;
&lt;li&gt;Bibtex 文件的后缀名必须是 &lt;code&gt;.bib&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;引用标签不能是中文，否则乱码&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img src="./assets/bib.webp"/&gt;&lt;/p&gt;
&lt;p&gt;不管是添加表格也好，添加其他内容也罢，当焦点在对应的元素环境里面时，第三列工具栏就会显示为当前环境的相关工具。比如表格就会显示添加行列的按钮等。&lt;/p&gt;
&lt;p&gt;我的应用场景是对排版元素要求不高的电子版作业，考虑到我的专业，基本没有公式和复杂表格的需求，所以用起来还是绰绰有余的。但是毕竟公式编辑是它最激动人心的功能,所以还是看一眼。&lt;/p&gt;
&lt;h2 id="公式编辑"&gt;公式编辑&lt;/h2&gt;
&lt;p&gt;直接键入 &lt;code&gt;shift + 4&lt;/code&gt; 进入数学模式，然后就可以编辑了。&lt;/p&gt;
&lt;p&gt;&lt;img src="./assets/math_.webp"/&gt;&lt;/p&gt;
&lt;p&gt;好吧，总的来说我应该是用不上的。&lt;/p&gt;
&lt;h2 id="参考"&gt;参考&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://texmacs.org/tmweb/documents/manuals/texmacs-manual.en.pdf"&gt;TeXmacs 文档(英文)&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://x-wei.github.io/TeXmacs_intro.html"&gt;学术文章写作利器: TeXmacs介绍&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://github.com/texmacs/plugins"&gt;TeXmacs Plugs&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;br/&gt;
&lt;!--%%REF%%--&gt;
&lt;br/&gt;
&lt;script async="" crossorigin="anonymous" data-category="Announcements" data-category-id="DIC_kwDOJ7Ymy84CX4eg" data-emit-metadata="0" data-input-position="top" data-lang="zh-CN" data-loading="lazy" data-mapping="title" data-reactions-enabled="1" data-repo="izfsk-ium/izfsk-ium.github.io" data-repo-id="R_kgDOJ7Ymyw" data-strict="0" data-theme="preferred_color_scheme" src="https://giscus.app/client.js"&gt;
&lt;/script&gt;
&lt;/main&gt;
&lt;footer&gt;
&lt;p class="signoff"&gt;
&lt;div class="metadata"&gt;
&lt;p class="date"&gt;&lt;time datetime="2023-01-31"&gt;创建日期：2023-01-31&lt;/time&gt;&lt;/p&gt;
&lt;p class="lastmodify"&gt;&lt;time&gt;最后编译：2023-08-10&lt;/time&gt;&lt;/p&gt;
&lt;p class="lastmodify" id="counter-span"&gt;访问次数：&lt;/p&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;/footer&gt;
&lt;script&gt;
    /* These script should run after page load */
    document.querySelectorAll('code.sourceCode').forEach(
      i =&gt; i.insertAdjacentHTML('beforeend', '&lt;div class="copy"&gt;复制&lt;/div&gt;')
    );
    document.querySelectorAll('div.copy').forEach(
      i =&gt; i.addEventListener(
        'click',
        () =&gt; {
          navigator.clipboard.writeText(i.parentElement.innerText.replace('复制', ''));
          i.innerText = '成功';
          setTimeout(() =&gt; {
            i.innerText = '复制';
          }, 1000);
        }
      )
    );

    if (location.href.includes("127.0.0.1:8080")) {
      document.getElementById("counter-span").innerHTML = "[[development mode]]";
    } else {
      const uuid = document.getElementById("article-uuid").innerText;
      const target = document.getElementById("counter-span");
      const last = localStorage.getItem("lastVisit-" + uuid);
      const shouldIncrease = last === null || new Date().getTime() - parseInt(last) &gt;= (1000 * 60 * 15);

      fetch(shouldIncrease ? ("https://counter.izfsk.top/counter/" + uuid) : ("https://counter.izfsk.top/readOnly/" + uuid))
        .then(r =&gt; r.text())
        .then(d =&gt; {
          if (!d.startsWith("Too"))
            document.getElementById("counter-span").innerText = "访问次数：" + d.toString();
          else
            document.getElementById("counter-span").innerHTML = "";
        });

      localStorage.setItem("lastVisit-" + uuid, new Date().getTime());
    }
  &lt;/script&gt;
&lt;script async="" data-website-id="2a1146ab-fa82-4a84-a04f-30e5967357c3" src="https://analytics.umami.is/script.js"&gt;&lt;/script&gt;
&lt;/body&gt;</content:encoded>
      <guid isPermaLink="false">ac2beaa1-e98c-4108-9d0c-06f035cbaad3</guid>
      <pubDate>Tue, 31 Jan 2023 00:00:00 +0800</pubDate>
    </item>
    <item>
      <title>Svelte 基础速查</title>
      <link>https://blog.izfsk.top/articles/Svelte基础速查.html</link>
      <description>Svelte 基础速查</description>
      <content:encoded>&lt;body&gt;
&lt;progress id="content_progress" value="0"&gt;&lt;/progress&gt;
&lt;button id="back-to-top"&gt;
    回页顶
  &lt;/button&gt;
&lt;header&gt;
&lt;small id="article-uuid" style="display: none !important;"&gt;ad498778-ccfb-4be7-97af-bd60ac5939f9&lt;/small&gt;
&lt;h1 class="title"&gt;Svelte 基础速查&lt;/h1&gt;
&lt;!-- Subtitle --&gt;
&lt;h3 class="subtitle"&gt; &lt;/h3&gt;
&lt;/header&gt;
&lt;nav id="TOC" role="doc-toc"&gt;
&lt;strong&gt;文章归类: &lt;a href="/pages/category.html#学习"&gt;学习&lt;/a&gt; &lt;/strong&gt;
&lt;input id="contents" type="checkbox"/&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#创建项目" id="toc-创建项目"&gt;创建项目&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#文件结构" id="toc-文件结构"&gt;文件结构&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#事件处理" id="toc-事件处理"&gt;事件处理&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#modifiers" id="toc-modifiers"&gt;&lt;code&gt;modifiers&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#消息传递" id="toc-消息传递"&gt;消息传递&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#dispatch" id="toc-dispatch"&gt;dispatch&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#夹心饼干" id="toc-夹心饼干"&gt;夹心饼干&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#组件的-props" id="toc-组件的-props"&gt;组件的 props&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#按需渲染" id="toc-按需渲染"&gt;按需渲染&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#if" id="toc-if"&gt;if&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#each" id="toc-each"&gt;each&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#promise" id="toc-promise"&gt;Promise&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#绑定" id="toc-绑定"&gt;绑定&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#input" id="toc-input"&gt;input&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#select" id="toc-select"&gt;select&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#可编辑元素" id="toc-可编辑元素"&gt;可编辑元素&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#尺寸绑定" id="toc-尺寸绑定"&gt;尺寸绑定&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#生命周期处理" id="toc-生命周期处理"&gt;生命周期处理&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#onmount" id="toc-onmount"&gt;&lt;code&gt;onMount&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#ondestroy" id="toc-ondestroy"&gt;&lt;code&gt;onDestroy&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#调试" id="toc-调试"&gt;调试&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#参考" id="toc-参考"&gt;参考&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#reference"&gt;参考链接&lt;/a&gt;&lt;/li&gt;
&lt;li&gt; &lt;/li&gt;
&lt;li class="tools"&gt;
&lt;span id="backtomain"&gt;
&lt;svg class="bi bi-house" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M8.707 1.5a1 1 0 0 0-1.414 0L.646 8.146a.5.5 0 0 0 .708.708L2 8.207V13.5A1.5 1.5 0 0 0 3.5 15h9a1.5 1.5 0 0 0 1.5-1.5V8.207l.646.647a.5.5 0 0 0 .708-.708L13 5.793V2.5a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v1.293L8.707 1.5ZM13 7.207V13.5a.5.5 0 0 1-.5.5h-9a.5.5 0 0 1-.5-.5V7.207l5-5 5 5Z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="readingmode"&gt;
&lt;svg class="bi bi-book" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M1 2.828c.885-.37 2.154-.769 3.388-.893 1.33-.134 2.458.063 3.112.752v9.746c-.935-.53-2.12-.603-3.213-.493-1.18.12-2.37.461-3.287.811V2.828zm7.5-.141c.654-.689 1.782-.886 3.112-.752 1.234.124 2.503.523 3.388.893v9.923c-.918-.35-2.107-.692-3.287-.81-1.094-.111-2.278-.039-3.213.492V2.687zM8 1.783C7.015.936 5.587.81 4.287.94c-1.514.153-3.042.672-3.994 1.105A.5.5 0 0 0 0 2.5v11a.5.5 0 0 0 .707.455c.882-.4 2.303-.881 3.68-1.02 1.409-.142 2.59.087 3.223.877a.5.5 0 0 0 .78 0c.633-.79 1.814-1.019 3.222-.877 1.378.139 2.8.62 3.681 1.02A.5.5 0 0 0 16 13.5v-11a.5.5 0 0 0-.293-.455c-.952-.433-2.48-.952-3.994-1.105C10.413.809 8.985.936 8 1.783z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="larger"&gt; &lt;/span&gt;
&lt;span id="smaller"&gt;&lt;/span&gt;
&lt;span id="switchfont"&gt;
&lt;svg class="bi bi-fonts" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M12.258 3h-8.51l-.083 2.46h.479c.26-1.544.758-1.783 2.693-1.845l.424-.013v7.827c0 .663-.144.82-1.3.923v.52h4.082v-.52c-1.162-.103-1.306-.26-1.306-.923V3.602l.431.013c1.934.062 2.434.301 2.693 1.846h.479L12.258 3z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="backtotop"&gt;
&lt;svg class="bi bi-arrow-bar-up" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M8 10a.5.5 0 0 0 .5-.5V3.707l2.146 2.147a.5.5 0 0 0 .708-.708l-3-3a.5.5 0 0 0-.708 0l-3 3a.5.5 0 1 0 .708.708L7.5 3.707V9.5a.5.5 0 0 0 .5.5zm-7 2.5a.5.5 0 0 1 .5-.5h13a.5.5 0 0 1 0 1h-13a.5.5 0 0 1-.5-.5z" fill-rule="evenodd"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/nav&gt;
&lt;main&gt;
&lt;p&gt;记录一下 Svelte 的概念和基础，省得每次去开教程了。&lt;/p&gt;
&lt;h1 id="创建项目"&gt;创建项目&lt;/h1&gt;
&lt;p&gt;注意 &lt;code&gt;SvelteKit&lt;/code&gt; 和 &lt;code&gt;Svelte&lt;/code&gt; 不一样。用 &lt;code&gt;create-vite&lt;/code&gt; 选择就行了。&lt;/p&gt;
&lt;h1 id="文件结构"&gt;文件结构&lt;/h1&gt;
&lt;p&gt;一个 Svelte 组件保存的后缀名是 &lt;code&gt;.svelte&lt;/code&gt; 内容一般是三个部分，脚本部分，HTML 部分和 CSS 部分。CSS 是只作用于这一个组件的。各个组件可以互相引用，就像 React 那样 Import。举例：&lt;/p&gt;
&lt;div class="sourceCode" id="cb1"&gt;&lt;pre class="sourceCode html"&gt;&lt;code class="sourceCode html"&gt;&lt;span id="cb1-1"&gt;&lt;a aria-hidden="true" href="#cb1-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;&amp;lt;script&lt;/span&gt; &lt;span class="er"&gt;lang&lt;/span&gt;&lt;span class="ot"&gt;=&lt;/span&gt;&lt;span class="st"&gt;"ts"&lt;/span&gt;&lt;span class="kw"&gt;&amp;gt;&lt;/span&gt; &lt;/span&gt;
&lt;span id="cb1-2"&gt;&lt;a aria-hidden="true" href="#cb1-2" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="im"&gt;import&lt;/span&gt; Another &lt;span class="im"&gt;from&lt;/span&gt; &lt;span class="st"&gt;'./Another.svelte'&lt;/span&gt;&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-3"&gt;&lt;a aria-hidden="true" href="#cb1-3" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="im"&gt;import&lt;/span&gt; picture &lt;span class="im"&gt;from&lt;/span&gt; &lt;span class="st"&gt;'./assets/picture.svg'&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-4"&gt;&lt;a aria-hidden="true" href="#cb1-4" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb1-5"&gt;&lt;a aria-hidden="true" href="#cb1-5" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="kw"&gt;const&lt;/span&gt; name&lt;span class="op"&gt;:&lt;/span&gt;string &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="st"&gt;"hello!"&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-6"&gt;&lt;a aria-hidden="true" href="#cb1-6" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;&amp;lt;/script&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-7"&gt;&lt;a aria-hidden="true" href="#cb1-7" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb1-8"&gt;&lt;a aria-hidden="true" href="#cb1-8" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;&amp;lt;p&amp;gt;&lt;/span&gt;This is a paragraph.&lt;span class="kw"&gt;&amp;lt;/p&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-9"&gt;&lt;a aria-hidden="true" href="#cb1-9" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;&amp;lt;Another&amp;gt;&amp;lt;/Another&amp;gt;&lt;/span&gt; &lt;span class="co"&gt;&amp;lt;!-- 也可以用 &amp;lt;Another/&amp;gt; --&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-10"&gt;&lt;a aria-hidden="true" href="#cb1-10" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;&amp;lt;img&lt;/span&gt; &lt;span class="er"&gt;{picture}&lt;/span&gt; &lt;span class="er"&gt;alt&lt;/span&gt;&lt;span class="ot"&gt;=&lt;/span&gt;&lt;span class="st"&gt;"{name}"&lt;/span&gt;&lt;span class="kw"&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-11"&gt;&lt;a aria-hidden="true" href="#cb1-11" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb1-12"&gt;&lt;a aria-hidden="true" href="#cb1-12" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;&amp;lt;style&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-13"&gt;&lt;a aria-hidden="true" href="#cb1-13" tabindex="-1"&gt;&lt;/a&gt;    p {&lt;/span&gt;
&lt;span id="cb1-14"&gt;&lt;a aria-hidden="true" href="#cb1-14" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="kw"&gt;color&lt;/span&gt;: &lt;span class="cn"&gt;purple&lt;/span&gt;&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-15"&gt;&lt;a aria-hidden="true" href="#cb1-15" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="kw"&gt;font-family&lt;/span&gt;: &lt;span class="st"&gt;'Comic Sans MS'&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt; &lt;span class="dv"&gt;cursive&lt;/span&gt;&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-16"&gt;&lt;a aria-hidden="true" href="#cb1-16" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="kw"&gt;font-size&lt;/span&gt;: &lt;span class="dv"&gt;2&lt;/span&gt;&lt;span class="dt"&gt;em&lt;/span&gt;&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-17"&gt;&lt;a aria-hidden="true" href="#cb1-17" tabindex="-1"&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id="cb1-18"&gt;&lt;a aria-hidden="true" href="#cb1-18" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;&amp;lt;/style&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;如果一个标签的属性和值相同，可以简单书写，例如：&lt;code&gt;&amp;lt;img {src} alt="A man dances."&amp;gt;&lt;/code&gt;。&lt;/li&gt;
&lt;li&gt;如果变量包含的是 HTML，可以使用 &lt;code&gt;{@html ...}&lt;/code&gt; 标签转义，例如：&lt;code&gt;&amp;lt;p&amp;gt;{@html&lt;/code&gt;&lt;strong&gt;Hello&lt;/strong&gt;&lt;code&gt;}&amp;lt;/p&amp;gt;&lt;/code&gt;。如果引入了 &lt;code&gt;marked&lt;/code&gt; 这样的处理器，可以直接 &lt;code&gt;{@html marked(value)}&lt;/code&gt; 这样渲染。&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id="事件处理"&gt;事件处理&lt;/h1&gt;
&lt;p&gt;给 HTML 元素加上 &lt;code&gt;on:xxxx&lt;/code&gt; 标签注册事件处理器：&lt;/p&gt;
&lt;div class="sourceCode" id="cb2"&gt;&lt;pre class="sourceCode html"&gt;&lt;code class="sourceCode html"&gt;&lt;span id="cb2-1"&gt;&lt;a aria-hidden="true" href="#cb2-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;&amp;lt;script&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-2"&gt;&lt;a aria-hidden="true" href="#cb2-2" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="kw"&gt;let&lt;/span&gt; count &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="dv"&gt;0&lt;/span&gt;&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-3"&gt;&lt;a aria-hidden="true" href="#cb2-3" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb2-4"&gt;&lt;a aria-hidden="true" href="#cb2-4" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="kw"&gt;function&lt;/span&gt; &lt;span class="fu"&gt;incrementCount&lt;/span&gt;() {&lt;/span&gt;
&lt;span id="cb2-5"&gt;&lt;a aria-hidden="true" href="#cb2-5" tabindex="-1"&gt;&lt;/a&gt;        count &lt;span class="op"&gt;+=&lt;/span&gt; &lt;span class="dv"&gt;1&lt;/span&gt;&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-6"&gt;&lt;a aria-hidden="true" href="#cb2-6" tabindex="-1"&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id="cb2-7"&gt;&lt;a aria-hidden="true" href="#cb2-7" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;&amp;lt;/script&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-8"&gt;&lt;a aria-hidden="true" href="#cb2-8" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb2-9"&gt;&lt;a aria-hidden="true" href="#cb2-9" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;&amp;lt;button&lt;/span&gt; &lt;span class="er"&gt;on:click&lt;/span&gt;&lt;span class="ot"&gt;=&lt;/span&gt;&lt;span class="st"&gt;{incrementCount}&lt;/span&gt;&lt;span class="kw"&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-10"&gt;&lt;a aria-hidden="true" href="#cb2-10" tabindex="-1"&gt;&lt;/a&gt;    Clicked {count} {count === 1 ? 'time' : 'times'}&lt;/span&gt;
&lt;span id="cb2-11"&gt;&lt;a aria-hidden="true" href="#cb2-11" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;&amp;lt;/button&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;也可以使用简略形式：&lt;/p&gt;
&lt;div class="sourceCode" id="cb3"&gt;&lt;pre class="sourceCode html"&gt;&lt;code class="sourceCode html"&gt;&lt;span id="cb3-1"&gt;&lt;a aria-hidden="true" href="#cb3-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;&amp;lt;button&lt;/span&gt; &lt;span class="er"&gt;on:click&lt;/span&gt;&lt;span class="ot"&gt;=&lt;/span&gt;&lt;span class="st"&gt;"{e=&amp;gt;count++}"&lt;/span&gt;&lt;span class="kw"&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb3-2"&gt;&lt;a aria-hidden="true" href="#cb3-2" tabindex="-1"&gt;&lt;/a&gt;    Clicked {count} {count === 1 ? 'time' : 'times'}&lt;/span&gt;
&lt;span id="cb3-3"&gt;&lt;a aria-hidden="true" href="#cb3-3" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;&amp;lt;/button&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;使用 &lt;code&gt;$:&lt;/code&gt; 来保持引用，这样一个变量改变了，另外一个也能够随之改变。这是一个 &lt;a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Statements/label"&gt;标记语句&lt;/a&gt;，就是声明了一个特殊的叫做 &lt;code&gt;$&lt;/code&gt; 的标记。&lt;/p&gt;
&lt;div class="sourceCode" id="cb4"&gt;&lt;pre class="sourceCode javascript"&gt;&lt;code class="sourceCode javascript"&gt;&lt;span id="cb4-1"&gt;&lt;a aria-hidden="true" href="#cb4-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;let&lt;/span&gt; count &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="dv"&gt;0&lt;/span&gt;&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb4-2"&gt;&lt;a aria-hidden="true" href="#cb4-2" tabindex="-1"&gt;&lt;/a&gt;$&lt;span class="op"&gt;:&lt;/span&gt; doubled &lt;span class="op"&gt;=&lt;/span&gt; count &lt;span class="op"&gt;*&lt;/span&gt; &lt;span class="dv"&gt;2&lt;/span&gt;&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;code&gt;Svelte&lt;/code&gt; 的更新取决于是否有 assignments 也就是赋值操作，所以单纯的写 &lt;code&gt;somethings.some_prop = 'xxx'&lt;/code&gt; 不会触发更新。你还需要 &lt;code&gt;something = something&lt;/code&gt; 才行。对于数组，可以便捷的采用 &lt;code&gt;numbers = [...numbers, new_element];&lt;/code&gt; 来更新。&lt;/p&gt;
&lt;div class="sourceCode" id="cb5"&gt;&lt;pre class="sourceCode html"&gt;&lt;code class="sourceCode html"&gt;&lt;span id="cb5-1"&gt;&lt;a aria-hidden="true" href="#cb5-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;&amp;lt;script&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb5-2"&gt;&lt;a aria-hidden="true" href="#cb5-2" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="kw"&gt;let&lt;/span&gt; numbers &lt;span class="op"&gt;=&lt;/span&gt; [&lt;span class="dv"&gt;1&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt; &lt;span class="dv"&gt;2&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt; &lt;span class="dv"&gt;3&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt; &lt;span class="dv"&gt;4&lt;/span&gt;]&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb5-3"&gt;&lt;a aria-hidden="true" href="#cb5-3" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb5-4"&gt;&lt;a aria-hidden="true" href="#cb5-4" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="kw"&gt;function&lt;/span&gt; &lt;span class="fu"&gt;addNumber&lt;/span&gt;() {&lt;/span&gt;
&lt;span id="cb5-5"&gt;&lt;a aria-hidden="true" href="#cb5-5" tabindex="-1"&gt;&lt;/a&gt;        numbers &lt;span class="op"&gt;=&lt;/span&gt; [&lt;span class="op"&gt;...&lt;/span&gt;numbers&lt;span class="op"&gt;,&lt;/span&gt; numbers&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="at"&gt;length&lt;/span&gt; &lt;span class="op"&gt;+&lt;/span&gt; &lt;span class="dv"&gt;1&lt;/span&gt;]&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb5-6"&gt;&lt;a aria-hidden="true" href="#cb5-6" tabindex="-1"&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id="cb5-7"&gt;&lt;a aria-hidden="true" href="#cb5-7" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb5-8"&gt;&lt;a aria-hidden="true" href="#cb5-8" tabindex="-1"&gt;&lt;/a&gt;    $&lt;span class="op"&gt;:&lt;/span&gt; sum &lt;span class="op"&gt;=&lt;/span&gt; numbers&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;reduce&lt;/span&gt;((t&lt;span class="op"&gt;,&lt;/span&gt; n) &lt;span class="kw"&gt;=&amp;gt;&lt;/span&gt; t &lt;span class="op"&gt;+&lt;/span&gt; n&lt;span class="op"&gt;,&lt;/span&gt; &lt;span class="dv"&gt;0&lt;/span&gt;)&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb5-9"&gt;&lt;a aria-hidden="true" href="#cb5-9" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;&amp;lt;/script&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb5-10"&gt;&lt;a aria-hidden="true" href="#cb5-10" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb5-11"&gt;&lt;a aria-hidden="true" href="#cb5-11" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;&amp;lt;p&amp;gt;&lt;/span&gt;{numbers.join(' + ')} = {sum}&lt;span class="kw"&gt;&amp;lt;/p&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb5-12"&gt;&lt;a aria-hidden="true" href="#cb5-12" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb5-13"&gt;&lt;a aria-hidden="true" href="#cb5-13" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;&amp;lt;button&lt;/span&gt; &lt;span class="er"&gt;on:click&lt;/span&gt;&lt;span class="ot"&gt;=&lt;/span&gt;&lt;span class="st"&gt;{addNumber}&lt;/span&gt;&lt;span class="kw"&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb5-14"&gt;&lt;a aria-hidden="true" href="#cb5-14" tabindex="-1"&gt;&lt;/a&gt;    Add a number&lt;/span&gt;
&lt;span id="cb5-15"&gt;&lt;a aria-hidden="true" href="#cb5-15" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;&amp;lt;/button&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id="modifiers"&gt;&lt;code&gt;modifiers&lt;/code&gt;&lt;/h2&gt;
&lt;p&gt;用 &lt;code&gt;|&lt;/code&gt; 来给处理器加额外设置，就像这样：&lt;/p&gt;
&lt;div class="sourceCode" id="cb6"&gt;&lt;pre class="sourceCode html"&gt;&lt;code class="sourceCode html"&gt;&lt;span id="cb6-1"&gt;&lt;a aria-hidden="true" href="#cb6-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;&amp;lt;script&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb6-2"&gt;&lt;a aria-hidden="true" href="#cb6-2" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="kw"&gt;function&lt;/span&gt; &lt;span class="fu"&gt;handleClick&lt;/span&gt;() { &lt;span class="fu"&gt;alert&lt;/span&gt;(&lt;span class="st"&gt;'no more alerts'&lt;/span&gt;) }&lt;/span&gt;
&lt;span id="cb6-3"&gt;&lt;a aria-hidden="true" href="#cb6-3" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;&amp;lt;/script&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb6-4"&gt;&lt;a aria-hidden="true" href="#cb6-4" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb6-5"&gt;&lt;a aria-hidden="true" href="#cb6-5" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;&amp;lt;button&lt;/span&gt; &lt;span class="er"&gt;on:click|once&lt;/span&gt;&lt;span class="ot"&gt;=&lt;/span&gt;&lt;span class="st"&gt;{handleClick}&lt;/span&gt;&lt;span class="kw"&gt;&amp;gt;&lt;/span&gt; Click me &lt;span class="kw"&gt;&amp;lt;/button&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;多个可以叠加，类似 &lt;code&gt;on:click|once|capture={...}&lt;/code&gt; 。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;preventDefault&lt;/code&gt; ：就是 &lt;code&gt;e.preventDefault()&lt;/code&gt; 。&lt;/li&gt;
&lt;li&gt;&lt;code&gt;stopPropagation&lt;/code&gt;：同样地，相当于调用 &lt;code&gt;e.stopPropagation()&lt;/code&gt;。&lt;/li&gt;
&lt;li&gt;&lt;code&gt;once&lt;/code&gt;：这个处理器只使用一次。&lt;/li&gt;
&lt;li&gt;&lt;code&gt;self&lt;/code&gt;：只有在 &lt;code&gt;event.target&lt;/code&gt; 是元素自己时调用。&lt;/li&gt;
&lt;li&gt;&lt;code&gt;trusted&lt;/code&gt;：只有 &lt;code&gt;event.isTrusted&lt;/code&gt; 是 &lt;code&gt;True&lt;/code&gt; 才调用。比如 &lt;code&gt;element.click()&lt;/code&gt; 就不是。&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id="消息传递"&gt;消息传递&lt;/h1&gt;
&lt;h2 id="dispatch"&gt;dispatch&lt;/h2&gt;
&lt;p&gt;组件之间的消息传递就是所谓 &lt;code&gt;dispatch&lt;/code&gt;（这个词中文含义是 &lt;em&gt;调度，派遣，发送&lt;/em&gt; 的意思），比如说有一个 Outside 组件，里面包含了一个 Inner 组件，Inner 组件想要让外部组件更新一项信息，如果用简单的 React 的话那就是把外部组件的对应处理函数作为 Inner 的一个 prop 传送进去，让它调用。如果使用 &lt;code&gt;dispatch&lt;/code&gt; 方法的话，就是 Inner 向外部组件发送一个消息，告诉他发生了什么，再由外部组件决定干啥。&lt;/p&gt;
&lt;p&gt;为此，Inner 组件需要引入 &lt;code&gt;createEventDispatcher&lt;/code&gt; 来便捷的创建&lt;strong&gt;标准&lt;/strong&gt;的消息。而外部组件需要对于每一种类的消息，定义一个 &lt;code&gt;on:&amp;lt;消息种类&amp;gt;&lt;/code&gt; 的处理器来接收消息。举例如下：&lt;/p&gt;
&lt;p&gt;Inner：&lt;/p&gt;
&lt;div class="sourceCode" id="cb7"&gt;&lt;pre class="sourceCode html"&gt;&lt;code class="sourceCode html"&gt;&lt;span id="cb7-1"&gt;&lt;a aria-hidden="true" href="#cb7-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;&amp;lt;script&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb7-2"&gt;&lt;a aria-hidden="true" href="#cb7-2" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="im"&gt;import&lt;/span&gt; { createEventDispatcher } &lt;span class="im"&gt;from&lt;/span&gt; &lt;span class="st"&gt;'svelte'&lt;/span&gt;&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb7-3"&gt;&lt;a aria-hidden="true" href="#cb7-3" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="kw"&gt;const&lt;/span&gt; dispatch &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="fu"&gt;createEventDispatcher&lt;/span&gt;()&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb7-4"&gt;&lt;a aria-hidden="true" href="#cb7-4" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="kw"&gt;function&lt;/span&gt; &lt;span class="fu"&gt;sayHello&lt;/span&gt;() {&lt;/span&gt;
&lt;span id="cb7-5"&gt;&lt;a aria-hidden="true" href="#cb7-5" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="fu"&gt;dispatch&lt;/span&gt;(&lt;span class="st"&gt;'sayhi'&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt; { &lt;span class="dt"&gt;text&lt;/span&gt;&lt;span class="op"&gt;:&lt;/span&gt; &lt;span class="st"&gt;'Hello!'&lt;/span&gt;})&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb7-6"&gt;&lt;a aria-hidden="true" href="#cb7-6" tabindex="-1"&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id="cb7-7"&gt;&lt;a aria-hidden="true" href="#cb7-7" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;&amp;lt;/script&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb7-8"&gt;&lt;a aria-hidden="true" href="#cb7-8" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb7-9"&gt;&lt;a aria-hidden="true" href="#cb7-9" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;&amp;lt;button&lt;/span&gt; &lt;span class="er"&gt;on:click&lt;/span&gt;&lt;span class="ot"&gt;=&lt;/span&gt;&lt;span class="st"&gt;{sayHello}&lt;/span&gt;&lt;span class="kw"&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb7-10"&gt;&lt;a aria-hidden="true" href="#cb7-10" tabindex="-1"&gt;&lt;/a&gt;    Click to say hello&lt;/span&gt;
&lt;span id="cb7-11"&gt;&lt;a aria-hidden="true" href="#cb7-11" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;&amp;lt;/button&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Outside：&lt;/p&gt;
&lt;div class="sourceCode" id="cb8"&gt;&lt;pre class="sourceCode html"&gt;&lt;code class="sourceCode html"&gt;&lt;span id="cb8-1"&gt;&lt;a aria-hidden="true" href="#cb8-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;&amp;lt;script&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb8-2"&gt;&lt;a aria-hidden="true" href="#cb8-2" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="im"&gt;import&lt;/span&gt; Inner &lt;span class="im"&gt;from&lt;/span&gt; &lt;span class="st"&gt;'./Inner.svelte'&lt;/span&gt;&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb8-3"&gt;&lt;a aria-hidden="true" href="#cb8-3" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb8-4"&gt;&lt;a aria-hidden="true" href="#cb8-4" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="kw"&gt;function&lt;/span&gt; &lt;span class="fu"&gt;handleMessage&lt;/span&gt;(&lt;span class="bu"&gt;event&lt;/span&gt;) {&lt;/span&gt;
&lt;span id="cb8-5"&gt;&lt;a aria-hidden="true" href="#cb8-5" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="fu"&gt;alert&lt;/span&gt;(&lt;span class="bu"&gt;event&lt;/span&gt;&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="at"&gt;detail&lt;/span&gt;&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="at"&gt;text&lt;/span&gt;)&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb8-6"&gt;&lt;a aria-hidden="true" href="#cb8-6" tabindex="-1"&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id="cb8-7"&gt;&lt;a aria-hidden="true" href="#cb8-7" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;&amp;lt;/script&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb8-8"&gt;&lt;a aria-hidden="true" href="#cb8-8" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb8-9"&gt;&lt;a aria-hidden="true" href="#cb8-9" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;&amp;lt;Inner&lt;/span&gt; &lt;span class="er"&gt;on:sayhi&lt;/span&gt;&lt;span class="ot"&gt;=&lt;/span&gt;&lt;span class="st"&gt;{handleMessage}&lt;/span&gt;&lt;span class="kw"&gt;/&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;接受到的消息是这样的结构，主要关心的数据就是里面的 &lt;code&gt;detail&lt;/code&gt; 和 &lt;code&gt;type&lt;/code&gt;：&lt;/p&gt;
&lt;p&gt;&lt;img src="./assets/type.webp"/&gt;&lt;/p&gt;
&lt;h2 id="夹心饼干"&gt;夹心饼干&lt;/h2&gt;
&lt;p&gt;有时候会遇到「夹心饼干」一样的组件堆叠，最里面的组件要传递信息给最外面的组件，于是要穿越中间很多层，&lt;code&gt;Svelte&lt;/code&gt; 给被穿越的那些组件提供了简单的数据传递写法。一个没有处理器的 &lt;code&gt;on:xxx&lt;/code&gt; 会转发一切到上层：&lt;/p&gt;
&lt;div class="sourceCode" id="cb9"&gt;&lt;pre class="sourceCode html"&gt;&lt;code class="sourceCode html"&gt;&lt;span id="cb9-1"&gt;&lt;a aria-hidden="true" href="#cb9-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;&amp;lt;Inner&lt;/span&gt; &lt;span class="er"&gt;on:sayhi&lt;/span&gt;&lt;span class="kw"&gt;/&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;code&gt;on:xxx&lt;/code&gt; 不仅仅可以转发自定义的消息，对于 DOM 事件也可以转发。所以可以对最内层的某个按钮的 click 事件一层层转发到最上层处理。&lt;/p&gt;
&lt;h1 id="组件的-props"&gt;组件的 props&lt;/h1&gt;
&lt;p&gt;就像 React 的 props 一样，不过是以 &lt;code&gt;export&lt;/code&gt; 变量的形式定义的：&lt;/p&gt;
&lt;div class="sourceCode" id="cb10"&gt;&lt;pre class="sourceCode html"&gt;&lt;code class="sourceCode html"&gt;&lt;span id="cb10-1"&gt;&lt;a aria-hidden="true" href="#cb10-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;&amp;lt;script&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb10-2"&gt;&lt;a aria-hidden="true" href="#cb10-2" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="im"&gt;export&lt;/span&gt; &lt;span class="kw"&gt;let&lt;/span&gt; answer &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="st"&gt;'default value'&lt;/span&gt;&lt;span class="op"&gt;;&lt;/span&gt;    &lt;span class="co"&gt;// answer 是 props，可以设定默认值&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb10-3"&gt;&lt;a aria-hidden="true" href="#cb10-3" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;&amp;lt;/script&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb10-4"&gt;&lt;a aria-hidden="true" href="#cb10-4" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb10-5"&gt;&lt;a aria-hidden="true" href="#cb10-5" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;&amp;lt;p&amp;gt;&lt;/span&gt;The answer is {answer}&lt;span class="kw"&gt;&amp;lt;/p&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;其他组件调用它是这样：&lt;/p&gt;
&lt;div class="sourceCode" id="cb11"&gt;&lt;pre class="sourceCode html"&gt;&lt;code class="sourceCode html"&gt;&lt;span id="cb11-1"&gt;&lt;a aria-hidden="true" href="#cb11-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;&amp;lt;script&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb11-2"&gt;&lt;a aria-hidden="true" href="#cb11-2" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="im"&gt;import&lt;/span&gt; MyElement &lt;span class="im"&gt;from&lt;/span&gt; &lt;span class="st"&gt;'./Nested.svelte'&lt;/span&gt;&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb11-3"&gt;&lt;a aria-hidden="true" href="#cb11-3" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;&amp;lt;/script&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb11-4"&gt;&lt;a aria-hidden="true" href="#cb11-4" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb11-5"&gt;&lt;a aria-hidden="true" href="#cb11-5" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;&amp;lt;MyElement&lt;/span&gt; &lt;span class="er"&gt;answer&lt;/span&gt;&lt;span class="ot"&gt;=&lt;/span&gt;&lt;span class="st"&gt;{42}&lt;/span&gt;&lt;span class="kw"&gt;/&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;对于有很多属性的组件，可以用简略的方法定义一个 &lt;code&gt;Object&lt;/code&gt; 放进去。假如有一个组件有四个 props ：&lt;code&gt;name&lt;/code&gt;，&lt;code&gt;version&lt;/code&gt;，&lt;code&gt;speed&lt;/code&gt;，&lt;code&gt;website&lt;/code&gt;：&lt;/p&gt;
&lt;div class="sourceCode" id="cb12"&gt;&lt;pre class="sourceCode html"&gt;&lt;code class="sourceCode html"&gt;&lt;span id="cb12-1"&gt;&lt;a aria-hidden="true" href="#cb12-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;&amp;lt;script&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb12-2"&gt;&lt;a aria-hidden="true" href="#cb12-2" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="im"&gt;import&lt;/span&gt; Info &lt;span class="im"&gt;from&lt;/span&gt; &lt;span class="st"&gt;'./Info.svelte'&lt;/span&gt;&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb12-3"&gt;&lt;a aria-hidden="true" href="#cb12-3" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb12-4"&gt;&lt;a aria-hidden="true" href="#cb12-4" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="kw"&gt;const&lt;/span&gt; pkg &lt;span class="op"&gt;=&lt;/span&gt; {&lt;/span&gt;
&lt;span id="cb12-5"&gt;&lt;a aria-hidden="true" href="#cb12-5" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="dt"&gt;name&lt;/span&gt;&lt;span class="op"&gt;:&lt;/span&gt; &lt;span class="st"&gt;'svelte'&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb12-6"&gt;&lt;a aria-hidden="true" href="#cb12-6" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="dt"&gt;version&lt;/span&gt;&lt;span class="op"&gt;:&lt;/span&gt; &lt;span class="dv"&gt;3&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb12-7"&gt;&lt;a aria-hidden="true" href="#cb12-7" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="dt"&gt;speed&lt;/span&gt;&lt;span class="op"&gt;:&lt;/span&gt; &lt;span class="st"&gt;'blazing'&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb12-8"&gt;&lt;a aria-hidden="true" href="#cb12-8" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="dt"&gt;website&lt;/span&gt;&lt;span class="op"&gt;:&lt;/span&gt; &lt;span class="st"&gt;'https://svelte.dev'&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb12-9"&gt;&lt;a aria-hidden="true" href="#cb12-9" tabindex="-1"&gt;&lt;/a&gt;    }&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb12-10"&gt;&lt;a aria-hidden="true" href="#cb12-10" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;&amp;lt;/script&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb12-11"&gt;&lt;a aria-hidden="true" href="#cb12-11" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb12-12"&gt;&lt;a aria-hidden="true" href="#cb12-12" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="co"&gt;&amp;lt;!--不要这样做--&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb12-13"&gt;&lt;a aria-hidden="true" href="#cb12-13" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;&amp;lt;Info&lt;/span&gt; &lt;span class="er"&gt;name&lt;/span&gt;&lt;span class="ot"&gt;=&lt;/span&gt;&lt;span class="st"&gt;{pkg.name}&lt;/span&gt; &lt;span class="er"&gt;version&lt;/span&gt;&lt;span class="ot"&gt;=&lt;/span&gt;&lt;span class="st"&gt;{pkg.version}&lt;/span&gt; &lt;span class="er"&gt;speed&lt;/span&gt;&lt;span class="ot"&gt;=&lt;/span&gt;&lt;span class="st"&gt;{pkg.speed}&lt;/span&gt; &lt;span class="er"&gt;website&lt;/span&gt;&lt;span class="ot"&gt;=&lt;/span&gt;&lt;span class="st"&gt;{pkg.website}&lt;/span&gt;&lt;span class="kw"&gt;/&amp;gt;&lt;/span&gt; &lt;/span&gt;
&lt;span id="cb12-14"&gt;&lt;a aria-hidden="true" href="#cb12-14" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="co"&gt;&amp;lt;!--用缩略形式--&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb12-15"&gt;&lt;a aria-hidden="true" href="#cb12-15" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;&amp;lt;Info&lt;/span&gt; &lt;span class="er"&gt;{...pkg}&lt;/span&gt;&lt;span class="kw"&gt;/&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h1 id="按需渲染"&gt;按需渲染&lt;/h1&gt;
&lt;h2 id="if"&gt;if&lt;/h2&gt;
&lt;div class="sourceCode" id="cb13"&gt;&lt;pre class="sourceCode javascript"&gt;&lt;code class="sourceCode javascript"&gt;&lt;span id="cb13-1"&gt;&lt;a aria-hidden="true" href="#cb13-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="co"&gt;// if...&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb13-2"&gt;&lt;a aria-hidden="true" href="#cb13-2" tabindex="-1"&gt;&lt;/a&gt;{#if user&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="at"&gt;loggedIn&lt;/span&gt;}&lt;/span&gt;
&lt;span id="cb13-3"&gt;&lt;a aria-hidden="true" href="#cb13-3" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="op"&gt;&amp;lt;&lt;/span&gt;button on&lt;span class="op"&gt;:&lt;/span&gt;click&lt;span class="op"&gt;=&lt;/span&gt;{toggle}&lt;span class="op"&gt;&amp;gt;&lt;/span&gt; Log out &lt;span class="op"&gt;&amp;lt;/&lt;/span&gt;button&lt;span class="op"&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb13-4"&gt;&lt;a aria-hidden="true" href="#cb13-4" tabindex="-1"&gt;&lt;/a&gt;{&lt;span class="ss"&gt;/if}&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb13-5"&gt;&lt;a aria-hidden="true" href="#cb13-5" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb13-6"&gt;&lt;a aria-hidden="true" href="#cb13-6" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="ss"&gt;// if...else&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb13-7"&gt;&lt;a aria-hidden="true" href="#cb13-7" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="ss"&gt;{#if user.loggedIn}&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb13-8"&gt;&lt;a aria-hidden="true" href="#cb13-8" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="ss"&gt;    &amp;lt;button on:click={toggle}&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb13-9"&gt;&lt;a aria-hidden="true" href="#cb13-9" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="ss"&gt;        Log out&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb13-10"&gt;&lt;a aria-hidden="true" href="#cb13-10" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="ss"&gt;    &amp;lt;/button&lt;/span&gt;&lt;span class="op"&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb13-11"&gt;&lt;a aria-hidden="true" href="#cb13-11" tabindex="-1"&gt;&lt;/a&gt;{&lt;span class="op"&gt;:&lt;/span&gt;&lt;span class="cf"&gt;else&lt;/span&gt;}&lt;/span&gt;
&lt;span id="cb13-12"&gt;&lt;a aria-hidden="true" href="#cb13-12" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="op"&gt;&amp;lt;&lt;/span&gt;button &lt;span class="dt"&gt;on&lt;/span&gt;&lt;span class="op"&gt;:&lt;/span&gt;click&lt;span class="op"&gt;=&lt;/span&gt;{toggle}&lt;span class="op"&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb13-13"&gt;&lt;a aria-hidden="true" href="#cb13-13" tabindex="-1"&gt;&lt;/a&gt;        Log &lt;span class="kw"&gt;in&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb13-14"&gt;&lt;a aria-hidden="true" href="#cb13-14" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="op"&gt;&amp;lt;/&lt;/span&gt;button&lt;span class="op"&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb13-15"&gt;&lt;a aria-hidden="true" href="#cb13-15" tabindex="-1"&gt;&lt;/a&gt;{&lt;span class="ss"&gt;/if}&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb13-16"&gt;&lt;a aria-hidden="true" href="#cb13-16" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb13-17"&gt;&lt;a aria-hidden="true" href="#cb13-17" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="ss"&gt;// if...else if...&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb13-18"&gt;&lt;a aria-hidden="true" href="#cb13-18" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="ss"&gt;{#if x &amp;gt; 10}&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb13-19"&gt;&lt;a aria-hidden="true" href="#cb13-19" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="ss"&gt;    &amp;lt;p&amp;gt;{x} is greater than 10&amp;lt;/p&lt;/span&gt;&lt;span class="op"&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb13-20"&gt;&lt;a aria-hidden="true" href="#cb13-20" tabindex="-1"&gt;&lt;/a&gt;{&lt;span class="op"&gt;:&lt;/span&gt;&lt;span class="cf"&gt;else&lt;/span&gt; &lt;span class="cf"&gt;if&lt;/span&gt; &lt;span class="dv"&gt;5&lt;/span&gt; &lt;span class="op"&gt;&amp;gt;&lt;/span&gt; x}&lt;/span&gt;
&lt;span id="cb13-21"&gt;&lt;a aria-hidden="true" href="#cb13-21" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="op"&gt;&amp;lt;&lt;/span&gt;p&lt;span class="op"&gt;&amp;gt;&lt;/span&gt;{x} is less than &lt;span class="dv"&gt;5&lt;/span&gt;&lt;span class="op"&gt;&amp;lt;/&lt;/span&gt;p&lt;span class="op"&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb13-22"&gt;&lt;a aria-hidden="true" href="#cb13-22" tabindex="-1"&gt;&lt;/a&gt;{&lt;span class="op"&gt;:&lt;/span&gt;&lt;span class="cf"&gt;else&lt;/span&gt;}&lt;/span&gt;
&lt;span id="cb13-23"&gt;&lt;a aria-hidden="true" href="#cb13-23" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="op"&gt;&amp;lt;&lt;/span&gt;p&lt;span class="op"&gt;&amp;gt;&lt;/span&gt;{x} is between &lt;span class="dv"&gt;5&lt;/span&gt; and &lt;span class="dv"&gt;10&lt;/span&gt;&lt;span class="op"&gt;&amp;lt;/&lt;/span&gt;p&lt;span class="op"&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb13-24"&gt;&lt;a aria-hidden="true" href="#cb13-24" tabindex="-1"&gt;&lt;/a&gt;{&lt;span class="ss"&gt;/if}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id="each"&gt;each&lt;/h2&gt;
&lt;p&gt;循环，类似于 React 中的 &lt;code&gt;map&lt;/code&gt; 函数：&lt;/p&gt;
&lt;div class="sourceCode" id="cb14"&gt;&lt;pre class="sourceCode js"&gt;&lt;code class="sourceCode javascript"&gt;&lt;span id="cb14-1"&gt;&lt;a aria-hidden="true" href="#cb14-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="op"&gt;&amp;lt;&lt;/span&gt;ul&lt;span class="op"&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb14-2"&gt;&lt;a aria-hidden="true" href="#cb14-2" tabindex="-1"&gt;&lt;/a&gt;    {#each [&lt;span class="st"&gt;'hello'&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt;&lt;span class="st"&gt;'world'&lt;/span&gt;] &lt;span class="im"&gt;as&lt;/span&gt; str&lt;span class="op"&gt;,&lt;/span&gt;index}&lt;/span&gt;
&lt;span id="cb14-3"&gt;&lt;a aria-hidden="true" href="#cb14-3" tabindex="-1"&gt;&lt;/a&gt;        {index} &lt;span class="op"&gt;-&amp;gt;&lt;/span&gt; {str} &lt;span class="op"&gt;&amp;lt;&lt;/span&gt;br&lt;span class="op"&gt;/&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb14-4"&gt;&lt;a aria-hidden="true" href="#cb14-4" tabindex="-1"&gt;&lt;/a&gt;    {&lt;span class="ss"&gt;/each}&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb14-5"&gt;&lt;a aria-hidden="true" href="#cb14-5" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="ss"&gt;&amp;lt;/ul&lt;/span&gt;&lt;span class="op"&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;如果循环的对象是一个复杂的 &lt;code&gt;Object&lt;/code&gt;，那么可以直接解构。假如数据 &lt;code&gt;addrs&lt;/code&gt; 是 &lt;code&gt;{name:string, age:number, address:string}&lt;/code&gt; 类型的数组，那么可以这样：&lt;/p&gt;
&lt;div class="sourceCode" id="cb15"&gt;&lt;pre class="sourceCode js"&gt;&lt;code class="sourceCode javascript"&gt;&lt;span id="cb15-1"&gt;&lt;a aria-hidden="true" href="#cb15-1" tabindex="-1"&gt;&lt;/a&gt;{#each addrs {name&lt;span class="op"&gt;,&lt;/span&gt; age&lt;span class="op"&gt;,&lt;/span&gt; address}&lt;span class="op"&gt;,&lt;/span&gt; index}&lt;/span&gt;
&lt;span id="cb15-2"&gt;&lt;a aria-hidden="true" href="#cb15-2" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="co"&gt;// processing data&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb15-3"&gt;&lt;a aria-hidden="true" href="#cb15-3" tabindex="-1"&gt;&lt;/a&gt;{&lt;span class="ss"&gt;/each}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;默认情况下，当改变 &lt;code&gt;each&lt;/code&gt; 中的数据时，最后一个项目会被增加或者删除，然后更新每一个更改的项目。也就是说，&lt;strong&gt;它是倒着更新的&lt;/strong&gt;，所以，需要指定一个 &lt;code&gt;key&lt;/code&gt;。&lt;/p&gt;
&lt;pre class="svelte"&gt;&lt;code&gt;{#each things as thing (thing.name) }
    &amp;lt;Thing name={thing.name}/&amp;gt;
{/each}

{#each things as {id,name},index (id) } // key 的括号放在最后
    {id} {name} {index} &amp;lt;br/&amp;gt;
{/each}&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id="promise"&gt;Promise&lt;/h2&gt;
&lt;p&gt;直接给 &lt;code&gt;promise&lt;/code&gt; 包装一层，很方便：&lt;/p&gt;
&lt;div class="sourceCode" id="cb17"&gt;&lt;pre class="sourceCode js"&gt;&lt;code class="sourceCode javascript"&gt;&lt;span id="cb17-1"&gt;&lt;a aria-hidden="true" href="#cb17-1" tabindex="-1"&gt;&lt;/a&gt;{#await &lt;span class="fu"&gt;fetch&lt;/span&gt;(&lt;span class="st"&gt;'https://www.bing.com/'&lt;/span&gt;)}&lt;/span&gt;
&lt;span id="cb17-2"&gt;&lt;a aria-hidden="true" href="#cb17-2" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="op"&gt;&amp;lt;&lt;/span&gt;p&lt;span class="op"&gt;&amp;gt;...&lt;/span&gt;waiting&lt;span class="op"&gt;&amp;lt;/&lt;/span&gt;p&lt;span class="op"&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb17-3"&gt;&lt;a aria-hidden="true" href="#cb17-3" tabindex="-1"&gt;&lt;/a&gt;{&lt;span class="op"&gt;:&lt;/span&gt;then data}&lt;/span&gt;
&lt;span id="cb17-4"&gt;&lt;a aria-hidden="true" href="#cb17-4" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="op"&gt;&amp;lt;&lt;/span&gt;p&lt;span class="op"&gt;&amp;gt;&lt;/span&gt;{data}&lt;span class="op"&gt;&amp;lt;/&lt;/span&gt;p&lt;span class="op"&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb17-5"&gt;&lt;a aria-hidden="true" href="#cb17-5" tabindex="-1"&gt;&lt;/a&gt;{&lt;span class="op"&gt;:&lt;/span&gt;&lt;span class="cf"&gt;catch&lt;/span&gt; error}&lt;/span&gt;
&lt;span id="cb17-6"&gt;&lt;a aria-hidden="true" href="#cb17-6" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="op"&gt;&amp;lt;&lt;/span&gt;p style&lt;span class="op"&gt;=&lt;/span&gt;&lt;span class="st"&gt;"color: red"&lt;/span&gt;&lt;span class="op"&gt;&amp;gt;&lt;/span&gt;{error}&lt;span class="op"&gt;&amp;lt;/&lt;/span&gt;p&lt;span class="op"&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb17-7"&gt;&lt;a aria-hidden="true" href="#cb17-7" tabindex="-1"&gt;&lt;/a&gt;{&lt;span class="ss"&gt;/await}&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb17-8"&gt;&lt;a aria-hidden="true" href="#cb17-8" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb17-9"&gt;&lt;a aria-hidden="true" href="#cb17-9" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="ss"&gt;// 相同&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb17-10"&gt;&lt;a aria-hidden="true" href="#cb17-10" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="ss"&gt;{#await fetch&lt;/span&gt;&lt;span class="sc"&gt;(&lt;/span&gt;&lt;span class="ss"&gt;'https://www.bing.com/&lt;/span&gt;&lt;span class="st"&gt;') then data}&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb17-11"&gt;&lt;a aria-hidden="true" href="#cb17-11" tabindex="-1"&gt;&lt;/a&gt;    {data}&lt;/span&gt;
&lt;span id="cb17-12"&gt;&lt;a aria-hidden="true" href="#cb17-12" tabindex="-1"&gt;&lt;/a&gt;{&lt;span class="op"&gt;:&lt;/span&gt;&lt;span class="cf"&gt;catch&lt;/span&gt; error}&lt;/span&gt;
&lt;span id="cb17-13"&gt;&lt;a aria-hidden="true" href="#cb17-13" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="op"&gt;&amp;lt;&lt;/span&gt;p style&lt;span class="op"&gt;=&lt;/span&gt;&lt;span class="st"&gt;"color: red"&lt;/span&gt;&lt;span class="op"&gt;&amp;gt;&lt;/span&gt;{error}&lt;span class="op"&gt;&amp;lt;/&lt;/span&gt;p&lt;span class="op"&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb17-14"&gt;&lt;a aria-hidden="true" href="#cb17-14" tabindex="-1"&gt;&lt;/a&gt;{&lt;span class="ss"&gt;/await}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h1 id="绑定"&gt;绑定&lt;/h1&gt;
&lt;p&gt;通过绑定，可以更好的处理一些交互式元素，特别是 &lt;code&gt;input&lt;/code&gt; 类的处理：&lt;/p&gt;
&lt;h2 id="input"&gt;input&lt;/h2&gt;
&lt;div class="sourceCode" id="cb18"&gt;&lt;pre class="sourceCode html"&gt;&lt;code class="sourceCode html"&gt;&lt;span id="cb18-1"&gt;&lt;a aria-hidden="true" href="#cb18-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;&amp;lt;script&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb18-2"&gt;&lt;a aria-hidden="true" href="#cb18-2" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="kw"&gt;let&lt;/span&gt; name &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="st"&gt;'world'&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt; a &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="dv"&gt;1&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt; b &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="dv"&gt;2&lt;/span&gt;&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb18-3"&gt;&lt;a aria-hidden="true" href="#cb18-3" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;&amp;lt;/script&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb18-4"&gt;&lt;a aria-hidden="true" href="#cb18-4" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb18-5"&gt;&lt;a aria-hidden="true" href="#cb18-5" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;&amp;lt;input&lt;/span&gt; &lt;span class="er"&gt;bind:value&lt;/span&gt;&lt;span class="ot"&gt;=&lt;/span&gt;&lt;span class="st"&gt;{name}&lt;/span&gt;&lt;span class="kw"&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb18-6"&gt;&lt;a aria-hidden="true" href="#cb18-6" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;&amp;lt;input&lt;/span&gt; &lt;span class="er"&gt;type&lt;/span&gt;&lt;span class="ot"&gt;=&lt;/span&gt;&lt;span class="st"&gt;number&lt;/span&gt; &lt;span class="er"&gt;bind:value&lt;/span&gt;&lt;span class="ot"&gt;=&lt;/span&gt;&lt;span class="st"&gt;{a}&lt;/span&gt; &lt;span class="er"&gt;min&lt;/span&gt;&lt;span class="ot"&gt;=&lt;/span&gt;&lt;span class="st"&gt;0&lt;/span&gt; &lt;span class="er"&gt;max&lt;/span&gt;&lt;span class="ot"&gt;=&lt;/span&gt;&lt;span class="st"&gt;10&lt;/span&gt;&lt;span class="kw"&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb18-7"&gt;&lt;a aria-hidden="true" href="#cb18-7" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;&amp;lt;input&lt;/span&gt; &lt;span class="er"&gt;type&lt;/span&gt;&lt;span class="ot"&gt;=&lt;/span&gt;&lt;span class="st"&gt;range&lt;/span&gt; &lt;span class="er"&gt;bind:value&lt;/span&gt;&lt;span class="ot"&gt;=&lt;/span&gt;&lt;span class="st"&gt;{a}&lt;/span&gt; &lt;span class="er"&gt;min&lt;/span&gt;&lt;span class="ot"&gt;=&lt;/span&gt;&lt;span class="st"&gt;0&lt;/span&gt; &lt;span class="er"&gt;max&lt;/span&gt;&lt;span class="ot"&gt;=&lt;/span&gt;&lt;span class="st"&gt;10&lt;/span&gt;&lt;span class="kw"&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb18-8"&gt;&lt;a aria-hidden="true" href="#cb18-8" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb18-9"&gt;&lt;a aria-hidden="true" href="#cb18-9" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;&amp;lt;h1&amp;gt;&lt;/span&gt;Hello {name}!&lt;span class="kw"&gt;&amp;lt;/h1&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;如果不使用 &lt;code&gt;bind&lt;/code&gt; 的话，就需要捕获输入事件，定义一个处理这个事件的函数，再更新数据，比较繁琐。&lt;/p&gt;
&lt;p&gt;对于一般的数据，使用 &lt;code&gt;bind:value&lt;/code&gt;，对于 checkbox 是否选中，使用 &lt;code&gt;bind:checked&lt;/code&gt;。如果你需要绑定更多值，则可以使用 &lt;code&gt;bind:group&lt;/code&gt; 将 value 属性放在一起使用。那么多个组件就共享一个数据源了。&lt;strong&gt;&lt;code&gt;bind:group&lt;/code&gt; 只能用于 checkbox 和 &lt;code&gt;radio&lt;/code&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;对于 &lt;code&gt;each&lt;/code&gt; 中的元素，可以挨个绑定，详见&lt;a href="https://svelte.dev/tutorial/each-block-bindings"&gt;这里&lt;/a&gt;。&lt;/p&gt;
&lt;h2 id="select"&gt;select&lt;/h2&gt;
&lt;div class="sourceCode" id="cb19"&gt;&lt;pre class="sourceCode html"&gt;&lt;code class="sourceCode html"&gt;&lt;span id="cb19-1"&gt;&lt;a aria-hidden="true" href="#cb19-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;&amp;lt;script&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb19-2"&gt;&lt;a aria-hidden="true" href="#cb19-2" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;let&lt;/span&gt; questions &lt;span class="op"&gt;=&lt;/span&gt; [&lt;/span&gt;
&lt;span id="cb19-3"&gt;&lt;a aria-hidden="true" href="#cb19-3" tabindex="-1"&gt;&lt;/a&gt;    { &lt;span class="dt"&gt;id&lt;/span&gt;&lt;span class="op"&gt;:&lt;/span&gt; &lt;span class="dv"&gt;1&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt; &lt;span class="dt"&gt;text&lt;/span&gt;&lt;span class="op"&gt;:&lt;/span&gt; &lt;span class="vs"&gt;`Where did you go to school?`&lt;/span&gt; }&lt;span class="op"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb19-4"&gt;&lt;a aria-hidden="true" href="#cb19-4" tabindex="-1"&gt;&lt;/a&gt;    { &lt;span class="dt"&gt;id&lt;/span&gt;&lt;span class="op"&gt;:&lt;/span&gt; &lt;span class="dv"&gt;2&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt; &lt;span class="dt"&gt;text&lt;/span&gt;&lt;span class="op"&gt;:&lt;/span&gt; &lt;span class="vs"&gt;`What is your mother's name?`&lt;/span&gt; }&lt;span class="op"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb19-5"&gt;&lt;a aria-hidden="true" href="#cb19-5" tabindex="-1"&gt;&lt;/a&gt;    { &lt;span class="dt"&gt;id&lt;/span&gt;&lt;span class="op"&gt;:&lt;/span&gt; &lt;span class="dv"&gt;3&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt; &lt;span class="dt"&gt;text&lt;/span&gt;&lt;span class="op"&gt;:&lt;/span&gt; &lt;span class="vs"&gt;`What is another personal fact that an attacker could easily find with Google?`&lt;/span&gt; }&lt;/span&gt;
&lt;span id="cb19-6"&gt;&lt;a aria-hidden="true" href="#cb19-6" tabindex="-1"&gt;&lt;/a&gt;]&lt;span class="op"&gt;,&lt;/span&gt; selected&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb19-7"&gt;&lt;a aria-hidden="true" href="#cb19-7" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="op"&gt;&amp;lt;&lt;/span&gt;script&lt;span class="op"&gt;/&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb19-8"&gt;&lt;a aria-hidden="true" href="#cb19-8" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="op"&gt;&amp;lt;&lt;/span&gt;select bind&lt;span class="op"&gt;:&lt;/span&gt;value&lt;span class="op"&gt;=&lt;/span&gt;{selected} on&lt;span class="op"&gt;:&lt;/span&gt;change&lt;span class="op"&gt;=&lt;/span&gt;&lt;span class="st"&gt;"{() =&amp;gt; answer = ''}"&lt;/span&gt;&lt;span class="op"&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb19-9"&gt;&lt;a aria-hidden="true" href="#cb19-9" tabindex="-1"&gt;&lt;/a&gt;    {#each questions &lt;span class="im"&gt;as&lt;/span&gt; question}&lt;/span&gt;
&lt;span id="cb19-10"&gt;&lt;a aria-hidden="true" href="#cb19-10" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="op"&gt;&amp;lt;&lt;/span&gt;option value&lt;span class="op"&gt;=&lt;/span&gt;{question}&lt;span class="op"&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb19-11"&gt;&lt;a aria-hidden="true" href="#cb19-11" tabindex="-1"&gt;&lt;/a&gt;            {question&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="at"&gt;text&lt;/span&gt;}&lt;/span&gt;
&lt;span id="cb19-12"&gt;&lt;a aria-hidden="true" href="#cb19-12" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="op"&gt;&amp;lt;/&lt;/span&gt;option&lt;span class="op"&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb19-13"&gt;&lt;a aria-hidden="true" href="#cb19-13" tabindex="-1"&gt;&lt;/a&gt;    {&lt;span class="ss"&gt;/each}&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb19-14"&gt;&lt;a aria-hidden="true" href="#cb19-14" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="ss"&gt;&amp;lt;/select&lt;/span&gt;&lt;span class="op"&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;code&gt;selected&lt;/code&gt; 的内容是 &lt;code&gt;{id:number, text:string}&lt;/code&gt; 的类型。&lt;/p&gt;
&lt;h2 id="可编辑元素"&gt;可编辑元素&lt;/h2&gt;
&lt;div class="sourceCode" id="cb20"&gt;&lt;pre class="sourceCode html"&gt;&lt;code class="sourceCode html"&gt;&lt;span id="cb20-1"&gt;&lt;a aria-hidden="true" href="#cb20-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;&amp;lt;script&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb20-2"&gt;&lt;a aria-hidden="true" href="#cb20-2" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="kw"&gt;let&lt;/span&gt; html &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="st"&gt;'&amp;lt;p&amp;gt;Write some text!&amp;lt;/p&amp;gt;'&lt;/span&gt;&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb20-3"&gt;&lt;a aria-hidden="true" href="#cb20-3" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;&amp;lt;/script&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb20-4"&gt;&lt;a aria-hidden="true" href="#cb20-4" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb20-5"&gt;&lt;a aria-hidden="true" href="#cb20-5" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;&amp;lt;div&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb20-6"&gt;&lt;a aria-hidden="true" href="#cb20-6" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="ot"&gt;    contenteditable=&lt;/span&gt;&lt;span class="st"&gt;"true"&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb20-7"&gt;&lt;a aria-hidden="true" href="#cb20-7" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="ot"&gt;    bind:innerHTML=&lt;/span&gt;&lt;span class="st"&gt;{html}&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb20-8"&gt;&lt;a aria-hidden="true" href="#cb20-8" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;&amp;gt;&amp;lt;/div&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id="尺寸绑定"&gt;尺寸绑定&lt;/h2&gt;
&lt;p&gt;每个块级标签都可以对 &lt;code&gt;clientWidth&lt;/code&gt;、&lt;code&gt;clientHeight&lt;/code&gt;、&lt;code&gt;offsetWidth&lt;/code&gt; 以及 &lt;code&gt;offsetHeight&lt;/code&gt; 属性进行绑定：&lt;/p&gt;
&lt;div class="sourceCode" id="cb21"&gt;&lt;pre class="sourceCode html"&gt;&lt;code class="sourceCode html"&gt;&lt;span id="cb21-1"&gt;&lt;a aria-hidden="true" href="#cb21-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;&amp;lt;div&lt;/span&gt; &lt;span class="er"&gt;bind:clientWidth&lt;/span&gt;&lt;span class="ot"&gt;=&lt;/span&gt;&lt;span class="st"&gt;{w}&lt;/span&gt; &lt;span class="er"&gt;bind:clientHeight&lt;/span&gt;&lt;span class="ot"&gt;=&lt;/span&gt;&lt;span class="st"&gt;{h}&lt;/span&gt;&lt;span class="kw"&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb21-2"&gt;&lt;a aria-hidden="true" href="#cb21-2" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="kw"&gt;&amp;lt;span&lt;/span&gt; &lt;span class="er"&gt;style&lt;/span&gt;&lt;span class="ot"&gt;=&lt;/span&gt;&lt;span class="st"&gt;"font-size: {size}px"&lt;/span&gt;&lt;span class="kw"&gt;&amp;gt;&lt;/span&gt;{text}&lt;span class="kw"&gt;&amp;lt;/span&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb21-3"&gt;&lt;a aria-hidden="true" href="#cb21-3" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;&amp;lt;/div&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;这些绑定是只读的，更改 w 和 h 的值不会有任何效果。&lt;/p&gt;
&lt;h1 id="生命周期处理"&gt;生命周期处理&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;onMount&lt;/code&gt; fired after the component is rendered&lt;/li&gt;
&lt;li&gt;&lt;code&gt;onDestroy&lt;/code&gt; fired after the component is destroyed&lt;/li&gt;
&lt;li&gt;&lt;code&gt;beforeUpdate&lt;/code&gt; fired before the DOM is updated&lt;/li&gt;
&lt;li&gt;&lt;code&gt;afterUpdate&lt;/code&gt; fired after the DOM is updated&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="onmount"&gt;&lt;code&gt;onMount&lt;/code&gt;&lt;/h2&gt;
&lt;p&gt;在每个组件第一次渲染之后触发。&lt;/p&gt;
&lt;div class="sourceCode" id="cb22"&gt;&lt;pre class="sourceCode html"&gt;&lt;code class="sourceCode html"&gt;&lt;span id="cb22-1"&gt;&lt;a aria-hidden="true" href="#cb22-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;&amp;lt;script&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb22-2"&gt;&lt;a aria-hidden="true" href="#cb22-2" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="im"&gt;import&lt;/span&gt; { onMount } &lt;span class="im"&gt;from&lt;/span&gt; &lt;span class="st"&gt;'svelte'&lt;/span&gt;&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb22-3"&gt;&lt;a aria-hidden="true" href="#cb22-3" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="kw"&gt;let&lt;/span&gt; data&lt;span class="op"&gt;=&lt;/span&gt;&lt;span class="dv"&gt;0&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb22-4"&gt;&lt;a aria-hidden="true" href="#cb22-4" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb22-5"&gt;&lt;a aria-hidden="true" href="#cb22-5" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="bu"&gt;console&lt;/span&gt;&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;log&lt;/span&gt;(&lt;span class="vs"&gt;`Data is &lt;/span&gt;&lt;span class="sc"&gt;${&lt;/span&gt;data&lt;span class="sc"&gt;}&lt;/span&gt;&lt;span class="vs"&gt;`&lt;/span&gt;)  &lt;span class="co"&gt;// 0&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb22-6"&gt;&lt;a aria-hidden="true" href="#cb22-6" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="fu"&gt;onMount&lt;/span&gt;(()&lt;span class="kw"&gt;=&amp;gt;&lt;/span&gt;{data&lt;span class="op"&gt;=&lt;/span&gt;&lt;span class="dv"&gt;100&lt;/span&gt;&lt;span class="op"&gt;;&lt;/span&gt;})&lt;/span&gt;
&lt;span id="cb22-7"&gt;&lt;a aria-hidden="true" href="#cb22-7" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;&amp;lt;/script&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb22-8"&gt;&lt;a aria-hidden="true" href="#cb22-8" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb22-9"&gt;&lt;a aria-hidden="true" href="#cb22-9" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;&amp;lt;b&amp;gt;&lt;/span&gt;{data}&lt;span class="kw"&gt;&amp;lt;/b&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;在 &lt;code&gt;onMount&lt;/code&gt; 中可以注册 async 函数，例如在里面 await fetch 什么东西。如果注册函数返回一个函数，这个函数将在组件销毁时触发。&lt;/p&gt;
&lt;h2 id="ondestroy"&gt;&lt;code&gt;onDestroy&lt;/code&gt;&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;onDestroy&lt;/code&gt; 允许清理数据或停止我们可能在组件初始化时启动的任何操作，例如计时器或使用 &lt;code&gt;setInterval&lt;/code&gt; 的计划周期函数。&lt;/p&gt;
&lt;div class="sourceCode" id="cb23"&gt;&lt;pre class="sourceCode html"&gt;&lt;code class="sourceCode html"&gt;&lt;span id="cb23-1"&gt;&lt;a aria-hidden="true" href="#cb23-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;&amp;lt;script&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb23-2"&gt;&lt;a aria-hidden="true" href="#cb23-2" tabindex="-1"&gt;&lt;/a&gt;  &lt;span class="im"&gt;import&lt;/span&gt; { onMount } &lt;span class="im"&gt;from&lt;/span&gt; &lt;span class="st"&gt;'svelte'&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb23-3"&gt;&lt;a aria-hidden="true" href="#cb23-3" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb23-4"&gt;&lt;a aria-hidden="true" href="#cb23-4" tabindex="-1"&gt;&lt;/a&gt;  &lt;span class="fu"&gt;onMount&lt;/span&gt;(&lt;span class="kw"&gt;async&lt;/span&gt; () &lt;span class="kw"&gt;=&amp;gt;&lt;/span&gt; {&lt;/span&gt;
&lt;span id="cb23-5"&gt;&lt;a aria-hidden="true" href="#cb23-5" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="kw"&gt;const&lt;/span&gt; interval &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="pp"&gt;setInterval&lt;/span&gt;(() &lt;span class="kw"&gt;=&amp;gt;&lt;/span&gt; {&lt;/span&gt;
&lt;span id="cb23-6"&gt;&lt;a aria-hidden="true" href="#cb23-6" tabindex="-1"&gt;&lt;/a&gt;      &lt;span class="bu"&gt;console&lt;/span&gt;&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;log&lt;/span&gt;(&lt;span class="st"&gt;'Something...'&lt;/span&gt;)&lt;/span&gt;
&lt;span id="cb23-7"&gt;&lt;a aria-hidden="true" href="#cb23-7" tabindex="-1"&gt;&lt;/a&gt;    }&lt;span class="op"&gt;,&lt;/span&gt; &lt;span class="dv"&gt;1000&lt;/span&gt;)&lt;/span&gt;
&lt;span id="cb23-8"&gt;&lt;a aria-hidden="true" href="#cb23-8" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb23-9"&gt;&lt;a aria-hidden="true" href="#cb23-9" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="cf"&gt;return&lt;/span&gt; () &lt;span class="kw"&gt;=&amp;gt;&lt;/span&gt; {&lt;/span&gt;
&lt;span id="cb23-10"&gt;&lt;a aria-hidden="true" href="#cb23-10" tabindex="-1"&gt;&lt;/a&gt;      &lt;span class="pp"&gt;clearInterval&lt;/span&gt;(interval)&lt;/span&gt;
&lt;span id="cb23-11"&gt;&lt;a aria-hidden="true" href="#cb23-11" tabindex="-1"&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id="cb23-12"&gt;&lt;a aria-hidden="true" href="#cb23-12" tabindex="-1"&gt;&lt;/a&gt;  })&lt;/span&gt;
&lt;span id="cb23-13"&gt;&lt;a aria-hidden="true" href="#cb23-13" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;&amp;lt;/script&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h1 id="调试"&gt;调试&lt;/h1&gt;
&lt;p&gt;使用 &lt;code&gt;{@debug ...}&lt;/code&gt; tag。&lt;/p&gt;
&lt;h1 id="参考"&gt;参考&lt;/h1&gt;
&lt;ol type="1"&gt;
&lt;li&gt;&lt;a href="https://flaviocopes.com/book/read/svelte/"&gt;The Svelte Handbook&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;br/&gt;
&lt;!--%%REF%%--&gt;
&lt;br/&gt;
&lt;script async="" crossorigin="anonymous" data-category="Announcements" data-category-id="DIC_kwDOJ7Ymy84CX4eg" data-emit-metadata="0" data-input-position="top" data-lang="zh-CN" data-loading="lazy" data-mapping="title" data-reactions-enabled="1" data-repo="izfsk-ium/izfsk-ium.github.io" data-repo-id="R_kgDOJ7Ymyw" data-strict="0" data-theme="preferred_color_scheme" src="https://giscus.app/client.js"&gt;
&lt;/script&gt;
&lt;/main&gt;
&lt;footer&gt;
&lt;p class="signoff"&gt;
&lt;div class="metadata"&gt;
&lt;p class="date"&gt;&lt;time datetime="2023-02-02"&gt;创建日期：2023-02-02&lt;/time&gt;&lt;/p&gt;
&lt;p class="lastmodify"&gt;&lt;time&gt;最后编译：2023-08-10&lt;/time&gt;&lt;/p&gt;
&lt;p class="lastmodify" id="counter-span"&gt;访问次数：&lt;/p&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;/footer&gt;
&lt;script&gt;
    /* These script should run after page load */
    document.querySelectorAll('code.sourceCode').forEach(
      i =&gt; i.insertAdjacentHTML('beforeend', '&lt;div class="copy"&gt;复制&lt;/div&gt;')
    );
    document.querySelectorAll('div.copy').forEach(
      i =&gt; i.addEventListener(
        'click',
        () =&gt; {
          navigator.clipboard.writeText(i.parentElement.innerText.replace('复制', ''));
          i.innerText = '成功';
          setTimeout(() =&gt; {
            i.innerText = '复制';
          }, 1000);
        }
      )
    );

    if (location.href.includes("127.0.0.1:8080")) {
      document.getElementById("counter-span").innerHTML = "[[development mode]]";
    } else {
      const uuid = document.getElementById("article-uuid").innerText;
      const target = document.getElementById("counter-span");
      const last = localStorage.getItem("lastVisit-" + uuid);
      const shouldIncrease = last === null || new Date().getTime() - parseInt(last) &gt;= (1000 * 60 * 15);

      fetch(shouldIncrease ? ("https://counter.izfsk.top/counter/" + uuid) : ("https://counter.izfsk.top/readOnly/" + uuid))
        .then(r =&gt; r.text())
        .then(d =&gt; {
          if (!d.startsWith("Too"))
            document.getElementById("counter-span").innerText = "访问次数：" + d.toString();
          else
            document.getElementById("counter-span").innerHTML = "";
        });

      localStorage.setItem("lastVisit-" + uuid, new Date().getTime());
    }
  &lt;/script&gt;
&lt;script async="" data-website-id="2a1146ab-fa82-4a84-a04f-30e5967357c3" src="https://analytics.umami.is/script.js"&gt;&lt;/script&gt;
&lt;/body&gt;</content:encoded>
      <guid isPermaLink="false">ad498778-ccfb-4be7-97af-bd60ac5939f9</guid>
      <pubDate>Thu, 02 Feb 2023 00:00:00 +0800</pubDate>
    </item>
    <item>
      <title>CROS，Cookie与hapi</title>
      <link>https://blog.izfsk.top/articles/CROS，Cookie与hapi.html</link>
      <description>CROS，Cookie与hapi</description>
      <content:encoded>&lt;body&gt;
&lt;progress id="content_progress" value="0"&gt;&lt;/progress&gt;
&lt;button id="back-to-top"&gt;
    回页顶
  &lt;/button&gt;
&lt;header&gt;
&lt;small id="article-uuid" style="display: none !important;"&gt;86894309-f881-4d14-b82f-6f3e755f2866&lt;/small&gt;
&lt;h1 class="title"&gt;CROS，Cookie与hapi&lt;/h1&gt;
&lt;!-- Subtitle --&gt;
&lt;h3 class="subtitle"&gt; &lt;/h3&gt;
&lt;/header&gt;
&lt;nav id="TOC" role="doc-toc"&gt;
&lt;strong&gt;文章归类: &lt;a href="/pages/category.html#技术"&gt;技术&lt;/a&gt; &lt;/strong&gt;
&lt;input id="contents" type="checkbox"/&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#简单请求" id="toc-简单请求"&gt;简单请求&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#复杂请求" id="toc-复杂请求"&gt;复杂请求&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#跨域-cookie" id="toc-跨域-cookie"&gt;跨域 Cookie&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#参考" id="toc-参考"&gt;参考&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#reference"&gt;参考链接&lt;/a&gt;&lt;/li&gt;
&lt;li&gt; &lt;/li&gt;
&lt;li class="tools"&gt;
&lt;span id="backtomain"&gt;
&lt;svg class="bi bi-house" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M8.707 1.5a1 1 0 0 0-1.414 0L.646 8.146a.5.5 0 0 0 .708.708L2 8.207V13.5A1.5 1.5 0 0 0 3.5 15h9a1.5 1.5 0 0 0 1.5-1.5V8.207l.646.647a.5.5 0 0 0 .708-.708L13 5.793V2.5a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v1.293L8.707 1.5ZM13 7.207V13.5a.5.5 0 0 1-.5.5h-9a.5.5 0 0 1-.5-.5V7.207l5-5 5 5Z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="readingmode"&gt;
&lt;svg class="bi bi-book" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M1 2.828c.885-.37 2.154-.769 3.388-.893 1.33-.134 2.458.063 3.112.752v9.746c-.935-.53-2.12-.603-3.213-.493-1.18.12-2.37.461-3.287.811V2.828zm7.5-.141c.654-.689 1.782-.886 3.112-.752 1.234.124 2.503.523 3.388.893v9.923c-.918-.35-2.107-.692-3.287-.81-1.094-.111-2.278-.039-3.213.492V2.687zM8 1.783C7.015.936 5.587.81 4.287.94c-1.514.153-3.042.672-3.994 1.105A.5.5 0 0 0 0 2.5v11a.5.5 0 0 0 .707.455c.882-.4 2.303-.881 3.68-1.02 1.409-.142 2.59.087 3.223.877a.5.5 0 0 0 .78 0c.633-.79 1.814-1.019 3.222-.877 1.378.139 2.8.62 3.681 1.02A.5.5 0 0 0 16 13.5v-11a.5.5 0 0 0-.293-.455c-.952-.433-2.48-.952-3.994-1.105C10.413.809 8.985.936 8 1.783z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="larger"&gt; &lt;/span&gt;
&lt;span id="smaller"&gt;&lt;/span&gt;
&lt;span id="switchfont"&gt;
&lt;svg class="bi bi-fonts" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M12.258 3h-8.51l-.083 2.46h.479c.26-1.544.758-1.783 2.693-1.845l.424-.013v7.827c0 .663-.144.82-1.3.923v.52h4.082v-.52c-1.162-.103-1.306-.26-1.306-.923V3.602l.431.013c1.934.062 2.434.301 2.693 1.846h.479L12.258 3z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="backtotop"&gt;
&lt;svg class="bi bi-arrow-bar-up" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M8 10a.5.5 0 0 0 .5-.5V3.707l2.146 2.147a.5.5 0 0 0 .708-.708l-3-3a.5.5 0 0 0-.708 0l-3 3a.5.5 0 1 0 .708.708L7.5 3.707V9.5a.5.5 0 0 0 .5.5zm-7 2.5a.5.5 0 0 1 .5-.5h13a.5.5 0 0 1 0 1h-13a.5.5 0 0 1-.5-.5z" fill-rule="evenodd"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/nav&gt;
&lt;main&gt;
&lt;p&gt;最近做项目，用到了 &lt;a href="https://hapi.dev/tutorials/gettingstarted/?lang=zh_CN"&gt;hapi.js&lt;/a&gt; 作为后端，但前端是放在不同域名的静态页面，于是喜闻乐见的遇到了无数 CROS 问题。虽然以前也遇到过，并且用各种瞎猫碰到死耗子的方法绕了过去，但没有真的留意过，直到这次需要大规模用到 CROS 请求，还要跨域传送 Cookie，这才仔细学了一下。&lt;/p&gt;
&lt;p&gt;CROS，全称是 Cross-Origin Resource Sharing，跨源资源共享。就是说，一个网站上的脚本要访问不在同一个域名的资源。主要的 CROS 请求来源有 XHR 请求， &lt;code&gt;fetch&lt;/code&gt; 调用以及字体文件。&lt;/p&gt;
&lt;p&gt;CROS 有两种，一种是「简单请求」，一种是「复杂请求」。简单请求，简单的来讲就是请求方法是 &lt;code&gt;get&lt;/code&gt;，&lt;code&gt;head&lt;/code&gt;，&lt;code&gt;post&lt;/code&gt;，并且请求的 &lt;code&gt;header&lt;/code&gt; 里面没有奇奇怪怪的自定义数据，里面的标头只能是&lt;a href="https://fetch.spec.whatwg.org/#cors-safelisted-request-header"&gt;这里提到的&lt;/a&gt;。第二种是「复杂请求」，它需要「预检」。也就是对这个资源发送一个 &lt;code&gt;options&lt;/code&gt; 请求，所以在 F12 工具里面能看到两个请求。&lt;/p&gt;
&lt;h1 id="简单请求"&gt;简单请求&lt;/h1&gt;
&lt;p&gt;简单请求中，浏览器会给目标服务器添加标头 &lt;code&gt;Origin&lt;/code&gt; 来表明来源，目标服务器必须要有一个 &lt;code&gt;Access-Control-Allow-Origin&lt;/code&gt; 标头，表示允许请求，不然请求的资源会被浏览器拦截。&lt;strong&gt;这个拦截在 js 层面是无法检测的&lt;/strong&gt;，但会在浏览器 Console 中显示出来。具体的显示是：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Access to fetch at '...' from origin '...' has been blocked by CORS policy: 
    No 'Access-Control-Allow-Origin' header is present on the requested resource.
    If an opaque response serves your needs, 
    set the request's mode to 'no-cors' to fetch the resource with CORS disabled.&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;作为服务器端，必须在返回的头中带有 &lt;code&gt;Access-Control-Allow-Origin&lt;/code&gt; 字段。如果是公共的 API 和资源，直接设置为 「*」即可，否则需要添加对应的调用方地址。&lt;/p&gt;
&lt;p&gt;举例来讲，对于一个这样的请求：&lt;/p&gt;
&lt;div class="sourceCode" id="cb2"&gt;&lt;pre class="sourceCode js"&gt;&lt;code class="sourceCode javascript"&gt;&lt;span id="cb2-1"&gt;&lt;a aria-hidden="true" href="#cb2-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="fu"&gt;fetch&lt;/span&gt;(&lt;span class="st"&gt;'http://target.api/api'&lt;/span&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;对应的 hapi 路由应该这样写：&lt;/p&gt;
&lt;div class="sourceCode" id="cb3"&gt;&lt;pre class="sourceCode js"&gt;&lt;code class="sourceCode javascript"&gt;&lt;span id="cb3-1"&gt;&lt;a aria-hidden="true" href="#cb3-1" tabindex="-1"&gt;&lt;/a&gt;server&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;route&lt;/span&gt;({&lt;/span&gt;
&lt;span id="cb3-2"&gt;&lt;a aria-hidden="true" href="#cb3-2" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="dt"&gt;method&lt;/span&gt;&lt;span class="op"&gt;:&lt;/span&gt; &lt;span class="st"&gt;"GET"&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb3-3"&gt;&lt;a aria-hidden="true" href="#cb3-3" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="dt"&gt;path&lt;/span&gt;&lt;span class="op"&gt;:&lt;/span&gt; &lt;span class="st"&gt;"/api"&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb3-4"&gt;&lt;a aria-hidden="true" href="#cb3-4" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="dt"&gt;handler&lt;/span&gt;&lt;span class="op"&gt;:&lt;/span&gt; &lt;span class="kw"&gt;async&lt;/span&gt; (req&lt;span class="op"&gt;,&lt;/span&gt; h) &lt;span class="kw"&gt;=&amp;gt;&lt;/span&gt; {&lt;/span&gt;
&lt;span id="cb3-5"&gt;&lt;a aria-hidden="true" href="#cb3-5" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="cf"&gt;return&lt;/span&gt; h&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;response&lt;/span&gt;(&lt;span class="st"&gt;"Something something"&lt;/span&gt;)&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;header&lt;/span&gt;(&lt;span class="st"&gt;'Access-Control-Allow-Origin'&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt;&lt;span class="st"&gt;'*'&lt;/span&gt;)&lt;span class="op"&gt;;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb3-6"&gt;&lt;a aria-hidden="true" href="#cb3-6" tabindex="-1"&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id="cb3-7"&gt;&lt;a aria-hidden="true" href="#cb3-7" tabindex="-1"&gt;&lt;/a&gt;})&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;或者这样：&lt;/p&gt;
&lt;div class="sourceCode" id="cb4"&gt;&lt;pre class="sourceCode js"&gt;&lt;code class="sourceCode javascript"&gt;&lt;span id="cb4-1"&gt;&lt;a aria-hidden="true" href="#cb4-1" tabindex="-1"&gt;&lt;/a&gt;server&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;route&lt;/span&gt;({&lt;/span&gt;
&lt;span id="cb4-2"&gt;&lt;a aria-hidden="true" href="#cb4-2" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="dt"&gt;method&lt;/span&gt;&lt;span class="op"&gt;:&lt;/span&gt; &lt;span class="st"&gt;"GET"&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb4-3"&gt;&lt;a aria-hidden="true" href="#cb4-3" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="dt"&gt;path&lt;/span&gt;&lt;span class="op"&gt;:&lt;/span&gt; &lt;span class="st"&gt;"/api"&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb4-4"&gt;&lt;a aria-hidden="true" href="#cb4-4" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="dt"&gt;options&lt;/span&gt;&lt;span class="op"&gt;:&lt;/span&gt; {&lt;/span&gt;
&lt;span id="cb4-5"&gt;&lt;a aria-hidden="true" href="#cb4-5" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="dt"&gt;cors&lt;/span&gt;&lt;span class="op"&gt;:&lt;/span&gt; {&lt;/span&gt;
&lt;span id="cb4-6"&gt;&lt;a aria-hidden="true" href="#cb4-6" tabindex="-1"&gt;&lt;/a&gt;            &lt;span class="dt"&gt;preflightStatusCode&lt;/span&gt;&lt;span class="op"&gt;:&lt;/span&gt; &lt;span class="dv"&gt;200&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb4-7"&gt;&lt;a aria-hidden="true" href="#cb4-7" tabindex="-1"&gt;&lt;/a&gt;            &lt;span class="dt"&gt;origin&lt;/span&gt;&lt;span class="op"&gt;:&lt;/span&gt; CONFIGURE&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="at"&gt;environment&lt;/span&gt;&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="at"&gt;frontend_location&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb4-8"&gt;&lt;a aria-hidden="true" href="#cb4-8" tabindex="-1"&gt;&lt;/a&gt;        }&lt;/span&gt;
&lt;span id="cb4-9"&gt;&lt;a aria-hidden="true" href="#cb4-9" tabindex="-1"&gt;&lt;/a&gt;    }&lt;span class="op"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb4-10"&gt;&lt;a aria-hidden="true" href="#cb4-10" tabindex="-1"&gt;&lt;/a&gt;})&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;这样就可以了。&lt;/p&gt;
&lt;h1 id="复杂请求"&gt;复杂请求&lt;/h1&gt;
&lt;p&gt;复杂请求必须首先使用 &lt;code&gt;OPTIONS&lt;/code&gt; 方法发起一个预检请求到服务器，以获知服务器是否允许该实际请求。在开发人员工具的「网络」中会显示其 Method 是 &lt;code&gt;OPTIONS&lt;/code&gt;，之后才是真正的请求，显示为 &lt;code&gt;XXX + Preflight&lt;/code&gt;。其中 &lt;code&gt;XXX&lt;/code&gt; 是请求的方法。&lt;/p&gt;
&lt;p&gt;对于 Preflight 请求，需要两个字段：&lt;code&gt;Access-Control-Request-Method&lt;/code&gt; 和 &lt;code&gt;Access-Control-Request-Headers&lt;/code&gt;。前者是实际请求的方法，后者是实际请求所携带的额外头部。&lt;/p&gt;
&lt;p&gt;对于服务器相应的 Preflight 请求，有四个额外字段：&lt;code&gt;Access-Control-Allow-Origin&lt;/code&gt;，&lt;code&gt;Access-Control-Allow-Methods&lt;/code&gt;，&lt;code&gt;Access-Control-Allow-Headers&lt;/code&gt;，&lt;code&gt;Access-Control-Max-Age&lt;/code&gt;。分别为允许的域名，允许的方法，允许的额外标头，可供缓存的时间长短（秒）。&lt;/p&gt;
&lt;p&gt;之后进行实际请求，其标头和一个简单的 CROS 请求一样。&lt;/p&gt;
&lt;div class="sourceCode" id="cb5"&gt;&lt;pre class="sourceCode js"&gt;&lt;code class="sourceCode javascript"&gt;&lt;span id="cb5-1"&gt;&lt;a aria-hidden="true" href="#cb5-1" tabindex="-1"&gt;&lt;/a&gt;server&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;route&lt;/span&gt;({&lt;/span&gt;
&lt;span id="cb5-2"&gt;&lt;a aria-hidden="true" href="#cb5-2" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="dt"&gt;method&lt;/span&gt;&lt;span class="op"&gt;:&lt;/span&gt; &lt;span class="st"&gt;"POST"&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb5-3"&gt;&lt;a aria-hidden="true" href="#cb5-3" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="dt"&gt;path&lt;/span&gt;&lt;span class="op"&gt;:&lt;/span&gt; &lt;span class="st"&gt;"/api/commonUserLogin"&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb5-4"&gt;&lt;a aria-hidden="true" href="#cb5-4" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="dt"&gt;options&lt;/span&gt;&lt;span class="op"&gt;:&lt;/span&gt; {&lt;/span&gt;
&lt;span id="cb5-5"&gt;&lt;a aria-hidden="true" href="#cb5-5" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="dt"&gt;cors&lt;/span&gt;&lt;span class="op"&gt;:&lt;/span&gt; {&lt;/span&gt;
&lt;span id="cb5-6"&gt;&lt;a aria-hidden="true" href="#cb5-6" tabindex="-1"&gt;&lt;/a&gt;            &lt;span class="dt"&gt;origin&lt;/span&gt;&lt;span class="op"&gt;:&lt;/span&gt; CONFIGURE&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="at"&gt;frontend_location&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt;    &lt;span class="co"&gt;// Access-Control-Allow-Origin&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb5-7"&gt;&lt;a aria-hidden="true" href="#cb5-7" tabindex="-1"&gt;&lt;/a&gt;            &lt;span class="dt"&gt;additionalHeaders&lt;/span&gt;&lt;span class="op"&gt;:&lt;/span&gt; [&lt;span class="st"&gt;"your-headers"&lt;/span&gt;]&lt;span class="op"&gt;,&lt;/span&gt;    &lt;span class="co"&gt;// Access-Control-Allow-Headers&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb5-8"&gt;&lt;a aria-hidden="true" href="#cb5-8" tabindex="-1"&gt;&lt;/a&gt;            &lt;span class="dt"&gt;additionalExposedHeaders&lt;/span&gt;&lt;span class="op"&gt;:&lt;/span&gt; [&lt;span class="st"&gt;"your-headers"&lt;/span&gt;]&lt;span class="op"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb5-9"&gt;&lt;a aria-hidden="true" href="#cb5-9" tabindex="-1"&gt;&lt;/a&gt;            &lt;span class="dt"&gt;maxAge&lt;/span&gt;&lt;span class="op"&gt;:&lt;/span&gt; &lt;span class="dv"&gt;1000&lt;/span&gt;        &lt;span class="co"&gt;// Access-Control-Max-Age&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb5-10"&gt;&lt;a aria-hidden="true" href="#cb5-10" tabindex="-1"&gt;&lt;/a&gt;        }&lt;/span&gt;
&lt;span id="cb5-11"&gt;&lt;a aria-hidden="true" href="#cb5-11" tabindex="-1"&gt;&lt;/a&gt;    }&lt;span class="op"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb5-12"&gt;&lt;a aria-hidden="true" href="#cb5-12" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="dt"&gt;handler&lt;/span&gt;&lt;span class="op"&gt;:&lt;/span&gt; &lt;span class="kw"&gt;async&lt;/span&gt; (req&lt;span class="op"&gt;,&lt;/span&gt; h) &lt;span class="kw"&gt;=&amp;gt;&lt;/span&gt; {&lt;span class="op"&gt;...&lt;/span&gt;}&lt;/span&gt;
&lt;span id="cb5-13"&gt;&lt;a aria-hidden="true" href="#cb5-13" tabindex="-1"&gt;&lt;/a&gt;})&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;对于浏览器的 fetch 请求，请求头会自动添加。&lt;/p&gt;
&lt;h1 id="跨域-cookie"&gt;跨域 Cookie&lt;/h1&gt;
&lt;p&gt;正常情况，一个站点的 Cookie 只能一个站点使用。想要跨站点发送 Cookie 需要：&lt;/p&gt;
&lt;ol type="1"&gt;
&lt;li&gt;在 &lt;code&gt;fetch&lt;/code&gt; 的请求中设置 &lt;code&gt;credentials&lt;/code&gt; 为 &lt;code&gt;"include"&lt;/code&gt;;&lt;/li&gt;
&lt;li&gt;服务器的相应中需要有 &lt;code&gt;Access-Control-Allow-Credentials: true&lt;/code&gt; 标头;&lt;/li&gt;
&lt;li&gt;当响应的是附带身份凭证的请求时，服务端必须明确 &lt;code&gt;Access-Control-Allow-Origin&lt;/code&gt; 和 &lt;code&gt;Access-Control-Allow-Headers&lt;/code&gt; 的值，而不能使用通配符。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;对于服务器，首先需要设置好 Cookie，hapi 中的 Cookie 叫做 &lt;code&gt;state&lt;/code&gt;：&lt;/p&gt;
&lt;div class="sourceCode" id="cb6"&gt;&lt;pre class="sourceCode js"&gt;&lt;code class="sourceCode javascript"&gt;&lt;span id="cb6-1"&gt;&lt;a aria-hidden="true" href="#cb6-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="bu"&gt;Server&lt;/span&gt;&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;state&lt;/span&gt;(&lt;span class="st"&gt;'something'&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt; {&lt;/span&gt;
&lt;span id="cb6-2"&gt;&lt;a aria-hidden="true" href="#cb6-2" tabindex="-1"&gt;&lt;/a&gt;  &lt;span class="dt"&gt;ttl&lt;/span&gt;&lt;span class="op"&gt;:&lt;/span&gt; &lt;span class="dv"&gt;1000&lt;/span&gt; &lt;span class="op"&gt;*&lt;/span&gt; &lt;span class="dv"&gt;60&lt;/span&gt; &lt;span class="op"&gt;*&lt;/span&gt; &lt;span class="dv"&gt;60&lt;/span&gt; &lt;span class="op"&gt;*&lt;/span&gt; &lt;span class="dv"&gt;60&lt;/span&gt; &lt;span class="op"&gt;*&lt;/span&gt; &lt;span class="dv"&gt;60&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb6-3"&gt;&lt;a aria-hidden="true" href="#cb6-3" tabindex="-1"&gt;&lt;/a&gt;  &lt;span class="dt"&gt;isSecure&lt;/span&gt;&lt;span class="op"&gt;:&lt;/span&gt; &lt;span class="kw"&gt;true&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb6-4"&gt;&lt;a aria-hidden="true" href="#cb6-4" tabindex="-1"&gt;&lt;/a&gt;  &lt;span class="dt"&gt;isHttpOnly&lt;/span&gt;&lt;span class="op"&gt;:&lt;/span&gt; &lt;span class="kw"&gt;true&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb6-5"&gt;&lt;a aria-hidden="true" href="#cb6-5" tabindex="-1"&gt;&lt;/a&gt;  &lt;span class="dt"&gt;isSameSite&lt;/span&gt;&lt;span class="op"&gt;:&lt;/span&gt; &lt;span class="st"&gt;'None'&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb6-6"&gt;&lt;a aria-hidden="true" href="#cb6-6" tabindex="-1"&gt;&lt;/a&gt;})&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;对应 router 的 options ：&lt;/p&gt;
&lt;div class="sourceCode" id="cb7"&gt;&lt;pre class="sourceCode js"&gt;&lt;code class="sourceCode javascript"&gt;&lt;span id="cb7-1"&gt;&lt;a aria-hidden="true" href="#cb7-1" tabindex="-1"&gt;&lt;/a&gt;options&lt;span class="op"&gt;:&lt;/span&gt; {&lt;/span&gt;
&lt;span id="cb7-2"&gt;&lt;a aria-hidden="true" href="#cb7-2" tabindex="-1"&gt;&lt;/a&gt;   &lt;span class="dt"&gt;cors&lt;/span&gt;&lt;span class="op"&gt;:&lt;/span&gt; {&lt;/span&gt;
&lt;span id="cb7-3"&gt;&lt;a aria-hidden="true" href="#cb7-3" tabindex="-1"&gt;&lt;/a&gt;       &lt;span class="dt"&gt;origin&lt;/span&gt;&lt;span class="op"&gt;:&lt;/span&gt; CONFIGURE&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="at"&gt;frontend_location&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb7-4"&gt;&lt;a aria-hidden="true" href="#cb7-4" tabindex="-1"&gt;&lt;/a&gt;       &lt;span class="dt"&gt;additionalHeaders&lt;/span&gt;&lt;span class="op"&gt;:&lt;/span&gt; [&lt;span class="st"&gt;"your-headers"&lt;/span&gt;]&lt;span class="op"&gt;,&lt;/span&gt; &lt;/span&gt;
&lt;span id="cb7-5"&gt;&lt;a aria-hidden="true" href="#cb7-5" tabindex="-1"&gt;&lt;/a&gt;       &lt;span class="dt"&gt;additionalExposedHeaders&lt;/span&gt;&lt;span class="op"&gt;:&lt;/span&gt;  [&lt;span class="st"&gt;"your-headers"&lt;/span&gt;]&lt;span class="op"&gt;,&lt;/span&gt; &lt;/span&gt;
&lt;span id="cb7-6"&gt;&lt;a aria-hidden="true" href="#cb7-6" tabindex="-1"&gt;&lt;/a&gt;       &lt;span class="dt"&gt;credentials&lt;/span&gt;&lt;span class="op"&gt;:&lt;/span&gt; &lt;span class="kw"&gt;true&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb7-7"&gt;&lt;a aria-hidden="true" href="#cb7-7" tabindex="-1"&gt;&lt;/a&gt;       &lt;span class="dt"&gt;maxAge&lt;/span&gt;&lt;span class="op"&gt;:&lt;/span&gt;&lt;span class="dv"&gt;100&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb7-8"&gt;&lt;a aria-hidden="true" href="#cb7-8" tabindex="-1"&gt;&lt;/a&gt;   }&lt;/span&gt;
&lt;span id="cb7-9"&gt;&lt;a aria-hidden="true" href="#cb7-9" tabindex="-1"&gt;&lt;/a&gt;}&lt;span class="op"&gt;,&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;设置 Cookie 则是：&lt;/p&gt;
&lt;div class="sourceCode" id="cb8"&gt;&lt;pre class="sourceCode typescript"&gt;&lt;code class="sourceCode typescript"&gt;&lt;span id="cb8-1"&gt;&lt;a aria-hidden="true" href="#cb8-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="cf"&gt;return&lt;/span&gt; h&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;response&lt;/span&gt;(&lt;span class="st"&gt;"Ok"&lt;/span&gt;)&lt;/span&gt;
&lt;span id="cb8-2"&gt;&lt;a aria-hidden="true" href="#cb8-2" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;code&lt;/span&gt;(&lt;span class="dv"&gt;200&lt;/span&gt;)&lt;/span&gt;
&lt;span id="cb8-3"&gt;&lt;a aria-hidden="true" href="#cb8-3" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;state&lt;/span&gt;(&lt;span class="st"&gt;'something'&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb8-4"&gt;&lt;a aria-hidden="true" href="#cb8-4" tabindex="-1"&gt;&lt;/a&gt;        jwt&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;sign&lt;/span&gt;(&lt;span class="st"&gt;"Your data"&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb8-5"&gt;&lt;a aria-hidden="true" href="#cb8-5" tabindex="-1"&gt;&lt;/a&gt;            CONFIGURE&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="at"&gt;jwt_secret&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt; { expiresIn&lt;span class="op"&gt;:&lt;/span&gt; &lt;span class="st"&gt;'100d'&lt;/span&gt; })&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;toString&lt;/span&gt;())&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h1 id="参考"&gt;参考&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://httptoolkit.com/will-it-cors/"&gt;CROS 交互式检测和教学&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="http://developer.mozilla.org/zh-CN/docs/web/http/cors"&gt;跨源资源共享（CORS）&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://hapi.dev/api/?v=21.1.0#-routeoptionscors"&gt;hapi.js – route.options.cors&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;br/&gt;
&lt;!--%%REF%%--&gt;
&lt;br/&gt;
&lt;script async="" crossorigin="anonymous" data-category="Announcements" data-category-id="DIC_kwDOJ7Ymy84CX4eg" data-emit-metadata="0" data-input-position="top" data-lang="zh-CN" data-loading="lazy" data-mapping="title" data-reactions-enabled="1" data-repo="izfsk-ium/izfsk-ium.github.io" data-repo-id="R_kgDOJ7Ymyw" data-strict="0" data-theme="preferred_color_scheme" src="https://giscus.app/client.js"&gt;
&lt;/script&gt;
&lt;/main&gt;
&lt;footer&gt;
&lt;p class="signoff"&gt;
&lt;div class="metadata"&gt;
&lt;p class="date"&gt;&lt;time datetime="2023-02-07"&gt;创建日期：2023-02-07&lt;/time&gt;&lt;/p&gt;
&lt;p class="lastmodify"&gt;&lt;time&gt;最后编译：2023-08-10&lt;/time&gt;&lt;/p&gt;
&lt;p class="lastmodify" id="counter-span"&gt;访问次数：&lt;/p&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;/footer&gt;
&lt;script&gt;
    /* These script should run after page load */
    document.querySelectorAll('code.sourceCode').forEach(
      i =&gt; i.insertAdjacentHTML('beforeend', '&lt;div class="copy"&gt;复制&lt;/div&gt;')
    );
    document.querySelectorAll('div.copy').forEach(
      i =&gt; i.addEventListener(
        'click',
        () =&gt; {
          navigator.clipboard.writeText(i.parentElement.innerText.replace('复制', ''));
          i.innerText = '成功';
          setTimeout(() =&gt; {
            i.innerText = '复制';
          }, 1000);
        }
      )
    );

    if (location.href.includes("127.0.0.1:8080")) {
      document.getElementById("counter-span").innerHTML = "[[development mode]]";
    } else {
      const uuid = document.getElementById("article-uuid").innerText;
      const target = document.getElementById("counter-span");
      const last = localStorage.getItem("lastVisit-" + uuid);
      const shouldIncrease = last === null || new Date().getTime() - parseInt(last) &gt;= (1000 * 60 * 15);

      fetch(shouldIncrease ? ("https://counter.izfsk.top/counter/" + uuid) : ("https://counter.izfsk.top/readOnly/" + uuid))
        .then(r =&gt; r.text())
        .then(d =&gt; {
          if (!d.startsWith("Too"))
            document.getElementById("counter-span").innerText = "访问次数：" + d.toString();
          else
            document.getElementById("counter-span").innerHTML = "";
        });

      localStorage.setItem("lastVisit-" + uuid, new Date().getTime());
    }
  &lt;/script&gt;
&lt;script async="" data-website-id="2a1146ab-fa82-4a84-a04f-30e5967357c3" src="https://analytics.umami.is/script.js"&gt;&lt;/script&gt;
&lt;/body&gt;</content:encoded>
      <guid isPermaLink="false">86894309-f881-4d14-b82f-6f3e755f2866</guid>
      <pubDate>Tue, 07 Feb 2023 00:00:00 +0800</pubDate>
    </item>
    <item>
      <title>为什么 OpenAI 并不 Open</title>
      <link>https://blog.izfsk.top/articles/为什么OpenAI并不Open.html</link>
      <description>为什么 OpenAI 并不 Open</description>
      <content:encoded>&lt;body&gt;
&lt;progress id="content_progress" value="0"&gt;&lt;/progress&gt;
&lt;button id="back-to-top"&gt;
    回页顶
  &lt;/button&gt;
&lt;header&gt;
&lt;small id="article-uuid" style="display: none !important;"&gt;4f81285d-6c9a-46af-a72b-af1bcb736623&lt;/small&gt;
&lt;h1 class="title"&gt;为什么 OpenAI 并不 Open&lt;/h1&gt;
&lt;!-- Subtitle --&gt;
&lt;h3 class="subtitle"&gt; &lt;/h3&gt;
&lt;/header&gt;
&lt;main&gt;
&lt;blockquote&gt;
&lt;p&gt;正如我们享受他人的发明带来的巨大便利一样，我们也应该乐于有机会让自己的发明为他人服务，而且我们应该免费并慷慨地这么做。 ——本杰明・富兰克林&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;40 年前，我们的先辈在这个星球上创立了自由软件运动，接近半个世纪的发展后，其成果深刻而全面的改变了我们的数字世界。&lt;/p&gt;
&lt;p&gt;而现在，我们面临着另外一场战斗。 GNU 工程的先辈们对抗着私有软件，而眼下这场战斗的敌人是「私有 AI」。它考验着我们能否把握住自己和未来几代人计算的权利，这场看不见的战斗可能要在很久之后──直到事态已经无法挽回的时候──才能够被大众注意到。&lt;/p&gt;
&lt;p&gt;自然，这里谈论的并不是有关失控的人工智能向人类城市发射核导弹，这样的危机未来自然有人会谈，眼下这场战斗对抗的形式难以察觉，却无所不在。理查德·斯托曼在其文章&lt;a href="https://www.gnu.org/philosophy/right-to-read.zh-cn.html"&gt;《阅读的权利》&lt;/a&gt;中用一个假想的历史故事描述了失去了阅读权利的社会图景，幸运的是，我们并不需要另外一部小说或者一个故事来描述我们被私有 AI 控制的社会。任何一个看过诸如 《银翼杀手2049》 或玩过 《赛博朋克 2077》 的人都不难想象出一个被巨型企业所控制的社会的图景，而不幸的是，今天，这样的巨型企业正在成型。&lt;/p&gt;
&lt;p&gt;随着 ChatGPT 在&lt;a href="https://www.reuters.com/technology/chatgpt-sets-record-fastest-growing-user-base-analyst-note-2023-02-01/"&gt;两个月以内获得了 100000000 活跃用户&lt;/a&gt;，其背后创造这一超越任何产品用户增长速度的历史性记录的公司，OpenAI，也获得了资本的青睐，然而，这家&lt;strong&gt;公司&lt;/strong&gt;以及其研发的人工智能依旧是私有的。&lt;/p&gt;
&lt;p&gt;OpenAI 并不像其名字中那个极具迷惑性的「Open」字眼所暗示那样，是开放的。其产品要求美国手机号码注册，而其最近开始提供的分级付费服务更是为其「ensure that artificial general intelligence benefits all of humanity」的宣传添加了一个可笑的注脚。当然，奢求一个商业公司无偿的为大众提供服务是幼稚的，但当我们考虑 OpenAI 这样的公司，其营业模式和研发产品的投入则向我们揭示了现代的人工智能是如何变得「不自由」的。&lt;/p&gt;
&lt;p&gt;如同汽油对于汽车，源代码的可获得性和控制权对于软件一样，创造和控制一个人工智能模型，最重要的三个方面是&lt;strong&gt;算法&lt;/strong&gt;，&lt;strong&gt;计算力&lt;/strong&gt;和&lt;strong&gt;数据&lt;/strong&gt;。而很遗憾，我们的手中几乎没有其中任何一项。先进的，能够创造出成规模的大型模型的人工智能算法要么在博士和教授们的论文中，要么在签署了重重保密协议的公司实验室中，而高中生宿舍里运行着 Tensorflow 的笔记本的计算能力也不可能与 24 小时运行的成千上万台专用机器相比，商业公司可以获得广泛的，海量的数据，并能够在与大量用户的交互中获得反馈和进行修正，而个人只能投入自己有限的精力寻找参差不齐和少量的数据。与自由软件运动不同，大型人工智能模型的开发在可见的革命性的技术发展出现以前，依靠的不仅仅是程序员的脑力和一腔热血，其背后起到支撑作用的，是商业公司海量的投资。&lt;/p&gt;
&lt;p&gt;在这三者中，最难以获得的，也是最为关键的，是计算力。毫不夸张的讲，谁掌控了计算力，谁就掌控了人工智能模型创造和训练，而鉴于人工智能在未来社会中的广泛运用，这一掌控事实上也就是掌控了整个社会。而不难想象，拥有这样巨大的影响力的巨型企业将会以何种方式影响和操纵社会。这并不是危言耸听，看看 DMCA 吧，回顾一下已经习以为常的 DRM 和「安全启动」。掌控了海量计算力的巨型企业，压倒和吞并小的企业，垄断计算能力，雪球一样越滚越大，直到成为笼罩在整个社会上的令人战栗的老大哥。&lt;/p&gt;
&lt;p&gt;对抗私有 AI 及其发展模式的战斗业已展开，这场战斗的规则是赢者通吃。目前，我们的敌人正在联合起来，并且不断增长 ──── 无论是处于追逐利益还是追逐其他什么东西 ──── 并在投资和估值令人眼花缭乱的上扬中不断壮大，而我们却依旧没有任何清晰的战略和方法来对抗它们。&lt;/p&gt;
&lt;p&gt;而就在 2023 年 1 月，OpenAI 即将&lt;a href="https://www.forbes.com/sites/qai/2023/01/19/microsoft-considers-investing-10-billion-in-openai-maker-of-chatgpt-heres-what-it-means-for-investors/?sh=26ca4e0f154a"&gt;获得微软的 100 亿投资&lt;/a&gt;，使其估值达到 290 亿美元。&lt;/p&gt;
&lt;br/&gt;
&lt;!--%%REF%%--&gt;
&lt;br/&gt;
&lt;script async="" crossorigin="anonymous" data-category="Announcements" data-category-id="DIC_kwDOJ7Ymy84CX4eg" data-emit-metadata="0" data-input-position="top" data-lang="zh-CN" data-loading="lazy" data-mapping="title" data-reactions-enabled="1" data-repo="izfsk-ium/izfsk-ium.github.io" data-repo-id="R_kgDOJ7Ymyw" data-strict="0" data-theme="preferred_color_scheme" src="https://giscus.app/client.js"&gt;
&lt;/script&gt;
&lt;/main&gt;
&lt;footer&gt;
&lt;p class="signoff"&gt;
&lt;div class="metadata"&gt;
&lt;p class="date"&gt;&lt;time datetime="2023-02-13"&gt;创建日期：2023-02-13&lt;/time&gt;&lt;/p&gt;
&lt;p class="lastmodify"&gt;&lt;time&gt;最后编译：2023-08-10&lt;/time&gt;&lt;/p&gt;
&lt;p class="lastmodify" id="counter-span"&gt;访问次数：&lt;/p&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;/footer&gt;
&lt;script&gt;
    /* These script should run after page load */
    document.querySelectorAll('code.sourceCode').forEach(
      i =&gt; i.insertAdjacentHTML('beforeend', '&lt;div class="copy"&gt;复制&lt;/div&gt;')
    );
    document.querySelectorAll('div.copy').forEach(
      i =&gt; i.addEventListener(
        'click',
        () =&gt; {
          navigator.clipboard.writeText(i.parentElement.innerText.replace('复制', ''));
          i.innerText = '成功';
          setTimeout(() =&gt; {
            i.innerText = '复制';
          }, 1000);
        }
      )
    );

    if (location.href.includes("127.0.0.1:8080")) {
      document.getElementById("counter-span").innerHTML = "[[development mode]]";
    } else {
      const uuid = document.getElementById("article-uuid").innerText;
      const target = document.getElementById("counter-span");
      const last = localStorage.getItem("lastVisit-" + uuid);
      const shouldIncrease = last === null || new Date().getTime() - parseInt(last) &gt;= (1000 * 60 * 15);

      fetch(shouldIncrease ? ("https://counter.izfsk.top/counter/" + uuid) : ("https://counter.izfsk.top/readOnly/" + uuid))
        .then(r =&gt; r.text())
        .then(d =&gt; {
          if (!d.startsWith("Too"))
            document.getElementById("counter-span").innerText = "访问次数：" + d.toString();
          else
            document.getElementById("counter-span").innerHTML = "";
        });

      localStorage.setItem("lastVisit-" + uuid, new Date().getTime());
    }
  &lt;/script&gt;
&lt;script async="" data-website-id="2a1146ab-fa82-4a84-a04f-30e5967357c3" src="https://analytics.umami.is/script.js"&gt;&lt;/script&gt;
&lt;/body&gt;</content:encoded>
      <guid isPermaLink="false">4f81285d-6c9a-46af-a72b-af1bcb736623</guid>
      <pubDate>Mon, 13 Feb 2023 00:00:00 +0800</pubDate>
    </item>
    <item>
      <title>GNU・Parallel使用例</title>
      <link>https://blog.izfsk.top/articles/GNU・Parallel使用例.html</link>
      <description>GNU・Parallel使用例</description>
      <content:encoded>&lt;body&gt;
&lt;progress id="content_progress" value="0"&gt;&lt;/progress&gt;
&lt;button id="back-to-top"&gt;
    回页顶
  &lt;/button&gt;
&lt;header&gt;
&lt;small id="article-uuid" style="display: none !important;"&gt;23d00329-9a40-41dc-96e4-673f89a6d1b6&lt;/small&gt;
&lt;h1 class="title"&gt;GNU・Parallel使用例&lt;/h1&gt;
&lt;!-- Subtitle --&gt;
&lt;h3 class="subtitle"&gt; &lt;/h3&gt;
&lt;/header&gt;
&lt;nav id="TOC" role="doc-toc"&gt;
&lt;strong&gt;文章归类: &lt;a href="/pages/category.html#整理"&gt;整理&lt;/a&gt; &lt;/strong&gt;
&lt;input id="contents" type="checkbox"/&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#替代-xargs--n1-使用" id="toc-替代-xargs--n1-使用"&gt;替代 &lt;code&gt;xargs -n1&lt;/code&gt; 使用&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#简单网络扫描器" id="toc-简单网络扫描器"&gt;简单网络扫描器&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#从命令行读取参数" id="toc-从命令行读取参数"&gt;从命令行读取参数&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#突破参数长度限制" id="toc-突破参数长度限制"&gt;突破参数长度限制&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#内容替换" id="toc-内容替换"&gt;内容替换&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#计算密集型作业" id="toc-计算密集型作业"&gt;计算密集型作业&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#替换和重定向" id="toc-替换和重定向"&gt;替换和重定向&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#多个命令组合" id="toc-多个命令组合"&gt;多个命令组合&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#多重来源数据替换" id="toc-多重来源数据替换"&gt;多重来源数据替换&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#移除参数中的特定字符串" id="toc-移除参数中的特定字符串"&gt;移除参数中的特定字符串&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#聚合文件内容" id="toc-聚合文件内容"&gt;聚合文件内容&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#更好的-for-和-while" id="toc-更好的-for-和-while"&gt;更好的 &lt;code&gt;for&lt;/code&gt; 和 &lt;code&gt;while&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#步进" id="toc-步进"&gt;步进&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#加速快速的任务" id="toc-加速快速的任务"&gt;加速快速的任务&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#远程运行" id="toc-远程运行"&gt;远程运行&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#reference"&gt;参考链接&lt;/a&gt;&lt;/li&gt;
&lt;li&gt; &lt;/li&gt;
&lt;li class="tools"&gt;
&lt;span id="backtomain"&gt;
&lt;svg class="bi bi-house" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M8.707 1.5a1 1 0 0 0-1.414 0L.646 8.146a.5.5 0 0 0 .708.708L2 8.207V13.5A1.5 1.5 0 0 0 3.5 15h9a1.5 1.5 0 0 0 1.5-1.5V8.207l.646.647a.5.5 0 0 0 .708-.708L13 5.793V2.5a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v1.293L8.707 1.5ZM13 7.207V13.5a.5.5 0 0 1-.5.5h-9a.5.5 0 0 1-.5-.5V7.207l5-5 5 5Z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="readingmode"&gt;
&lt;svg class="bi bi-book" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M1 2.828c.885-.37 2.154-.769 3.388-.893 1.33-.134 2.458.063 3.112.752v9.746c-.935-.53-2.12-.603-3.213-.493-1.18.12-2.37.461-3.287.811V2.828zm7.5-.141c.654-.689 1.782-.886 3.112-.752 1.234.124 2.503.523 3.388.893v9.923c-.918-.35-2.107-.692-3.287-.81-1.094-.111-2.278-.039-3.213.492V2.687zM8 1.783C7.015.936 5.587.81 4.287.94c-1.514.153-3.042.672-3.994 1.105A.5.5 0 0 0 0 2.5v11a.5.5 0 0 0 .707.455c.882-.4 2.303-.881 3.68-1.02 1.409-.142 2.59.087 3.223.877a.5.5 0 0 0 .78 0c.633-.79 1.814-1.019 3.222-.877 1.378.139 2.8.62 3.681 1.02A.5.5 0 0 0 16 13.5v-11a.5.5 0 0 0-.293-.455c-.952-.433-2.48-.952-3.994-1.105C10.413.809 8.985.936 8 1.783z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="larger"&gt; &lt;/span&gt;
&lt;span id="smaller"&gt;&lt;/span&gt;
&lt;span id="switchfont"&gt;
&lt;svg class="bi bi-fonts" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M12.258 3h-8.51l-.083 2.46h.479c.26-1.544.758-1.783 2.693-1.845l.424-.013v7.827c0 .663-.144.82-1.3.923v.52h4.082v-.52c-1.162-.103-1.306-.26-1.306-.923V3.602l.431.013c1.934.062 2.434.301 2.693 1.846h.479L12.258 3z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="backtotop"&gt;
&lt;svg class="bi bi-arrow-bar-up" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M8 10a.5.5 0 0 0 .5-.5V3.707l2.146 2.147a.5.5 0 0 0 .708-.708l-3-3a.5.5 0 0 0-.708 0l-3 3a.5.5 0 1 0 .708.708L7.5 3.707V9.5a.5.5 0 0 0 .5.5zm-7 2.5a.5.5 0 0 1 .5-.5h13a.5.5 0 0 1 0 1h-13a.5.5 0 0 1-.5-.5z" fill-rule="evenodd"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/nav&gt;
&lt;main&gt;
&lt;p&gt;当需要并行处理一堆东西的时候，有时候会考虑 &lt;a href="https://www.gnu.org/software/parallel/"&gt;GNU Parallel&lt;/a&gt;，但它真的很复杂，而且总的来讲比较混乱，最好的办法不是从头到尾学一遍，而是按照例子去操作。官方文档也考虑到了这个问题，提供了&lt;a href="https://www.gnu.org/software/parallel/parallel_examples.html"&gt;例子大全&lt;/a&gt;，本文是对这些例子的转译，顺便添加一些注解。&lt;strong&gt;注意，这里只保留了我认为有用的例子&lt;/strong&gt;，因为这样的工具实在不需要太过复杂的运用。&lt;/p&gt;
&lt;p&gt;首先写一个验证程序，显示 &lt;code&gt;parallel&lt;/code&gt; 到底是怎么给程序添加参数的：&lt;/p&gt;
&lt;div class="sourceCode" id="cb1"&gt;&lt;pre class="sourceCode c"&gt;&lt;code class="sourceCode c"&gt;&lt;span id="cb1-1"&gt;&lt;a aria-hidden="true" href="#cb1-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="pp"&gt;#include &lt;/span&gt;&lt;span class="im"&gt;&amp;lt;stdio.h&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-2"&gt;&lt;a aria-hidden="true" href="#cb1-2" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="pp"&gt;#include &lt;/span&gt;&lt;span class="im"&gt;&amp;lt;unistd.h&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-3"&gt;&lt;a aria-hidden="true" href="#cb1-3" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb1-4"&gt;&lt;a aria-hidden="true" href="#cb1-4" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="dt"&gt;int&lt;/span&gt; main&lt;span class="op"&gt;(&lt;/span&gt;&lt;span class="dt"&gt;int&lt;/span&gt; argc&lt;span class="op"&gt;,&lt;/span&gt; &lt;span class="dt"&gt;char&lt;/span&gt;&lt;span class="op"&gt;**&lt;/span&gt; argv&lt;span class="op"&gt;){&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-5"&gt;&lt;a aria-hidden="true" href="#cb1-5" tabindex="-1"&gt;&lt;/a&gt;    printf&lt;span class="op"&gt;(&lt;/span&gt;&lt;span class="st"&gt;"[&lt;/span&gt;&lt;span class="sc"&gt;%d&lt;/span&gt;&lt;span class="st"&gt;]Arguments: "&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt; getpid&lt;span class="op"&gt;());&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-6"&gt;&lt;a aria-hidden="true" href="#cb1-6" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="cf"&gt;for&lt;/span&gt; &lt;span class="op"&gt;(&lt;/span&gt;&lt;span class="dt"&gt;int&lt;/span&gt; i&lt;span class="op"&gt;=&lt;/span&gt;&lt;span class="dv"&gt;0&lt;/span&gt;&lt;span class="op"&gt;;&lt;/span&gt; i&lt;span class="op"&gt;!=&lt;/span&gt;argc&lt;span class="op"&gt;;&lt;/span&gt; i&lt;span class="op"&gt;++){&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-7"&gt;&lt;a aria-hidden="true" href="#cb1-7" tabindex="-1"&gt;&lt;/a&gt;        printf&lt;span class="op"&gt;(&lt;/span&gt;&lt;span class="st"&gt;" [&lt;/span&gt;&lt;span class="sc"&gt;%s&lt;/span&gt;&lt;span class="st"&gt;]"&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt; argv&lt;span class="op"&gt;[&lt;/span&gt;i&lt;span class="op"&gt;]);&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-8"&gt;&lt;a aria-hidden="true" href="#cb1-8" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="op"&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-9"&gt;&lt;a aria-hidden="true" href="#cb1-9" tabindex="-1"&gt;&lt;/a&gt;    printf&lt;span class="op"&gt;(&lt;/span&gt;&lt;span class="st"&gt;"&lt;/span&gt;&lt;span class="sc"&gt;\n&lt;/span&gt;&lt;span class="st"&gt;"&lt;/span&gt;&lt;span class="op"&gt;);&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-10"&gt;&lt;a aria-hidden="true" href="#cb1-10" tabindex="-1"&gt;&lt;/a&gt;    sleep&lt;span class="op"&gt;(&lt;/span&gt;&lt;span class="dv"&gt;1&lt;/span&gt;&lt;span class="op"&gt;);&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-11"&gt;&lt;a aria-hidden="true" href="#cb1-11" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="cf"&gt;return&lt;/span&gt; &lt;span class="dv"&gt;0&lt;/span&gt;&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-12"&gt;&lt;a aria-hidden="true" href="#cb1-12" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="op"&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id="替代-xargs--n1-使用"&gt;替代 &lt;code&gt;xargs -n1&lt;/code&gt; 使用&lt;/h2&gt;
&lt;p&gt;很简单，比如你有很多 html 文件要压缩：&lt;/p&gt;
&lt;p&gt;&lt;code&gt;find . -name '*.html' | parallel gzip --best&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;当然也可以&lt;/p&gt;
&lt;p&gt;&lt;code&gt;find . -name '*.html' | xargs -n1 gzip --best&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;区别就在 parallel 是并行的，使用 &lt;code&gt;xargs&lt;/code&gt;：&lt;/p&gt;
&lt;div class="sourceCode" id="cb2"&gt;&lt;pre class="sourceCode js"&gt;&lt;code class="sourceCode javascript"&gt;&lt;span id="cb2-1"&gt;&lt;a aria-hidden="true" href="#cb2-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="op"&gt;%&lt;/span&gt; time ls &lt;span class="op"&gt;|&lt;/span&gt; xargs &lt;span class="op"&gt;-&lt;/span&gt;n1 &lt;span class="op"&gt;./&lt;/span&gt;a&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="at"&gt;out&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-2"&gt;&lt;a aria-hidden="true" href="#cb2-2" tabindex="-1"&gt;&lt;/a&gt;[&lt;span class="dv"&gt;27602&lt;/span&gt;]Arguments&lt;span class="op"&gt;:&lt;/span&gt;  [&lt;span class="op"&gt;./&lt;/span&gt;a&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="at"&gt;out&lt;/span&gt;] [&lt;span class="dv"&gt;31&lt;/span&gt;]&lt;/span&gt;
&lt;span id="cb2-3"&gt;&lt;a aria-hidden="true" href="#cb2-3" tabindex="-1"&gt;&lt;/a&gt;[&lt;span class="dv"&gt;27607&lt;/span&gt;]Arguments&lt;span class="op"&gt;:&lt;/span&gt;  [&lt;span class="op"&gt;./&lt;/span&gt;a&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="at"&gt;out&lt;/span&gt;] [&lt;span class="dv"&gt;32&lt;/span&gt;]&lt;/span&gt;
&lt;span id="cb2-4"&gt;&lt;a aria-hidden="true" href="#cb2-4" tabindex="-1"&gt;&lt;/a&gt;[&lt;span class="dv"&gt;27608&lt;/span&gt;]Arguments&lt;span class="op"&gt;:&lt;/span&gt;  [&lt;span class="op"&gt;./&lt;/span&gt;a&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="at"&gt;out&lt;/span&gt;] [a&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="at"&gt;out&lt;/span&gt;]&lt;/span&gt;
&lt;span id="cb2-5"&gt;&lt;a aria-hidden="true" href="#cb2-5" tabindex="-1"&gt;&lt;/a&gt;[&lt;span class="dv"&gt;27611&lt;/span&gt;]Arguments&lt;span class="op"&gt;:&lt;/span&gt;  [&lt;span class="op"&gt;./&lt;/span&gt;a&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="at"&gt;out&lt;/span&gt;] [show&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="at"&gt;c&lt;/span&gt;]&lt;/span&gt;
&lt;span id="cb2-6"&gt;&lt;a aria-hidden="true" href="#cb2-6" tabindex="-1"&gt;&lt;/a&gt;ls &lt;span class="op"&gt;--&lt;/span&gt;color&lt;span class="op"&gt;=&lt;/span&gt;tty  &lt;span class="fl"&gt;0.00&lt;/span&gt;s user &lt;span class="fl"&gt;0.00&lt;/span&gt;s system &lt;span class="dv"&gt;73&lt;/span&gt;&lt;span class="op"&gt;%&lt;/span&gt; cpu &lt;span class="fl"&gt;0.002&lt;/span&gt; total&lt;/span&gt;
&lt;span id="cb2-7"&gt;&lt;a aria-hidden="true" href="#cb2-7" tabindex="-1"&gt;&lt;/a&gt;xargs &lt;span class="op"&gt;-&lt;/span&gt;n1 &lt;span class="op"&gt;./&lt;/span&gt;a&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="at"&gt;out&lt;/span&gt;  &lt;span class="fl"&gt;0.00&lt;/span&gt;s user &lt;span class="fl"&gt;0.00&lt;/span&gt;s system &lt;span class="dv"&gt;0&lt;/span&gt;&lt;span class="op"&gt;%&lt;/span&gt; cpu &lt;span class="fl"&gt;4.006&lt;/span&gt; total&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;而使用 &lt;code&gt;parallel&lt;/code&gt;：&lt;/p&gt;
&lt;div class="sourceCode" id="cb3"&gt;&lt;pre class="sourceCode js"&gt;&lt;code class="sourceCode javascript"&gt;&lt;span id="cb3-1"&gt;&lt;a aria-hidden="true" href="#cb3-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="op"&gt;%&lt;/span&gt; time ls &lt;span class="op"&gt;|&lt;/span&gt; parallel &lt;span class="op"&gt;./&lt;/span&gt;a&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="at"&gt;out&lt;/span&gt; &lt;/span&gt;
&lt;span id="cb3-2"&gt;&lt;a aria-hidden="true" href="#cb3-2" tabindex="-1"&gt;&lt;/a&gt;[&lt;span class="dv"&gt;27945&lt;/span&gt;]Arguments&lt;span class="op"&gt;:&lt;/span&gt;  [&lt;span class="op"&gt;./&lt;/span&gt;a&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="at"&gt;out&lt;/span&gt;] [&lt;span class="dv"&gt;31&lt;/span&gt;]&lt;/span&gt;
&lt;span id="cb3-3"&gt;&lt;a aria-hidden="true" href="#cb3-3" tabindex="-1"&gt;&lt;/a&gt;[&lt;span class="dv"&gt;27946&lt;/span&gt;]Arguments&lt;span class="op"&gt;:&lt;/span&gt;  [&lt;span class="op"&gt;./&lt;/span&gt;a&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="at"&gt;out&lt;/span&gt;] [&lt;span class="dv"&gt;32&lt;/span&gt;]&lt;/span&gt;
&lt;span id="cb3-4"&gt;&lt;a aria-hidden="true" href="#cb3-4" tabindex="-1"&gt;&lt;/a&gt;[&lt;span class="dv"&gt;27947&lt;/span&gt;]Arguments&lt;span class="op"&gt;:&lt;/span&gt;  [&lt;span class="op"&gt;./&lt;/span&gt;a&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="at"&gt;out&lt;/span&gt;] [a&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="at"&gt;out&lt;/span&gt;]&lt;/span&gt;
&lt;span id="cb3-5"&gt;&lt;a aria-hidden="true" href="#cb3-5" tabindex="-1"&gt;&lt;/a&gt;[&lt;span class="dv"&gt;27948&lt;/span&gt;]Arguments&lt;span class="op"&gt;:&lt;/span&gt;  [&lt;span class="op"&gt;./&lt;/span&gt;a&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="at"&gt;out&lt;/span&gt;] [show&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="at"&gt;c&lt;/span&gt;]&lt;/span&gt;
&lt;span id="cb3-6"&gt;&lt;a aria-hidden="true" href="#cb3-6" tabindex="-1"&gt;&lt;/a&gt;ls &lt;span class="op"&gt;--&lt;/span&gt;color&lt;span class="op"&gt;=&lt;/span&gt;tty  &lt;span class="fl"&gt;0.00&lt;/span&gt;s user &lt;span class="fl"&gt;0.00&lt;/span&gt;s system &lt;span class="dv"&gt;61&lt;/span&gt;&lt;span class="op"&gt;%&lt;/span&gt; cpu &lt;span class="fl"&gt;0.001&lt;/span&gt; total&lt;/span&gt;
&lt;span id="cb3-7"&gt;&lt;a aria-hidden="true" href="#cb3-7" tabindex="-1"&gt;&lt;/a&gt;parallel &lt;span class="op"&gt;./&lt;/span&gt;a&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="at"&gt;out&lt;/span&gt;  &lt;span class="fl"&gt;0.08&lt;/span&gt;s user &lt;span class="fl"&gt;0.03&lt;/span&gt;s system &lt;span class="dv"&gt;9&lt;/span&gt;&lt;span class="op"&gt;%&lt;/span&gt; cpu &lt;span class="fl"&gt;1.076&lt;/span&gt; total&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;可以看到 &lt;code&gt;parallel&lt;/code&gt; &lt;strong&gt;同时运行&lt;/strong&gt; 四个程序，只花了一秒。这也是为什么要用 &lt;code&gt;parallel&lt;/code&gt; 的原因。所以，同样的，如果碰到视频转码之类的耗费时间的任务，使用 &lt;code&gt;parallel&lt;/code&gt; 能加快速度不少。&lt;/p&gt;
&lt;h2 id="简单网络扫描器"&gt;简单网络扫描器&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;prips 130.229.16.0/20 | parallel --timeout 2 -j0 'ping -c 1 {} &amp;gt;/dev/null &amp;amp;&amp;amp; echo {}' 2&amp;gt;/dev/null&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;由此可以过滤出返回数据的目标。在这个例子里面，一是要注意换行符号用来分割参数，二是注意使用 &lt;code&gt;{}&lt;/code&gt; 来包含每一次的参数。另外 &lt;code&gt;-j&lt;/code&gt; 参数用来控制每一批的操作数量。&lt;/p&gt;
&lt;h2 id="从命令行读取参数"&gt;从命令行读取参数&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;parallel&lt;/code&gt; 可以从命令行读取参数，而不是一定要找 &lt;code&gt;stdin&lt;/code&gt;。例如第一个例子也可以写成：&lt;/p&gt;
&lt;p&gt;&lt;code&gt;parallel gzip --best ::: *.html&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;但是只能压缩目前级别的文件。命令行参数同样可以使用 &lt;code&gt;{}&lt;/code&gt;，例如使用 &lt;code&gt;ffmpeg&lt;/code&gt; 转码：&lt;/p&gt;
&lt;p&gt;&lt;code&gt;parallel ffmpeg -i {} -o {.}.mp3 ::: *.wav&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;在这里，&lt;code&gt;{.}&lt;/code&gt; 是「取点号之前的字符串」，而 &lt;code&gt;:::&lt;/code&gt; 则是分割。&lt;/p&gt;
&lt;div class="sourceCode" id="cb4"&gt;&lt;pre class="sourceCode js"&gt;&lt;code class="sourceCode javascript"&gt;&lt;span id="cb4-1"&gt;&lt;a aria-hidden="true" href="#cb4-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="op"&gt;%&lt;/span&gt; ls&lt;/span&gt;
&lt;span id="cb4-2"&gt;&lt;a aria-hidden="true" href="#cb4-2" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="dv"&gt;31&lt;/span&gt;   &lt;span class="dv"&gt;32&lt;/span&gt;   a&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="at"&gt;out&lt;/span&gt;  &lt;span class="st"&gt;'Hello world'&lt;/span&gt;   show&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="at"&gt;c&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb4-3"&gt;&lt;a aria-hidden="true" href="#cb4-3" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb4-4"&gt;&lt;a aria-hidden="true" href="#cb4-4" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="op"&gt;%&lt;/span&gt; parallel &lt;span class="op"&gt;./&lt;/span&gt;a&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="at"&gt;out&lt;/span&gt; {} {&lt;span class="op"&gt;.&lt;/span&gt;} &lt;span class="op"&gt;:::&lt;/span&gt; &lt;span class="op"&gt;*&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb4-5"&gt;&lt;a aria-hidden="true" href="#cb4-5" tabindex="-1"&gt;&lt;/a&gt;[&lt;span class="dv"&gt;4619&lt;/span&gt;]Arguments&lt;span class="op"&gt;:&lt;/span&gt;  [&lt;span class="op"&gt;./&lt;/span&gt;a&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="at"&gt;out&lt;/span&gt;] [&lt;span class="dv"&gt;31&lt;/span&gt;] [&lt;span class="dv"&gt;31&lt;/span&gt;]&lt;/span&gt;
&lt;span id="cb4-6"&gt;&lt;a aria-hidden="true" href="#cb4-6" tabindex="-1"&gt;&lt;/a&gt;[&lt;span class="dv"&gt;4620&lt;/span&gt;]Arguments&lt;span class="op"&gt;:&lt;/span&gt;  [&lt;span class="op"&gt;./&lt;/span&gt;a&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="at"&gt;out&lt;/span&gt;] [&lt;span class="dv"&gt;32&lt;/span&gt;] [&lt;span class="dv"&gt;32&lt;/span&gt;]&lt;/span&gt;
&lt;span id="cb4-7"&gt;&lt;a aria-hidden="true" href="#cb4-7" tabindex="-1"&gt;&lt;/a&gt;[&lt;span class="dv"&gt;4621&lt;/span&gt;]Arguments&lt;span class="op"&gt;:&lt;/span&gt;  [&lt;span class="op"&gt;./&lt;/span&gt;a&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="at"&gt;out&lt;/span&gt;] [a&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="at"&gt;out&lt;/span&gt;] [a]&lt;/span&gt;
&lt;span id="cb4-8"&gt;&lt;a aria-hidden="true" href="#cb4-8" tabindex="-1"&gt;&lt;/a&gt;[&lt;span class="dv"&gt;4622&lt;/span&gt;]Arguments&lt;span class="op"&gt;:&lt;/span&gt;  [&lt;span class="op"&gt;./&lt;/span&gt;a&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="at"&gt;out&lt;/span&gt;] [Hello world] [Hello world]&lt;/span&gt;
&lt;span id="cb4-9"&gt;&lt;a aria-hidden="true" href="#cb4-9" tabindex="-1"&gt;&lt;/a&gt;[&lt;span class="dv"&gt;4623&lt;/span&gt;]Arguments&lt;span class="op"&gt;:&lt;/span&gt;  [&lt;span class="op"&gt;./&lt;/span&gt;a&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="at"&gt;out&lt;/span&gt;] [show&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="at"&gt;c&lt;/span&gt;] [show]&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id="突破参数长度限制"&gt;突破参数长度限制&lt;/h2&gt;
&lt;p&gt;有时候你会碰见这样的问题：&lt;/p&gt;
&lt;div class="sourceCode" id="cb5"&gt;&lt;pre class="sourceCode js"&gt;&lt;code class="sourceCode javascript"&gt;&lt;span id="cb5-1"&gt;&lt;a aria-hidden="true" href="#cb5-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="op"&gt;%&lt;/span&gt; &lt;span class="op"&gt;./&lt;/span&gt;a&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;out&lt;/span&gt; &lt;span class="vs"&gt;`find ~`&lt;/span&gt;     &lt;/span&gt;
&lt;span id="cb5-2"&gt;&lt;a aria-hidden="true" href="#cb5-2" tabindex="-1"&gt;&lt;/a&gt;zsh&lt;span class="op"&gt;:&lt;/span&gt; argument list too long&lt;span class="op"&gt;:&lt;/span&gt; &lt;span class="op"&gt;./&lt;/span&gt;a&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="at"&gt;out&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;这是因为文件太多了，超出参数长度限制。 传统的方法是使用 &lt;code&gt;xargs&lt;/code&gt;，但也可以使用 &lt;code&gt;parallel&lt;/code&gt;：&lt;/p&gt;
&lt;p&gt;&lt;code&gt;find ~ | parallel ./a.out {}&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;这会给&lt;strong&gt;每一个操作&lt;/strong&gt;单独开一个程序。你可以把每一个的参数加到允许的最大范围来加速操作：&lt;/p&gt;
&lt;p&gt;&lt;code&gt;find ~ | parallel -m ./a.out {}&lt;/code&gt;&lt;/p&gt;
&lt;h2 id="内容替换"&gt;内容替换&lt;/h2&gt;
&lt;p&gt;使用&lt;/p&gt;
&lt;p&gt;&lt;code&gt;seq -w 0 9999 | parallel rm pict{}.jpg&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;或者&lt;/p&gt;
&lt;p&gt;&lt;code&gt;seq -w 0 9999 | perl -pe 's/(.*)/pict$1.jpg/' | parallel -m rm&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;来删除 pict0000.jpg 到 pict9999.jpg。第一个版本允许 &lt;code&gt;rm&lt;/code&gt; 10000 次，第二个给每一个允许的 &lt;code&gt;rm&lt;/code&gt; 添加刚好不至于突破参数长度限制的参数，更加快速，也可以这样做：&lt;/p&gt;
&lt;p&gt;&lt;code&gt;seq -w 0 9999 | parallel -X rm pict{}.jpg&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;-X&lt;/code&gt; 的作用是，如果多个作业并行运行，则将参数平均分配给作业。&lt;/p&gt;
&lt;h2 id="计算密集型作业"&gt;计算密集型作业&lt;/h2&gt;
&lt;p&gt;你可以使用 &lt;code&gt;ImageMagick&lt;/code&gt; 来给图片制作缩略图：&lt;/p&gt;
&lt;p&gt;&lt;code&gt;convert -geometry 120 foo.jpg thumb_foo.jpg&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;这个版本则能够充分利用你的 CPU：&lt;/p&gt;
&lt;p&gt;&lt;code&gt;ls *.jpg | parallel convert -geometry 120 {} thumb_{}&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;也可以递归的来处理所有的文件：&lt;/p&gt;
&lt;p&gt;&lt;code&gt;find . -name '*.jpg' | parallel convert -geometry 120 {} {}_thumb.jpg&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;如上所述，使用 &lt;code&gt;{.}&lt;/code&gt; 来获取文件名，所以如果你想要 &lt;em&gt;./foo/bar_thumb.jpg&lt;/em&gt; 的文件名，这样做：&lt;/p&gt;
&lt;p&gt;&lt;code&gt;find . -name '*.jpg' | parallel convert -geometry 120 {} {.}_thumb.jpg&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;将所有 &lt;code&gt;wav&lt;/code&gt; 变成 &lt;code&gt;mp3&lt;/code&gt;，并放到同一个目录：&lt;/p&gt;
&lt;p&gt;&lt;code&gt;find sounddir -type f -name '*.wav' | parallel lame {} -o mydir/{/.}.mp3&lt;/code&gt;&lt;/p&gt;
&lt;h2 id="替换和重定向"&gt;替换和重定向&lt;/h2&gt;
&lt;p&gt;你有很多 &lt;code&gt;.gz&lt;/code&gt; 文件，你想要获得未压缩版本。你可以这样：&lt;/p&gt;
&lt;pre class="shell"&gt;&lt;code&gt;for file in ./*.gz;do
    zcat $file &amp;gt; "${file%.*}"
done&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;使用 &lt;code&gt;parallel&lt;/code&gt; 的版本如下：&lt;/p&gt;
&lt;p&gt;&lt;code&gt;parallel zcat {} "&amp;gt;"{.} ::: *.gz&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;你需要把 &lt;code&gt;&amp;gt;&lt;/code&gt; 用引号包围。否则这样做：&lt;/p&gt;
&lt;p&gt;&lt;code&gt;parallel "zcat {} &amp;gt;{.}" ::: *.gz&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;其他特殊符号也许要使用引号包围。例如：&lt;code&gt;* ; $ &amp;gt; &amp;lt; | &amp;gt;&amp;gt; &amp;lt;&amp;lt;&lt;/code&gt;，否则它们会被 shell 解释，而不是传递给 &lt;code&gt;parallel&lt;/code&gt;。&lt;/p&gt;
&lt;h2 id="多个命令组合"&gt;多个命令组合&lt;/h2&gt;
&lt;p&gt;一个作业可以包含若干条命令，它们之间使用 &lt;code&gt;;&lt;/code&gt; 分割：&lt;/p&gt;
&lt;p&gt;&lt;code&gt;ls | parallel 'echo {} ; ls {} '&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;甚至可以输入一个小脚本：&lt;/p&gt;
&lt;div class="sourceCode" id="cb7"&gt;&lt;pre class="sourceCode haskell"&gt;&lt;code class="sourceCode haskell"&gt;&lt;span id="cb7-1"&gt;&lt;a aria-hidden="true" href="#cb7-1" tabindex="-1"&gt;&lt;/a&gt;find &lt;span class="op"&gt;.&lt;/span&gt; &lt;span class="op"&gt;|&lt;/span&gt; parallel 'a&lt;span class="ot"&gt;=&lt;/span&gt;{}; name&lt;span class="op"&gt;=$&lt;/span&gt;{a&lt;span class="op"&gt;##*/&lt;/span&gt;};' \&lt;/span&gt;
&lt;span id="cb7-2"&gt;&lt;a aria-hidden="true" href="#cb7-2" tabindex="-1"&gt;&lt;/a&gt;  'upper&lt;span class="op"&gt;=$&lt;/span&gt;(echo &lt;span class="st"&gt;"$name"&lt;/span&gt; &lt;span class="op"&gt;|&lt;/span&gt; tr &lt;span class="st"&gt;"[:lower:]"&lt;/span&gt; &lt;span class="st"&gt;"[:upper:]"&lt;/span&gt;);'\&lt;/span&gt;
&lt;span id="cb7-3"&gt;&lt;a aria-hidden="true" href="#cb7-3" tabindex="-1"&gt;&lt;/a&gt;  'echo &lt;span class="st"&gt;"$name - $upper"&lt;/span&gt;'&lt;/span&gt;
&lt;span id="cb7-4"&gt;&lt;a aria-hidden="true" href="#cb7-4" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb7-5"&gt;&lt;a aria-hidden="true" href="#cb7-5" tabindex="-1"&gt;&lt;/a&gt;ls &lt;span class="op"&gt;|&lt;/span&gt; parallel 'mv {} &lt;span class="st"&gt;"$(echo {} | tr "&lt;/span&gt;[&lt;span class="op"&gt;:&lt;/span&gt;upper&lt;span class="op"&gt;:&lt;/span&gt;]&lt;span class="st"&gt;" "&lt;/span&gt;[&lt;span class="op"&gt;:&lt;/span&gt;lower&lt;span class="op"&gt;:&lt;/span&gt;]&lt;span class="st"&gt;")"&lt;/span&gt;'&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;批量下载不是问题。以下命令会打印出下载错误的 url 和行号：&lt;/p&gt;
&lt;p&gt;&lt;code&gt;cat urlfile | parallel "wget {} 2&amp;gt;/dev/null || grep -n {} urlfile"&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;创建一个具有相同文件名的镜像目录，除了所有文件和符号链接都是空文件。&lt;/p&gt;
&lt;p&gt;&lt;code&gt;cp -rs /the/source/dir mirror_dir &amp;amp;&amp;amp; find mirror_dir -type l | parallel -m rm {} '&amp;amp;&amp;amp;' touch {}&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;在文件列表中过滤出不存在的文件：&lt;/p&gt;
&lt;p&gt;&lt;code&gt;cat file_list | parallel 'if [ ! -e {} ] ; then echo {}; fi'&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;很长的操作可以写成 shell 函数调用，不要忘记 export -f：&lt;/p&gt;
&lt;div class="sourceCode" id="cb8"&gt;&lt;pre class="sourceCode js"&gt;&lt;code class="sourceCode javascript"&gt;&lt;span id="cb8-1"&gt;&lt;a aria-hidden="true" href="#cb8-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="fu"&gt;doit&lt;/span&gt;() {&lt;/span&gt;
&lt;span id="cb8-2"&gt;&lt;a aria-hidden="true" href="#cb8-2" tabindex="-1"&gt;&lt;/a&gt;  echo Doing it &lt;span class="cf"&gt;for&lt;/span&gt; $1&lt;/span&gt;
&lt;span id="cb8-3"&gt;&lt;a aria-hidden="true" href="#cb8-3" tabindex="-1"&gt;&lt;/a&gt;  sleep &lt;span class="dv"&gt;2&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb8-4"&gt;&lt;a aria-hidden="true" href="#cb8-4" tabindex="-1"&gt;&lt;/a&gt;  echo Done &lt;span class="cf"&gt;with&lt;/span&gt; $1&lt;/span&gt;
&lt;span id="cb8-5"&gt;&lt;a aria-hidden="true" href="#cb8-5" tabindex="-1"&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id="cb8-6"&gt;&lt;a aria-hidden="true" href="#cb8-6" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="im"&gt;export&lt;/span&gt; &lt;span class="op"&gt;-&lt;/span&gt;f doit&lt;/span&gt;
&lt;span id="cb8-7"&gt;&lt;a aria-hidden="true" href="#cb8-7" tabindex="-1"&gt;&lt;/a&gt;parallel doit &lt;span class="op"&gt;:::&lt;/span&gt; &lt;span class="dv"&gt;1&lt;/span&gt; &lt;span class="dv"&gt;2&lt;/span&gt; &lt;span class="dv"&gt;3&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id="多重来源数据替换"&gt;多重来源数据替换&lt;/h2&gt;
&lt;p&gt;举例：&lt;/p&gt;
&lt;div class="sourceCode" id="cb9"&gt;&lt;pre class="sourceCode python"&gt;&lt;code class="sourceCode python"&gt;&lt;span id="cb9-1"&gt;&lt;a aria-hidden="true" href="#cb9-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="op"&gt;%&lt;/span&gt; parallel &lt;span class="st"&gt;"./a.out &lt;/span&gt;&lt;span class="sc"&gt;{1}&lt;/span&gt;&lt;span class="st"&gt; &lt;/span&gt;&lt;span class="sc"&gt;{2}&lt;/span&gt;&lt;span class="st"&gt;"&lt;/span&gt; ::: {a..c} ::: {&lt;span class="fl"&gt;0..3&lt;/span&gt;}   &lt;/span&gt;
&lt;span id="cb9-2"&gt;&lt;a aria-hidden="true" href="#cb9-2" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="co"&gt;# Same as `parallel "./a.out {1} {2}" ::: {a..c} ::: 0 1 2 3`&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb9-3"&gt;&lt;a aria-hidden="true" href="#cb9-3" tabindex="-1"&gt;&lt;/a&gt;[&lt;span class="dv"&gt;15696&lt;/span&gt;]Arguments:  [.&lt;span class="op"&gt;/&lt;/span&gt;a.out] [a] [&lt;span class="dv"&gt;0&lt;/span&gt;]&lt;/span&gt;
&lt;span id="cb9-4"&gt;&lt;a aria-hidden="true" href="#cb9-4" tabindex="-1"&gt;&lt;/a&gt;[&lt;span class="dv"&gt;15697&lt;/span&gt;]Arguments:  [.&lt;span class="op"&gt;/&lt;/span&gt;a.out] [a] [&lt;span class="dv"&gt;1&lt;/span&gt;]&lt;/span&gt;
&lt;span id="cb9-5"&gt;&lt;a aria-hidden="true" href="#cb9-5" tabindex="-1"&gt;&lt;/a&gt;[&lt;span class="dv"&gt;15699&lt;/span&gt;]Arguments:  [.&lt;span class="op"&gt;/&lt;/span&gt;a.out] [a] [&lt;span class="dv"&gt;2&lt;/span&gt;]&lt;/span&gt;
&lt;span id="cb9-6"&gt;&lt;a aria-hidden="true" href="#cb9-6" tabindex="-1"&gt;&lt;/a&gt;[&lt;span class="dv"&gt;15700&lt;/span&gt;]Arguments:  [.&lt;span class="op"&gt;/&lt;/span&gt;a.out] [a] [&lt;span class="dv"&gt;3&lt;/span&gt;]&lt;/span&gt;
&lt;span id="cb9-7"&gt;&lt;a aria-hidden="true" href="#cb9-7" tabindex="-1"&gt;&lt;/a&gt;[&lt;span class="dv"&gt;15701&lt;/span&gt;]Arguments:  [.&lt;span class="op"&gt;/&lt;/span&gt;a.out] [b] [&lt;span class="dv"&gt;0&lt;/span&gt;]&lt;/span&gt;
&lt;span id="cb9-8"&gt;&lt;a aria-hidden="true" href="#cb9-8" tabindex="-1"&gt;&lt;/a&gt;[&lt;span class="dv"&gt;15702&lt;/span&gt;]Arguments:  [.&lt;span class="op"&gt;/&lt;/span&gt;a.out] [b] [&lt;span class="dv"&gt;1&lt;/span&gt;]&lt;/span&gt;
&lt;span id="cb9-9"&gt;&lt;a aria-hidden="true" href="#cb9-9" tabindex="-1"&gt;&lt;/a&gt;[&lt;span class="dv"&gt;15703&lt;/span&gt;]Arguments:  [.&lt;span class="op"&gt;/&lt;/span&gt;a.out] [b] [&lt;span class="dv"&gt;2&lt;/span&gt;]&lt;/span&gt;
&lt;span id="cb9-10"&gt;&lt;a aria-hidden="true" href="#cb9-10" tabindex="-1"&gt;&lt;/a&gt;[&lt;span class="dv"&gt;15704&lt;/span&gt;]Arguments:  [.&lt;span class="op"&gt;/&lt;/span&gt;a.out] [b] [&lt;span class="dv"&gt;3&lt;/span&gt;]&lt;/span&gt;
&lt;span id="cb9-11"&gt;&lt;a aria-hidden="true" href="#cb9-11" tabindex="-1"&gt;&lt;/a&gt;[&lt;span class="dv"&gt;15705&lt;/span&gt;]Arguments:  [.&lt;span class="op"&gt;/&lt;/span&gt;a.out] [c] [&lt;span class="dv"&gt;0&lt;/span&gt;]&lt;/span&gt;
&lt;span id="cb9-12"&gt;&lt;a aria-hidden="true" href="#cb9-12" tabindex="-1"&gt;&lt;/a&gt;[&lt;span class="dv"&gt;15706&lt;/span&gt;]Arguments:  [.&lt;span class="op"&gt;/&lt;/span&gt;a.out] [c] [&lt;span class="dv"&gt;1&lt;/span&gt;]&lt;/span&gt;
&lt;span id="cb9-13"&gt;&lt;a aria-hidden="true" href="#cb9-13" tabindex="-1"&gt;&lt;/a&gt;[&lt;span class="dv"&gt;15707&lt;/span&gt;]Arguments:  [.&lt;span class="op"&gt;/&lt;/span&gt;a.out] [c] [&lt;span class="dv"&gt;2&lt;/span&gt;]&lt;/span&gt;
&lt;span id="cb9-14"&gt;&lt;a aria-hidden="true" href="#cb9-14" tabindex="-1"&gt;&lt;/a&gt;[&lt;span class="dv"&gt;15708&lt;/span&gt;]Arguments:  [.&lt;span class="op"&gt;/&lt;/span&gt;a.out] [c] [&lt;span class="dv"&gt;3&lt;/span&gt;]&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;可以看到它的替换效果类似于笛卡尔积。&lt;/p&gt;
&lt;h2 id="移除参数中的特定字符串"&gt;移除参数中的特定字符串&lt;/h2&gt;
&lt;p&gt;如果只有一个后缀名，例如 &lt;code&gt;a.mp4&lt;/code&gt; 可以使用 &lt;code&gt;{.}&lt;/code&gt;，同样地，对于诸如 &lt;code&gt;a.tar.gz&lt;/code&gt; 可以使用 &lt;code&gt;{..}&lt;/code&gt;，&lt;strong&gt;切记要加上 &lt;code&gt;--plus&lt;/code&gt; 参数&lt;/strong&gt;。&lt;/p&gt;
&lt;p&gt;举例：&lt;/p&gt;
&lt;div class="sourceCode" id="cb10"&gt;&lt;pre class="sourceCode python"&gt;&lt;code class="sourceCode python"&gt;&lt;span id="cb10-1"&gt;&lt;a aria-hidden="true" href="#cb10-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="op"&gt;%&lt;/span&gt; ls&lt;/span&gt;
&lt;span id="cb10-2"&gt;&lt;a aria-hidden="true" href="#cb10-2" tabindex="-1"&gt;&lt;/a&gt;a.tar.gz   b.tar.gz   c.tar.gz   d.tar.gz   e.tar.gz&lt;/span&gt;
&lt;span id="cb10-3"&gt;&lt;a aria-hidden="true" href="#cb10-3" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb10-4"&gt;&lt;a aria-hidden="true" href="#cb10-4" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="op"&gt;%&lt;/span&gt; parallel &lt;span class="op"&gt;--&lt;/span&gt;plus &lt;span class="st"&gt;'./a.out {..}'&lt;/span&gt; ::: &lt;span class="op"&gt;*&lt;/span&gt;.tar.gz&lt;/span&gt;
&lt;span id="cb10-5"&gt;&lt;a aria-hidden="true" href="#cb10-5" tabindex="-1"&gt;&lt;/a&gt;[&lt;span class="dv"&gt;27784&lt;/span&gt;]Arguments:  [.&lt;span class="op"&gt;/&lt;/span&gt;a.out] [a]&lt;/span&gt;
&lt;span id="cb10-6"&gt;&lt;a aria-hidden="true" href="#cb10-6" tabindex="-1"&gt;&lt;/a&gt;[&lt;span class="dv"&gt;27785&lt;/span&gt;]Arguments:  [.&lt;span class="op"&gt;/&lt;/span&gt;a.out] [b]&lt;/span&gt;
&lt;span id="cb10-7"&gt;&lt;a aria-hidden="true" href="#cb10-7" tabindex="-1"&gt;&lt;/a&gt;[&lt;span class="dv"&gt;27786&lt;/span&gt;]Arguments:  [.&lt;span class="op"&gt;/&lt;/span&gt;a.out] [c]&lt;/span&gt;
&lt;span id="cb10-8"&gt;&lt;a aria-hidden="true" href="#cb10-8" tabindex="-1"&gt;&lt;/a&gt;[&lt;span class="dv"&gt;27787&lt;/span&gt;]Arguments:  [.&lt;span class="op"&gt;/&lt;/span&gt;a.out] [d]&lt;/span&gt;
&lt;span id="cb10-9"&gt;&lt;a aria-hidden="true" href="#cb10-9" tabindex="-1"&gt;&lt;/a&gt;[&lt;span class="dv"&gt;27788&lt;/span&gt;]Arguments:  [.&lt;span class="op"&gt;/&lt;/span&gt;a.out] [e]&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;同样地，对于更多的 &lt;code&gt;.&lt;/code&gt; 也可以处理：&lt;/p&gt;
&lt;div class="sourceCode" id="cb11"&gt;&lt;pre class="sourceCode perl"&gt;&lt;code class="sourceCode perl"&gt;&lt;span id="cb11-1"&gt;&lt;a aria-hidden="true" href="#cb11-1" tabindex="-1"&gt;&lt;/a&gt;% ls&lt;/span&gt;
&lt;span id="cb11-2"&gt;&lt;a aria-hidden="true" href="#cb11-2" tabindex="-1"&gt;&lt;/a&gt;a.src.tar.xz   b.src.tar.xz   c.src.tar.xz   d.src.tar.xz   e.src.tar.xz &lt;/span&gt;
&lt;span id="cb11-3"&gt;&lt;a aria-hidden="true" href="#cb11-3" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb11-4"&gt;&lt;a aria-hidden="true" href="#cb11-4" tabindex="-1"&gt;&lt;/a&gt;% parallel -&lt;span class="ot"&gt;-p&lt;/span&gt;lus &lt;span class="ot"&gt;'&lt;/span&gt;&lt;span class="ss"&gt;./a.out {...}&lt;/span&gt;&lt;span class="ot"&gt;'&lt;/span&gt; ::: &lt;span class="wa"&gt;*.&lt;/span&gt;src.tar.xz&lt;/span&gt;
&lt;span id="cb11-5"&gt;&lt;a aria-hidden="true" href="#cb11-5" tabindex="-1"&gt;&lt;/a&gt;[&lt;span class="dv"&gt;28960&lt;/span&gt;]Arguments:  [.&lt;span class="ot"&gt;/a.out] &lt;/span&gt;&lt;span class="ch"&gt;[&lt;/span&gt;&lt;span class="bn"&gt;a&lt;/span&gt;&lt;span class="ch"&gt;]&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb11-6"&gt;&lt;a aria-hidden="true" href="#cb11-6" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="ch"&gt;[&lt;/span&gt;&lt;span class="bn"&gt;28961&lt;/span&gt;&lt;span class="ch"&gt;]&lt;/span&gt;&lt;span class="ot"&gt;Arguments:  &lt;/span&gt;&lt;span class="ch"&gt;[&lt;/span&gt;&lt;span class="bn"&gt;./a.out&lt;/span&gt;&lt;span class="ch"&gt;]&lt;/span&gt;&lt;span class="ot"&gt; &lt;/span&gt;&lt;span class="ch"&gt;[&lt;/span&gt;&lt;span class="bn"&gt;b&lt;/span&gt;&lt;span class="ch"&gt;]&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb11-7"&gt;&lt;a aria-hidden="true" href="#cb11-7" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="ch"&gt;[&lt;/span&gt;&lt;span class="bn"&gt;28962&lt;/span&gt;&lt;span class="ch"&gt;]&lt;/span&gt;&lt;span class="ot"&gt;Arguments:  &lt;/span&gt;&lt;span class="ch"&gt;[&lt;/span&gt;&lt;span class="bn"&gt;./a.out&lt;/span&gt;&lt;span class="ch"&gt;]&lt;/span&gt;&lt;span class="ot"&gt; &lt;/span&gt;&lt;span class="ch"&gt;[&lt;/span&gt;&lt;span class="bn"&gt;c&lt;/span&gt;&lt;span class="ch"&gt;]&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb11-8"&gt;&lt;a aria-hidden="true" href="#cb11-8" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="ch"&gt;[&lt;/span&gt;&lt;span class="bn"&gt;28963&lt;/span&gt;&lt;span class="ch"&gt;]&lt;/span&gt;&lt;span class="ot"&gt;Arguments:  &lt;/span&gt;&lt;span class="ch"&gt;[&lt;/span&gt;&lt;span class="bn"&gt;./a.out&lt;/span&gt;&lt;span class="ch"&gt;]&lt;/span&gt;&lt;span class="ot"&gt; &lt;/span&gt;&lt;span class="ch"&gt;[&lt;/span&gt;&lt;span class="bn"&gt;d&lt;/span&gt;&lt;span class="ch"&gt;]&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb11-9"&gt;&lt;a aria-hidden="true" href="#cb11-9" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="ch"&gt;[&lt;/span&gt;&lt;span class="bn"&gt;28964&lt;/span&gt;&lt;span class="ch"&gt;]&lt;/span&gt;&lt;span class="ot"&gt;Arguments:  &lt;/span&gt;&lt;span class="ch"&gt;[&lt;/span&gt;&lt;span class="bn"&gt;./a.out&lt;/span&gt;&lt;span class="ch"&gt;]&lt;/span&gt;&lt;span class="ot"&gt; &lt;/span&gt;&lt;span class="ch"&gt;[&lt;/span&gt;&lt;span class="bn"&gt;e&lt;/span&gt;&lt;span class="ch"&gt;]&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;对于任意字符串的替换使用 &lt;code&gt;%&lt;/code&gt; （后缀）&lt;code&gt;#&lt;/code&gt; （前缀）和 &lt;code&gt;/&lt;/code&gt; 正则表达式：&lt;/p&gt;
&lt;div class="sourceCode" id="cb12"&gt;&lt;pre class="sourceCode perl"&gt;&lt;code class="sourceCode perl"&gt;&lt;span id="cb12-1"&gt;&lt;a aria-hidden="true" href="#cb12-1" tabindex="-1"&gt;&lt;/a&gt;% ls&lt;/span&gt;
&lt;span id="cb12-2"&gt;&lt;a aria-hidden="true" href="#cb12-2" tabindex="-1"&gt;&lt;/a&gt;aHello  bHello  cHello  dHello  eHello&lt;/span&gt;
&lt;span id="cb12-3"&gt;&lt;a aria-hidden="true" href="#cb12-3" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb12-4"&gt;&lt;a aria-hidden="true" href="#cb12-4" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb12-5"&gt;&lt;a aria-hidden="true" href="#cb12-5" tabindex="-1"&gt;&lt;/a&gt;% parallel -&lt;span class="ot"&gt;-p&lt;/span&gt;lus &lt;span class="ot"&gt;'&lt;/span&gt;&lt;span class="ss"&gt;../a.out {/ello/}&lt;/span&gt;&lt;span class="ot"&gt;'&lt;/span&gt; ::: *&lt;/span&gt;
&lt;span id="cb12-6"&gt;&lt;a aria-hidden="true" href="#cb12-6" tabindex="-1"&gt;&lt;/a&gt;[&lt;span class="dv"&gt;29835&lt;/span&gt;]Arguments:  [..&lt;span class="ot"&gt;/a.out] &lt;/span&gt;&lt;span class="ch"&gt;[&lt;/span&gt;&lt;span class="bn"&gt;aH&lt;/span&gt;&lt;span class="ch"&gt;]&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb12-7"&gt;&lt;a aria-hidden="true" href="#cb12-7" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="ch"&gt;[&lt;/span&gt;&lt;span class="bn"&gt;29836&lt;/span&gt;&lt;span class="ch"&gt;]&lt;/span&gt;&lt;span class="ot"&gt;Arguments:  &lt;/span&gt;&lt;span class="ch"&gt;[&lt;/span&gt;&lt;span class="bn"&gt;../a.out&lt;/span&gt;&lt;span class="ch"&gt;]&lt;/span&gt;&lt;span class="ot"&gt; &lt;/span&gt;&lt;span class="ch"&gt;[&lt;/span&gt;&lt;span class="bn"&gt;bH&lt;/span&gt;&lt;span class="ch"&gt;]&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb12-8"&gt;&lt;a aria-hidden="true" href="#cb12-8" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="ch"&gt;[&lt;/span&gt;&lt;span class="bn"&gt;29837&lt;/span&gt;&lt;span class="ch"&gt;]&lt;/span&gt;&lt;span class="ot"&gt;Arguments:  &lt;/span&gt;&lt;span class="ch"&gt;[&lt;/span&gt;&lt;span class="bn"&gt;../a.out&lt;/span&gt;&lt;span class="ch"&gt;]&lt;/span&gt;&lt;span class="ot"&gt; &lt;/span&gt;&lt;span class="ch"&gt;[&lt;/span&gt;&lt;span class="bn"&gt;cH&lt;/span&gt;&lt;span class="ch"&gt;]&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb12-9"&gt;&lt;a aria-hidden="true" href="#cb12-9" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="ch"&gt;[&lt;/span&gt;&lt;span class="bn"&gt;29838&lt;/span&gt;&lt;span class="ch"&gt;]&lt;/span&gt;&lt;span class="ot"&gt;Arguments:  &lt;/span&gt;&lt;span class="ch"&gt;[&lt;/span&gt;&lt;span class="bn"&gt;../a.out&lt;/span&gt;&lt;span class="ch"&gt;]&lt;/span&gt;&lt;span class="ot"&gt; &lt;/span&gt;&lt;span class="ch"&gt;[&lt;/span&gt;&lt;span class="bn"&gt;dH&lt;/span&gt;&lt;span class="ch"&gt;]&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb12-10"&gt;&lt;a aria-hidden="true" href="#cb12-10" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="ch"&gt;[&lt;/span&gt;&lt;span class="bn"&gt;29839&lt;/span&gt;&lt;span class="ch"&gt;]&lt;/span&gt;&lt;span class="ot"&gt;Arguments:  &lt;/span&gt;&lt;span class="ch"&gt;[&lt;/span&gt;&lt;span class="bn"&gt;../a.out&lt;/span&gt;&lt;span class="ch"&gt;]&lt;/span&gt;&lt;span class="ot"&gt; &lt;/span&gt;&lt;span class="ch"&gt;[&lt;/span&gt;&lt;span class="bn"&gt;eH&lt;/span&gt;&lt;span class="ch"&gt;]&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;用这种方法，可以快捷的重命名。再比如给文件加上时间戳：&lt;/p&gt;
&lt;p&gt;&lt;code&gt;parallel mv {} '{= $a=pQ($_); $b=$_;' '$_=qx{date -r "$a" +%FT%T}; chomp; $_="$_ $b" =}' ::: *&lt;/code&gt;&lt;/p&gt;
&lt;h2 id="聚合文件内容"&gt;聚合文件内容&lt;/h2&gt;
&lt;p&gt;以下命令将会生成文件 &lt;code&gt;x1y01z1&lt;/code&gt; 到 &lt;code&gt;x5y10z5&lt;/code&gt;：&lt;/p&gt;
&lt;p&gt;&lt;code&gt;parallel --header : echo x{X}y{Y}z{Z} \&amp;gt; x{X}y{Y}z{Z} ::: X {1..5} ::: Y {01..10} ::: Z {1..5}&lt;/code&gt;&lt;/p&gt;
&lt;h2 id="更好的-for-和-while"&gt;更好的 &lt;code&gt;for&lt;/code&gt; 和 &lt;code&gt;while&lt;/code&gt;&lt;/h2&gt;
&lt;p&gt;一般的 &lt;code&gt;for&lt;/code&gt; 循环长这样：&lt;/p&gt;
&lt;div class="sourceCode" id="cb13"&gt;&lt;pre class="sourceCode haskell"&gt;&lt;code class="sourceCode haskell"&gt;&lt;span id="cb13-1"&gt;&lt;a aria-hidden="true" href="#cb13-1" tabindex="-1"&gt;&lt;/a&gt;(for x &lt;span class="kw"&gt;in&lt;/span&gt; &lt;span class="ot"&gt;`cat list`&lt;/span&gt; ; &lt;span class="kw"&gt;do&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb13-2"&gt;&lt;a aria-hidden="true" href="#cb13-2" tabindex="-1"&gt;&lt;/a&gt;  do_something &lt;span class="op"&gt;$&lt;/span&gt;x&lt;/span&gt;
&lt;span id="cb13-3"&gt;&lt;a aria-hidden="true" href="#cb13-3" tabindex="-1"&gt;&lt;/a&gt;done) &lt;span class="op"&gt;|&lt;/span&gt; process_output&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;以及 &lt;code&gt;while&lt;/code&gt; 循环：&lt;/p&gt;
&lt;div class="sourceCode" id="cb14"&gt;&lt;pre class="sourceCode haskell"&gt;&lt;code class="sourceCode haskell"&gt;&lt;span id="cb14-1"&gt;&lt;a aria-hidden="true" href="#cb14-1" tabindex="-1"&gt;&lt;/a&gt;cat list &lt;span class="op"&gt;|&lt;/span&gt; (while &lt;span class="fu"&gt;read&lt;/span&gt; x ; &lt;span class="kw"&gt;do&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb14-2"&gt;&lt;a aria-hidden="true" href="#cb14-2" tabindex="-1"&gt;&lt;/a&gt;  do_something &lt;span class="op"&gt;$&lt;/span&gt;x&lt;/span&gt;
&lt;span id="cb14-3"&gt;&lt;a aria-hidden="true" href="#cb14-3" tabindex="-1"&gt;&lt;/a&gt;done) &lt;span class="op"&gt;|&lt;/span&gt; process_output&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;可以重写成这样：&lt;/p&gt;
&lt;p&gt;&lt;code&gt;cat list | parallel do_something | process_output&lt;/code&gt;&lt;/p&gt;
&lt;h2 id="步进"&gt;步进&lt;/h2&gt;
&lt;p&gt;假如你有以下输入：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;aardvark
babble
cab
dab
each&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;你想要这样：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;aardvark babble
babble cab
cab dab
dab each&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;对于保存在文件里面的情况，使用这个命令：&lt;/p&gt;
&lt;p&gt;&lt;code&gt;parallel echo {1} - {2} ::::+ &amp;lt;(head -n -1 in.txt) &amp;lt;(tail -n +2 in.txt)&lt;/code&gt;&lt;/p&gt;
&lt;h2 id="加速快速的任务"&gt;加速快速的任务&lt;/h2&gt;
&lt;p&gt;在本地机器上启动作业大约需要 3-10 毫秒，如果作业运行时间非常短，这可能是一个很大的开销。可以使用 -X 将小作业组合在一起。例如：&lt;/p&gt;
&lt;div class="sourceCode" id="cb17"&gt;&lt;pre class="sourceCode haskell"&gt;&lt;code class="sourceCode haskell"&gt;&lt;span id="cb17-1"&gt;&lt;a aria-hidden="true" href="#cb17-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="fu"&gt;seq&lt;/span&gt; &lt;span class="op"&gt;-&lt;/span&gt;w &lt;span class="dv"&gt;0&lt;/span&gt; &lt;span class="dv"&gt;9999&lt;/span&gt; &lt;span class="op"&gt;|&lt;/span&gt; parallel touch pict{}&lt;span class="op"&gt;.&lt;/span&gt;jpg&lt;/span&gt;
&lt;span id="cb17-2"&gt;&lt;a aria-hidden="true" href="#cb17-2" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="fu"&gt;seq&lt;/span&gt; &lt;span class="op"&gt;-&lt;/span&gt;w &lt;span class="dv"&gt;0&lt;/span&gt; &lt;span class="dv"&gt;9999&lt;/span&gt; &lt;span class="op"&gt;|&lt;/span&gt; parallel &lt;span class="op"&gt;-&lt;/span&gt;&lt;span class="dt"&gt;X&lt;/span&gt; touch pict{}&lt;span class="op"&gt;.&lt;/span&gt;jpg&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id="远程运行"&gt;远程运行&lt;/h2&gt;
&lt;p&gt;要在远程计算机上运行命令，需要设置 SSH，并且必须能够在不输入密码的情况下登录。&lt;/p&gt;
&lt;p&gt;&lt;code&gt;seq 10 | parallel --sshlogin server.example.com echo&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;要将命令分发到计算机列表，为所有计算机创建一个文件：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;server.example.com
foo@server2.example.com
server3.example.com
:&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;然后运行:&lt;/p&gt;
&lt;p&gt;&lt;code&gt;seq 10 | parallel --sshloginfile mycomputers echo&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;其中的 &lt;code&gt;:&lt;/code&gt; 代表本机。&lt;/p&gt;
&lt;p&gt;GNU parallel 将尝试确定每台远程计算机上的 CPU 数量，并为每个 CPU 运行一个作业。&lt;/p&gt;
&lt;p&gt;&lt;br/&gt;&lt;/p&gt;
&lt;p&gt;本文档的部分来源是 &lt;a href="https://www.gnu.org/software/parallel/parallel_examples.html"&gt;GNU PARALLEL EXAMPLES&lt;/a&gt;，其许可证为：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Permission is granted to copy, distribute and/or modify this documentation under the terms of the GNU Free Documentation License, Version 1.3 or any later version published by the Free Software Foundation; with no Invariant Sections, with no Front-Cover Texts, and with no Back-Cover Texts. A copy of the license is included in the file LICENSES/GFDL-1.3-or-later.txt.&lt;/code&gt;&lt;/pre&gt;
&lt;br/&gt;
&lt;!--%%REF%%--&gt;
&lt;br/&gt;
&lt;script async="" crossorigin="anonymous" data-category="Announcements" data-category-id="DIC_kwDOJ7Ymy84CX4eg" data-emit-metadata="0" data-input-position="top" data-lang="zh-CN" data-loading="lazy" data-mapping="title" data-reactions-enabled="1" data-repo="izfsk-ium/izfsk-ium.github.io" data-repo-id="R_kgDOJ7Ymyw" data-strict="0" data-theme="preferred_color_scheme" src="https://giscus.app/client.js"&gt;
&lt;/script&gt;
&lt;/main&gt;
&lt;footer&gt;
&lt;p class="signoff"&gt;
&lt;div class="metadata"&gt;
&lt;p class="date"&gt;&lt;time datetime="2023-02-19"&gt;创建日期：2023-02-19&lt;/time&gt;&lt;/p&gt;
&lt;p class="lastmodify"&gt;&lt;time&gt;最后编译：2023-08-10&lt;/time&gt;&lt;/p&gt;
&lt;p class="lastmodify" id="counter-span"&gt;访问次数：&lt;/p&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;/footer&gt;
&lt;script&gt;
    /* These script should run after page load */
    document.querySelectorAll('code.sourceCode').forEach(
      i =&gt; i.insertAdjacentHTML('beforeend', '&lt;div class="copy"&gt;复制&lt;/div&gt;')
    );
    document.querySelectorAll('div.copy').forEach(
      i =&gt; i.addEventListener(
        'click',
        () =&gt; {
          navigator.clipboard.writeText(i.parentElement.innerText.replace('复制', ''));
          i.innerText = '成功';
          setTimeout(() =&gt; {
            i.innerText = '复制';
          }, 1000);
        }
      )
    );

    if (location.href.includes("127.0.0.1:8080")) {
      document.getElementById("counter-span").innerHTML = "[[development mode]]";
    } else {
      const uuid = document.getElementById("article-uuid").innerText;
      const target = document.getElementById("counter-span");
      const last = localStorage.getItem("lastVisit-" + uuid);
      const shouldIncrease = last === null || new Date().getTime() - parseInt(last) &gt;= (1000 * 60 * 15);

      fetch(shouldIncrease ? ("https://counter.izfsk.top/counter/" + uuid) : ("https://counter.izfsk.top/readOnly/" + uuid))
        .then(r =&gt; r.text())
        .then(d =&gt; {
          if (!d.startsWith("Too"))
            document.getElementById("counter-span").innerText = "访问次数：" + d.toString();
          else
            document.getElementById("counter-span").innerHTML = "";
        });

      localStorage.setItem("lastVisit-" + uuid, new Date().getTime());
    }
  &lt;/script&gt;
&lt;script async="" data-website-id="2a1146ab-fa82-4a84-a04f-30e5967357c3" src="https://analytics.umami.is/script.js"&gt;&lt;/script&gt;
&lt;/body&gt;</content:encoded>
      <guid isPermaLink="false">23d00329-9a40-41dc-96e4-673f89a6d1b6</guid>
      <pubDate>Sun, 19 Feb 2023 00:00:00 +0800</pubDate>
    </item>
    <item>
      <title>博客迁移从域名到部署</title>
      <link>https://blog.izfsk.top/articles/Journey-of-blog-migrating-from-domain-to-deployment.html</link>
      <description>博客迁移从域名到部署</description>
      <content:encoded>&lt;body&gt;
&lt;progress id="content_progress" value="0"&gt;&lt;/progress&gt;
&lt;button id="back-to-top"&gt;
    回页顶
  &lt;/button&gt;
&lt;header&gt;
&lt;small id="article-uuid" style="display: none !important;"&gt;3dcffc06-560d-4ab2-9c64-62cf2b24682a&lt;/small&gt;
&lt;h1 class="title"&gt;博客迁移从域名到部署&lt;/h1&gt;
&lt;!-- Subtitle --&gt;
&lt;h3 class="subtitle"&gt; &lt;/h3&gt;
&lt;/header&gt;
&lt;nav id="TOC" role="doc-toc"&gt;
&lt;strong&gt;文章归类: &lt;a href="/pages/category.html#杂项"&gt;杂项&lt;/a&gt; &lt;/strong&gt;
&lt;input id="contents" type="checkbox"/&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#域名的选择和购买" id="toc-域名的选择和购买"&gt;域名的选择和购买&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#render" id="toc-render"&gt;Render&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#cloudflare" id="toc-cloudflare"&gt;Cloudflare&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#reference"&gt;参考链接&lt;/a&gt;&lt;/li&gt;
&lt;li&gt; &lt;/li&gt;
&lt;li class="tools"&gt;
&lt;span id="backtomain"&gt;
&lt;svg class="bi bi-house" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M8.707 1.5a1 1 0 0 0-1.414 0L.646 8.146a.5.5 0 0 0 .708.708L2 8.207V13.5A1.5 1.5 0 0 0 3.5 15h9a1.5 1.5 0 0 0 1.5-1.5V8.207l.646.647a.5.5 0 0 0 .708-.708L13 5.793V2.5a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v1.293L8.707 1.5ZM13 7.207V13.5a.5.5 0 0 1-.5.5h-9a.5.5 0 0 1-.5-.5V7.207l5-5 5 5Z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="readingmode"&gt;
&lt;svg class="bi bi-book" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M1 2.828c.885-.37 2.154-.769 3.388-.893 1.33-.134 2.458.063 3.112.752v9.746c-.935-.53-2.12-.603-3.213-.493-1.18.12-2.37.461-3.287.811V2.828zm7.5-.141c.654-.689 1.782-.886 3.112-.752 1.234.124 2.503.523 3.388.893v9.923c-.918-.35-2.107-.692-3.287-.81-1.094-.111-2.278-.039-3.213.492V2.687zM8 1.783C7.015.936 5.587.81 4.287.94c-1.514.153-3.042.672-3.994 1.105A.5.5 0 0 0 0 2.5v11a.5.5 0 0 0 .707.455c.882-.4 2.303-.881 3.68-1.02 1.409-.142 2.59.087 3.223.877a.5.5 0 0 0 .78 0c.633-.79 1.814-1.019 3.222-.877 1.378.139 2.8.62 3.681 1.02A.5.5 0 0 0 16 13.5v-11a.5.5 0 0 0-.293-.455c-.952-.433-2.48-.952-3.994-1.105C10.413.809 8.985.936 8 1.783z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="larger"&gt; &lt;/span&gt;
&lt;span id="smaller"&gt;&lt;/span&gt;
&lt;span id="switchfont"&gt;
&lt;svg class="bi bi-fonts" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M12.258 3h-8.51l-.083 2.46h.479c.26-1.544.758-1.783 2.693-1.845l.424-.013v7.827c0 .663-.144.82-1.3.923v.52h4.082v-.52c-1.162-.103-1.306-.26-1.306-.923V3.602l.431.013c1.934.062 2.434.301 2.693 1.846h.479L12.258 3z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="backtotop"&gt;
&lt;svg class="bi bi-arrow-bar-up" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M8 10a.5.5 0 0 0 .5-.5V3.707l2.146 2.147a.5.5 0 0 0 .708-.708l-3-3a.5.5 0 0 0-.708 0l-3 3a.5.5 0 1 0 .708.708L7.5 3.707V9.5a.5.5 0 0 0 .5.5zm-7 2.5a.5.5 0 0 1 .5-.5h13a.5.5 0 0 1 0 1h-13a.5.5 0 0 1-.5-.5z" fill-rule="evenodd"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/nav&gt;
&lt;main&gt;
&lt;p&gt;本站进行了一次迁徙，其实也不能说是完全的「迁徙」，但不管怎么样，现在可以使用自己的域名，而不是托管使用 github.io 的子域名了。除此以外，部署方式也作了修改，不再使用中国境内访问慢吞吞的 Github Pages 而采用 render.com 提供的部署服务，同时也套上了 Cloudflare。总之，除了域名费用以外并没有花其他的钱。这篇文章记录一下整个的流程。&lt;/p&gt;
&lt;h1 id="域名的选择和购买"&gt;域名的选择和购买&lt;/h1&gt;
&lt;p&gt;&lt;strong&gt;购买域名的第一注意事项：不要使用中国的域名注册商家或者购买由中国的公司/组织管理的顶级域名&lt;/strong&gt;。这样做纯粹是为了避免麻烦，主要是不可预期的政策风险和及其复杂的备案流程。即使你像我一样只是一个遵纪守法的好公民，这一整套流程下来，钱和精力都要耗费不少。具体的来讲，首先不要购买 &lt;code&gt;.cn&lt;/code&gt; 的域名，其次不要选择中文域名，最后，在其他域名之间选择时，记得先去 &lt;a href="https://icannwiki.org/"&gt;ICANN Wiki&lt;/a&gt; 查询一下你要购买的顶级域名的管理者到底是何方神圣，省得后悔。比如，本站的新域名的顶级域名 &lt;a href="https://icannwiki.org/Top_Registry"&gt;&lt;code&gt;.top&lt;/code&gt;&lt;/a&gt; 就是一家江苏省的公司管理的，这也是我购买以后才发现，真是后悔不迭。&lt;/p&gt;
&lt;p&gt;其次，要注意「第一年价格」和「续费价格」，有的域名第一年很便宜，但之后续费就飙升到几十乃至上百美元，另外还需要注意各种附加服务，提防不小心选择到自己不需要的东西。&lt;/p&gt;
&lt;p&gt;我选择的域名注册商家是 &lt;a href="http://namesilo.com"&gt;Namesilo&lt;/a&gt;，主要原因是它支持支付宝支付。选择和购买很简单顺畅，毕竟没有一个商家会在用户付款的路上添堵。然而，相比于它现代的选择购买界面：&lt;/p&gt;
&lt;p&gt;&lt;img src="./assets/main.png"/&gt;&lt;/p&gt;
&lt;p&gt;它的后台管理界面似乎让你回到了 15 年前：&lt;/p&gt;
&lt;p&gt;&lt;img src="./assets/bad.png"/&gt;&lt;/p&gt;
&lt;p&gt;以至于我第一次进入时以为自己被什么野鸡商家骗了钱（&lt;/p&gt;
&lt;p&gt;接下来在右边第二个「Domain Manager」里面确认你的域名即可。&lt;/p&gt;
&lt;p&gt;&lt;img src="./assets/div.png"/&gt;&lt;/p&gt;
&lt;h1 id="render"&gt;Render&lt;/h1&gt;
&lt;p&gt;Github Pages 其实已经很好了，但是由于众所周知的原因，中国境内访问它时不时会被阻断和劣化。所以需要另外一个部署服务来「加速」。有不少教程推荐使用 Netlify，但是它很荣幸的在我所在的区域被 reset 了。所以我选择其他替代方案。&lt;/p&gt;
&lt;p&gt;其实这些服务，Netlify 也好，Render 也好，对于我这样的用户来讲都是大同小异的。我用不到复杂的功能，只是作为一个静态站点同步和部署来用。&lt;/p&gt;
&lt;p&gt;直接在&lt;a href="https://dashboard.render.com/register"&gt;这里&lt;/a&gt;注册登录，如果使用 Github 登录，可以直接快捷的绑定 repo。选择创建一个新的 Static Site，然后点击右侧的 「Configure account 」绑定 Github 帐号里面的相应 repo 点击 Connect 即可。&lt;/p&gt;
&lt;p&gt;&lt;img src="./assets/start.png"/&gt;&lt;/p&gt;
&lt;p&gt;然后就是配置。你需要起一个名字，它同样是一个二级域名：&lt;code&gt;*.onrender.com&lt;/code&gt;。不过既然接下来要自定义域名这个也无关紧要。我的站点是完全本地生成后 push 到仓库的，所以没有 Build Command，Publish directory 则是根目录 &lt;code&gt;./&lt;/code&gt;。&lt;strong&gt;默认情况下每一次对源 repo 的 push 都会触发一次更新&lt;/strong&gt;，不需要手动设置。&lt;/p&gt;
&lt;p&gt;&lt;img src="./assets/cfgs.png"/&gt;&lt;/p&gt;
&lt;p&gt;接下来是等待部署。等到部署完成后，就可以访问了。同时，状态变成这样：&lt;/p&gt;
&lt;p&gt;&lt;img src="./assets/oks.png"/&gt;&lt;/p&gt;
&lt;p&gt;此时可以访问 &lt;code&gt;name.onrender.com&lt;/code&gt; 访问了。这种情况下它相当于是一个类似 Github Pages 但是略微加速。&lt;/p&gt;
&lt;h1 id="cloudflare"&gt;Cloudflare&lt;/h1&gt;
&lt;p&gt;使用它不仅仅是出于防止 DDOS 或者的考虑，&lt;del&gt;毕竟 CDN 能减速。&lt;/del&gt;其实这反而是次要的考虑。要使用 Cloudflare ，首先需要把域名的 nameserver 转移到 Cloudflare 那边去。Cloudflare 注册以后会有一个向导，一步一步来就行了。主要是 namesilo 那边。你需要先勾选复选框，再点击：&lt;/p&gt;
&lt;p&gt;&lt;img src="./assets/div2.png"/&gt;&lt;/p&gt;
&lt;p&gt;然后把原来的删除，添加 Cloudflare 给你的：&lt;/p&gt;
&lt;p&gt;&lt;img src="./assets/ns.png"/&gt;&lt;/p&gt;
&lt;p&gt;接下来是 CF 这边，DNS 缓存的全球更新需要一点时间，所以需要等一会儿。接下来就是设置解析地址，点到你的域名，DNS 设置里面添加。DNS 记录可以理解成一个 K-V 对，主要需要知道的三种记录类型：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;A : 域名 -&amp;gt; IPv4 地址&lt;/li&gt;
&lt;li&gt;AAAA : 域名 -&amp;gt; IPv6 地址&lt;/li&gt;
&lt;li&gt;CNAME : 域名 -&amp;gt; 另外一个域名&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;添加好相应的域名即可。注意在导入站点的时候，会发现有几条不认识的 A 记录，那是 Namesilo 的广告页面，删掉就行。添加 &lt;code&gt;A&lt;/code&gt; 记录可以使用中国境内的 VPS 地址也可以正常访问，但是&lt;strong&gt;有合规性风险&lt;/strong&gt;，不建议尝试。「要么全是(中国)境外，要么全是(中国)境内」，不要混着来。&lt;/p&gt;
&lt;p&gt;&lt;img src="./assets/name.png"/&gt;&lt;/p&gt;
&lt;p&gt;所以，访问 &lt;code&gt;blog.izfsk.top&lt;/code&gt; 就会相应的跳转到 &lt;code&gt;izfsk.onrender.com&lt;/code&gt; 那边去。但是，此时还是不能够正常使用，因为 Render 那边的 &lt;code&gt;Custom Domains&lt;/code&gt; 还没有设置。回到 Render 的 Dashboard 里面找到你的项目，在 Settings 里面，添加自定义的域名即可。需要等待一会儿 DNS 刷新以及 Render 处理证书。最后的状态是这样的：&lt;/p&gt;
&lt;p&gt;&lt;img src="./assets/ok.png"/&gt;&lt;/p&gt;
&lt;p&gt;那么就大功告成啦！&lt;/p&gt;
&lt;p&gt;其实 Render 还支持免费(有大小和时间限制的) PostgreSQL 服务和 Web Service 服务，完全可以折腾一下搞一个评论功能，把白嫖进行到底（&lt;/p&gt;
&lt;br/&gt;
&lt;!--%%REF%%--&gt;
&lt;br/&gt;
&lt;script async="" crossorigin="anonymous" data-category="Announcements" data-category-id="DIC_kwDOJ7Ymy84CX4eg" data-emit-metadata="0" data-input-position="top" data-lang="zh-CN" data-loading="lazy" data-mapping="title" data-reactions-enabled="1" data-repo="izfsk-ium/izfsk-ium.github.io" data-repo-id="R_kgDOJ7Ymyw" data-strict="0" data-theme="preferred_color_scheme" src="https://giscus.app/client.js"&gt;
&lt;/script&gt;
&lt;/main&gt;
&lt;footer&gt;
&lt;p class="signoff"&gt;
&lt;div class="metadata"&gt;
&lt;p class="date"&gt;&lt;time datetime="2023-02-26"&gt;创建日期：2023-02-26&lt;/time&gt;&lt;/p&gt;
&lt;p class="lastmodify"&gt;&lt;time&gt;最后编译：2023-08-10&lt;/time&gt;&lt;/p&gt;
&lt;p class="lastmodify" id="counter-span"&gt;访问次数：&lt;/p&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;/footer&gt;
&lt;script&gt;
    /* These script should run after page load */
    document.querySelectorAll('code.sourceCode').forEach(
      i =&gt; i.insertAdjacentHTML('beforeend', '&lt;div class="copy"&gt;复制&lt;/div&gt;')
    );
    document.querySelectorAll('div.copy').forEach(
      i =&gt; i.addEventListener(
        'click',
        () =&gt; {
          navigator.clipboard.writeText(i.parentElement.innerText.replace('复制', ''));
          i.innerText = '成功';
          setTimeout(() =&gt; {
            i.innerText = '复制';
          }, 1000);
        }
      )
    );

    if (location.href.includes("127.0.0.1:8080")) {
      document.getElementById("counter-span").innerHTML = "[[development mode]]";
    } else {
      const uuid = document.getElementById("article-uuid").innerText;
      const target = document.getElementById("counter-span");
      const last = localStorage.getItem("lastVisit-" + uuid);
      const shouldIncrease = last === null || new Date().getTime() - parseInt(last) &gt;= (1000 * 60 * 15);

      fetch(shouldIncrease ? ("https://counter.izfsk.top/counter/" + uuid) : ("https://counter.izfsk.top/readOnly/" + uuid))
        .then(r =&gt; r.text())
        .then(d =&gt; {
          if (!d.startsWith("Too"))
            document.getElementById("counter-span").innerText = "访问次数：" + d.toString();
          else
            document.getElementById("counter-span").innerHTML = "";
        });

      localStorage.setItem("lastVisit-" + uuid, new Date().getTime());
    }
  &lt;/script&gt;
&lt;script async="" data-website-id="2a1146ab-fa82-4a84-a04f-30e5967357c3" src="https://analytics.umami.is/script.js"&gt;&lt;/script&gt;
&lt;/body&gt;</content:encoded>
      <guid isPermaLink="false">3dcffc06-560d-4ab2-9c64-62cf2b24682a</guid>
      <pubDate>Sun, 26 Feb 2023 00:00:00 +0800</pubDate>
    </item>
    <item>
      <title>使用fetch下载时获取进度信息</title>
      <link>https://blog.izfsk.top/articles/使用fetch下载时获取进度信息.html</link>
      <description>使用fetch下载时获取进度信息</description>
      <content:encoded>&lt;body&gt;
&lt;progress id="content_progress" value="0"&gt;&lt;/progress&gt;
&lt;button id="back-to-top"&gt;
    回页顶
  &lt;/button&gt;
&lt;header&gt;
&lt;small id="article-uuid" style="display: none !important;"&gt;3f650bd0-bdbb-4ac4-a2a6-5c62da3749dd&lt;/small&gt;
&lt;h1 class="title"&gt;使用fetch下载时获取进度信息&lt;/h1&gt;
&lt;!-- Subtitle --&gt;
&lt;h3 class="subtitle"&gt; &lt;/h3&gt;
&lt;/header&gt;
&lt;nav id="TOC" role="doc-toc"&gt;
&lt;strong&gt;文章归类: &lt;a href="/pages/category.html#学习"&gt;学习&lt;/a&gt; &lt;/strong&gt;
&lt;input id="contents" type="checkbox"/&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#流-api" id="toc-流-api"&gt;流 API&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#上传进度使用-xhr" id="toc-上传进度使用-xhr"&gt;上传进度（使用 XHR ）&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#参考" id="toc-参考"&gt;参考&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#reference"&gt;参考链接&lt;/a&gt;&lt;/li&gt;
&lt;li&gt; &lt;/li&gt;
&lt;li class="tools"&gt;
&lt;span id="backtomain"&gt;
&lt;svg class="bi bi-house" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M8.707 1.5a1 1 0 0 0-1.414 0L.646 8.146a.5.5 0 0 0 .708.708L2 8.207V13.5A1.5 1.5 0 0 0 3.5 15h9a1.5 1.5 0 0 0 1.5-1.5V8.207l.646.647a.5.5 0 0 0 .708-.708L13 5.793V2.5a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v1.293L8.707 1.5ZM13 7.207V13.5a.5.5 0 0 1-.5.5h-9a.5.5 0 0 1-.5-.5V7.207l5-5 5 5Z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="readingmode"&gt;
&lt;svg class="bi bi-book" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M1 2.828c.885-.37 2.154-.769 3.388-.893 1.33-.134 2.458.063 3.112.752v9.746c-.935-.53-2.12-.603-3.213-.493-1.18.12-2.37.461-3.287.811V2.828zm7.5-.141c.654-.689 1.782-.886 3.112-.752 1.234.124 2.503.523 3.388.893v9.923c-.918-.35-2.107-.692-3.287-.81-1.094-.111-2.278-.039-3.213.492V2.687zM8 1.783C7.015.936 5.587.81 4.287.94c-1.514.153-3.042.672-3.994 1.105A.5.5 0 0 0 0 2.5v11a.5.5 0 0 0 .707.455c.882-.4 2.303-.881 3.68-1.02 1.409-.142 2.59.087 3.223.877a.5.5 0 0 0 .78 0c.633-.79 1.814-1.019 3.222-.877 1.378.139 2.8.62 3.681 1.02A.5.5 0 0 0 16 13.5v-11a.5.5 0 0 0-.293-.455c-.952-.433-2.48-.952-3.994-1.105C10.413.809 8.985.936 8 1.783z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="larger"&gt; &lt;/span&gt;
&lt;span id="smaller"&gt;&lt;/span&gt;
&lt;span id="switchfont"&gt;
&lt;svg class="bi bi-fonts" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M12.258 3h-8.51l-.083 2.46h.479c.26-1.544.758-1.783 2.693-1.845l.424-.013v7.827c0 .663-.144.82-1.3.923v.52h4.082v-.52c-1.162-.103-1.306-.26-1.306-.923V3.602l.431.013c1.934.062 2.434.301 2.693 1.846h.479L12.258 3z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="backtotop"&gt;
&lt;svg class="bi bi-arrow-bar-up" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M8 10a.5.5 0 0 0 .5-.5V3.707l2.146 2.147a.5.5 0 0 0 .708-.708l-3-3a.5.5 0 0 0-.708 0l-3 3a.5.5 0 1 0 .708.708L7.5 3.707V9.5a.5.5 0 0 0 .5.5zm-7 2.5a.5.5 0 0 1 .5-.5h13a.5.5 0 0 1 0 1h-13a.5.5 0 0 1-.5-.5z" fill-rule="evenodd"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/nav&gt;
&lt;main&gt;
&lt;p&gt;一般当要在前端动态的使用 &lt;code&gt;fetch&lt;/code&gt; 下载某物的时候，常规的模式是这样的：&lt;/p&gt;
&lt;div class="sourceCode" id="cb1"&gt;&lt;pre class="sourceCode typescript"&gt;&lt;code class="sourceCode typescript"&gt;&lt;span id="cb1-1"&gt;&lt;a aria-hidden="true" href="#cb1-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;async&lt;/span&gt; &lt;span class="kw"&gt;function&lt;/span&gt; &lt;span class="fu"&gt;downloadFiles&lt;/span&gt;() {&lt;/span&gt;
&lt;span id="cb1-2"&gt;&lt;a aria-hidden="true" href="#cb1-2" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="cf"&gt;return&lt;/span&gt; &lt;span class="fu"&gt;fetch&lt;/span&gt;(&lt;span class="st"&gt;"Address"&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt; {&lt;/span&gt;
&lt;span id="cb1-3"&gt;&lt;a aria-hidden="true" href="#cb1-3" tabindex="-1"&gt;&lt;/a&gt;        credentials&lt;span class="op"&gt;:&lt;/span&gt; &lt;span class="st"&gt;"include"&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-4"&gt;&lt;a aria-hidden="true" href="#cb1-4" tabindex="-1"&gt;&lt;/a&gt;    })&lt;/span&gt;
&lt;span id="cb1-5"&gt;&lt;a aria-hidden="true" href="#cb1-5" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;then&lt;/span&gt;((resp) &lt;span class="kw"&gt;=&amp;gt;&lt;/span&gt; {&lt;/span&gt;
&lt;span id="cb1-6"&gt;&lt;a aria-hidden="true" href="#cb1-6" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="cf"&gt;return&lt;/span&gt; resp&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;blob&lt;/span&gt;()&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-7"&gt;&lt;a aria-hidden="true" href="#cb1-7" tabindex="-1"&gt;&lt;/a&gt;    })&lt;/span&gt;
&lt;span id="cb1-8"&gt;&lt;a aria-hidden="true" href="#cb1-8" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;then&lt;/span&gt;(&lt;span class="kw"&gt;async&lt;/span&gt; (b) &lt;span class="kw"&gt;=&amp;gt;&lt;/span&gt; {&lt;/span&gt;
&lt;span id="cb1-9"&gt;&lt;a aria-hidden="true" href="#cb1-9" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="kw"&gt;const&lt;/span&gt; a &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="bu"&gt;document&lt;/span&gt;&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;createElement&lt;/span&gt;(&lt;span class="st"&gt;"a"&lt;/span&gt;)&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-10"&gt;&lt;a aria-hidden="true" href="#cb1-10" tabindex="-1"&gt;&lt;/a&gt;        a&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="at"&gt;href&lt;/span&gt; &lt;span class="op"&gt;=&lt;/span&gt; URL&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;createObjectURL&lt;/span&gt;(b)&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-11"&gt;&lt;a aria-hidden="true" href="#cb1-11" tabindex="-1"&gt;&lt;/a&gt;        a&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;setAttribute&lt;/span&gt;(&lt;span class="st"&gt;"download"&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt; &lt;span class="st"&gt;"下载.zip"&lt;/span&gt;)&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-12"&gt;&lt;a aria-hidden="true" href="#cb1-12" tabindex="-1"&gt;&lt;/a&gt;        a&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;click&lt;/span&gt;()&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-13"&gt;&lt;a aria-hidden="true" href="#cb1-13" tabindex="-1"&gt;&lt;/a&gt;    })&lt;/span&gt;
&lt;span id="cb1-14"&gt;&lt;a aria-hidden="true" href="#cb1-14" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;catch&lt;/span&gt;((e) &lt;span class="kw"&gt;=&amp;gt;&lt;/span&gt; {&lt;/span&gt;
&lt;span id="cb1-15"&gt;&lt;a aria-hidden="true" href="#cb1-15" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="bu"&gt;console&lt;/span&gt;&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;log&lt;/span&gt;(e&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;toString&lt;/span&gt;())&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-16"&gt;&lt;a aria-hidden="true" href="#cb1-16" tabindex="-1"&gt;&lt;/a&gt;    })&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-17"&gt;&lt;a aria-hidden="true" href="#cb1-17" tabindex="-1"&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;这样做有一个坏处：&lt;strong&gt;不能显示进度&lt;/strong&gt;。返回的 blob 必须要等到下载全部完毕以后，才能有反映。对于比较大的文件，用户的观感就是页面「卡住了」，然后不停的重复点击。更好的做法是把接收的流资源分成一个个小的分块，然后按位处理它。&lt;/p&gt;
&lt;h1 id="流-api"&gt;流 API&lt;/h1&gt;
&lt;p&gt;在 &lt;code&gt;fetch&lt;/code&gt; 第一步返回的 &lt;code&gt;Response&lt;/code&gt; 类型中包含了请求的状态，大小长度，&lt;code&gt;headers&lt;/code&gt; 等等的信息，而文件的大小就可以使用 &lt;code&gt;parseInt(resp.headers.get("content-length"), 10)&lt;/code&gt; 来获得。为了获得每一块的状态则需要返回一个 &lt;code&gt;ReadableStream&lt;/code&gt;。&lt;/p&gt;
&lt;p&gt;具体的来讲第二步返回的内容是这样：&lt;/p&gt;
&lt;div class="sourceCode" id="cb2"&gt;&lt;pre class="sourceCode typescript"&gt;&lt;code class="sourceCode typescript"&gt;&lt;span id="cb2-1"&gt;&lt;a aria-hidden="true" href="#cb2-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="cf"&gt;return&lt;/span&gt; &lt;span class="kw"&gt;new&lt;/span&gt; &lt;span class="fu"&gt;Response&lt;/span&gt;(&lt;/span&gt;
&lt;span id="cb2-2"&gt;&lt;a aria-hidden="true" href="#cb2-2" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="kw"&gt;new&lt;/span&gt; &lt;span class="fu"&gt;ReadableStream&lt;/span&gt;({&lt;/span&gt;
&lt;span id="cb2-3"&gt;&lt;a aria-hidden="true" href="#cb2-3" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="kw"&gt;async&lt;/span&gt; &lt;span class="fu"&gt;start&lt;/span&gt;(controller) {&lt;/span&gt;
&lt;span id="cb2-4"&gt;&lt;a aria-hidden="true" href="#cb2-4" tabindex="-1"&gt;&lt;/a&gt;            &lt;span class="kw"&gt;const&lt;/span&gt; reader &lt;span class="op"&gt;=&lt;/span&gt; resp&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="at"&gt;body&lt;/span&gt;&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;getReader&lt;/span&gt;()&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-5"&gt;&lt;a aria-hidden="true" href="#cb2-5" tabindex="-1"&gt;&lt;/a&gt;            &lt;span class="cf"&gt;for&lt;/span&gt; (&lt;span class="op"&gt;;;&lt;/span&gt;) {&lt;/span&gt;
&lt;span id="cb2-6"&gt;&lt;a aria-hidden="true" href="#cb2-6" tabindex="-1"&gt;&lt;/a&gt;                &lt;span class="kw"&gt;const&lt;/span&gt; { done&lt;span class="op"&gt;,&lt;/span&gt; value } &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="cf"&gt;await&lt;/span&gt; reader&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;read&lt;/span&gt;()&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-7"&gt;&lt;a aria-hidden="true" href="#cb2-7" tabindex="-1"&gt;&lt;/a&gt;                &lt;span class="cf"&gt;if&lt;/span&gt; (done) &lt;span class="cf"&gt;break&lt;/span&gt;&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-8"&gt;&lt;a aria-hidden="true" href="#cb2-8" tabindex="-1"&gt;&lt;/a&gt;                loaded &lt;span class="op"&gt;+=&lt;/span&gt; value&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="at"&gt;byteLength&lt;/span&gt;&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-9"&gt;&lt;a aria-hidden="true" href="#cb2-9" tabindex="-1"&gt;&lt;/a&gt;                controller&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;enqueue&lt;/span&gt;(value)&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-10"&gt;&lt;a aria-hidden="true" href="#cb2-10" tabindex="-1"&gt;&lt;/a&gt;            }&lt;/span&gt;
&lt;span id="cb2-11"&gt;&lt;a aria-hidden="true" href="#cb2-11" tabindex="-1"&gt;&lt;/a&gt;            controller&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;close&lt;/span&gt;()&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-12"&gt;&lt;a aria-hidden="true" href="#cb2-12" tabindex="-1"&gt;&lt;/a&gt;        }&lt;span class="op"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-13"&gt;&lt;a aria-hidden="true" href="#cb2-13" tabindex="-1"&gt;&lt;/a&gt;    })&lt;/span&gt;
&lt;span id="cb2-14"&gt;&lt;a aria-hidden="true" href="#cb2-14" tabindex="-1"&gt;&lt;/a&gt;)&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;这一步返回的东西依旧是一个 &lt;code&gt;Response&lt;/code&gt;，所以下一步还是需要用 &lt;code&gt;r.blob()&lt;/code&gt; 来获得最终的数据。&lt;/p&gt;
&lt;div class="sourceCode" id="cb3"&gt;&lt;pre class="sourceCode typescript"&gt;&lt;code class="sourceCode typescript"&gt;&lt;span id="cb3-1"&gt;&lt;a aria-hidden="true" href="#cb3-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;let&lt;/span&gt; total &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="dv"&gt;0&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt; loaded &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="dv"&gt;0&lt;/span&gt;&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb3-2"&gt;&lt;a aria-hidden="true" href="#cb3-2" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb3-3"&gt;&lt;a aria-hidden="true" href="#cb3-3" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;function&lt;/span&gt; &lt;span class="fu"&gt;handleDownloadAppendix&lt;/span&gt;() {&lt;/span&gt;
&lt;span id="cb3-4"&gt;&lt;a aria-hidden="true" href="#cb3-4" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="fu"&gt;fetch&lt;/span&gt;(&lt;span class="vs"&gt;`Something`&lt;/span&gt;)&lt;/span&gt;
&lt;span id="cb3-5"&gt;&lt;a aria-hidden="true" href="#cb3-5" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;then&lt;/span&gt;((resp) &lt;span class="kw"&gt;=&amp;gt;&lt;/span&gt; {&lt;/span&gt;
&lt;span id="cb3-6"&gt;&lt;a aria-hidden="true" href="#cb3-6" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="cf"&gt;switch&lt;/span&gt; (resp&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="at"&gt;status&lt;/span&gt;) {&lt;/span&gt;
&lt;span id="cb3-7"&gt;&lt;a aria-hidden="true" href="#cb3-7" tabindex="-1"&gt;&lt;/a&gt;            &lt;span class="cf"&gt;case&lt;/span&gt; &lt;span class="dv"&gt;429&lt;/span&gt;&lt;span class="op"&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb3-8"&gt;&lt;a aria-hidden="true" href="#cb3-8" tabindex="-1"&gt;&lt;/a&gt;            &lt;span class="cf"&gt;case&lt;/span&gt; &lt;span class="dv"&gt;404&lt;/span&gt;&lt;span class="op"&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb3-9"&gt;&lt;a aria-hidden="true" href="#cb3-9" tabindex="-1"&gt;&lt;/a&gt;            &lt;span class="cf"&gt;case&lt;/span&gt; &lt;span class="dv"&gt;400&lt;/span&gt;&lt;span class="op"&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb3-10"&gt;&lt;a aria-hidden="true" href="#cb3-10" tabindex="-1"&gt;&lt;/a&gt;                &lt;span class="cf"&gt;throw&lt;/span&gt; &lt;span class="bu"&gt;Error&lt;/span&gt;(resp&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="at"&gt;statusText&lt;/span&gt;)&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb3-11"&gt;&lt;a aria-hidden="true" href="#cb3-11" tabindex="-1"&gt;&lt;/a&gt;            &lt;span class="cf"&gt;default&lt;/span&gt;&lt;span class="op"&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb3-12"&gt;&lt;a aria-hidden="true" href="#cb3-12" tabindex="-1"&gt;&lt;/a&gt;                total &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="pp"&gt;parseInt&lt;/span&gt;(&lt;/span&gt;
&lt;span id="cb3-13"&gt;&lt;a aria-hidden="true" href="#cb3-13" tabindex="-1"&gt;&lt;/a&gt;                    resp&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="at"&gt;headers&lt;/span&gt;&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;get&lt;/span&gt;(&lt;span class="st"&gt;"content-length"&lt;/span&gt;)&lt;span class="op"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb3-14"&gt;&lt;a aria-hidden="true" href="#cb3-14" tabindex="-1"&gt;&lt;/a&gt;                    &lt;span class="dv"&gt;10&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb3-15"&gt;&lt;a aria-hidden="true" href="#cb3-15" tabindex="-1"&gt;&lt;/a&gt;                )&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb3-16"&gt;&lt;a aria-hidden="true" href="#cb3-16" tabindex="-1"&gt;&lt;/a&gt;                &lt;span class="cf"&gt;return&lt;/span&gt; &lt;span class="kw"&gt;new&lt;/span&gt; &lt;span class="fu"&gt;Response&lt;/span&gt;(&lt;/span&gt;
&lt;span id="cb3-17"&gt;&lt;a aria-hidden="true" href="#cb3-17" tabindex="-1"&gt;&lt;/a&gt;                    &lt;span class="kw"&gt;new&lt;/span&gt; &lt;span class="fu"&gt;ReadableStream&lt;/span&gt;({&lt;/span&gt;
&lt;span id="cb3-18"&gt;&lt;a aria-hidden="true" href="#cb3-18" tabindex="-1"&gt;&lt;/a&gt;                        &lt;span class="kw"&gt;async&lt;/span&gt; &lt;span class="fu"&gt;start&lt;/span&gt;(controller) {&lt;/span&gt;
&lt;span id="cb3-19"&gt;&lt;a aria-hidden="true" href="#cb3-19" tabindex="-1"&gt;&lt;/a&gt;                            &lt;span class="kw"&gt;const&lt;/span&gt; reader &lt;span class="op"&gt;=&lt;/span&gt; resp&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="at"&gt;body&lt;/span&gt;&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;getReader&lt;/span&gt;()&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb3-20"&gt;&lt;a aria-hidden="true" href="#cb3-20" tabindex="-1"&gt;&lt;/a&gt;                            &lt;span class="cf"&gt;for&lt;/span&gt; (&lt;span class="op"&gt;;;&lt;/span&gt;) {&lt;/span&gt;
&lt;span id="cb3-21"&gt;&lt;a aria-hidden="true" href="#cb3-21" tabindex="-1"&gt;&lt;/a&gt;                                &lt;span class="kw"&gt;const&lt;/span&gt; { done&lt;span class="op"&gt;,&lt;/span&gt; value } &lt;span class="op"&gt;=&lt;/span&gt;  &lt;span class="cf"&gt;await&lt;/span&gt; reader&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;read&lt;/span&gt;()&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb3-22"&gt;&lt;a aria-hidden="true" href="#cb3-22" tabindex="-1"&gt;&lt;/a&gt;                                &lt;span class="cf"&gt;if&lt;/span&gt; (done) &lt;span class="cf"&gt;break&lt;/span&gt;&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb3-23"&gt;&lt;a aria-hidden="true" href="#cb3-23" tabindex="-1"&gt;&lt;/a&gt;                                loaded &lt;span class="op"&gt;+=&lt;/span&gt; value&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="at"&gt;byteLength&lt;/span&gt;&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb3-24"&gt;&lt;a aria-hidden="true" href="#cb3-24" tabindex="-1"&gt;&lt;/a&gt;                                promptText &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="vs"&gt;`下载中 &lt;/span&gt;&lt;span class="sc"&gt;${&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb3-25"&gt;&lt;a aria-hidden="true" href="#cb3-25" tabindex="-1"&gt;&lt;/a&gt;                                    &lt;span class="bu"&gt;Math&lt;/span&gt;&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;floor&lt;/span&gt;(loaded &lt;span class="op"&gt;/&lt;/span&gt; total) &lt;span class="op"&gt;*&lt;/span&gt; &lt;span class="dv"&gt;100&lt;/span&gt; &lt;span class="op"&gt;-&lt;/span&gt; &lt;span class="dv"&gt;1&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb3-26"&gt;&lt;a aria-hidden="true" href="#cb3-26" tabindex="-1"&gt;&lt;/a&gt;                                &lt;span class="sc"&gt;}&lt;/span&gt;&lt;span class="vs"&gt; %`&lt;/span&gt;&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb3-27"&gt;&lt;a aria-hidden="true" href="#cb3-27" tabindex="-1"&gt;&lt;/a&gt;                                controller&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;enqueue&lt;/span&gt;(value)&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb3-28"&gt;&lt;a aria-hidden="true" href="#cb3-28" tabindex="-1"&gt;&lt;/a&gt;                            }&lt;/span&gt;
&lt;span id="cb3-29"&gt;&lt;a aria-hidden="true" href="#cb3-29" tabindex="-1"&gt;&lt;/a&gt;                            controller&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;close&lt;/span&gt;()&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb3-30"&gt;&lt;a aria-hidden="true" href="#cb3-30" tabindex="-1"&gt;&lt;/a&gt;                        }&lt;span class="op"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb3-31"&gt;&lt;a aria-hidden="true" href="#cb3-31" tabindex="-1"&gt;&lt;/a&gt;                    })&lt;/span&gt;
&lt;span id="cb3-32"&gt;&lt;a aria-hidden="true" href="#cb3-32" tabindex="-1"&gt;&lt;/a&gt;                )&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb3-33"&gt;&lt;a aria-hidden="true" href="#cb3-33" tabindex="-1"&gt;&lt;/a&gt;        }&lt;/span&gt;
&lt;span id="cb3-34"&gt;&lt;a aria-hidden="true" href="#cb3-34" tabindex="-1"&gt;&lt;/a&gt;    })&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;then&lt;/span&gt;(&lt;span class="kw"&gt;async&lt;/span&gt; (r) &lt;span class="kw"&gt;=&amp;gt;&lt;/span&gt; {&lt;/span&gt;
&lt;span id="cb3-35"&gt;&lt;a aria-hidden="true" href="#cb3-35" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="kw"&gt;let&lt;/span&gt; blob &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="cf"&gt;await&lt;/span&gt; r&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;blob&lt;/span&gt;()&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb3-36"&gt;&lt;a aria-hidden="true" href="#cb3-36" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="kw"&gt;const&lt;/span&gt; a &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="bu"&gt;document&lt;/span&gt;&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;createElement&lt;/span&gt;(&lt;span class="st"&gt;"a"&lt;/span&gt;)&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb3-37"&gt;&lt;a aria-hidden="true" href="#cb3-37" tabindex="-1"&gt;&lt;/a&gt;        a&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="at"&gt;href&lt;/span&gt; &lt;span class="op"&gt;=&lt;/span&gt; URL&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;createObjectURL&lt;/span&gt;(blob)&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb3-38"&gt;&lt;a aria-hidden="true" href="#cb3-38" tabindex="-1"&gt;&lt;/a&gt;        a&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;setAttribute&lt;/span&gt;(&lt;span class="st"&gt;"download"&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt; file&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="at"&gt;name&lt;/span&gt;)&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb3-39"&gt;&lt;a aria-hidden="true" href="#cb3-39" tabindex="-1"&gt;&lt;/a&gt;        a&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;click&lt;/span&gt;()&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb3-40"&gt;&lt;a aria-hidden="true" href="#cb3-40" tabindex="-1"&gt;&lt;/a&gt;    })&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h1 id="上传进度使用-xhr"&gt;上传进度（使用 XHR ）&lt;/h1&gt;
&lt;p&gt;很遗憾 &lt;code&gt;fetch&lt;/code&gt; 不支持给上传请求提供进度信息，所以不得不使用更加古典的 &lt;code&gt;xhr&lt;/code&gt; 请求：&lt;/p&gt;
&lt;div class="sourceCode" id="cb4"&gt;&lt;pre class="sourceCode typescript"&gt;&lt;code class="sourceCode typescript"&gt;&lt;span id="cb4-1"&gt;&lt;a aria-hidden="true" href="#cb4-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;const&lt;/span&gt; xhr &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="kw"&gt;new&lt;/span&gt; &lt;span class="bu"&gt;XMLHttpRequest&lt;/span&gt;()&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb4-2"&gt;&lt;a aria-hidden="true" href="#cb4-2" tabindex="-1"&gt;&lt;/a&gt;xhr&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;open&lt;/span&gt;(&lt;span class="st"&gt;"POST"&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt; &lt;span class="vs"&gt;`URL`&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt; &lt;span class="kw"&gt;true&lt;/span&gt;)&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb4-3"&gt;&lt;a aria-hidden="true" href="#cb4-3" tabindex="-1"&gt;&lt;/a&gt;xhr&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="at"&gt;withCredentials&lt;/span&gt; &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="kw"&gt;true&lt;/span&gt;&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb4-4"&gt;&lt;a aria-hidden="true" href="#cb4-4" tabindex="-1"&gt;&lt;/a&gt;xhr&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="at"&gt;onreadystatechange&lt;/span&gt; &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="kw"&gt;function&lt;/span&gt; () {&lt;/span&gt;
&lt;span id="cb4-5"&gt;&lt;a aria-hidden="true" href="#cb4-5" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="cf"&gt;if&lt;/span&gt; (xhr&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="at"&gt;readyState&lt;/span&gt; &lt;span class="op"&gt;==&lt;/span&gt; &lt;span class="dv"&gt;4&lt;/span&gt; &lt;span class="op"&gt;&amp;amp;&amp;amp;&lt;/span&gt; xhr&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="at"&gt;status&lt;/span&gt; &lt;span class="op"&gt;==&lt;/span&gt; &lt;span class="dv"&gt;200&lt;/span&gt;) {&lt;/span&gt;
&lt;span id="cb4-6"&gt;&lt;a aria-hidden="true" href="#cb4-6" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="co"&gt;// OK&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb4-7"&gt;&lt;a aria-hidden="true" href="#cb4-7" tabindex="-1"&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id="cb4-8"&gt;&lt;a aria-hidden="true" href="#cb4-8" tabindex="-1"&gt;&lt;/a&gt;}&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb4-9"&gt;&lt;a aria-hidden="true" href="#cb4-9" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb4-10"&gt;&lt;a aria-hidden="true" href="#cb4-10" tabindex="-1"&gt;&lt;/a&gt;xhr&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="at"&gt;onerror&lt;/span&gt; &lt;span class="op"&gt;=&lt;/span&gt; (e) &lt;span class="kw"&gt;=&amp;gt;&lt;/span&gt; {&lt;/span&gt;
&lt;span id="cb4-11"&gt;&lt;a aria-hidden="true" href="#cb4-11" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="co"&gt;// Error&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb4-12"&gt;&lt;a aria-hidden="true" href="#cb4-12" tabindex="-1"&gt;&lt;/a&gt;}&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb4-13"&gt;&lt;a aria-hidden="true" href="#cb4-13" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb4-14"&gt;&lt;a aria-hidden="true" href="#cb4-14" tabindex="-1"&gt;&lt;/a&gt;xhr&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="at"&gt;upload&lt;/span&gt;&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="at"&gt;onprogress&lt;/span&gt; &lt;span class="op"&gt;=&lt;/span&gt; (e) &lt;span class="kw"&gt;=&amp;gt;&lt;/span&gt; {&lt;/span&gt;
&lt;span id="cb4-15"&gt;&lt;a aria-hidden="true" href="#cb4-15" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="cf"&gt;if&lt;/span&gt; (e&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="at"&gt;lengthComputable&lt;/span&gt;) {&lt;/span&gt;
&lt;span id="cb4-16"&gt;&lt;a aria-hidden="true" href="#cb4-16" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="co"&gt;/*&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb4-17"&gt;&lt;a aria-hidden="true" href="#cb4-17" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="co"&gt;        * 获得总大小 ： e.total&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb4-18"&gt;&lt;a aria-hidden="true" href="#cb4-18" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="co"&gt;        * 获取上传了的大小 ： e.loaded&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb4-19"&gt;&lt;a aria-hidden="true" href="#cb4-19" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="co"&gt;        */&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb4-20"&gt;&lt;a aria-hidden="true" href="#cb4-20" tabindex="-1"&gt;&lt;/a&gt;        hint &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="vs"&gt;`总量：&lt;/span&gt;&lt;span class="sc"&gt;${&lt;/span&gt;Utils&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;formatBytes&lt;/span&gt;(&lt;/span&gt;
&lt;span id="cb4-21"&gt;&lt;a aria-hidden="true" href="#cb4-21" tabindex="-1"&gt;&lt;/a&gt;            e&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="at"&gt;total&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb4-22"&gt;&lt;a aria-hidden="true" href="#cb4-22" tabindex="-1"&gt;&lt;/a&gt;        )&lt;span class="sc"&gt;}&lt;/span&gt;&lt;span class="vs"&gt; 上传：&lt;/span&gt;&lt;span class="sc"&gt;${&lt;/span&gt;Utils&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;formatBytes&lt;/span&gt;(e&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="at"&gt;loaded&lt;/span&gt;)&lt;span class="sc"&gt;}&lt;/span&gt;&lt;span class="vs"&gt; &lt;/span&gt;&lt;span class="sc"&gt;${&lt;/span&gt;(&lt;/span&gt;
&lt;span id="cb4-23"&gt;&lt;a aria-hidden="true" href="#cb4-23" tabindex="-1"&gt;&lt;/a&gt;            (e&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="at"&gt;loaded&lt;/span&gt; &lt;span class="op"&gt;/&lt;/span&gt; e&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="at"&gt;total&lt;/span&gt;) &lt;span class="op"&gt;*&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb4-24"&gt;&lt;a aria-hidden="true" href="#cb4-24" tabindex="-1"&gt;&lt;/a&gt;            &lt;span class="dv"&gt;100&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb4-25"&gt;&lt;a aria-hidden="true" href="#cb4-25" tabindex="-1"&gt;&lt;/a&gt;        )&lt;/span&gt;
&lt;span id="cb4-26"&gt;&lt;a aria-hidden="true" href="#cb4-26" tabindex="-1"&gt;&lt;/a&gt;            &lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;toString&lt;/span&gt;()&lt;/span&gt;
&lt;span id="cb4-27"&gt;&lt;a aria-hidden="true" href="#cb4-27" tabindex="-1"&gt;&lt;/a&gt;            &lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;substring&lt;/span&gt;(&lt;span class="dv"&gt;0&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt; &lt;span class="dv"&gt;4&lt;/span&gt;)&lt;span class="sc"&gt;}&lt;/span&gt;&lt;span class="vs"&gt; %`&lt;/span&gt;&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb4-28"&gt;&lt;a aria-hidden="true" href="#cb4-28" tabindex="-1"&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id="cb4-29"&gt;&lt;a aria-hidden="true" href="#cb4-29" tabindex="-1"&gt;&lt;/a&gt;}&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb4-30"&gt;&lt;a aria-hidden="true" href="#cb4-30" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb4-31"&gt;&lt;a aria-hidden="true" href="#cb4-31" tabindex="-1"&gt;&lt;/a&gt;xhr&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;send&lt;/span&gt;(finalForm)&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;strong&gt;注意是 &lt;code&gt;xhr.upload.onprogress&lt;/code&gt; 而不是 &lt;code&gt;xhr.onprogress&lt;/code&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;h1 id="参考"&gt;参考&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;可显示进度的 &lt;code&gt;Fetch&lt;/code&gt; 示例：&lt;a href="https://fetch-progress.anthum.com/fetch-basic/"&gt;Basic Fetch() Progress Indicator&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;ReadableStream &lt;a href="%5BReadableStream%20-%20Web%20API%20接口参考%20%7C%20MDN%5D(https://developer.mozilla.org/zh-CN/docs/Web/API/ReadableStream)"&gt;ReadableStream&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;br/&gt;
&lt;!--%%REF%%--&gt;
&lt;br/&gt;
&lt;script async="" crossorigin="anonymous" data-category="Announcements" data-category-id="DIC_kwDOJ7Ymy84CX4eg" data-emit-metadata="0" data-input-position="top" data-lang="zh-CN" data-loading="lazy" data-mapping="title" data-reactions-enabled="1" data-repo="izfsk-ium/izfsk-ium.github.io" data-repo-id="R_kgDOJ7Ymyw" data-strict="0" data-theme="preferred_color_scheme" src="https://giscus.app/client.js"&gt;
&lt;/script&gt;
&lt;/main&gt;
&lt;footer&gt;
&lt;p class="signoff"&gt;
&lt;div class="metadata"&gt;
&lt;p class="date"&gt;&lt;time datetime="2023-03-02"&gt;创建日期：2023-03-02&lt;/time&gt;&lt;/p&gt;
&lt;p class="lastmodify"&gt;&lt;time&gt;最后编译：2023-08-10&lt;/time&gt;&lt;/p&gt;
&lt;p class="lastmodify" id="counter-span"&gt;访问次数：&lt;/p&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;/footer&gt;
&lt;script&gt;
    /* These script should run after page load */
    document.querySelectorAll('code.sourceCode').forEach(
      i =&gt; i.insertAdjacentHTML('beforeend', '&lt;div class="copy"&gt;复制&lt;/div&gt;')
    );
    document.querySelectorAll('div.copy').forEach(
      i =&gt; i.addEventListener(
        'click',
        () =&gt; {
          navigator.clipboard.writeText(i.parentElement.innerText.replace('复制', ''));
          i.innerText = '成功';
          setTimeout(() =&gt; {
            i.innerText = '复制';
          }, 1000);
        }
      )
    );

    if (location.href.includes("127.0.0.1:8080")) {
      document.getElementById("counter-span").innerHTML = "[[development mode]]";
    } else {
      const uuid = document.getElementById("article-uuid").innerText;
      const target = document.getElementById("counter-span");
      const last = localStorage.getItem("lastVisit-" + uuid);
      const shouldIncrease = last === null || new Date().getTime() - parseInt(last) &gt;= (1000 * 60 * 15);

      fetch(shouldIncrease ? ("https://counter.izfsk.top/counter/" + uuid) : ("https://counter.izfsk.top/readOnly/" + uuid))
        .then(r =&gt; r.text())
        .then(d =&gt; {
          if (!d.startsWith("Too"))
            document.getElementById("counter-span").innerText = "访问次数：" + d.toString();
          else
            document.getElementById("counter-span").innerHTML = "";
        });

      localStorage.setItem("lastVisit-" + uuid, new Date().getTime());
    }
  &lt;/script&gt;
&lt;script async="" data-website-id="2a1146ab-fa82-4a84-a04f-30e5967357c3" src="https://analytics.umami.is/script.js"&gt;&lt;/script&gt;
&lt;/body&gt;</content:encoded>
      <guid isPermaLink="false">3f650bd0-bdbb-4ac4-a2a6-5c62da3749dd</guid>
      <pubDate>Thu, 02 Mar 2023 00:00:00 +0800</pubDate>
    </item>
    <item>
      <title>编译安装ApacheServer</title>
      <link>https://blog.izfsk.top/articles/编译安装ApacheServer.html</link>
      <description>编译安装ApacheServer</description>
      <content:encoded>&lt;body&gt;
&lt;progress id="content_progress" value="0"&gt;&lt;/progress&gt;
&lt;button id="back-to-top"&gt;
    回页顶
  &lt;/button&gt;
&lt;header&gt;
&lt;small id="article-uuid" style="display: none !important;"&gt;1a6ce92c-d5be-4fdb-a324-fa03d0dd6e93&lt;/small&gt;
&lt;h1 class="title"&gt;编译安装ApacheServer&lt;/h1&gt;
&lt;!-- Subtitle --&gt;
&lt;h3 class="subtitle"&gt; &lt;/h3&gt;
&lt;/header&gt;
&lt;nav id="TOC" role="doc-toc"&gt;
&lt;strong&gt;文章归类: &lt;a href="/pages/category.html#备忘录"&gt;备忘录&lt;/a&gt; &lt;/strong&gt;
&lt;input id="contents" type="checkbox"/&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#再次编译升级" id="toc-再次编译升级"&gt;再次编译升级&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#所以-ibm-为什么知道-apache-的版本" id="toc-所以-ibm-为什么知道-apache-的版本"&gt;所以 IBM 为什么知道 Apache 的版本&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#后续" id="toc-后续"&gt;后续&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#参考" id="toc-参考"&gt;参考&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#reference"&gt;参考链接&lt;/a&gt;&lt;/li&gt;
&lt;li&gt; &lt;/li&gt;
&lt;li class="tools"&gt;
&lt;span id="backtomain"&gt;
&lt;svg class="bi bi-house" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M8.707 1.5a1 1 0 0 0-1.414 0L.646 8.146a.5.5 0 0 0 .708.708L2 8.207V13.5A1.5 1.5 0 0 0 3.5 15h9a1.5 1.5 0 0 0 1.5-1.5V8.207l.646.647a.5.5 0 0 0 .708-.708L13 5.793V2.5a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v1.293L8.707 1.5ZM13 7.207V13.5a.5.5 0 0 1-.5.5h-9a.5.5 0 0 1-.5-.5V7.207l5-5 5 5Z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="readingmode"&gt;
&lt;svg class="bi bi-book" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M1 2.828c.885-.37 2.154-.769 3.388-.893 1.33-.134 2.458.063 3.112.752v9.746c-.935-.53-2.12-.603-3.213-.493-1.18.12-2.37.461-3.287.811V2.828zm7.5-.141c.654-.689 1.782-.886 3.112-.752 1.234.124 2.503.523 3.388.893v9.923c-.918-.35-2.107-.692-3.287-.81-1.094-.111-2.278-.039-3.213.492V2.687zM8 1.783C7.015.936 5.587.81 4.287.94c-1.514.153-3.042.672-3.994 1.105A.5.5 0 0 0 0 2.5v11a.5.5 0 0 0 .707.455c.882-.4 2.303-.881 3.68-1.02 1.409-.142 2.59.087 3.223.877a.5.5 0 0 0 .78 0c.633-.79 1.814-1.019 3.222-.877 1.378.139 2.8.62 3.681 1.02A.5.5 0 0 0 16 13.5v-11a.5.5 0 0 0-.293-.455c-.952-.433-2.48-.952-3.994-1.105C10.413.809 8.985.936 8 1.783z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="larger"&gt; &lt;/span&gt;
&lt;span id="smaller"&gt;&lt;/span&gt;
&lt;span id="switchfont"&gt;
&lt;svg class="bi bi-fonts" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M12.258 3h-8.51l-.083 2.46h.479c.26-1.544.758-1.783 2.693-1.845l.424-.013v7.827c0 .663-.144.82-1.3.923v.52h4.082v-.52c-1.162-.103-1.306-.26-1.306-.923V3.602l.431.013c1.934.062 2.434.301 2.693 1.846h.479L12.258 3z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="backtotop"&gt;
&lt;svg class="bi bi-arrow-bar-up" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M8 10a.5.5 0 0 0 .5-.5V3.707l2.146 2.147a.5.5 0 0 0 .708-.708l-3-3a.5.5 0 0 0-.708 0l-3 3a.5.5 0 1 0 .708.708L7.5 3.707V9.5a.5.5 0 0 0 .5.5zm-7 2.5a.5.5 0 0 1 .5-.5h13a.5.5 0 0 1 0 1h-13a.5.5 0 0 1-.5-.5z" fill-rule="evenodd"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/nav&gt;
&lt;main&gt;
&lt;p&gt;早上收到 linuxOne 的邮件：&lt;/p&gt;
&lt;figure&gt;
&lt;img alt="和蔼的恐吓(bushi)" src="assets/vl.webp"/&gt;
&lt;figcaption aria-hidden="true"&gt;和蔼的恐吓(bushi)&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;一开始受宠若惊，毕竟这样就某个软件的漏洞专门发邮提醒的服务商不多见，仔细一看人家是 kindly ask you to correct all the ones listed below within 5 days…… 好吧，那看来我不在 5 天内修复那我就要寄，白嫖党可没什么好硬气的，人家都警告的 Your access will be revoked for any non-compliance.&lt;/p&gt;
&lt;p&gt;本来以为是 &lt;code&gt;apt update &amp;amp;&amp;amp; apt upgrade&lt;/code&gt; 一波，但是软件源里面的 apache 版本只到 2.4.52，只能自己编译安装了。&lt;/p&gt;
&lt;p&gt;整个依赖链条是这样的：&lt;/p&gt;
&lt;pre class="shell"&gt;&lt;code&gt;            /----&amp;gt; PCRE2 (Perl Compatible Regular Expressions 2)
Apache2 ---|
            \----&amp;gt; Apache Portable Runtime (APR) ----&amp;gt; libxml2&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;所以需要单独编译安装它们。&lt;/p&gt;
&lt;p&gt;一图以蔽之：&lt;/p&gt;
&lt;p&gt;&lt;img src="./assets/quick.webp"/&gt;&lt;/p&gt;
&lt;ol start="0" type="1"&gt;
&lt;li&gt;&lt;p&gt;首先：&lt;strong&gt;卸载原来的 apache2&lt;/strong&gt;，使用 &lt;code&gt;sudo apt purge apache2 &amp;amp;&amp;amp; sudo apt autoremove&lt;/code&gt; 因为自己编译安装的 apache 不使用 /etc 里面的配置文件。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;安装编译器集合&lt;/p&gt;
&lt;p&gt;&lt;code&gt;sudo apt install build-essential&lt;/code&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;安装 &lt;code&gt;apr&lt;/code&gt;&lt;/p&gt;
&lt;div class="sourceCode" id="cb2"&gt;&lt;pre class="sourceCode bash"&gt;&lt;code class="sourceCode bash"&gt;&lt;span id="cb2-1"&gt;&lt;a aria-hidden="true" href="#cb2-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="fu"&gt;git&lt;/span&gt; clone https://github.com/apache/apr&lt;/span&gt;
&lt;span id="cb2-2"&gt;&lt;a aria-hidden="true" href="#cb2-2" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="bu"&gt;cd&lt;/span&gt; apr&lt;/span&gt;
&lt;span id="cb2-3"&gt;&lt;a aria-hidden="true" href="#cb2-3" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="ex"&gt;./buildconf&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-4"&gt;&lt;a aria-hidden="true" href="#cb2-4" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="ex"&gt;./configure&lt;/span&gt; &lt;span class="at"&gt;--with-libxml2&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;注意它需要 &lt;code&gt;libxml2&lt;/code&gt; 但是软件源里面安装的 &lt;code&gt;libxml2-dev&lt;/code&gt; 需要手动软链接一下：&lt;/p&gt;
&lt;div class="sourceCode" id="cb3"&gt;&lt;pre class="sourceCode bash"&gt;&lt;code class="sourceCode bash"&gt;&lt;span id="cb3-1"&gt;&lt;a aria-hidden="true" href="#cb3-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="fu"&gt;sudo&lt;/span&gt; ln &lt;span class="at"&gt;-s&lt;/span&gt; /usr/include/libxml2/libxml /usr/include/libxml&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;接下来再&lt;/p&gt;
&lt;div class="sourceCode" id="cb4"&gt;&lt;pre class="sourceCode bash"&gt;&lt;code class="sourceCode bash"&gt;&lt;span id="cb4-1"&gt;&lt;a aria-hidden="true" href="#cb4-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="fu"&gt;make&lt;/span&gt; &lt;span class="at"&gt;-j8&lt;/span&gt; &lt;span class="kw"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="fu"&gt;make&lt;/span&gt; install&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;安装 &lt;code&gt;pcre&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;替换为最新的版本！&lt;/strong&gt;&lt;/p&gt;
&lt;div class="sourceCode" id="cb5"&gt;&lt;pre class="sourceCode bash"&gt;&lt;code class="sourceCode bash"&gt;&lt;span id="cb5-1"&gt;&lt;a aria-hidden="true" href="#cb5-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="fu"&gt;wget&lt;/span&gt; https://github.com/PCRE2Project/pcre2/releases/download/pcre2-10.42/pcre2-10.42.tar.bz2&lt;/span&gt;
&lt;span id="cb5-2"&gt;&lt;a aria-hidden="true" href="#cb5-2" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="fu"&gt;tar&lt;/span&gt; &lt;span class="at"&gt;-xvf&lt;/span&gt; pcre2-10.42.tar.bz2&lt;/span&gt;
&lt;span id="cb5-3"&gt;&lt;a aria-hidden="true" href="#cb5-3" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="bu"&gt;cd&lt;/span&gt; pcre2-10.42/&lt;/span&gt;
&lt;span id="cb5-4"&gt;&lt;a aria-hidden="true" href="#cb5-4" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="ex"&gt;./configure&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb5-5"&gt;&lt;a aria-hidden="true" href="#cb5-5" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="fu"&gt;make&lt;/span&gt; &lt;span class="at"&gt;-j8&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb5-6"&gt;&lt;a aria-hidden="true" href="#cb5-6" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="fu"&gt;sudo&lt;/span&gt; make install&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;安装 &lt;code&gt;apache2&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;寻找最新的版本：&lt;a href="http://httpd.apache.org/download.cgi"&gt;http://httpd.apache.org/download.cgi&lt;/a&gt;&lt;/p&gt;
&lt;div class="sourceCode" id="cb6"&gt;&lt;pre class="sourceCode bash"&gt;&lt;code class="sourceCode bash"&gt;&lt;span id="cb6-1"&gt;&lt;a aria-hidden="true" href="#cb6-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="fu"&gt;wget&lt;/span&gt; https://dlcdn.apache.org/httpd/httpd-2.4.55.tar.bz2&lt;/span&gt;
&lt;span id="cb6-2"&gt;&lt;a aria-hidden="true" href="#cb6-2" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="fu"&gt;tar&lt;/span&gt; &lt;span class="at"&gt;-xvf&lt;/span&gt; httpd-2.4.55.tar.bz2 &lt;/span&gt;
&lt;span id="cb6-3"&gt;&lt;a aria-hidden="true" href="#cb6-3" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="bu"&gt;cd&lt;/span&gt; httpd-2.4.55/&lt;/span&gt;
&lt;span id="cb6-4"&gt;&lt;a aria-hidden="true" href="#cb6-4" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="ex"&gt;./configure&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb6-5"&gt;&lt;a aria-hidden="true" href="#cb6-5" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="fu"&gt;make&lt;/span&gt; &lt;span class="at"&gt;-j8&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb6-6"&gt;&lt;a aria-hidden="true" href="#cb6-6" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="fu"&gt;sudo&lt;/span&gt; make install&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;配置文件位置：&lt;code&gt;/usr/local/apache2/conf&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;服务器控制：&lt;code&gt;/usr/local/apache2/bin/apachectl&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;所以启动服务器：&lt;code&gt;/usr/local/apache2/bin/apachectl -k restart&lt;/code&gt;&lt;/p&gt;
&lt;h2 id="再次编译升级"&gt;再次编译升级&lt;/h2&gt;
&lt;p&gt;在已安装服务器的构建目录中或旧安装的源代码树的根目录中找到文件 &lt;code&gt;config.nice&lt;/code&gt;。然后，将 &lt;code&gt;config.nice&lt;/code&gt; 文件复制到新版本的源代码树中，对其进行编辑以进行任何所需的更改，然后编译即可。&lt;/p&gt;
&lt;h1 id="所以-ibm-为什么知道-apache-的版本"&gt;所以 IBM 为什么知道 Apache 的版本&lt;/h1&gt;
&lt;p&gt;&lt;code&gt;top&lt;/code&gt; 一下，看见两个程序 &lt;code&gt;iucvconn&lt;/code&gt; &lt;code&gt;iucvserv&lt;/code&gt;，&lt;code&gt;strings&lt;/code&gt; 之看见不少 &lt;code&gt;z/VM&lt;/code&gt;，&lt;code&gt;Copyright IBM Corp&lt;/code&gt; 之类的字符串，看来就是它没错了。&lt;/p&gt;
&lt;p&gt;当然我还是不敢去掉它们，毕竟我也不知道这算不算 &lt;code&gt;non-compliance&lt;/code&gt;（&lt;/p&gt;
&lt;h1 id="后续"&gt;后续&lt;/h1&gt;
&lt;p&gt;服务器被收回了，悲……&lt;/p&gt;
&lt;h1 id="参考"&gt;参考&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://httpd.apache.org/docs/current/install.html"&gt;Apache - Compiling and Installing&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="http://pcre.org/current/doc/html/pcre2build.html"&gt;pcre2build man page&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;br/&gt;
&lt;!--%%REF%%--&gt;
&lt;br/&gt;
&lt;script async="" crossorigin="anonymous" data-category="Announcements" data-category-id="DIC_kwDOJ7Ymy84CX4eg" data-emit-metadata="0" data-input-position="top" data-lang="zh-CN" data-loading="lazy" data-mapping="title" data-reactions-enabled="1" data-repo="izfsk-ium/izfsk-ium.github.io" data-repo-id="R_kgDOJ7Ymyw" data-strict="0" data-theme="preferred_color_scheme" src="https://giscus.app/client.js"&gt;
&lt;/script&gt;
&lt;/main&gt;
&lt;footer&gt;
&lt;p class="signoff"&gt;
&lt;div class="metadata"&gt;
&lt;p class="date"&gt;&lt;time datetime="2023-03-04"&gt;创建日期：2023-03-04&lt;/time&gt;&lt;/p&gt;
&lt;p class="lastmodify"&gt;&lt;time&gt;最后编译：2023-08-10&lt;/time&gt;&lt;/p&gt;
&lt;p class="lastmodify" id="counter-span"&gt;访问次数：&lt;/p&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;/footer&gt;
&lt;script&gt;
    /* These script should run after page load */
    document.querySelectorAll('code.sourceCode').forEach(
      i =&gt; i.insertAdjacentHTML('beforeend', '&lt;div class="copy"&gt;复制&lt;/div&gt;')
    );
    document.querySelectorAll('div.copy').forEach(
      i =&gt; i.addEventListener(
        'click',
        () =&gt; {
          navigator.clipboard.writeText(i.parentElement.innerText.replace('复制', ''));
          i.innerText = '成功';
          setTimeout(() =&gt; {
            i.innerText = '复制';
          }, 1000);
        }
      )
    );

    if (location.href.includes("127.0.0.1:8080")) {
      document.getElementById("counter-span").innerHTML = "[[development mode]]";
    } else {
      const uuid = document.getElementById("article-uuid").innerText;
      const target = document.getElementById("counter-span");
      const last = localStorage.getItem("lastVisit-" + uuid);
      const shouldIncrease = last === null || new Date().getTime() - parseInt(last) &gt;= (1000 * 60 * 15);

      fetch(shouldIncrease ? ("https://counter.izfsk.top/counter/" + uuid) : ("https://counter.izfsk.top/readOnly/" + uuid))
        .then(r =&gt; r.text())
        .then(d =&gt; {
          if (!d.startsWith("Too"))
            document.getElementById("counter-span").innerText = "访问次数：" + d.toString();
          else
            document.getElementById("counter-span").innerHTML = "";
        });

      localStorage.setItem("lastVisit-" + uuid, new Date().getTime());
    }
  &lt;/script&gt;
&lt;script async="" data-website-id="2a1146ab-fa82-4a84-a04f-30e5967357c3" src="https://analytics.umami.is/script.js"&gt;&lt;/script&gt;
&lt;/body&gt;</content:encoded>
      <guid isPermaLink="false">1a6ce92c-d5be-4fdb-a324-fa03d0dd6e93</guid>
      <pubDate>Sat, 04 Mar 2023 00:00:00 +0800</pubDate>
    </item>
    <item>
      <title>给Apache2安装ModSecurity</title>
      <link>https://blog.izfsk.top/articles/给Apache2安装ModSecurity.html</link>
      <description>给Apache2安装ModSecurity</description>
      <content:encoded>&lt;body&gt;
&lt;progress id="content_progress" value="0"&gt;&lt;/progress&gt;
&lt;button id="back-to-top"&gt;
    回页顶
  &lt;/button&gt;
&lt;header&gt;
&lt;small id="article-uuid" style="display: none !important;"&gt;fa8435d4-54a4-4d3a-bb65-d26f913e009e&lt;/small&gt;
&lt;h1 class="title"&gt;给Apache2安装ModSecurity&lt;/h1&gt;
&lt;!-- Subtitle --&gt;
&lt;h3 class="subtitle"&gt; &lt;/h3&gt;
&lt;/header&gt;
&lt;main&gt;
&lt;p&gt;我想要禁止服务器发送 Server: Apache 的 Header，但是不能通过直接配置的方法实现，需要使用第三方模块来实现。也就是这个 ModSecurity。除了这个功能以外 ModSecurity 就像它的名字那样包含了大量的的安全加强功能。&lt;/p&gt;
&lt;p&gt;首先你需要安装一系列前置:编译器套件不用多说，在 SUSE 上还需要额外安装 gcc-c++ 。除此以外还有其他的前置需要安装，&lt;code&gt;zypper in libyajl libyajl-devel&lt;/code&gt; 即可。&lt;/p&gt;
&lt;p&gt;接下来编译安装 ModSecurity 主体：&lt;/p&gt;
&lt;div class="sourceCode" id="cb1"&gt;&lt;pre class="sourceCode bash"&gt;&lt;code class="sourceCode bash"&gt;&lt;span id="cb1-1"&gt;&lt;a aria-hidden="true" href="#cb1-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="fu"&gt;git&lt;/span&gt; clone https://github.com/SpiderLabs/ModSecurity&lt;/span&gt;
&lt;span id="cb1-2"&gt;&lt;a aria-hidden="true" href="#cb1-2" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="bu"&gt;cd&lt;/span&gt; ModSecurity/&lt;/span&gt;
&lt;span id="cb1-3"&gt;&lt;a aria-hidden="true" href="#cb1-3" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="fu"&gt;git&lt;/span&gt; submodule update&lt;/span&gt;
&lt;span id="cb1-4"&gt;&lt;a aria-hidden="true" href="#cb1-4" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="fu"&gt;git&lt;/span&gt; submodule init&lt;/span&gt;
&lt;span id="cb1-5"&gt;&lt;a aria-hidden="true" href="#cb1-5" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="ex"&gt;./build.sh&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-6"&gt;&lt;a aria-hidden="true" href="#cb1-6" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="fu"&gt;make&lt;/span&gt; &lt;span class="at"&gt;-j4&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-7"&gt;&lt;a aria-hidden="true" href="#cb1-7" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="fu"&gt;sudo&lt;/span&gt; make install&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;接下来手动拷贝一下模块文件：&lt;/p&gt;
&lt;div class="sourceCode" id="cb2"&gt;&lt;pre class="sourceCode bash"&gt;&lt;code class="sourceCode bash"&gt;&lt;span id="cb2-1"&gt;&lt;a aria-hidden="true" href="#cb2-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="fu"&gt;cp&lt;/span&gt; /usr/local/modsecurity/lib/libmodsecurity.so /usr/local/apache2/modules/&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;这样主体安装完成。&lt;strong&gt;对于 Apache 服务器还需要安装对应的连接器&lt;/strong&gt;：&lt;/p&gt;
&lt;div class="sourceCode" id="cb3"&gt;&lt;pre class="sourceCode bash"&gt;&lt;code class="sourceCode bash"&gt;&lt;span id="cb3-1"&gt;&lt;a aria-hidden="true" href="#cb3-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="ex"&gt;./configure&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb3-2"&gt;&lt;a aria-hidden="true" href="#cb3-2" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="ex"&gt;./autogen.sh&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb3-3"&gt;&lt;a aria-hidden="true" href="#cb3-3" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="bu"&gt;cd&lt;/span&gt; ModSecurity-apache/&lt;/span&gt;
&lt;span id="cb3-4"&gt;&lt;a aria-hidden="true" href="#cb3-4" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="fu"&gt;git&lt;/span&gt; clone https://github.com/SpiderLabs/ModSecurity-apache&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;如果提示找不到 &lt;code&gt;libmodsecurity&lt;/code&gt; 说明需要手动寻找一下安装位置。一般就是在 &lt;code&gt;/usr/local/&lt;/code&gt; 之中：&lt;/p&gt;
&lt;div class="sourceCode" id="cb4"&gt;&lt;pre class="sourceCode bash"&gt;&lt;code class="sourceCode bash"&gt;&lt;span id="cb4-1"&gt;&lt;a aria-hidden="true" href="#cb4-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="fu"&gt;make&lt;/span&gt; install&lt;/span&gt;
&lt;span id="cb4-2"&gt;&lt;a aria-hidden="true" href="#cb4-2" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="fu"&gt;make&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb4-3"&gt;&lt;a aria-hidden="true" href="#cb4-3" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="ex"&gt;./configure&lt;/span&gt; &lt;span class="at"&gt;--with-libmodsecurity&lt;/span&gt;&lt;span class="op"&gt;=&lt;/span&gt;/usr/local/modsecurity/&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;接下来开启模块：&lt;/p&gt;
&lt;pre class="conf"&gt;&lt;code&gt;LoadModule security3_module modules/mod_security3.so

modsecurity on&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;注意添加配置文件。日志里面可以看到这个：&lt;/p&gt;
&lt;p&gt;&lt;code&gt;[Fri Mar 10 08:54:55.965949 2023] [:notice] [pid 14761:tid 4396092952880] ModSecurity: ModSecurity-Apache v0.1.1-beta configured.&lt;/code&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://github.com/SpiderLabs/ModSecurity/"&gt;ModSecurity&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://github.com/SpiderLabs/ModSecurity/blob/v3/master/modsecurity.conf-recommended"&gt;默认配置&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;br/&gt;
&lt;!--%%REF%%--&gt;
&lt;br/&gt;
&lt;script async="" crossorigin="anonymous" data-category="Announcements" data-category-id="DIC_kwDOJ7Ymy84CX4eg" data-emit-metadata="0" data-input-position="top" data-lang="zh-CN" data-loading="lazy" data-mapping="title" data-reactions-enabled="1" data-repo="izfsk-ium/izfsk-ium.github.io" data-repo-id="R_kgDOJ7Ymyw" data-strict="0" data-theme="preferred_color_scheme" src="https://giscus.app/client.js"&gt;
&lt;/script&gt;
&lt;/main&gt;
&lt;footer&gt;
&lt;p class="signoff"&gt;
&lt;div class="metadata"&gt;
&lt;p class="date"&gt;&lt;time datetime="2023-03-10"&gt;创建日期：2023-03-10&lt;/time&gt;&lt;/p&gt;
&lt;p class="lastmodify"&gt;&lt;time&gt;最后编译：2023-08-10&lt;/time&gt;&lt;/p&gt;
&lt;p class="lastmodify" id="counter-span"&gt;访问次数：&lt;/p&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;/footer&gt;
&lt;script&gt;
    /* These script should run after page load */
    document.querySelectorAll('code.sourceCode').forEach(
      i =&gt; i.insertAdjacentHTML('beforeend', '&lt;div class="copy"&gt;复制&lt;/div&gt;')
    );
    document.querySelectorAll('div.copy').forEach(
      i =&gt; i.addEventListener(
        'click',
        () =&gt; {
          navigator.clipboard.writeText(i.parentElement.innerText.replace('复制', ''));
          i.innerText = '成功';
          setTimeout(() =&gt; {
            i.innerText = '复制';
          }, 1000);
        }
      )
    );

    if (location.href.includes("127.0.0.1:8080")) {
      document.getElementById("counter-span").innerHTML = "[[development mode]]";
    } else {
      const uuid = document.getElementById("article-uuid").innerText;
      const target = document.getElementById("counter-span");
      const last = localStorage.getItem("lastVisit-" + uuid);
      const shouldIncrease = last === null || new Date().getTime() - parseInt(last) &gt;= (1000 * 60 * 15);

      fetch(shouldIncrease ? ("https://counter.izfsk.top/counter/" + uuid) : ("https://counter.izfsk.top/readOnly/" + uuid))
        .then(r =&gt; r.text())
        .then(d =&gt; {
          if (!d.startsWith("Too"))
            document.getElementById("counter-span").innerText = "访问次数：" + d.toString();
          else
            document.getElementById("counter-span").innerHTML = "";
        });

      localStorage.setItem("lastVisit-" + uuid, new Date().getTime());
    }
  &lt;/script&gt;
&lt;script async="" data-website-id="2a1146ab-fa82-4a84-a04f-30e5967357c3" src="https://analytics.umami.is/script.js"&gt;&lt;/script&gt;
&lt;/body&gt;</content:encoded>
      <guid isPermaLink="false">fa8435d4-54a4-4d3a-bb65-d26f913e009e</guid>
      <pubDate>Fri, 10 Mar 2023 00:00:00 +0800</pubDate>
    </item>
    <item>
      <title>Adalang初探</title>
      <link>https://blog.izfsk.top/articles/Adalang初探.html</link>
      <description>Adalang初探</description>
      <content:encoded>&lt;body&gt;
&lt;progress id="content_progress" value="0"&gt;&lt;/progress&gt;
&lt;button id="back-to-top"&gt;
    回页顶
  &lt;/button&gt;
&lt;header&gt;
&lt;small id="article-uuid" style="display: none !important;"&gt;8f47beda-8cb7-4835-a463-a60e6ac2dcd5&lt;/small&gt;
&lt;h1 class="title"&gt;Adalang初探&lt;/h1&gt;
&lt;!-- Subtitle --&gt;
&lt;h3 class="subtitle"&gt; &lt;/h3&gt;
&lt;/header&gt;
&lt;nav id="TOC" role="doc-toc"&gt;
&lt;strong&gt;文章归类: &lt;a href="/pages/category.html#学习"&gt;学习&lt;/a&gt; &lt;/strong&gt;
&lt;input id="contents" type="checkbox"/&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#if" id="toc-if"&gt;If&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#case-switch" id="toc-case-switch"&gt;case (switch)&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#loop" id="toc-loop"&gt;loop&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#for" id="toc-for"&gt;for&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#异常处理" id="toc-异常处理"&gt;异常处理&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#multitasking" id="toc-multitasking"&gt;MultiTasking&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#参考" id="toc-参考"&gt;参考&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#reference"&gt;参考链接&lt;/a&gt;&lt;/li&gt;
&lt;li&gt; &lt;/li&gt;
&lt;li class="tools"&gt;
&lt;span id="backtomain"&gt;
&lt;svg class="bi bi-house" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M8.707 1.5a1 1 0 0 0-1.414 0L.646 8.146a.5.5 0 0 0 .708.708L2 8.207V13.5A1.5 1.5 0 0 0 3.5 15h9a1.5 1.5 0 0 0 1.5-1.5V8.207l.646.647a.5.5 0 0 0 .708-.708L13 5.793V2.5a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v1.293L8.707 1.5ZM13 7.207V13.5a.5.5 0 0 1-.5.5h-9a.5.5 0 0 1-.5-.5V7.207l5-5 5 5Z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="readingmode"&gt;
&lt;svg class="bi bi-book" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M1 2.828c.885-.37 2.154-.769 3.388-.893 1.33-.134 2.458.063 3.112.752v9.746c-.935-.53-2.12-.603-3.213-.493-1.18.12-2.37.461-3.287.811V2.828zm7.5-.141c.654-.689 1.782-.886 3.112-.752 1.234.124 2.503.523 3.388.893v9.923c-.918-.35-2.107-.692-3.287-.81-1.094-.111-2.278-.039-3.213.492V2.687zM8 1.783C7.015.936 5.587.81 4.287.94c-1.514.153-3.042.672-3.994 1.105A.5.5 0 0 0 0 2.5v11a.5.5 0 0 0 .707.455c.882-.4 2.303-.881 3.68-1.02 1.409-.142 2.59.087 3.223.877a.5.5 0 0 0 .78 0c.633-.79 1.814-1.019 3.222-.877 1.378.139 2.8.62 3.681 1.02A.5.5 0 0 0 16 13.5v-11a.5.5 0 0 0-.293-.455c-.952-.433-2.48-.952-3.994-1.105C10.413.809 8.985.936 8 1.783z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="larger"&gt; &lt;/span&gt;
&lt;span id="smaller"&gt;&lt;/span&gt;
&lt;span id="switchfont"&gt;
&lt;svg class="bi bi-fonts" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M12.258 3h-8.51l-.083 2.46h.479c.26-1.544.758-1.783 2.693-1.845l.424-.013v7.827c0 .663-.144.82-1.3.923v.52h4.082v-.52c-1.162-.103-1.306-.26-1.306-.923V3.602l.431.013c1.934.062 2.434.301 2.693 1.846h.479L12.258 3z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="backtotop"&gt;
&lt;svg class="bi bi-arrow-bar-up" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M8 10a.5.5 0 0 0 .5-.5V3.707l2.146 2.147a.5.5 0 0 0 .708-.708l-3-3a.5.5 0 0 0-.708 0l-3 3a.5.5 0 1 0 .708.708L7.5 3.707V9.5a.5.5 0 0 0 .5.5zm-7 2.5a.5.5 0 0 1 .5-.5h13a.5.5 0 0 1 0 1h-13a.5.5 0 0 1-.5-.5z" fill-rule="evenodd"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/nav&gt;
&lt;main&gt;
&lt;aside class="warning-draft"&gt;
&lt;span&gt;⚠️&lt;/span&gt;注意：本文章被标记为草稿！请谨慎对待其内容。 &lt;span&gt;⚠️&lt;/span&gt;
&lt;/aside&gt;
&lt;p&gt;学习 Ada 的原因无非是两个：一是好奇这个从来没有接触过的语言，二是想要尝试一个不同「风格」的语言。&lt;/p&gt;
&lt;p&gt;首先是要安装开发环境。Ada 语言是 GCC 编译器集合里面官方支持的。但光有编译器还不行，还需要工具链条，以及 IDE。具体的来讲就是：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;安装 GNAT：&lt;code&gt;sudo zypper in gcc-ada&lt;/code&gt;；&lt;/li&gt;
&lt;li&gt;安装 GPRBuild，Ada 的项目管理工具，需要在 OBS 里面下载：&lt;a href="https://build.opensuse.org/package/show/home:vibondare:devel:languages:Ada/gprbuild"&gt;The GPRBuild Ada/multilanguage build tool&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;创建和编译运行的简单示例：&lt;/p&gt;
&lt;ol type="1"&gt;
&lt;li&gt;&lt;p&gt;创建 gpr 项目文件：&lt;/p&gt;
&lt;div class="sourceCode" id="cb1"&gt;&lt;pre class="sourceCode ada"&gt;&lt;code class="sourceCode ada"&gt;&lt;span id="cb1-1"&gt;&lt;a aria-hidden="true" href="#cb1-1" tabindex="-1"&gt;&lt;/a&gt;project Default &lt;span class="kw"&gt;is&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-2"&gt;&lt;a aria-hidden="true" href="#cb1-2" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="kw"&gt;for&lt;/span&gt; Main &lt;span class="kw"&gt;use&lt;/span&gt; &lt;span class="op"&gt;(&lt;/span&gt;&lt;span class="st"&gt;"main.adb"&lt;/span&gt;&lt;span class="op"&gt;)&lt;/span&gt;;&lt;/span&gt;
&lt;span id="cb1-3"&gt;&lt;a aria-hidden="true" href="#cb1-3" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="kw"&gt;for&lt;/span&gt; Object_Dir &lt;span class="kw"&gt;use&lt;/span&gt; &lt;span class="st"&gt;"obj"&lt;/span&gt;;&lt;/span&gt;
&lt;span id="cb1-4"&gt;&lt;a aria-hidden="true" href="#cb1-4" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="kw"&gt;for&lt;/span&gt; Source_Dirs &lt;span class="kw"&gt;use&lt;/span&gt; &lt;span class="op"&gt;(&lt;/span&gt;&lt;span class="st"&gt;"src/**"&lt;/span&gt;&lt;span class="op"&gt;)&lt;/span&gt;;&lt;/span&gt;
&lt;span id="cb1-5"&gt;&lt;a aria-hidden="true" href="#cb1-5" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;end&lt;/span&gt; Default;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;创建源文件：&lt;/p&gt;
&lt;div class="sourceCode" id="cb2"&gt;&lt;pre class="sourceCode ada"&gt;&lt;code class="sourceCode ada"&gt;&lt;span id="cb2-1"&gt;&lt;a aria-hidden="true" href="#cb2-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="co"&gt;--- src/lib/hello.ads&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-2"&gt;&lt;a aria-hidden="true" href="#cb2-2" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;package&lt;/span&gt; hello &lt;span class="kw"&gt;is&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-3"&gt;&lt;a aria-hidden="true" href="#cb2-3" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="kw"&gt;procedure&lt;/span&gt; SayHello;&lt;/span&gt;
&lt;span id="cb2-4"&gt;&lt;a aria-hidden="true" href="#cb2-4" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;private&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-5"&gt;&lt;a aria-hidden="true" href="#cb2-5" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;end&lt;/span&gt; hello;&lt;/span&gt;
&lt;span id="cb2-6"&gt;&lt;a aria-hidden="true" href="#cb2-6" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb2-7"&gt;&lt;a aria-hidden="true" href="#cb2-7" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="co"&gt;--- src/lib.hello.adb&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-8"&gt;&lt;a aria-hidden="true" href="#cb2-8" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;with&lt;/span&gt; Ada&lt;span class="op"&gt;.&lt;/span&gt;Text_IO; &lt;span class="kw"&gt;use&lt;/span&gt; Ada&lt;span class="op"&gt;.&lt;/span&gt;Text_IO;&lt;/span&gt;
&lt;span id="cb2-9"&gt;&lt;a aria-hidden="true" href="#cb2-9" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;package&lt;/span&gt; &lt;span class="kw"&gt;body&lt;/span&gt; hello &lt;span class="kw"&gt;is&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-10"&gt;&lt;a aria-hidden="true" href="#cb2-10" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="kw"&gt;procedure&lt;/span&gt; SayHello &lt;span class="kw"&gt;is&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-11"&gt;&lt;a aria-hidden="true" href="#cb2-11" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="kw"&gt;begin&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-12"&gt;&lt;a aria-hidden="true" href="#cb2-12" tabindex="-1"&gt;&lt;/a&gt;        Put &lt;span class="op"&gt;(&lt;/span&gt;&lt;span class="st"&gt;"Hello!"&lt;/span&gt;&lt;span class="op"&gt;)&lt;/span&gt;;&lt;/span&gt;
&lt;span id="cb2-13"&gt;&lt;a aria-hidden="true" href="#cb2-13" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="kw"&gt;end&lt;/span&gt; SayHello;&lt;/span&gt;
&lt;span id="cb2-14"&gt;&lt;a aria-hidden="true" href="#cb2-14" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;end&lt;/span&gt; hello;&lt;/span&gt;
&lt;span id="cb2-15"&gt;&lt;a aria-hidden="true" href="#cb2-15" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb2-16"&gt;&lt;a aria-hidden="true" href="#cb2-16" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="co"&gt;--- src/main.adb&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-17"&gt;&lt;a aria-hidden="true" href="#cb2-17" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;with&lt;/span&gt; hello;&lt;/span&gt;
&lt;span id="cb2-18"&gt;&lt;a aria-hidden="true" href="#cb2-18" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb2-19"&gt;&lt;a aria-hidden="true" href="#cb2-19" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;procedure&lt;/span&gt; main &lt;span class="kw"&gt;is&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-20"&gt;&lt;a aria-hidden="true" href="#cb2-20" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;begin&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-21"&gt;&lt;a aria-hidden="true" href="#cb2-21" tabindex="-1"&gt;&lt;/a&gt;    hello&lt;span class="op"&gt;.&lt;/span&gt;SayHello;&lt;/span&gt;
&lt;span id="cb2-22"&gt;&lt;a aria-hidden="true" href="#cb2-22" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;end&lt;/span&gt; main;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;编译运行：&lt;/p&gt;
&lt;div class="sourceCode" id="cb3"&gt;&lt;pre class="sourceCode bash"&gt;&lt;code class="sourceCode bash"&gt;&lt;span id="cb3-1"&gt;&lt;a aria-hidden="true" href="#cb3-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="ex"&gt;gprbuild&lt;/span&gt; &lt;span class="kw"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="ex"&gt;./obj/main&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;可以看到相比于 C 系的大括号语言和 Python 系的游标卡尺语言，Ada 在语法上有明显的不同，举个例子：&lt;/p&gt;
&lt;div class="sourceCode" id="cb4"&gt;&lt;pre class="sourceCode ada"&gt;&lt;code class="sourceCode ada"&gt;&lt;span id="cb4-1"&gt;&lt;a aria-hidden="true" href="#cb4-1" tabindex="-1"&gt;&lt;/a&gt; &lt;span class="kw"&gt;with&lt;/span&gt; Ada&lt;span class="op"&gt;.&lt;/span&gt;Text_IO;                                       &lt;span class="co"&gt;--  1&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb4-2"&gt;&lt;a aria-hidden="true" href="#cb4-2" tabindex="-1"&gt;&lt;/a&gt; &lt;span class="kw"&gt;procedure&lt;/span&gt; Hello &lt;span class="kw"&gt;is&lt;/span&gt;                                      &lt;span class="co"&gt;--  2&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb4-3"&gt;&lt;a aria-hidden="true" href="#cb4-3" tabindex="-1"&gt;&lt;/a&gt; &lt;span class="kw"&gt;begin&lt;/span&gt;                                                   &lt;span class="co"&gt;--  3&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb4-4"&gt;&lt;a aria-hidden="true" href="#cb4-4" tabindex="-1"&gt;&lt;/a&gt;     Ada&lt;span class="op"&gt;.&lt;/span&gt;Text_IO&lt;span class="op"&gt;.&lt;/span&gt;Put &lt;span class="op"&gt;(&lt;/span&gt;&lt;span class="st"&gt;"Hello world!"&lt;/span&gt;&lt;span class="op"&gt;)&lt;/span&gt;;                   &lt;span class="co"&gt;--  4&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb4-5"&gt;&lt;a aria-hidden="true" href="#cb4-5" tabindex="-1"&gt;&lt;/a&gt;     Ada&lt;span class="op"&gt;.&lt;/span&gt;Text_IO&lt;span class="op"&gt;.&lt;/span&gt;New_Line;                               &lt;span class="co"&gt;--  5&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb4-6"&gt;&lt;a aria-hidden="true" href="#cb4-6" tabindex="-1"&gt;&lt;/a&gt; &lt;span class="kw"&gt;end&lt;/span&gt; Hello;                                              &lt;span class="co"&gt;--  6&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;首先，Ada 是&lt;strong&gt;严格区分「过程」和「函数」的&lt;/strong&gt;。函数&lt;strong&gt;必须&lt;/strong&gt;返回一个值，而过程不一定需要。我印象里面似乎只有 Pascal 这样干。Functions 和 Procedures 都是 &lt;code&gt;Subprograms&lt;/code&gt;。函数作为表达式的组成部分被调用，并返回一个值作为表达式的一部分，而过程就是「一组语句」。定义一个过程如下：&lt;/p&gt;
&lt;div class="sourceCode" id="cb5"&gt;&lt;pre class="sourceCode ada"&gt;&lt;code class="sourceCode ada"&gt;&lt;span id="cb5-1"&gt;&lt;a aria-hidden="true" href="#cb5-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;procedure&lt;/span&gt; 过程名 &lt;span class="op"&gt;(&lt;/span&gt;参数&lt;span class="op"&gt;)&lt;/span&gt; &lt;span class="kw"&gt;is&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb5-2"&gt;&lt;a aria-hidden="true" href="#cb5-2" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="co"&gt;--- 需要用到的变量等信息&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb5-3"&gt;&lt;a aria-hidden="true" href="#cb5-3" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;begin&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb5-4"&gt;&lt;a aria-hidden="true" href="#cb5-4" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="co"&gt;--- 过程体&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb5-5"&gt;&lt;a aria-hidden="true" href="#cb5-5" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;end&lt;/span&gt; 过程名;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;调用过程则是：&lt;code&gt;过程名 + 括号&lt;/code&gt;。比较奇特的是，如果过程没有参数，那么调用也不需要括号。所以直接调用 &lt;code&gt;New_Line&lt;/code&gt; 是换行，加一个括号调用 &lt;code&gt;New_Line(10)&lt;/code&gt; 则是 10 个空行：&lt;/p&gt;
&lt;div class="sourceCode" id="cb6"&gt;&lt;pre class="sourceCode ada"&gt;&lt;code class="sourceCode ada"&gt;&lt;span id="cb6-1"&gt;&lt;a aria-hidden="true" href="#cb6-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;with&lt;/span&gt; Ada&lt;span class="op"&gt;.&lt;/span&gt;Text_IO;         &lt;span class="kw"&gt;use&lt;/span&gt; Ada&lt;span class="op"&gt;.&lt;/span&gt;Text_IO;&lt;/span&gt;
&lt;span id="cb6-2"&gt;&lt;a aria-hidden="true" href="#cb6-2" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;with&lt;/span&gt; Ada&lt;span class="op"&gt;.&lt;/span&gt;Integer_Text_IO; &lt;span class="kw"&gt;use&lt;/span&gt; Ada&lt;span class="op"&gt;.&lt;/span&gt;Integer_Text_IO;&lt;/span&gt;
&lt;span id="cb6-3"&gt;&lt;a aria-hidden="true" href="#cb6-3" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="co"&gt;--- hello&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb6-4"&gt;&lt;a aria-hidden="true" href="#cb6-4" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;package&lt;/span&gt; &lt;span class="kw"&gt;body&lt;/span&gt; hello &lt;span class="kw"&gt;is&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb6-5"&gt;&lt;a aria-hidden="true" href="#cb6-5" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="kw"&gt;procedure&lt;/span&gt; SayHello &lt;span class="op"&gt;(&lt;/span&gt;Name &lt;span class="op"&gt;:&lt;/span&gt; &lt;span class="kw"&gt;in&lt;/span&gt; &lt;span class="dt"&gt;String&lt;/span&gt; &lt;span class="op"&gt;:=&lt;/span&gt; &lt;span class="st"&gt;"Someone"&lt;/span&gt;&lt;span class="op"&gt;)&lt;/span&gt; &lt;/span&gt;
&lt;span id="cb6-6"&gt;&lt;a aria-hidden="true" href="#cb6-6" tabindex="-1"&gt;&lt;/a&gt;        LengthOfName &lt;span class="op"&gt;:&lt;/span&gt; &lt;span class="dt"&gt;Integer&lt;/span&gt; &lt;span class="op"&gt;:=&lt;/span&gt; Name'Length;&lt;/span&gt;
&lt;span id="cb6-7"&gt;&lt;a aria-hidden="true" href="#cb6-7" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="kw"&gt;begin&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb6-8"&gt;&lt;a aria-hidden="true" href="#cb6-8" tabindex="-1"&gt;&lt;/a&gt;        Put &lt;span class="op"&gt;(&lt;/span&gt;&lt;span class="st"&gt;"Hello! "&lt;/span&gt;&lt;span class="op"&gt;)&lt;/span&gt;;&lt;/span&gt;
&lt;span id="cb6-9"&gt;&lt;a aria-hidden="true" href="#cb6-9" tabindex="-1"&gt;&lt;/a&gt;        Put &lt;span class="op"&gt;(&lt;/span&gt;Name&lt;span class="op"&gt;)&lt;/span&gt;;&lt;/span&gt;
&lt;span id="cb6-10"&gt;&lt;a aria-hidden="true" href="#cb6-10" tabindex="-1"&gt;&lt;/a&gt;        Put &lt;span class="op"&gt;(&lt;/span&gt;LengthOfName&lt;span class="op"&gt;)&lt;/span&gt;;&lt;/span&gt;
&lt;span id="cb6-11"&gt;&lt;a aria-hidden="true" href="#cb6-11" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="kw"&gt;end&lt;/span&gt; SayHello;&lt;/span&gt;
&lt;span id="cb6-12"&gt;&lt;a aria-hidden="true" href="#cb6-12" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;end&lt;/span&gt; hello;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;这里还有几个点：首先是过程的参数有 &lt;code&gt;in&lt;/code&gt; 和 &lt;code&gt;out&lt;/code&gt; 两种，&lt;code&gt;in&lt;/code&gt; 关键字表示参数在过程中是只读的，这意味着过程可以访问参数的值但不能修改它。&lt;code&gt;out&lt;/code&gt; 关键字表示参数在过程中是只写的，这意味着过程可以修改参数的值但不能读取其原始值；其次获取一个对象的属性是使用 &lt;code&gt;'&lt;/code&gt; 符号而不是其他语言的 &lt;code&gt;.&lt;/code&gt; 表示方法，所以获取字符串的长度就变成了 &lt;code&gt;Name'Length&lt;/code&gt;；再者，给一个变量赋值是使用 &lt;code&gt;:=&lt;/code&gt; 符号而非 &lt;code&gt;=&lt;/code&gt; 符号、指明类型（Ada 是强类型语言，必须指明类型）是使用 &lt;code&gt;:&lt;/code&gt;，这一点倒是和 Typescript 一致，最后，注释使用 &lt;code&gt;---&lt;/code&gt; 符号。所以可以很方便的框一个大框出来（&lt;/p&gt;
&lt;p&gt;另外，Ada 中的定义变量&lt;strong&gt;必须&lt;/strong&gt;在 begin 之前。&lt;/p&gt;
&lt;p&gt;调用：&lt;/p&gt;
&lt;div class="sourceCode" id="cb7"&gt;&lt;pre class="sourceCode ada"&gt;&lt;code class="sourceCode ada"&gt;&lt;span id="cb7-1"&gt;&lt;a aria-hidden="true" href="#cb7-1" tabindex="-1"&gt;&lt;/a&gt;hello&lt;span class="op"&gt;.&lt;/span&gt;SayHello &lt;span class="op"&gt;(&lt;/span&gt;&lt;span class="st"&gt;"izfsk"&lt;/span&gt;&lt;span class="op"&gt;)&lt;/span&gt;;   &lt;span class="co"&gt;--- 直接调用&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb7-2"&gt;&lt;a aria-hidden="true" href="#cb7-2" tabindex="-1"&gt;&lt;/a&gt;hello&lt;span class="op"&gt;.&lt;/span&gt;SayHello &lt;span class="op"&gt;(&lt;/span&gt;Name &lt;span class="op"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="st"&gt;"izfsk"&lt;/span&gt;&lt;span class="op"&gt;)&lt;/span&gt;;   &lt;span class="co"&gt;--- 按照名字调用&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb7-3"&gt;&lt;a aria-hidden="true" href="#cb7-3" tabindex="-1"&gt;&lt;/a&gt;hello&lt;span class="op"&gt;.&lt;/span&gt;SayHello; &lt;span class="co"&gt;--- 默认&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;相比之下，定义一个函数是这样的，必须要指明返回类型。调用方法和过程类似。&lt;/p&gt;
&lt;div class="sourceCode" id="cb8"&gt;&lt;pre class="sourceCode ada"&gt;&lt;code class="sourceCode ada"&gt;&lt;span id="cb8-1"&gt;&lt;a aria-hidden="true" href="#cb8-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;function&lt;/span&gt; add &lt;span class="op"&gt;(&lt;/span&gt;a &lt;span class="op"&gt;:&lt;/span&gt; &lt;span class="dt"&gt;Integer&lt;/span&gt; &lt;span class="op"&gt;:=&lt;/span&gt; &lt;span class="dv"&gt;10&lt;/span&gt;; b &lt;span class="op"&gt;:&lt;/span&gt; &lt;span class="dt"&gt;Integer&lt;/span&gt; &lt;span class="op"&gt;:=&lt;/span&gt; &lt;span class="dv"&gt;20&lt;/span&gt;&lt;span class="op"&gt;)&lt;/span&gt; &lt;span class="kw"&gt;return&lt;/span&gt; &lt;span class="dt"&gt;Integer&lt;/span&gt; &lt;span class="kw"&gt;is&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb8-2"&gt;&lt;a aria-hidden="true" href="#cb8-2" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;begin&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb8-3"&gt;&lt;a aria-hidden="true" href="#cb8-3" tabindex="-1"&gt;&lt;/a&gt;  &lt;span class="kw"&gt;return&lt;/span&gt; a &lt;span class="op"&gt;+&lt;/span&gt; b;&lt;/span&gt;
&lt;span id="cb8-4"&gt;&lt;a aria-hidden="true" href="#cb8-4" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;end&lt;/span&gt; add;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;接下来是喜闻乐见的基本 statements 环节，举例说明：&lt;/p&gt;
&lt;h2 id="if"&gt;If&lt;/h2&gt;
&lt;div class="sourceCode" id="cb9"&gt;&lt;pre class="sourceCode ada"&gt;&lt;code class="sourceCode ada"&gt;&lt;span id="cb9-1"&gt;&lt;a aria-hidden="true" href="#cb9-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="co"&gt;-- Example 1: using multiple conditions in if statement&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb9-2"&gt;&lt;a aria-hidden="true" href="#cb9-2" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;if&lt;/span&gt; A &lt;span class="op"&gt;&amp;gt;&lt;/span&gt; &lt;span class="dv"&gt;0&lt;/span&gt; &lt;span class="kw"&gt;and&lt;/span&gt; &lt;span class="kw"&gt;then&lt;/span&gt; B &lt;span class="op"&gt;&amp;lt;&lt;/span&gt; &lt;span class="dv"&gt;30&lt;/span&gt; &lt;span class="kw"&gt;then&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb9-3"&gt;&lt;a aria-hidden="true" href="#cb9-3" tabindex="-1"&gt;&lt;/a&gt;   Put_Line&lt;span class="op"&gt;(&lt;/span&gt;&lt;span class="st"&gt;"A is greater than 0 and B is less than 30."&lt;/span&gt;&lt;span class="op"&gt;)&lt;/span&gt;;&lt;/span&gt;
&lt;span id="cb9-4"&gt;&lt;a aria-hidden="true" href="#cb9-4" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;end if&lt;/span&gt;;&lt;/span&gt;
&lt;span id="cb9-5"&gt;&lt;a aria-hidden="true" href="#cb9-5" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb9-6"&gt;&lt;a aria-hidden="true" href="#cb9-6" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="co"&gt;-- Example 2: using if statement with elsif and else clauses&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb9-7"&gt;&lt;a aria-hidden="true" href="#cb9-7" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;if&lt;/span&gt; A &lt;span class="op"&gt;&amp;gt;&lt;/span&gt; B &lt;span class="kw"&gt;then&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb9-8"&gt;&lt;a aria-hidden="true" href="#cb9-8" tabindex="-1"&gt;&lt;/a&gt;   Put_Line&lt;span class="op"&gt;(&lt;/span&gt;&lt;span class="st"&gt;"A is greater than B."&lt;/span&gt;&lt;span class="op"&gt;)&lt;/span&gt;;&lt;/span&gt;
&lt;span id="cb9-9"&gt;&lt;a aria-hidden="true" href="#cb9-9" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;elsif&lt;/span&gt; A &lt;span class="op"&gt;&amp;lt;&lt;/span&gt; B &lt;span class="kw"&gt;then&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb9-10"&gt;&lt;a aria-hidden="true" href="#cb9-10" tabindex="-1"&gt;&lt;/a&gt;   Put_Line&lt;span class="op"&gt;(&lt;/span&gt;&lt;span class="st"&gt;"A is less than B."&lt;/span&gt;&lt;span class="op"&gt;)&lt;/span&gt;;&lt;/span&gt;
&lt;span id="cb9-11"&gt;&lt;a aria-hidden="true" href="#cb9-11" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;else&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb9-12"&gt;&lt;a aria-hidden="true" href="#cb9-12" tabindex="-1"&gt;&lt;/a&gt;   Put_Line&lt;span class="op"&gt;(&lt;/span&gt;&lt;span class="st"&gt;"A is equal to B."&lt;/span&gt;&lt;span class="op"&gt;)&lt;/span&gt;;&lt;/span&gt;
&lt;span id="cb9-13"&gt;&lt;a aria-hidden="true" href="#cb9-13" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;end if&lt;/span&gt;;&lt;/span&gt;
&lt;span id="cb9-14"&gt;&lt;a aria-hidden="true" href="#cb9-14" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb9-15"&gt;&lt;a aria-hidden="true" href="#cb9-15" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="co"&gt;-- Example 3: using if statement with logical negation&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb9-16"&gt;&lt;a aria-hidden="true" href="#cb9-16" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;if&lt;/span&gt; A &lt;span class="op"&gt;/=&lt;/span&gt; B &lt;span class="kw"&gt;then&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb9-17"&gt;&lt;a aria-hidden="true" href="#cb9-17" tabindex="-1"&gt;&lt;/a&gt;   Put_Line&lt;span class="op"&gt;(&lt;/span&gt;&lt;span class="st"&gt;"Something"&lt;/span&gt;&lt;span class="op"&gt;)&lt;/span&gt;;&lt;/span&gt;
&lt;span id="cb9-18"&gt;&lt;a aria-hidden="true" href="#cb9-18" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;end if&lt;/span&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;strong&gt;注意&lt;/strong&gt;，判断相等是 &lt;code&gt;=&lt;/code&gt; 而不是 &lt;code&gt;==&lt;/code&gt;，判断不相等是 &lt;code&gt;/=&lt;/code&gt; 而非 &lt;code&gt;!=&lt;/code&gt;。除此以外，判断是否在一个范围可以这样：&lt;code&gt;if Number in 1 .. 100 then&lt;/code&gt;。&lt;/p&gt;
&lt;h2 id="case-switch"&gt;case (switch)&lt;/h2&gt;
&lt;div class="sourceCode" id="cb10"&gt;&lt;pre class="sourceCode ada"&gt;&lt;code class="sourceCode ada"&gt;&lt;span id="cb10-1"&gt;&lt;a aria-hidden="true" href="#cb10-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;procedure&lt;/span&gt; Greetings &lt;span class="kw"&gt;is&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb10-2"&gt;&lt;a aria-hidden="true" href="#cb10-2" tabindex="-1"&gt;&lt;/a&gt;  Answer &lt;span class="op"&gt;:&lt;/span&gt; &lt;span class="dt"&gt;Character&lt;/span&gt;;&lt;/span&gt;
&lt;span id="cb10-3"&gt;&lt;a aria-hidden="true" href="#cb10-3" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;begin&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb10-4"&gt;&lt;a aria-hidden="true" href="#cb10-4" tabindex="-1"&gt;&lt;/a&gt;  Put &lt;span class="op"&gt;(&lt;/span&gt;&lt;span class="st"&gt;"Is it morning (m) or afternoon (a)? "&lt;/span&gt;&lt;span class="op"&gt;)&lt;/span&gt;;&lt;/span&gt;
&lt;span id="cb10-5"&gt;&lt;a aria-hidden="true" href="#cb10-5" tabindex="-1"&gt;&lt;/a&gt;  Get &lt;span class="op"&gt;(&lt;/span&gt;Answer&lt;span class="op"&gt;)&lt;/span&gt;;&lt;/span&gt;
&lt;span id="cb10-6"&gt;&lt;a aria-hidden="true" href="#cb10-6" tabindex="-1"&gt;&lt;/a&gt;  &lt;span class="kw"&gt;case&lt;/span&gt; Answer &lt;span class="kw"&gt;is&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb10-7"&gt;&lt;a aria-hidden="true" href="#cb10-7" tabindex="-1"&gt;&lt;/a&gt;      &lt;span class="kw"&gt;when&lt;/span&gt; &lt;span class="ch"&gt;'M'&lt;/span&gt; &lt;span class="op"&gt;|&lt;/span&gt; &lt;span class="ch"&gt;'m'&lt;/span&gt; &lt;span class="op"&gt;=&amp;gt;&lt;/span&gt;                    &lt;span class="co"&gt;-- 1&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb10-8"&gt;&lt;a aria-hidden="true" href="#cb10-8" tabindex="-1"&gt;&lt;/a&gt;          Put_Line &lt;span class="op"&gt;(&lt;/span&gt;&lt;span class="st"&gt;"Good morning!"&lt;/span&gt;&lt;span class="op"&gt;)&lt;/span&gt;;&lt;/span&gt;
&lt;span id="cb10-9"&gt;&lt;a aria-hidden="true" href="#cb10-9" tabindex="-1"&gt;&lt;/a&gt;      &lt;span class="kw"&gt;when&lt;/span&gt; &lt;span class="ch"&gt;'A'&lt;/span&gt; &lt;span class="op"&gt;|&lt;/span&gt; &lt;span class="ch"&gt;'a'&lt;/span&gt; &lt;span class="op"&gt;=&amp;gt;&lt;/span&gt;                    &lt;span class="co"&gt;-- 2&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb10-10"&gt;&lt;a aria-hidden="true" href="#cb10-10" tabindex="-1"&gt;&lt;/a&gt;          Put_Line &lt;span class="op"&gt;(&lt;/span&gt;&lt;span class="st"&gt;"Good afternoon!"&lt;/span&gt;&lt;span class="op"&gt;)&lt;/span&gt;;&lt;/span&gt;
&lt;span id="cb10-11"&gt;&lt;a aria-hidden="true" href="#cb10-11" tabindex="-1"&gt;&lt;/a&gt;      &lt;span class="kw"&gt;when&lt;/span&gt; &lt;span class="kw"&gt;others&lt;/span&gt; &lt;span class="op"&gt;=&amp;gt;&lt;/span&gt;                       &lt;span class="co"&gt;-- 3&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb10-12"&gt;&lt;a aria-hidden="true" href="#cb10-12" tabindex="-1"&gt;&lt;/a&gt;          Put_Line &lt;span class="op"&gt;(&lt;/span&gt;&lt;span class="st"&gt;"Please type 'm' or 'a'!"&lt;/span&gt;&lt;span class="op"&gt;)&lt;/span&gt;;&lt;/span&gt;
&lt;span id="cb10-13"&gt;&lt;a aria-hidden="true" href="#cb10-13" tabindex="-1"&gt;&lt;/a&gt;  &lt;span class="kw"&gt;end case&lt;/span&gt;;&lt;/span&gt;
&lt;span id="cb10-14"&gt;&lt;a aria-hidden="true" href="#cb10-14" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;end&lt;/span&gt; Greetings;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;以及范围测试：&lt;/p&gt;
&lt;div class="sourceCode" id="cb11"&gt;&lt;pre class="sourceCode ada"&gt;&lt;code class="sourceCode ada"&gt;&lt;span id="cb11-1"&gt;&lt;a aria-hidden="true" href="#cb11-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;case&lt;/span&gt; Answer &lt;span class="kw"&gt;is&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb11-2"&gt;&lt;a aria-hidden="true" href="#cb11-2" tabindex="-1"&gt;&lt;/a&gt;  &lt;span class="kw"&gt;when&lt;/span&gt; &lt;span class="ch"&gt;'A'&lt;/span&gt; &lt;span class="op"&gt;..&lt;/span&gt; &lt;span class="ch"&gt;'Z'&lt;/span&gt; &lt;span class="op"&gt;|&lt;/span&gt; &lt;span class="ch"&gt;'a'&lt;/span&gt; &lt;span class="op"&gt;..&lt;/span&gt; &lt;span class="ch"&gt;'z'&lt;/span&gt; &lt;span class="op"&gt;=&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb11-3"&gt;&lt;a aria-hidden="true" href="#cb11-3" tabindex="-1"&gt;&lt;/a&gt;      Put_Line &lt;span class="op"&gt;(&lt;/span&gt;&lt;span class="st"&gt;"Letter!"&lt;/span&gt;&lt;span class="op"&gt;)&lt;/span&gt;;&lt;/span&gt;
&lt;span id="cb11-4"&gt;&lt;a aria-hidden="true" href="#cb11-4" tabindex="-1"&gt;&lt;/a&gt;  &lt;span class="kw"&gt;when&lt;/span&gt; &lt;span class="kw"&gt;others&lt;/span&gt; &lt;span class="op"&gt;=&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb11-5"&gt;&lt;a aria-hidden="true" href="#cb11-5" tabindex="-1"&gt;&lt;/a&gt;      &lt;span class="kw"&gt;null&lt;/span&gt;;  &lt;span class="co"&gt;-- 啥都不做&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb11-6"&gt;&lt;a aria-hidden="true" href="#cb11-6" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;end case&lt;/span&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id="loop"&gt;loop&lt;/h2&gt;
&lt;p&gt;首先 Ada 中的 &lt;code&gt;do&lt;/code&gt; 大致可以替换成 &lt;code&gt;loop&lt;/code&gt;，所以：&lt;/p&gt;
&lt;div class="sourceCode" id="cb12"&gt;&lt;pre class="sourceCode c"&gt;&lt;code class="sourceCode c"&gt;&lt;span id="cb12-1"&gt;&lt;a aria-hidden="true" href="#cb12-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="cf"&gt;while&lt;/span&gt; &lt;span class="op"&gt;(&lt;/span&gt;&lt;span class="dv"&gt;1&lt;/span&gt;&lt;span class="op"&gt;){&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb12-2"&gt;&lt;a aria-hidden="true" href="#cb12-2" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="co"&gt;// do something&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb12-3"&gt;&lt;a aria-hidden="true" href="#cb12-3" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="op"&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;就是&lt;/p&gt;
&lt;div class="sourceCode" id="cb13"&gt;&lt;pre class="sourceCode ada"&gt;&lt;code class="sourceCode ada"&gt;&lt;span id="cb13-1"&gt;&lt;a aria-hidden="true" href="#cb13-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;while&lt;/span&gt; True &lt;span class="kw"&gt;loop&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb13-2"&gt;&lt;a aria-hidden="true" href="#cb13-2" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="co"&gt;--- do something&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb13-3"&gt;&lt;a aria-hidden="true" href="#cb13-3" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;end loop&lt;/span&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id="for"&gt;for&lt;/h2&gt;
&lt;div class="sourceCode" id="cb14"&gt;&lt;pre class="sourceCode ada"&gt;&lt;code class="sourceCode ada"&gt;&lt;span id="cb14-1"&gt;&lt;a aria-hidden="true" href="#cb14-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;for&lt;/span&gt; N &lt;span class="kw"&gt;in&lt;/span&gt; &lt;span class="dv"&gt;1&lt;/span&gt;&lt;span class="op"&gt;..&lt;/span&gt;&lt;span class="dv"&gt;20&lt;/span&gt; &lt;span class="kw"&gt;loop&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb14-2"&gt;&lt;a aria-hidden="true" href="#cb14-2" tabindex="-1"&gt;&lt;/a&gt;  Put &lt;span class="op"&gt;(&lt;/span&gt;&lt;span class="st"&gt;"*"&lt;/span&gt;&lt;span class="op"&gt;)&lt;/span&gt;;&lt;/span&gt;
&lt;span id="cb14-3"&gt;&lt;a aria-hidden="true" href="#cb14-3" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;end loop&lt;/span&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id="异常处理"&gt;异常处理&lt;/h2&gt;
&lt;p&gt;Ada 内置了完整的异常处理机制：&lt;/p&gt;
&lt;div class="sourceCode" id="cb15"&gt;&lt;pre class="sourceCode ada"&gt;&lt;code class="sourceCode ada"&gt;&lt;span id="cb15-1"&gt;&lt;a aria-hidden="true" href="#cb15-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;procedure&lt;/span&gt; Calculator &lt;span class="kw"&gt;is&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb15-2"&gt;&lt;a aria-hidden="true" href="#cb15-2" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;begin&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb15-3"&gt;&lt;a aria-hidden="true" href="#cb15-3" tabindex="-1"&gt;&lt;/a&gt;  &lt;span class="co"&gt;--- code to process data&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb15-4"&gt;&lt;a aria-hidden="true" href="#cb15-4" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;exception&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb15-5"&gt;&lt;a aria-hidden="true" href="#cb15-5" tabindex="-1"&gt;&lt;/a&gt;  &lt;span class="kw"&gt;when&lt;/span&gt; Constraint_Error &lt;span class="op"&gt;=&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb15-6"&gt;&lt;a aria-hidden="true" href="#cb15-6" tabindex="-1"&gt;&lt;/a&gt;      Put_Line &lt;span class="op"&gt;(&lt;/span&gt;&lt;span class="st"&gt;"Value out of range"&lt;/span&gt;&lt;span class="op"&gt;)&lt;/span&gt;;&lt;/span&gt;
&lt;span id="cb15-7"&gt;&lt;a aria-hidden="true" href="#cb15-7" tabindex="-1"&gt;&lt;/a&gt;  &lt;span class="kw"&gt;when&lt;/span&gt; Program_Error &lt;span class="op"&gt;|&lt;/span&gt; Data_Error &lt;span class="op"&gt;=&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb15-8"&gt;&lt;a aria-hidden="true" href="#cb15-8" tabindex="-1"&gt;&lt;/a&gt;      Put_Line &lt;span class="op"&gt;(&lt;/span&gt;&lt;span class="st"&gt;"Error in input -- integer expected"&lt;/span&gt;&lt;span class="op"&gt;)&lt;/span&gt;;&lt;/span&gt;
&lt;span id="cb15-9"&gt;&lt;a aria-hidden="true" href="#cb15-9" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;end&lt;/span&gt; Calculator;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Ada 中有以下几种异常：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;Constraint_Error&lt;/code&gt;：当某个值不符合类型限制时抛出&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Program_Error&lt;/code&gt;：当程序出现逻辑错误时抛出&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Storage_Error&lt;/code&gt;：当程序无法分配足够的内存时抛出&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Tasking_Error&lt;/code&gt;：当任务相关的错误发生时抛出&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Numerics_Error&lt;/code&gt;：当数字计算出现错误时抛出&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Check_Error&lt;/code&gt;：当某些检查失败时抛出&lt;/li&gt;
&lt;li&gt;&lt;code&gt;System_Error&lt;/code&gt;：当系统错误发生时抛出&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Use_Error&lt;/code&gt;：当程序使用不正确时抛出&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Assertion_Error&lt;/code&gt;：当程序中的断言失败时抛出&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="multitasking"&gt;MultiTasking&lt;/h2&gt;
&lt;p&gt;说起 &lt;code&gt;MultiTasking&lt;/code&gt; 现在第一个想到的就是 &lt;code&gt;Golang&lt;/code&gt;，但 Adalang 这个比我的年龄还大的语言也可以做到：而且一点也不勉强：&lt;/p&gt;
&lt;div class="sourceCode" id="cb16"&gt;&lt;pre class="sourceCode ada"&gt;&lt;code class="sourceCode ada"&gt;&lt;span id="cb16-1"&gt;&lt;a aria-hidden="true" href="#cb16-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;procedure&lt;/span&gt; Show_Simple_Tasks &lt;span class="kw"&gt;is&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb16-2"&gt;&lt;a aria-hidden="true" href="#cb16-2" tabindex="-1"&gt;&lt;/a&gt;   &lt;span class="kw"&gt;task&lt;/span&gt; T;&lt;/span&gt;
&lt;span id="cb16-3"&gt;&lt;a aria-hidden="true" href="#cb16-3" tabindex="-1"&gt;&lt;/a&gt;   &lt;span class="kw"&gt;task&lt;/span&gt; T2;&lt;/span&gt;
&lt;span id="cb16-4"&gt;&lt;a aria-hidden="true" href="#cb16-4" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb16-5"&gt;&lt;a aria-hidden="true" href="#cb16-5" tabindex="-1"&gt;&lt;/a&gt;   &lt;span class="kw"&gt;task&lt;/span&gt; &lt;span class="kw"&gt;body&lt;/span&gt; T &lt;span class="kw"&gt;is&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb16-6"&gt;&lt;a aria-hidden="true" href="#cb16-6" tabindex="-1"&gt;&lt;/a&gt;   &lt;span class="kw"&gt;begin&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb16-7"&gt;&lt;a aria-hidden="true" href="#cb16-7" tabindex="-1"&gt;&lt;/a&gt;      &lt;span class="kw"&gt;delay&lt;/span&gt; &lt;span class="fl"&gt;1.25&lt;/span&gt;; &lt;span class="co"&gt;--- sleep 1.25 秒&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb16-8"&gt;&lt;a aria-hidden="true" href="#cb16-8" tabindex="-1"&gt;&lt;/a&gt;      Put_Line &lt;span class="op"&gt;(&lt;/span&gt;&lt;span class="st"&gt;"In task T"&lt;/span&gt;&lt;span class="op"&gt;)&lt;/span&gt;;&lt;/span&gt;
&lt;span id="cb16-9"&gt;&lt;a aria-hidden="true" href="#cb16-9" tabindex="-1"&gt;&lt;/a&gt;   &lt;span class="kw"&gt;end&lt;/span&gt; T;&lt;/span&gt;
&lt;span id="cb16-10"&gt;&lt;a aria-hidden="true" href="#cb16-10" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb16-11"&gt;&lt;a aria-hidden="true" href="#cb16-11" tabindex="-1"&gt;&lt;/a&gt;   &lt;span class="kw"&gt;task&lt;/span&gt; &lt;span class="kw"&gt;body&lt;/span&gt; T2 &lt;span class="kw"&gt;is&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb16-12"&gt;&lt;a aria-hidden="true" href="#cb16-12" tabindex="-1"&gt;&lt;/a&gt;   &lt;span class="kw"&gt;begin&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb16-13"&gt;&lt;a aria-hidden="true" href="#cb16-13" tabindex="-1"&gt;&lt;/a&gt;      &lt;span class="kw"&gt;delay&lt;/span&gt; &lt;span class="fl"&gt;2.25&lt;/span&gt;; &lt;span class="co"&gt;--- sleep 2.25 秒&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb16-14"&gt;&lt;a aria-hidden="true" href="#cb16-14" tabindex="-1"&gt;&lt;/a&gt;      Put_Line &lt;span class="op"&gt;(&lt;/span&gt;&lt;span class="st"&gt;"In task T2"&lt;/span&gt;&lt;span class="op"&gt;)&lt;/span&gt;;&lt;/span&gt;
&lt;span id="cb16-15"&gt;&lt;a aria-hidden="true" href="#cb16-15" tabindex="-1"&gt;&lt;/a&gt;   &lt;span class="kw"&gt;end&lt;/span&gt; T2;&lt;/span&gt;
&lt;span id="cb16-16"&gt;&lt;a aria-hidden="true" href="#cb16-16" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb16-17"&gt;&lt;a aria-hidden="true" href="#cb16-17" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;begin&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb16-18"&gt;&lt;a aria-hidden="true" href="#cb16-18" tabindex="-1"&gt;&lt;/a&gt;   Put_Line &lt;span class="op"&gt;(&lt;/span&gt;&lt;span class="st"&gt;"In main"&lt;/span&gt;&lt;span class="op"&gt;)&lt;/span&gt;;&lt;/span&gt;
&lt;span id="cb16-19"&gt;&lt;a aria-hidden="true" href="#cb16-19" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;end&lt;/span&gt; Show_Simple_Tasks;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;程序的输出是&lt;/p&gt;
&lt;div class="sourceCode" id="cb17"&gt;&lt;pre class="sourceCode js"&gt;&lt;code class="sourceCode javascript"&gt;&lt;span id="cb17-1"&gt;&lt;a aria-hidden="true" href="#cb17-1" tabindex="-1"&gt;&lt;/a&gt;In main&lt;/span&gt;
&lt;span id="cb17-2"&gt;&lt;a aria-hidden="true" href="#cb17-2" tabindex="-1"&gt;&lt;/a&gt;In task T&lt;/span&gt;
&lt;span id="cb17-3"&gt;&lt;a aria-hidden="true" href="#cb17-3" tabindex="-1"&gt;&lt;/a&gt;In task T2&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;并且是并行的。&lt;/p&gt;
&lt;p&gt;&lt;code&gt;select&lt;/code&gt; 也可以轻松实现：&lt;/p&gt;
&lt;div class="sourceCode" id="cb18"&gt;&lt;pre class="sourceCode ada"&gt;&lt;code class="sourceCode ada"&gt;&lt;span id="cb18-1"&gt;&lt;a aria-hidden="true" href="#cb18-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;procedure&lt;/span&gt; Show_Rendezvous_Loop &lt;span class="kw"&gt;is&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb18-2"&gt;&lt;a aria-hidden="true" href="#cb18-2" tabindex="-1"&gt;&lt;/a&gt;   &lt;span class="kw"&gt;task&lt;/span&gt; T &lt;span class="kw"&gt;is&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb18-3"&gt;&lt;a aria-hidden="true" href="#cb18-3" tabindex="-1"&gt;&lt;/a&gt;      &lt;span class="kw"&gt;entry&lt;/span&gt; Reset;&lt;/span&gt;
&lt;span id="cb18-4"&gt;&lt;a aria-hidden="true" href="#cb18-4" tabindex="-1"&gt;&lt;/a&gt;      &lt;span class="kw"&gt;entry&lt;/span&gt; Increment;&lt;/span&gt;
&lt;span id="cb18-5"&gt;&lt;a aria-hidden="true" href="#cb18-5" tabindex="-1"&gt;&lt;/a&gt;   &lt;span class="kw"&gt;end&lt;/span&gt; T;&lt;/span&gt;
&lt;span id="cb18-6"&gt;&lt;a aria-hidden="true" href="#cb18-6" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb18-7"&gt;&lt;a aria-hidden="true" href="#cb18-7" tabindex="-1"&gt;&lt;/a&gt;   &lt;span class="kw"&gt;task&lt;/span&gt; &lt;span class="kw"&gt;body&lt;/span&gt; T &lt;span class="kw"&gt;is&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb18-8"&gt;&lt;a aria-hidden="true" href="#cb18-8" tabindex="-1"&gt;&lt;/a&gt;      Cnt &lt;span class="op"&gt;:&lt;/span&gt; &lt;span class="dt"&gt;Integer&lt;/span&gt; &lt;span class="op"&gt;:=&lt;/span&gt; &lt;span class="dv"&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id="cb18-9"&gt;&lt;a aria-hidden="true" href="#cb18-9" tabindex="-1"&gt;&lt;/a&gt;   &lt;span class="kw"&gt;begin&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb18-10"&gt;&lt;a aria-hidden="true" href="#cb18-10" tabindex="-1"&gt;&lt;/a&gt;      &lt;span class="kw"&gt;loop&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb18-11"&gt;&lt;a aria-hidden="true" href="#cb18-11" tabindex="-1"&gt;&lt;/a&gt;         &lt;span class="kw"&gt;select&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb18-12"&gt;&lt;a aria-hidden="true" href="#cb18-12" tabindex="-1"&gt;&lt;/a&gt;            &lt;span class="kw"&gt;accept&lt;/span&gt; Reset &lt;span class="kw"&gt;do&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb18-13"&gt;&lt;a aria-hidden="true" href="#cb18-13" tabindex="-1"&gt;&lt;/a&gt;               Cnt &lt;span class="op"&gt;:=&lt;/span&gt; &lt;span class="dv"&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id="cb18-14"&gt;&lt;a aria-hidden="true" href="#cb18-14" tabindex="-1"&gt;&lt;/a&gt;            &lt;span class="kw"&gt;end&lt;/span&gt; Reset;&lt;/span&gt;
&lt;span id="cb18-15"&gt;&lt;a aria-hidden="true" href="#cb18-15" tabindex="-1"&gt;&lt;/a&gt;            Put_Line &lt;span class="op"&gt;(&lt;/span&gt;&lt;span class="st"&gt;"Reset"&lt;/span&gt;&lt;span class="op"&gt;)&lt;/span&gt;;&lt;/span&gt;
&lt;span id="cb18-16"&gt;&lt;a aria-hidden="true" href="#cb18-16" tabindex="-1"&gt;&lt;/a&gt;         &lt;span class="kw"&gt;or&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb18-17"&gt;&lt;a aria-hidden="true" href="#cb18-17" tabindex="-1"&gt;&lt;/a&gt;            &lt;span class="kw"&gt;accept&lt;/span&gt; Increment &lt;span class="kw"&gt;do&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb18-18"&gt;&lt;a aria-hidden="true" href="#cb18-18" tabindex="-1"&gt;&lt;/a&gt;               Cnt &lt;span class="op"&gt;:=&lt;/span&gt; Cnt &lt;span class="op"&gt;+&lt;/span&gt; &lt;span class="dv"&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id="cb18-19"&gt;&lt;a aria-hidden="true" href="#cb18-19" tabindex="-1"&gt;&lt;/a&gt;            &lt;span class="kw"&gt;end&lt;/span&gt; Increment;&lt;/span&gt;
&lt;span id="cb18-20"&gt;&lt;a aria-hidden="true" href="#cb18-20" tabindex="-1"&gt;&lt;/a&gt;            &lt;span class="kw"&gt;delay&lt;/span&gt; &lt;span class="fl"&gt;1.0&lt;/span&gt;;&lt;/span&gt;
&lt;span id="cb18-21"&gt;&lt;a aria-hidden="true" href="#cb18-21" tabindex="-1"&gt;&lt;/a&gt;            Put_Line &lt;span class="op"&gt;(&lt;/span&gt;&lt;span class="st"&gt;"In T's loop ("&lt;/span&gt; &lt;span class="op"&gt;&amp;amp;&lt;/span&gt; Integer'Image &lt;span class="op"&gt;(&lt;/span&gt;Cnt&lt;span class="op"&gt;)&lt;/span&gt; &lt;span class="op"&gt;&amp;amp;&lt;/span&gt; &lt;span class="st"&gt;")"&lt;/span&gt;&lt;span class="op"&gt;)&lt;/span&gt;;&lt;/span&gt;
&lt;span id="cb18-22"&gt;&lt;a aria-hidden="true" href="#cb18-22" tabindex="-1"&gt;&lt;/a&gt;         &lt;span class="kw"&gt;or&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb18-23"&gt;&lt;a aria-hidden="true" href="#cb18-23" tabindex="-1"&gt;&lt;/a&gt;            &lt;span class="kw"&gt;terminate&lt;/span&gt;;&lt;/span&gt;
&lt;span id="cb18-24"&gt;&lt;a aria-hidden="true" href="#cb18-24" tabindex="-1"&gt;&lt;/a&gt;         &lt;span class="kw"&gt;end select&lt;/span&gt;;&lt;/span&gt;
&lt;span id="cb18-25"&gt;&lt;a aria-hidden="true" href="#cb18-25" tabindex="-1"&gt;&lt;/a&gt;      &lt;span class="kw"&gt;end loop&lt;/span&gt;;&lt;/span&gt;
&lt;span id="cb18-26"&gt;&lt;a aria-hidden="true" href="#cb18-26" tabindex="-1"&gt;&lt;/a&gt;   &lt;span class="kw"&gt;end&lt;/span&gt; T;&lt;/span&gt;
&lt;span id="cb18-27"&gt;&lt;a aria-hidden="true" href="#cb18-27" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb18-28"&gt;&lt;a aria-hidden="true" href="#cb18-28" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;begin&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb18-29"&gt;&lt;a aria-hidden="true" href="#cb18-29" tabindex="-1"&gt;&lt;/a&gt;   Put_Line &lt;span class="op"&gt;(&lt;/span&gt;&lt;span class="st"&gt;"In Main"&lt;/span&gt;&lt;span class="op"&gt;)&lt;/span&gt;;&lt;/span&gt;
&lt;span id="cb18-30"&gt;&lt;a aria-hidden="true" href="#cb18-30" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb18-31"&gt;&lt;a aria-hidden="true" href="#cb18-31" tabindex="-1"&gt;&lt;/a&gt;   &lt;span class="kw"&gt;for&lt;/span&gt; I &lt;span class="kw"&gt;in&lt;/span&gt; &lt;span class="dv"&gt;1&lt;/span&gt; &lt;span class="op"&gt;..&lt;/span&gt; &lt;span class="dv"&gt;4&lt;/span&gt; &lt;span class="kw"&gt;loop&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb18-32"&gt;&lt;a aria-hidden="true" href="#cb18-32" tabindex="-1"&gt;&lt;/a&gt;      T&lt;span class="op"&gt;.&lt;/span&gt;Increment;&lt;/span&gt;
&lt;span id="cb18-33"&gt;&lt;a aria-hidden="true" href="#cb18-33" tabindex="-1"&gt;&lt;/a&gt;   &lt;span class="kw"&gt;end loop&lt;/span&gt;;&lt;/span&gt;
&lt;span id="cb18-34"&gt;&lt;a aria-hidden="true" href="#cb18-34" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb18-35"&gt;&lt;a aria-hidden="true" href="#cb18-35" tabindex="-1"&gt;&lt;/a&gt;   T&lt;span class="op"&gt;.&lt;/span&gt;Reset;&lt;/span&gt;
&lt;span id="cb18-36"&gt;&lt;a aria-hidden="true" href="#cb18-36" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb18-37"&gt;&lt;a aria-hidden="true" href="#cb18-37" tabindex="-1"&gt;&lt;/a&gt;   &lt;span class="kw"&gt;for&lt;/span&gt; I &lt;span class="kw"&gt;in&lt;/span&gt; &lt;span class="dv"&gt;1&lt;/span&gt; &lt;span class="op"&gt;..&lt;/span&gt; &lt;span class="dv"&gt;4&lt;/span&gt; &lt;span class="kw"&gt;loop&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb18-38"&gt;&lt;a aria-hidden="true" href="#cb18-38" tabindex="-1"&gt;&lt;/a&gt;      T&lt;span class="op"&gt;.&lt;/span&gt;Increment;&lt;/span&gt;
&lt;span id="cb18-39"&gt;&lt;a aria-hidden="true" href="#cb18-39" tabindex="-1"&gt;&lt;/a&gt;   &lt;span class="kw"&gt;end loop&lt;/span&gt;;&lt;/span&gt;
&lt;span id="cb18-40"&gt;&lt;a aria-hidden="true" href="#cb18-40" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;end&lt;/span&gt; Show_Rendezvous_Loop;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;结果：&lt;/p&gt;
&lt;pre class="elisp"&gt;&lt;code&gt;In Main
In T's loop ( 1)
In T's loop ( 2)
In T's loop ( 3)
In T's loop ( 4)
Reset
In T's loop ( 1)
In T's loop ( 2)
In T's loop ( 3)
In T's loop ( 4)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;编译结果 &lt;code&gt;-rwxr-xr-x 1 izfsk izfsk 359K Mar 26 21:09 Show_Simple_Tasks&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;总而言之，Ada 是一个超越时代的语言，它有类似 Golang 甚至 Rust 的一些特性，而且语法也很优雅，但时代局限了它。&lt;/p&gt;
&lt;h2 id="参考"&gt;参考&lt;/h2&gt;
&lt;ol type="1"&gt;
&lt;li&gt;&lt;a href="https://www.adaic.org/resources/add_content/docs/craft/html/appa.htm"&gt;Ada 语言参考&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://learn.adacore.com"&gt;Adacore 提供的学习资源&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://www.adaic.org/learn/materials/"&gt;学习资源列表&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;br/&gt;
&lt;!--%%REF%%--&gt;
&lt;br/&gt;
&lt;script async="" crossorigin="anonymous" data-category="Announcements" data-category-id="DIC_kwDOJ7Ymy84CX4eg" data-emit-metadata="0" data-input-position="top" data-lang="zh-CN" data-loading="lazy" data-mapping="title" data-reactions-enabled="1" data-repo="izfsk-ium/izfsk-ium.github.io" data-repo-id="R_kgDOJ7Ymyw" data-strict="0" data-theme="preferred_color_scheme" src="https://giscus.app/client.js"&gt;
&lt;/script&gt;
&lt;/main&gt;
&lt;footer&gt;
&lt;p class="signoff"&gt;
&lt;div class="metadata"&gt;
&lt;p class="date"&gt;&lt;time datetime="2023-03-24"&gt;创建日期：2023-03-24&lt;/time&gt;&lt;/p&gt;
&lt;p class="lastmodify"&gt;&lt;time&gt;最后编译：2023-08-10&lt;/time&gt;&lt;/p&gt;
&lt;p class="lastmodify" id="counter-span"&gt;访问次数：&lt;/p&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;/footer&gt;
&lt;script&gt;
    /* These script should run after page load */
    document.querySelectorAll('code.sourceCode').forEach(
      i =&gt; i.insertAdjacentHTML('beforeend', '&lt;div class="copy"&gt;复制&lt;/div&gt;')
    );
    document.querySelectorAll('div.copy').forEach(
      i =&gt; i.addEventListener(
        'click',
        () =&gt; {
          navigator.clipboard.writeText(i.parentElement.innerText.replace('复制', ''));
          i.innerText = '成功';
          setTimeout(() =&gt; {
            i.innerText = '复制';
          }, 1000);
        }
      )
    );

    if (location.href.includes("127.0.0.1:8080")) {
      document.getElementById("counter-span").innerHTML = "[[development mode]]";
    } else {
      const uuid = document.getElementById("article-uuid").innerText;
      const target = document.getElementById("counter-span");
      const last = localStorage.getItem("lastVisit-" + uuid);
      const shouldIncrease = last === null || new Date().getTime() - parseInt(last) &gt;= (1000 * 60 * 15);

      fetch(shouldIncrease ? ("https://counter.izfsk.top/counter/" + uuid) : ("https://counter.izfsk.top/readOnly/" + uuid))
        .then(r =&gt; r.text())
        .then(d =&gt; {
          if (!d.startsWith("Too"))
            document.getElementById("counter-span").innerText = "访问次数：" + d.toString();
          else
            document.getElementById("counter-span").innerHTML = "";
        });

      localStorage.setItem("lastVisit-" + uuid, new Date().getTime());
    }
  &lt;/script&gt;
&lt;script async="" data-website-id="2a1146ab-fa82-4a84-a04f-30e5967357c3" src="https://analytics.umami.is/script.js"&gt;&lt;/script&gt;
&lt;/body&gt;</content:encoded>
      <guid isPermaLink="false">8f47beda-8cb7-4835-a463-a60e6ac2dcd5</guid>
      <pubDate>Fri, 24 Mar 2023 00:00:00 +0800</pubDate>
    </item>
    <item>
      <title>当用户爬行的时候</title>
      <link>https://blog.izfsk.top/articles/当用户爬行的时候.html</link>
      <description>当用户爬行的时候</description>
      <content:encoded>&lt;body&gt;
&lt;progress id="content_progress" value="0"&gt;&lt;/progress&gt;
&lt;button id="back-to-top"&gt;
    回页顶
  &lt;/button&gt;
&lt;header&gt;
&lt;small id="article-uuid" style="display: none !important;"&gt;dc6740ad-5546-451a-a74a-c3721cdd76ca&lt;/small&gt;
&lt;h1 class="title"&gt;当用户爬行的时候&lt;/h1&gt;
&lt;!-- Subtitle --&gt;
&lt;h3 class="subtitle"&gt; &lt;/h3&gt;
&lt;/header&gt;
&lt;main&gt;
&lt;p&gt;我曾经有幸看到过用户和界面交互的场景。那真是让人绝望：很显然，他们不明白登录和不登陆有什么区别，当遇到问题时，他们在很明显不是交互元素的地方徒劳而倔强的反复的点击，有的用户还算有那么一点使用浏览器的经验，至少知道「刷新」这一功能，于是接连不断绝望的刷新着网页，期待着某一次刷新过后能够魔法般的获得登录状态……&lt;/p&gt;
&lt;p&gt;看到这种情况，开发人员的恨不得拧着用户的耳朵教会他们，然而目前的技术并不能让人手从显示屏中伸出来，而连登录按钮都看不到的人，自然也不能指望他去阅读有小拇指那么厚的用户文档。他们倔强，会使用各种百度出来的那些奇怪、过时、错误、莫名其妙的技巧反复尝试，但他们又很浮躁，既不愿意了解登录的作用，也不愿意花费哪怕是5分钟时间看一下文档或者来请教一下用户支持，在这种情况下，如果开发者有幸能够发觉这一情况，解决的方案自然只能是给登录按钮加粗，加大，加边框，加背景颜色，乃至到让它漂浮起来像抹了油的台球似的满屏幕弹来弹去────没错，就是那种经常在政府网页上看见的 js 漂浮卡片：&lt;strong&gt;它们真的很难看，但真的很管用&lt;/strong&gt;。&lt;/p&gt;
&lt;p&gt;任何开发人员都不会愿意看到自己的用户是这样的情况，你修了一条路，自然希望人家老老实实是走，或许还能跑，但绝对不希望人家蚰蜒一样曲折的爬行。然而现实情况却总是让人觉得自己不是在修路而是在养蛊。有一个「二八定律」,说法是 80% 用户只会去使用 20% 功能，虽然我觉得从软件功能开发上看这句话并不一定合理，还容易成为偷懒的滥觞，但如果按照它的说法，把用户分为百分之二十的「高级用户」和百分之八十的「一般用户」的话，那么对于软件产品的反馈，百分之八十来自于那些「高级用户」，而那些占据大头的普通用户则是实打实的「沉默的大多数」。这些人计算机操作经验普遍的不足，乃至看着他们操作会让我们这种自诩「专家」的人莫名的生起气来。&lt;/p&gt;
&lt;p&gt;对于这些用户，我的项目经历告诉我：&lt;/p&gt;
&lt;ol type="1"&gt;
&lt;li&gt;他们可能会以一种开发者意想不到的方法使用应用程序。&lt;/li&gt;
&lt;li&gt;他们永远不会报告和反馈遇到的困难和bug。&lt;/li&gt;
&lt;li&gt;他们最终还是会成功。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;这类用户占据了很大一部分，他们认为「文件管理」就是「qq浏览器」，分不清「内存」和「存储」，问他使用什么系统会很认真的回答你手机的品牌，他们不关心你的 CDN 有没有使用 http3 和 brotli 压缩，他们只是希望这个「东西」能够好好干活，而他们的期望也很具体，某个具体的窗口，一行特定的提示字符串就是成功的符号。&lt;/p&gt;
&lt;p&gt;但开发者看不见他们。或者说，不愿意看到他们。人总是希望看到自己希望看到的东西，而有意或无意的忽略不合口味的东西。或许程序员多少都有些孤芳自赏，作为开发者，理想的用户是这样的：他有大把的时间研究手册，受到相当程度的计算机教育，汇报 issue 时条理清晰内容简洁，闲时还能和你唠唠技术上的实现细节的阳春白雪（自然，最后还是你占上风）……但即使是在 20% 的「高级用户」中，这样的人也是屈指可数的。而对于一般用户和缺乏计算机能力的用户，却只能受到白眼乃至逐客令 ──── 这一点在某些精英化的开源/自由软件中尤其突出，反而是不够自由的商业软件给了这些低级用户不受（技术上的）歧视的自由。于是，一方面用户沉默不语（即使有什么想说的也入不了开发者的法眼），一方面是开发者日益闭门造车孤芳自赏唯我独尊众人皆醉我独醒，这当然对于软件本身是不利的。如果看见用户在爬行，就应该扶他们起来，而不是抱着「不会走路就给爷爬」的心态和态度把他们一概归为「低端用户」，冷冰冰的一句「不会用就别用」是不可能吸引到更多的用户，以及维持一个健康的社区的。&lt;/p&gt;
&lt;p&gt;而让用户都去主动适应开发者的「哲学」，要用户来学习他们的软件，就像是某些老板命令程序员实现「能够根据手机壳的颜色切换应用主题」一样娘希匹了。&lt;/p&gt;
&lt;br/&gt;
&lt;!--%%REF%%--&gt;
&lt;br/&gt;
&lt;script async="" crossorigin="anonymous" data-category="Announcements" data-category-id="DIC_kwDOJ7Ymy84CX4eg" data-emit-metadata="0" data-input-position="top" data-lang="zh-CN" data-loading="lazy" data-mapping="title" data-reactions-enabled="1" data-repo="izfsk-ium/izfsk-ium.github.io" data-repo-id="R_kgDOJ7Ymyw" data-strict="0" data-theme="preferred_color_scheme" src="https://giscus.app/client.js"&gt;
&lt;/script&gt;
&lt;/main&gt;
&lt;footer&gt;
&lt;p class="signoff"&gt;
&lt;div class="metadata"&gt;
&lt;p class="date"&gt;&lt;time datetime="2023-04-06"&gt;创建日期：2023-04-06&lt;/time&gt;&lt;/p&gt;
&lt;p class="lastmodify"&gt;&lt;time&gt;最后编译：2023-08-10&lt;/time&gt;&lt;/p&gt;
&lt;p class="lastmodify" id="counter-span"&gt;访问次数：&lt;/p&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;/footer&gt;
&lt;script&gt;
    /* These script should run after page load */
    document.querySelectorAll('code.sourceCode').forEach(
      i =&gt; i.insertAdjacentHTML('beforeend', '&lt;div class="copy"&gt;复制&lt;/div&gt;')
    );
    document.querySelectorAll('div.copy').forEach(
      i =&gt; i.addEventListener(
        'click',
        () =&gt; {
          navigator.clipboard.writeText(i.parentElement.innerText.replace('复制', ''));
          i.innerText = '成功';
          setTimeout(() =&gt; {
            i.innerText = '复制';
          }, 1000);
        }
      )
    );

    if (location.href.includes("127.0.0.1:8080")) {
      document.getElementById("counter-span").innerHTML = "[[development mode]]";
    } else {
      const uuid = document.getElementById("article-uuid").innerText;
      const target = document.getElementById("counter-span");
      const last = localStorage.getItem("lastVisit-" + uuid);
      const shouldIncrease = last === null || new Date().getTime() - parseInt(last) &gt;= (1000 * 60 * 15);

      fetch(shouldIncrease ? ("https://counter.izfsk.top/counter/" + uuid) : ("https://counter.izfsk.top/readOnly/" + uuid))
        .then(r =&gt; r.text())
        .then(d =&gt; {
          if (!d.startsWith("Too"))
            document.getElementById("counter-span").innerText = "访问次数：" + d.toString();
          else
            document.getElementById("counter-span").innerHTML = "";
        });

      localStorage.setItem("lastVisit-" + uuid, new Date().getTime());
    }
  &lt;/script&gt;
&lt;script async="" data-website-id="2a1146ab-fa82-4a84-a04f-30e5967357c3" src="https://analytics.umami.is/script.js"&gt;&lt;/script&gt;
&lt;/body&gt;</content:encoded>
      <guid isPermaLink="false">dc6740ad-5546-451a-a74a-c3721cdd76ca</guid>
      <pubDate>Thu, 06 Apr 2023 00:00:00 +0800</pubDate>
    </item>
    <item>
      <title>给Nautilus添加自定义菜单项</title>
      <link>https://blog.izfsk.top/articles/给Nautilus添加自定义菜单项.html</link>
      <description>给Nautilus添加自定义菜单项</description>
      <content:encoded>&lt;body&gt;
&lt;progress id="content_progress" value="0"&gt;&lt;/progress&gt;
&lt;button id="back-to-top"&gt;
    回页顶
  &lt;/button&gt;
&lt;header&gt;
&lt;small id="article-uuid" style="display: none !important;"&gt;de5bb46d-a069-4de8-b61b-18cfe5e38fc7&lt;/small&gt;
&lt;h1 class="title"&gt;给Nautilus添加自定义菜单项&lt;/h1&gt;
&lt;!-- Subtitle --&gt;
&lt;h3 class="subtitle"&gt; &lt;/h3&gt;
&lt;/header&gt;
&lt;main&gt;
&lt;blockquote&gt;
&lt;p&gt;“GNOME’s […] excuse for not doing something is not it’s too complicated to do , but it would confuse users . The whole we know best thing is a disease.” — Linus Torvalds&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;首先，我必须要狠狠的吐槽 Nautilus 的设计 —— 事实上是整个 Gnome 的设计哲学，如果这样扭曲的思维也能叫做一种“哲学”的话。默认的Gnome，说得好听叫简洁，说得难听叫简陋，做减法做过头。我知道 Gnome 的设计借鉴和吸收了 MacOS 的简洁，但在实际上，他们似乎搞错了“简洁”和“简陋”的区别。以至于搞出了一个看上去很简洁，但用起来大量缺失基础功能的精品毛坯房。在 Gnome 中，回字不会有四种写法——它干脆不提供这个字。已经是 2023 年了，连 Windows 的资源管理器都添加了“在这里打开终端”的上下文菜单，Nautilus 的菜单项目倒是越来越少了。&lt;/p&gt;
&lt;p&gt;当然，Nautilus 天才的设计者对极致简洁的不懈追求并没有止步于不添加新的功能，他们也没有忘记砍掉原本好用的老功能。曾经有一个叫做 &lt;code&gt;filemanager/nautilus-actions&lt;/code&gt; 的（官方）项目，用户可以给 Nautilus 添加自定义的菜单内容，这样如同火箭科学一样复杂难懂的功能想必是根本不会有人用的，于是它就被砍掉了。&lt;/p&gt;
&lt;p&gt;幸运的是，&lt;a href="https://github.com/bassmanitram/actions-for-nautilus#configuration-ui"&gt;还有一个项目&lt;/a&gt;为我这样庸俗的，不懂得面向未来的低端用户弥补了这个缺陷，以下是安装和配置过程：&lt;/p&gt;
&lt;p&gt;首先，安装对应的依赖，对于 openSUSE, 需要安装的包是：&lt;/p&gt;
&lt;div class="sourceCode" id="cb1"&gt;&lt;pre class="sourceCode bash"&gt;&lt;code class="sourceCode bash"&gt;&lt;span id="cb1-1"&gt;&lt;a aria-hidden="true" href="#cb1-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="fu"&gt;sudo&lt;/span&gt; zypper in python310-nautilus python310-gobject procps libprocps8&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;其他的无关紧要，当然为了能够正确弹窗和访问剪贴板，最好再安装一下 &lt;code&gt;zenity&lt;/code&gt; 和 &lt;code&gt;xclip&lt;/code&gt;。&lt;/p&gt;
&lt;p&gt;接下来克隆 repo ： &lt;code&gt;git clone https://github.com/bassmanitram/actions-for-nautilus.git&lt;/code&gt;，安装：&lt;code&gt;cd actions-for-nautilus &amp;amp;&amp;amp; make install&lt;/code&gt;。然后&lt;strong&gt;注销并重新登陆&lt;/strong&gt;。接着在全部应用里面寻找 &lt;code&gt;Actions For Nautilus configuration&lt;/code&gt;：&lt;/p&gt;
&lt;p&gt;&lt;img src="./assets/Ha.png"/&gt;&lt;/p&gt;
&lt;p&gt;然后就能够运行了。这是一个网页程序（&lt;code&gt;http://localhost:47599/&lt;/code&gt;），将会在浏览器里面打开：&lt;/p&gt;
&lt;p&gt;&lt;img src="./assets/12.png"/&gt;&lt;/p&gt;
&lt;p&gt;编辑基本上是有手就行，但是注意：&lt;strong&gt;在这里编辑并保存以后是有可能无效的&lt;/strong&gt;，也就是说根本没有真的保存。如果刷新以后总是显示原始配置，那么恭喜，你不得不和我一样自己编配置文件。配置文件的位置是：&lt;code&gt;~/.local/share/actions-for-nautilus/config.json&lt;/code&gt;，内容是 JSON 文件。附上我调试出来的配置一份：&lt;/p&gt;
&lt;div class="sourceCode" id="cb2"&gt;&lt;pre class="sourceCode json"&gt;&lt;code class="sourceCode json"&gt;&lt;span id="cb2-1"&gt;&lt;a aria-hidden="true" href="#cb2-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="fu"&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-2"&gt;&lt;a aria-hidden="true" href="#cb2-2" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="dt"&gt;"actions"&lt;/span&gt;&lt;span class="fu"&gt;:&lt;/span&gt; &lt;span class="ot"&gt;[&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-3"&gt;&lt;a aria-hidden="true" href="#cb2-3" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="fu"&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-4"&gt;&lt;a aria-hidden="true" href="#cb2-4" tabindex="-1"&gt;&lt;/a&gt;            &lt;span class="dt"&gt;"type"&lt;/span&gt;&lt;span class="fu"&gt;:&lt;/span&gt; &lt;span class="st"&gt;"command"&lt;/span&gt;&lt;span class="fu"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-5"&gt;&lt;a aria-hidden="true" href="#cb2-5" tabindex="-1"&gt;&lt;/a&gt;            &lt;span class="dt"&gt;"label"&lt;/span&gt;&lt;span class="fu"&gt;:&lt;/span&gt; &lt;span class="st"&gt;"Open Terminal..."&lt;/span&gt;&lt;span class="fu"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-6"&gt;&lt;a aria-hidden="true" href="#cb2-6" tabindex="-1"&gt;&lt;/a&gt;            &lt;span class="dt"&gt;"command_line"&lt;/span&gt;&lt;span class="fu"&gt;:&lt;/span&gt; &lt;span class="st"&gt;"xfce4-terminal --working-directory=%f"&lt;/span&gt;&lt;span class="fu"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-7"&gt;&lt;a aria-hidden="true" href="#cb2-7" tabindex="-1"&gt;&lt;/a&gt;            &lt;span class="dt"&gt;"cwd"&lt;/span&gt;&lt;span class="fu"&gt;:&lt;/span&gt; &lt;span class="st"&gt;"%f"&lt;/span&gt;&lt;span class="fu"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-8"&gt;&lt;a aria-hidden="true" href="#cb2-8" tabindex="-1"&gt;&lt;/a&gt;            &lt;span class="dt"&gt;"use_shell"&lt;/span&gt;&lt;span class="fu"&gt;:&lt;/span&gt; &lt;span class="kw"&gt;true&lt;/span&gt;&lt;span class="fu"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-9"&gt;&lt;a aria-hidden="true" href="#cb2-9" tabindex="-1"&gt;&lt;/a&gt;            &lt;span class="dt"&gt;"filetypes"&lt;/span&gt;&lt;span class="fu"&gt;:&lt;/span&gt; &lt;span class="ot"&gt;[&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-10"&gt;&lt;a aria-hidden="true" href="#cb2-10" tabindex="-1"&gt;&lt;/a&gt;                &lt;span class="st"&gt;"directory"&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-11"&gt;&lt;a aria-hidden="true" href="#cb2-11" tabindex="-1"&gt;&lt;/a&gt;            &lt;span class="ot"&gt;]&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-12"&gt;&lt;a aria-hidden="true" href="#cb2-12" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="fu"&gt;}&lt;/span&gt;&lt;span class="ot"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-13"&gt;&lt;a aria-hidden="true" href="#cb2-13" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="fu"&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-14"&gt;&lt;a aria-hidden="true" href="#cb2-14" tabindex="-1"&gt;&lt;/a&gt;            &lt;span class="dt"&gt;"type"&lt;/span&gt;&lt;span class="fu"&gt;:&lt;/span&gt; &lt;span class="st"&gt;"menu"&lt;/span&gt;&lt;span class="fu"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-15"&gt;&lt;a aria-hidden="true" href="#cb2-15" tabindex="-1"&gt;&lt;/a&gt;            &lt;span class="dt"&gt;"label"&lt;/span&gt;&lt;span class="fu"&gt;:&lt;/span&gt; &lt;span class="st"&gt;"Copy details"&lt;/span&gt;&lt;span class="fu"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-16"&gt;&lt;a aria-hidden="true" href="#cb2-16" tabindex="-1"&gt;&lt;/a&gt;            &lt;span class="dt"&gt;"actions"&lt;/span&gt;&lt;span class="fu"&gt;:&lt;/span&gt; &lt;span class="ot"&gt;[&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-17"&gt;&lt;a aria-hidden="true" href="#cb2-17" tabindex="-1"&gt;&lt;/a&gt;                &lt;span class="fu"&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-18"&gt;&lt;a aria-hidden="true" href="#cb2-18" tabindex="-1"&gt;&lt;/a&gt;                    &lt;span class="dt"&gt;"type"&lt;/span&gt;&lt;span class="fu"&gt;:&lt;/span&gt; &lt;span class="st"&gt;"command"&lt;/span&gt;&lt;span class="fu"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-19"&gt;&lt;a aria-hidden="true" href="#cb2-19" tabindex="-1"&gt;&lt;/a&gt;                    &lt;span class="dt"&gt;"label"&lt;/span&gt;&lt;span class="fu"&gt;:&lt;/span&gt; &lt;span class="st"&gt;"Copy name"&lt;/span&gt;&lt;span class="fu"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-20"&gt;&lt;a aria-hidden="true" href="#cb2-20" tabindex="-1"&gt;&lt;/a&gt;                    &lt;span class="dt"&gt;"command_line"&lt;/span&gt;&lt;span class="fu"&gt;:&lt;/span&gt; &lt;span class="st"&gt;"echo -n %B | xclip -f -selection primary | xclip -selection clipboard"&lt;/span&gt;&lt;span class="fu"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-21"&gt;&lt;a aria-hidden="true" href="#cb2-21" tabindex="-1"&gt;&lt;/a&gt;                    &lt;span class="dt"&gt;"use_shell"&lt;/span&gt;&lt;span class="fu"&gt;:&lt;/span&gt; &lt;span class="kw"&gt;true&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-22"&gt;&lt;a aria-hidden="true" href="#cb2-22" tabindex="-1"&gt;&lt;/a&gt;                &lt;span class="fu"&gt;}&lt;/span&gt;&lt;span class="ot"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-23"&gt;&lt;a aria-hidden="true" href="#cb2-23" tabindex="-1"&gt;&lt;/a&gt;                &lt;span class="fu"&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-24"&gt;&lt;a aria-hidden="true" href="#cb2-24" tabindex="-1"&gt;&lt;/a&gt;                    &lt;span class="dt"&gt;"type"&lt;/span&gt;&lt;span class="fu"&gt;:&lt;/span&gt; &lt;span class="st"&gt;"command"&lt;/span&gt;&lt;span class="fu"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-25"&gt;&lt;a aria-hidden="true" href="#cb2-25" tabindex="-1"&gt;&lt;/a&gt;                    &lt;span class="dt"&gt;"label"&lt;/span&gt;&lt;span class="fu"&gt;:&lt;/span&gt; &lt;span class="st"&gt;"Copy path"&lt;/span&gt;&lt;span class="fu"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-26"&gt;&lt;a aria-hidden="true" href="#cb2-26" tabindex="-1"&gt;&lt;/a&gt;                    &lt;span class="dt"&gt;"command_line"&lt;/span&gt;&lt;span class="fu"&gt;:&lt;/span&gt; &lt;span class="st"&gt;"echo -n %F | xclip -f -selection primary | xclip -selection clipboard"&lt;/span&gt;&lt;span class="fu"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-27"&gt;&lt;a aria-hidden="true" href="#cb2-27" tabindex="-1"&gt;&lt;/a&gt;                    &lt;span class="dt"&gt;"use_shell"&lt;/span&gt;&lt;span class="fu"&gt;:&lt;/span&gt; &lt;span class="kw"&gt;true&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-28"&gt;&lt;a aria-hidden="true" href="#cb2-28" tabindex="-1"&gt;&lt;/a&gt;                &lt;span class="fu"&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-29"&gt;&lt;a aria-hidden="true" href="#cb2-29" tabindex="-1"&gt;&lt;/a&gt;            &lt;span class="ot"&gt;]&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-30"&gt;&lt;a aria-hidden="true" href="#cb2-30" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="fu"&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-31"&gt;&lt;a aria-hidden="true" href="#cb2-31" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="ot"&gt;]&lt;/span&gt;&lt;span class="fu"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-32"&gt;&lt;a aria-hidden="true" href="#cb2-32" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="dt"&gt;"debug"&lt;/span&gt;&lt;span class="fu"&gt;:&lt;/span&gt; &lt;span class="kw"&gt;false&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-33"&gt;&lt;a aria-hidden="true" href="#cb2-33" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="fu"&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;当然保存以后可能还是没有生效，&lt;code&gt;nautilus -q&lt;/code&gt; 试试看，再不行就注销重新登陆一下。&lt;/p&gt;
&lt;p&gt;这一番折腾下来，说句老实话我的耐性基本上被消磨干净了。在其他类似软件里触手可及的功能却要配置老半天，而且说不定就在下次某个版本的“砍功能”环节中失效。&lt;/p&gt;
&lt;p&gt;我觉得 Gnome 的哲学是这样的：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;小而美（小的程序比对的程序更称心如意）&lt;/li&gt;
&lt;li&gt;简洁干净（达到最 要求就足够了）&lt;/li&gt;
&lt;li&gt;标准（标准可以有很多个，而且随时能更改）&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;所以，我的最终决定还是：&lt;/p&gt;
&lt;div class="sourceCode" id="cb3"&gt;&lt;pre class="sourceCode bash"&gt;&lt;code class="sourceCode bash"&gt;&lt;span id="cb3-1"&gt;&lt;a aria-hidden="true" href="#cb3-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="fu"&gt;sudo&lt;/span&gt; zypper in dolphin&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;参考：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://github.com/bassmanitram/actions-for-nautilus"&gt;actions-for-nautilus 的 Github 仓库&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://gitlab.gnome.org/Archive/nautilus-actions"&gt;已经死掉的 nautilus-actions&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://medium.com/@fulalas/gnome-linux-a-complete-disaster-feb27b13a5c2"&gt;Gnome 是一场灾难吗？&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;br/&gt;
&lt;!--%%REF%%--&gt;
&lt;br/&gt;
&lt;script async="" crossorigin="anonymous" data-category="Announcements" data-category-id="DIC_kwDOJ7Ymy84CX4eg" data-emit-metadata="0" data-input-position="top" data-lang="zh-CN" data-loading="lazy" data-mapping="title" data-reactions-enabled="1" data-repo="izfsk-ium/izfsk-ium.github.io" data-repo-id="R_kgDOJ7Ymyw" data-strict="0" data-theme="preferred_color_scheme" src="https://giscus.app/client.js"&gt;
&lt;/script&gt;
&lt;/main&gt;
&lt;footer&gt;
&lt;p class="signoff"&gt;
&lt;div class="metadata"&gt;
&lt;p class="date"&gt;&lt;time datetime="2023-04-13"&gt;创建日期：2023-04-13&lt;/time&gt;&lt;/p&gt;
&lt;p class="lastmodify"&gt;&lt;time&gt;最后编译：2023-08-10&lt;/time&gt;&lt;/p&gt;
&lt;p class="lastmodify" id="counter-span"&gt;访问次数：&lt;/p&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;/footer&gt;
&lt;script&gt;
    /* These script should run after page load */
    document.querySelectorAll('code.sourceCode').forEach(
      i =&gt; i.insertAdjacentHTML('beforeend', '&lt;div class="copy"&gt;复制&lt;/div&gt;')
    );
    document.querySelectorAll('div.copy').forEach(
      i =&gt; i.addEventListener(
        'click',
        () =&gt; {
          navigator.clipboard.writeText(i.parentElement.innerText.replace('复制', ''));
          i.innerText = '成功';
          setTimeout(() =&gt; {
            i.innerText = '复制';
          }, 1000);
        }
      )
    );

    if (location.href.includes("127.0.0.1:8080")) {
      document.getElementById("counter-span").innerHTML = "[[development mode]]";
    } else {
      const uuid = document.getElementById("article-uuid").innerText;
      const target = document.getElementById("counter-span");
      const last = localStorage.getItem("lastVisit-" + uuid);
      const shouldIncrease = last === null || new Date().getTime() - parseInt(last) &gt;= (1000 * 60 * 15);

      fetch(shouldIncrease ? ("https://counter.izfsk.top/counter/" + uuid) : ("https://counter.izfsk.top/readOnly/" + uuid))
        .then(r =&gt; r.text())
        .then(d =&gt; {
          if (!d.startsWith("Too"))
            document.getElementById("counter-span").innerText = "访问次数：" + d.toString();
          else
            document.getElementById("counter-span").innerHTML = "";
        });

      localStorage.setItem("lastVisit-" + uuid, new Date().getTime());
    }
  &lt;/script&gt;
&lt;script async="" data-website-id="2a1146ab-fa82-4a84-a04f-30e5967357c3" src="https://analytics.umami.is/script.js"&gt;&lt;/script&gt;
&lt;/body&gt;</content:encoded>
      <guid isPermaLink="false">de5bb46d-a069-4de8-b61b-18cfe5e38fc7</guid>
      <pubDate>Thu, 13 Apr 2023 00:00:00 +0800</pubDate>
    </item>
    <item>
      <title>关于光线追踪,颜色和反射</title>
      <link>https://blog.izfsk.top/articles/关于颜色和反射.html</link>
      <description>关于光线追踪,颜色和反射</description>
      <content:encoded>&lt;body&gt;
&lt;progress id="content_progress" value="0"&gt;&lt;/progress&gt;
&lt;button id="back-to-top"&gt;
    回页顶
  &lt;/button&gt;
&lt;header&gt;
&lt;small id="article-uuid" style="display: none !important;"&gt;5ef70152-7905-48bc-b22e-51a82d1956d6&lt;/small&gt;
&lt;h1 class="title"&gt;关于光线追踪,颜色和反射&lt;/h1&gt;
&lt;!-- Subtitle --&gt;
&lt;h3 class="subtitle"&gt; &lt;/h3&gt;
&lt;/header&gt;
&lt;nav id="TOC" role="doc-toc"&gt;
&lt;strong&gt;文章归类: &lt;a href="/pages/category.html#学习"&gt;学习&lt;/a&gt; &lt;/strong&gt;
&lt;input id="contents" type="checkbox"/&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#关于颜色" id="toc-关于颜色"&gt;关于颜色&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#减色模型subtractive-color-model" id="toc-减色模型subtractive-color-model"&gt;减色模型（&lt;code&gt;Subtractive Color Model&lt;/code&gt;）&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#增色模型additive-color-model" id="toc-增色模型additive-color-model"&gt;增色模型（&lt;code&gt;Additive Color Model&lt;/code&gt;）&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#颜色的相关计算" id="toc-颜色的相关计算"&gt;颜色的相关计算&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#关于光源" id="toc-关于光源"&gt;关于光源&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#点状光源point-lights或omnidirectional-lights" id="toc-点状光源point-lights或omnidirectional-lights"&gt;点状光源（&lt;code&gt;Point Lights&lt;/code&gt;或&lt;code&gt;Omnidirectional Lights&lt;/code&gt;）&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#有向光源directional-lights" id="toc-有向光源directional-lights"&gt;有向光源（&lt;code&gt;Directional Lights&lt;/code&gt;）&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#环境光源ambient-light" id="toc-环境光源ambient-light"&gt;环境光源（&lt;code&gt;Ambient Light&lt;/code&gt;）&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#关于反射" id="toc-关于反射"&gt;关于反射&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#法向normal" id="toc-法向normal"&gt;法向（&lt;code&gt;normal&lt;/code&gt;）&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#漫反射diffuse-reflection" id="toc-漫反射diffuse-reflection"&gt;漫反射（&lt;code&gt;Diffuse Reflection&lt;/code&gt;）&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#漫反射公式" id="toc-漫反射公式"&gt;漫反射公式&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#镜面反射specular-reflection" id="toc-镜面反射specular-reflection"&gt;镜面反射（&lt;code&gt;Specular Reflection&lt;/code&gt;）&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#镜面反射公式" id="toc-镜面反射公式"&gt;镜面反射公式&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#reference"&gt;参考链接&lt;/a&gt;&lt;/li&gt;
&lt;li&gt; &lt;/li&gt;
&lt;li class="tools"&gt;
&lt;span id="backtomain"&gt;
&lt;svg class="bi bi-house" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M8.707 1.5a1 1 0 0 0-1.414 0L.646 8.146a.5.5 0 0 0 .708.708L2 8.207V13.5A1.5 1.5 0 0 0 3.5 15h9a1.5 1.5 0 0 0 1.5-1.5V8.207l.646.647a.5.5 0 0 0 .708-.708L13 5.793V2.5a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v1.293L8.707 1.5ZM13 7.207V13.5a.5.5 0 0 1-.5.5h-9a.5.5 0 0 1-.5-.5V7.207l5-5 5 5Z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="readingmode"&gt;
&lt;svg class="bi bi-book" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M1 2.828c.885-.37 2.154-.769 3.388-.893 1.33-.134 2.458.063 3.112.752v9.746c-.935-.53-2.12-.603-3.213-.493-1.18.12-2.37.461-3.287.811V2.828zm7.5-.141c.654-.689 1.782-.886 3.112-.752 1.234.124 2.503.523 3.388.893v9.923c-.918-.35-2.107-.692-3.287-.81-1.094-.111-2.278-.039-3.213.492V2.687zM8 1.783C7.015.936 5.587.81 4.287.94c-1.514.153-3.042.672-3.994 1.105A.5.5 0 0 0 0 2.5v11a.5.5 0 0 0 .707.455c.882-.4 2.303-.881 3.68-1.02 1.409-.142 2.59.087 3.223.877a.5.5 0 0 0 .78 0c.633-.79 1.814-1.019 3.222-.877 1.378.139 2.8.62 3.681 1.02A.5.5 0 0 0 16 13.5v-11a.5.5 0 0 0-.293-.455c-.952-.433-2.48-.952-3.994-1.105C10.413.809 8.985.936 8 1.783z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="larger"&gt; &lt;/span&gt;
&lt;span id="smaller"&gt;&lt;/span&gt;
&lt;span id="switchfont"&gt;
&lt;svg class="bi bi-fonts" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M12.258 3h-8.51l-.083 2.46h.479c.26-1.544.758-1.783 2.693-1.845l.424-.013v7.827c0 .663-.144.82-1.3.923v.52h4.082v-.52c-1.162-.103-1.306-.26-1.306-.923V3.602l.431.013c1.934.062 2.434.301 2.693 1.846h.479L12.258 3z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="backtotop"&gt;
&lt;svg class="bi bi-arrow-bar-up" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M8 10a.5.5 0 0 0 .5-.5V3.707l2.146 2.147a.5.5 0 0 0 .708-.708l-3-3a.5.5 0 0 0-.708 0l-3 3a.5.5 0 1 0 .708.708L7.5 3.707V9.5a.5.5 0 0 0 .5.5zm-7 2.5a.5.5 0 0 1 .5-.5h13a.5.5 0 0 1 0 1h-13a.5.5 0 0 1-.5-.5z" fill-rule="evenodd"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/nav&gt;
&lt;main&gt;
&lt;h1 id="关于颜色"&gt;关于颜色&lt;/h1&gt;
&lt;p&gt;人类的眼睛只能看见特定波长的光（&lt;code&gt;visible range&lt;/code&gt;），低于的部分叫做红外线，高出的叫做紫外线。所有的颜色都可以看成是几种原色（&lt;code&gt;primary colors&lt;/code&gt;）的线性组合。&lt;/p&gt;
&lt;h2 id="减色模型subtractive-color-model"&gt;减色模型（&lt;code&gt;Subtractive Color Model&lt;/code&gt;）&lt;/h2&gt;
&lt;p&gt;物体反射光线，白色的光线照射到某个物体上，该物体在反射的同时吸收了一部分波长的光（这些颜色被“减去”）了。例如，白纸上的黄色图案只允许黄色通过，蓝色图案只允许蓝色通过，不断叠加，最后不允许任何颜色通过，那就是黑色。实际操作中的减色模型一般使用 &lt;code&gt;CMYK&lt;/code&gt; 模型，四中基本色是 Cyan, Magenta, Yellow 和 Black。&lt;/p&gt;
&lt;h2 id="增色模型additive-color-model"&gt;增色模型（&lt;code&gt;Additive Color Model&lt;/code&gt;）&lt;/h2&gt;
&lt;p&gt;有的物体不发光，有的物体发光。对于发光的物体，使用增色模型，例如电脑屏幕，放大以后就能看见小小的三种颜色的发光元件密集排列。在这种情况下，几种原色的混合不是形成黑色，而是形成白色。&lt;/p&gt;
&lt;h2 id="颜色的相关计算"&gt;颜色的相关计算&lt;/h2&gt;
&lt;p&gt;设一个颜色表示为：&lt;/p&gt;
&lt;p&gt;&lt;span class="math display"&gt;
    (R,G,B)
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;那么&lt;/p&gt;
&lt;p&gt;&lt;span class="math display"&gt;
    k\cdot(R,G,B) = (kR,kG,kB)
    &lt;/span&gt; &lt;span class="math display"&gt;
    (R_1,G_1,B_1)+(R_2,G_2,B_2)=(R_1+R_2,G_1+G_2,B_1+B_2)
    &lt;/span&gt;&lt;/p&gt;
&lt;h1 id="关于光源"&gt;关于光源&lt;/h1&gt;
&lt;h2 id="点状光源point-lights或omnidirectional-lights"&gt;点状光源（&lt;code&gt;Point Lights&lt;/code&gt;或&lt;code&gt;Omnidirectional Lights&lt;/code&gt;）&lt;/h2&gt;
&lt;p&gt;点状光源位于&lt;span class="math inline"&gt;3D&lt;/span&gt;空间中一点，向各个方向放射出光线，类似于白炽灯。对于空间中的任何一点，点状光源对其的光照向量都是不同的。&lt;/p&gt;
&lt;h2 id="有向光源directional-lights"&gt;有向光源（&lt;code&gt;Directional Lights&lt;/code&gt;）&lt;/h2&gt;
&lt;p&gt;有向光源没有位置，具有固定的方向，在地球上太阳就相当于一个有向光源。对于环境中的每一点，有向光源对其的光照向量的都是一样的。&lt;/p&gt;
&lt;h2 id="环境光源ambient-light"&gt;环境光源（&lt;code&gt;Ambient Light&lt;/code&gt;）&lt;/h2&gt;
&lt;p&gt;如果没有环境光源，那么没有被光源直接照射到的地方将会是完全的黑色，这并不河里，物体本身或多或少都会反射光，这些复杂的反射光构成了环境光源。它只有强度。对于一个场景来讲，只有一个环境光源，可以有任意个点状或有向光源。&lt;/p&gt;
&lt;h1 id="关于反射"&gt;关于反射&lt;/h1&gt;
&lt;h2 id="法向normal"&gt;法向（&lt;code&gt;normal&lt;/code&gt;）&lt;/h2&gt;
&lt;p&gt;黑话，全称是“法向量”。垂直于面上一点&lt;span class="math inline"&gt;P&lt;/span&gt;之单位向量谓之法向量，用于该面方向 之表征。想象一下&lt;code&gt;Blender&lt;/code&gt;里面拖动面的那个垂直箭头。&lt;/p&gt;
&lt;h2 id="漫反射diffuse-reflection"&gt;漫反射（&lt;code&gt;Diffuse Reflection&lt;/code&gt;）&lt;/h2&gt;
&lt;p&gt;漫反射的物体将光线均等的反射到所有方向，无论在什么方向看这个物体都是一样的。可以看成一个凹凸不平的平面，坑坑洼洼，所以光线被反射到各个不同的方向。例如纸张或者一般墙壁。漫反射所反射的光线的数量取决于光照的角度。角度越大，同样能量的光照就要分布到更大面积的物体上，那么这个物体受到的光照能量就越小。&lt;/p&gt;
&lt;p&gt;给漫反射建模，就是要找出给定光照的前提下，这个表面上的点到底反射出了啥。&lt;/p&gt;
&lt;figure&gt;
&lt;img alt="漫反射" src="./assets/06-diffuse-diagram.png"/&gt;
&lt;figcaption aria-hidden="true"&gt;漫反射&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;光线&lt;span class="math inline"&gt;L&lt;/span&gt;具有强度&lt;span class="math inline"&gt;I&lt;/span&gt;，方向&lt;span class="math inline"&gt;\vec L&lt;/span&gt;&lt;/li&gt;
&lt;li&gt;平面的法向量&lt;span class="math inline"&gt;N&lt;/span&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;假设光线的“宽度”(&lt;span class="math inline"&gt;I&lt;/span&gt;)就是它的强度，那么&lt;span class="math inline"&gt;A&lt;/span&gt;的长度就是平面得到的能量。可以看出随着&lt;span class="math inline"&gt;\beta&lt;/span&gt;越来越大，&lt;span class="math inline"&gt;A&lt;/span&gt;越来越趋近于&lt;span class="math inline"&gt;I&lt;/span&gt;，那么表面也就越亮，反之，&lt;span class="math inline"&gt;\lim_{A \to \infty} {I \over A} = 0&lt;/span&gt;，那么也就是一片黑暗了。&lt;/p&gt;
&lt;p&gt;毫无疑问，表面光照与法线和光照夹角有关，表示为一个函数：&lt;/p&gt;
&lt;p&gt;&lt;span class="math display"&gt;
    {I \over A}
    =
    {{\vec{N} \cdot \vec{L}} \over {|\vec{N}||\vec{L}|}}
    &lt;/span&gt;&lt;/p&gt;
&lt;h3 id="漫反射公式"&gt;漫反射公式&lt;/h3&gt;
&lt;p&gt;The Diffuse Reflection Equation：&lt;/p&gt;
&lt;p&gt;&lt;span class="math display"&gt;
    I_P =
    I_A
    +
    \sum_{i = 1}^{n} I_i
        {{\vec{N} \cdot \vec{L_i}}
        \over
        {|\vec{N}||\vec{L_i}|}}
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;其中：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;span class="math inline"&gt;I_P:&lt;/span&gt;具有法向&lt;span class="math inline"&gt;\vec N&lt;/span&gt;的点&lt;span class="math inline"&gt;P&lt;/span&gt;所获得的全部光照&lt;/li&gt;
&lt;li&gt;&lt;span class="math inline"&gt;I_A:&lt;/span&gt;环境光照的强度&lt;/li&gt;
&lt;li&gt;&lt;span class="math inline"&gt;{{\vec{N} \cdot \vec{L}} \over {|\vec{N}||\vec{L}|}}:{I \over A}&lt;/span&gt;&lt;/li&gt;
&lt;li&gt;&lt;span class="math inline"&gt;I_i \cdot {{\vec{N} \cdot \vec{L}} \over {|\vec{N}||\vec{L}|}}:&lt;/span&gt;计算光照强度&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="镜面反射specular-reflection"&gt;镜面反射（&lt;code&gt;Specular Reflection&lt;/code&gt;）&lt;/h2&gt;
&lt;p&gt;与漫反射不同，镜面反射就是让光线怎么进来怎么出去。很好理解。&lt;/p&gt;
&lt;figure&gt;
&lt;img alt="镜面反射" src="./assets/07-specular-diagram.png"/&gt;
&lt;figcaption aria-hidden="true"&gt;镜面反射&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;&lt;span class="math inline"&gt;N&lt;/span&gt;是法向，光线从&lt;span class="math inline"&gt;L&lt;/span&gt;进去，从&lt;span class="math inline"&gt;R&lt;/span&gt;出来，我们位于&lt;span class="math inline"&gt;V&lt;/span&gt;的摄影机看到的光线就是要计算的目标。当&lt;span class="math inline"&gt;\alpha=0&lt;/span&gt;，你就被亮瞎啦。&lt;/p&gt;
&lt;h3 id="镜面反射公式"&gt;镜面反射公式&lt;/h3&gt;
&lt;p&gt;&lt;span class="math display"&gt;
    \vec{R} = 2\vec{N} \langle \vec{N}, \vec{L} \rangle - \vec{L}
    &lt;/span&gt; &lt;span class="math display"&gt;
    I_S = I_L \left( {{\langle \vec{R}, \vec{V} \rangle} \over {|\vec{R}||\vec{V}|}} \right)^s
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;那么&lt;/p&gt;
&lt;p&gt;&lt;span class="math display"&gt;
    I_P = I_A + \sum_{i = 1}^{n} I_i \cdot \left[ {{{\langle \vec{N}, \vec{L_i} \rangle} \over {|\vec{N}||\vec{L_i}|}} + \left( {{\langle \vec{R_i}, \vec{V} \rangle} \over {|\vec{R_i}||\vec{V}|}} \right)^s} \right]
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;参考：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://www.gabrielgambetta.com/computer-graphics-from-scratch/03-light.html"&gt;computer-graphics-from-scratch - Light&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;br/&gt;
&lt;!--%%REF%%--&gt;
&lt;br/&gt;
&lt;script async="" crossorigin="anonymous" data-category="Announcements" data-category-id="DIC_kwDOJ7Ymy84CX4eg" data-emit-metadata="0" data-input-position="top" data-lang="zh-CN" data-loading="lazy" data-mapping="title" data-reactions-enabled="1" data-repo="izfsk-ium/izfsk-ium.github.io" data-repo-id="R_kgDOJ7Ymyw" data-strict="0" data-theme="preferred_color_scheme" src="https://giscus.app/client.js"&gt;
&lt;/script&gt;
&lt;/main&gt;
&lt;footer&gt;
&lt;p class="signoff"&gt;
&lt;div class="metadata"&gt;
&lt;p class="date"&gt;&lt;time datetime="2023-04-20"&gt;创建日期：2023-04-20&lt;/time&gt;&lt;/p&gt;
&lt;p class="lastmodify"&gt;&lt;time&gt;最后编译：2023-08-10&lt;/time&gt;&lt;/p&gt;
&lt;p class="lastmodify" id="counter-span"&gt;访问次数：&lt;/p&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;/footer&gt;
&lt;script&gt;
    /* These script should run after page load */
    document.querySelectorAll('code.sourceCode').forEach(
      i =&gt; i.insertAdjacentHTML('beforeend', '&lt;div class="copy"&gt;复制&lt;/div&gt;')
    );
    document.querySelectorAll('div.copy').forEach(
      i =&gt; i.addEventListener(
        'click',
        () =&gt; {
          navigator.clipboard.writeText(i.parentElement.innerText.replace('复制', ''));
          i.innerText = '成功';
          setTimeout(() =&gt; {
            i.innerText = '复制';
          }, 1000);
        }
      )
    );

    if (location.href.includes("127.0.0.1:8080")) {
      document.getElementById("counter-span").innerHTML = "[[development mode]]";
    } else {
      const uuid = document.getElementById("article-uuid").innerText;
      const target = document.getElementById("counter-span");
      const last = localStorage.getItem("lastVisit-" + uuid);
      const shouldIncrease = last === null || new Date().getTime() - parseInt(last) &gt;= (1000 * 60 * 15);

      fetch(shouldIncrease ? ("https://counter.izfsk.top/counter/" + uuid) : ("https://counter.izfsk.top/readOnly/" + uuid))
        .then(r =&gt; r.text())
        .then(d =&gt; {
          if (!d.startsWith("Too"))
            document.getElementById("counter-span").innerText = "访问次数：" + d.toString();
          else
            document.getElementById("counter-span").innerHTML = "";
        });

      localStorage.setItem("lastVisit-" + uuid, new Date().getTime());
    }
  &lt;/script&gt;
&lt;script async="" data-website-id="2a1146ab-fa82-4a84-a04f-30e5967357c3" src="https://analytics.umami.is/script.js"&gt;&lt;/script&gt;
&lt;/body&gt;</content:encoded>
      <guid isPermaLink="false">5ef70152-7905-48bc-b22e-51a82d1956d6</guid>
      <pubDate>Thu, 20 Apr 2023 00:00:00 +0800</pubDate>
    </item>
    <item>
      <title>刚好够用的线性代数基础</title>
      <link>https://blog.izfsk.top/articles/刚好够用的线性代数基础.html</link>
      <description>刚好够用的线性代数基础</description>
      <content:encoded>&lt;body&gt;
&lt;progress id="content_progress" value="0"&gt;&lt;/progress&gt;
&lt;button id="back-to-top"&gt;
    回页顶
  &lt;/button&gt;
&lt;header&gt;
&lt;small id="article-uuid" style="display: none !important;"&gt;45479e53-d727-48f5-8946-657556b4110c&lt;/small&gt;
&lt;h1 class="title"&gt;刚好够用的线性代数基础&lt;/h1&gt;
&lt;!-- Subtitle --&gt;
&lt;h3 class="subtitle"&gt; &lt;/h3&gt;
&lt;/header&gt;
&lt;nav id="TOC" role="doc-toc"&gt;
&lt;strong&gt;文章归类: &lt;a href="/pages/category.html#学习"&gt;学习&lt;/a&gt; &lt;/strong&gt;
&lt;input id="contents" type="checkbox"/&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#向量向量运算和矩阵运算" id="toc-向量向量运算和矩阵运算"&gt;向量、向量运算和矩阵运算&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#向量vector" id="toc-向量vector"&gt;向量(&lt;code&gt;vector&lt;/code&gt;)&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#向量的长度vector-magnitude" id="toc-向量的长度vector-magnitude"&gt;向量的长度(&lt;code&gt;Vector Magnitude&lt;/code&gt;)&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#从点到向量" id="toc-从点到向量"&gt;从点到向量&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#向量的加法" id="toc-向量的加法"&gt;向量的加法&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#放缩scalar-product" id="toc-放缩scalar-product"&gt;放缩(&lt;code&gt;scalar product&lt;/code&gt;)&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#点乘dot-product" id="toc-点乘dot-product"&gt;点乘(&lt;code&gt;Dot Product&lt;/code&gt;)&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#叉积cross-product" id="toc-叉积cross-product"&gt;叉积（&lt;code&gt;Cross Product&lt;/code&gt;）&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#矩阵matrix" id="toc-矩阵matrix"&gt;矩阵（&lt;code&gt;Matrix&lt;/code&gt;）&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#行列式determinant" id="toc-行列式determinant"&gt;行列式(&lt;code&gt;determinant&lt;/code&gt;)：&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#加法" id="toc-加法"&gt;加法：&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#点乘" id="toc-点乘"&gt;点乘：&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#矩阵向量乘法" id="toc-矩阵向量乘法"&gt;矩阵向量乘法：&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#矩阵乘矩阵" id="toc-矩阵乘矩阵"&gt;矩阵乘矩阵&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#矩阵和线性方程组" id="toc-矩阵和线性方程组"&gt;矩阵和线性方程组&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#矩阵的逆" id="toc-矩阵的逆"&gt;矩阵的逆&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#秩rank" id="toc-秩rank"&gt;秩(&lt;code&gt;Rank&lt;/code&gt;)&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#reference"&gt;参考链接&lt;/a&gt;&lt;/li&gt;
&lt;li&gt; &lt;/li&gt;
&lt;li class="tools"&gt;
&lt;span id="backtomain"&gt;
&lt;svg class="bi bi-house" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M8.707 1.5a1 1 0 0 0-1.414 0L.646 8.146a.5.5 0 0 0 .708.708L2 8.207V13.5A1.5 1.5 0 0 0 3.5 15h9a1.5 1.5 0 0 0 1.5-1.5V8.207l.646.647a.5.5 0 0 0 .708-.708L13 5.793V2.5a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v1.293L8.707 1.5ZM13 7.207V13.5a.5.5 0 0 1-.5.5h-9a.5.5 0 0 1-.5-.5V7.207l5-5 5 5Z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="readingmode"&gt;
&lt;svg class="bi bi-book" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M1 2.828c.885-.37 2.154-.769 3.388-.893 1.33-.134 2.458.063 3.112.752v9.746c-.935-.53-2.12-.603-3.213-.493-1.18.12-2.37.461-3.287.811V2.828zm7.5-.141c.654-.689 1.782-.886 3.112-.752 1.234.124 2.503.523 3.388.893v9.923c-.918-.35-2.107-.692-3.287-.81-1.094-.111-2.278-.039-3.213.492V2.687zM8 1.783C7.015.936 5.587.81 4.287.94c-1.514.153-3.042.672-3.994 1.105A.5.5 0 0 0 0 2.5v11a.5.5 0 0 0 .707.455c.882-.4 2.303-.881 3.68-1.02 1.409-.142 2.59.087 3.223.877a.5.5 0 0 0 .78 0c.633-.79 1.814-1.019 3.222-.877 1.378.139 2.8.62 3.681 1.02A.5.5 0 0 0 16 13.5v-11a.5.5 0 0 0-.293-.455c-.952-.433-2.48-.952-3.994-1.105C10.413.809 8.985.936 8 1.783z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="larger"&gt; &lt;/span&gt;
&lt;span id="smaller"&gt;&lt;/span&gt;
&lt;span id="switchfont"&gt;
&lt;svg class="bi bi-fonts" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M12.258 3h-8.51l-.083 2.46h.479c.26-1.544.758-1.783 2.693-1.845l.424-.013v7.827c0 .663-.144.82-1.3.923v.52h4.082v-.52c-1.162-.103-1.306-.26-1.306-.923V3.602l.431.013c1.934.062 2.434.301 2.693 1.846h.479L12.258 3z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="backtotop"&gt;
&lt;svg class="bi bi-arrow-bar-up" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M8 10a.5.5 0 0 0 .5-.5V3.707l2.146 2.147a.5.5 0 0 0 .708-.708l-3-3a.5.5 0 0 0-.708 0l-3 3a.5.5 0 1 0 .708.708L7.5 3.707V9.5a.5.5 0 0 0 .5.5zm-7 2.5a.5.5 0 0 1 .5-.5h13a.5.5 0 0 1 0 1h-13a.5.5 0 0 1-.5-.5z" fill-rule="evenodd"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/nav&gt;
&lt;main&gt;
&lt;h1 id="向量向量运算和矩阵运算"&gt;向量、向量运算和矩阵运算&lt;/h1&gt;
&lt;h2 id="向量vector"&gt;向量(&lt;code&gt;vector&lt;/code&gt;)&lt;/h2&gt;
&lt;p&gt;表示两点之间的不同，可以看作是指示一个点如何向另外一个点移动。区分两个向量的要素：&lt;strong&gt;方向(&lt;code&gt;direction&lt;/code&gt;)&lt;/strong&gt;和&lt;strong&gt;长度(&lt;code&gt;magnitude&lt;/code&gt;)&lt;/strong&gt;。&lt;/p&gt;
&lt;h2 id="向量的长度vector-magnitude"&gt;向量的长度(&lt;code&gt;Vector Magnitude&lt;/code&gt;)&lt;/h2&gt;
&lt;p&gt;向量的长度这样表示：&lt;span class="math inline"&gt;|\vec V|&lt;/span&gt;，可以通过坐标计算：&lt;/p&gt;
&lt;p&gt;&lt;span class="math display"&gt;
    |\vec V| = \sqrt{V_x^2+V_y^2+V_z^2}
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;就是说，把这个向量挪到原点那里，然后计算“那条线段”的长度。&lt;/p&gt;
&lt;h2 id="从点到向量"&gt;从点到向量&lt;/h2&gt;
&lt;p&gt;向量指两个点怎么移动，假如说有两个点&lt;span class="math inline"&gt;P&lt;/span&gt;和&lt;span class="math inline"&gt;Q&lt;/span&gt;，要指示&lt;span class="math inline"&gt;P&lt;/span&gt;移动到&lt;span class="math inline"&gt;Q&lt;/span&gt;，就是：&lt;/p&gt;
&lt;p&gt;&lt;span class="math display"&gt;
    P+\vec V = Q , \vec V = Q-P
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;计算的方法就是点的坐标运算。&lt;/p&gt;
&lt;h2 id="向量的加法"&gt;向量的加法&lt;/h2&gt;
&lt;p&gt;&lt;span class="math display"&gt;
    \vec V+\vec W=(V_x,V_y,V_z)+(W_x,W_y,W_z)=(V_x+W_x,V_y+W_y,V_z+W_z)
    &lt;/span&gt;&lt;/p&gt;
&lt;h2 id="放缩scalar-product"&gt;放缩(&lt;code&gt;scalar product&lt;/code&gt;)&lt;/h2&gt;
&lt;p&gt;通过乘一个数，把向量变长变短或者改变方向：&lt;span class="math inline"&gt;k \cdot \vec V = k \cdot (V_x,V_y,V_z) = (k \cdot V_x,k \cdot V_y,k \cdot V_z)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;除法就是乘它的倒数。把一个向量除它的长度得到单位向量。&lt;/p&gt;
&lt;p&gt;&lt;span class="math display"&gt;
    \vec {V_{normalize}} = \frac{\vec V}{|\vec V|}
    &lt;/span&gt;&lt;/p&gt;
&lt;h2 id="点乘dot-product"&gt;点乘(&lt;code&gt;Dot Product&lt;/code&gt;)&lt;/h2&gt;
&lt;p&gt;表示方法：&lt;span class="math inline"&gt;\vec V \cdot \vec W&lt;/span&gt; 或者 &lt;span class="math inline"&gt;\langle \vec V,\vec W\rangle&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;计算方法：&lt;/p&gt;
&lt;p&gt;&lt;span class="math display"&gt;
    \vec V \cdot \vec W = V_x \cdot W_x + V_y \cdot W_y + V_z \cdot W_z
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;或者&lt;/p&gt;
&lt;p&gt;&lt;span class="math display"&gt;
    \vec V \cdot \vec W = |\vec V|\cdot|\vec W|\cdot\cos(\alpha)
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;其中 &lt;span class="math inline"&gt;\alpha&lt;/span&gt; 是两个向量的夹角&lt;/p&gt;
&lt;p&gt;其他：&lt;/p&gt;
&lt;p&gt;&lt;span class="math display"&gt;
    \alpha = \cos^{-1}(\frac{\vec V \cdot \vec W}{|\vec V|\cdot|\vec W|})
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class="math display"&gt;
    |\vec V| = \sqrt{\vec V \cdot \vec V}
    &lt;/span&gt;&lt;/p&gt;
&lt;h2 id="叉积cross-product"&gt;叉积（&lt;code&gt;Cross Product&lt;/code&gt;）&lt;/h2&gt;
&lt;p&gt;向量的 Cross Product（叉积）是一种二元运算，其结果是一个向量。写作 &lt;span class="math inline"&gt;\vec V \times \vec W&lt;/span&gt;，三维空间中的两个向量的叉积大小等于两个向量所在平行四边形的面积。&lt;/p&gt;
&lt;p&gt;如果 &lt;span class="math inline"&gt;\vec R = \vec V \times \vec W&lt;/span&gt;，那么：&lt;/p&gt;
&lt;p&gt;&lt;span class="math display"&gt;
    R_x = V_y \cdot W_z - V_z \cdot W_y
    &lt;/span&gt; &lt;span class="math display"&gt;
    R_y = V_z \cdot W_x - V_x \cdot W_z
    &lt;/span&gt; &lt;span class="math display"&gt;
    R_z = V_x \cdot W_y - V_y \cdot W_x
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;注意&lt;/strong&gt;：&lt;span class="math inline"&gt;\vec V \times \vec W = -(\vec W \times \vec V)&lt;/span&gt;&lt;/p&gt;
&lt;h1 id="矩阵matrix"&gt;矩阵（&lt;code&gt;Matrix&lt;/code&gt;）&lt;/h1&gt;
&lt;p&gt;矩阵就是一个方框里面的一堆数字，嗯。&lt;/p&gt;
&lt;h2 id="行列式determinant"&gt;行列式(&lt;code&gt;determinant&lt;/code&gt;)：&lt;/h2&gt;
&lt;p&gt;行列式是一个矩阵的一个标量值，用于描述线性变换对面积或体积的缩放因子。就是说，对于一个线性变换，行列式得到的是这个变换对面积或者体积产生的变化。&lt;del&gt;为什么翻译成“行列式”&lt;/del&gt;。&lt;/p&gt;
&lt;p&gt;计算方法：&lt;/p&gt;
&lt;p&gt;&lt;span class="math display"&gt;
    dec(
        \begin{bmatrix}
        a &amp;amp; b \\
        c &amp;amp; d
        \end{bmatrix}
    ) =  ad -  bc
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;例如：&lt;/p&gt;
&lt;p&gt;&lt;span class="math display"&gt;
    dec(
    \begin{bmatrix}
    0.0 &amp;amp; 2.0 \\
    -1.5 &amp;amp; 1.0
    \end{bmatrix}
    )
    =
    3.0
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;表示这个线性变换把原来平面里面所以的图形的面积缩放两三倍。如果行列式的结果得到&lt;span class="math inline"&gt;0&lt;/span&gt;，就意味着这个线性变换进行了降维。&lt;/p&gt;
&lt;p&gt;考虑这个行列式：&lt;/p&gt;
&lt;p&gt;&lt;span class="math display"&gt;
    dec(
        \begin{bmatrix}
        2 &amp;amp; 1 \\
        -1 &amp;amp; -3
        \end{bmatrix}
    ) = -5.0
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;出现了一个负数，这意味着这个线性变换把整个空间翻了个面。&lt;/p&gt;
&lt;h2 id="加法"&gt;加法：&lt;/h2&gt;
&lt;p&gt;&lt;span class="math display"&gt;
    \begin{bmatrix}
    a &amp;amp; b &amp;amp; c \\
    d &amp;amp; e &amp;amp; f \\
    g &amp;amp; h &amp;amp; i
    \end{bmatrix}
    +
    \begin{bmatrix}
    j &amp;amp; k &amp;amp; l \\
    m &amp;amp; n &amp;amp; o \\
    p &amp;amp; q &amp;amp; r
    \end{bmatrix}
    =
    \begin{bmatrix}
    a+j &amp;amp; b+k &amp;amp; c+l \\
    d+m &amp;amp; e+n &amp;amp; f+o \\
    g+p &amp;amp; h+q &amp;amp; i+r
    \end{bmatrix}
    &lt;/span&gt;&lt;/p&gt;
&lt;h2 id="点乘"&gt;点乘：&lt;/h2&gt;
&lt;p&gt;&lt;span class="math display"&gt;
    n \cdot
    \begin{bmatrix}
    a &amp;amp; b &amp;amp; c \\
    d &amp;amp; e &amp;amp; f \\
    g &amp;amp; h &amp;amp; i
    \end{bmatrix}
    =
    \begin{bmatrix}
    n \cdot a &amp;amp; n \cdot b &amp;amp; n \cdot c \\
    n \cdot d &amp;amp; n \cdot e &amp;amp; n \cdot f \\
    n \cdot g &amp;amp; n \cdot h &amp;amp; n \cdot i
    \end{bmatrix}
    &lt;/span&gt;&lt;/p&gt;
&lt;h2 id="矩阵向量乘法"&gt;矩阵向量乘法：&lt;/h2&gt;
&lt;p&gt;“线性变换”是处理向量的函数，空间会因为各种变换而扭曲变形，如果一个变换是线性变换，那么：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;直线依旧是直线&lt;/li&gt;
&lt;li&gt;原点保持不动&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;用数学方法描述这种变换，例如，“把空间网格旋转九十度”，只需要描述和记录两个基向量即可，其他的向量都可以通过（变化后的基向量）计算出来，于是，一个二维空间的线性变换可以用四个数字确定：&lt;strong&gt;变化后的两个基向量的坐标&lt;/strong&gt;。把这四个数字放在一起，变成 &lt;span class="math inline"&gt;2 \times 2&lt;/span&gt; 矩阵：&lt;/p&gt;
&lt;p&gt;&lt;span class="math display"&gt;
    \begin{bmatrix}
    a &amp;amp; b \\
    c &amp;amp; d
    \end{bmatrix}
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;其中，&lt;span class="math inline"&gt;a&lt;/span&gt; 和 &lt;span class="math inline"&gt;c&lt;/span&gt; 是第一个基向量的坐标，&lt;span class="math inline"&gt;b&lt;/span&gt; 和 &lt;span class="math inline"&gt;d&lt;/span&gt; 是第二个基向量的坐标。&lt;/p&gt;
&lt;p&gt;那么想要知道这个矩阵所描述的线性变换对给定的向量的作用效果，就是把它和这个矩阵相乘：&lt;/p&gt;
&lt;p&gt;&lt;span class="math display"&gt;
    \begin{bmatrix}
    a &amp;amp; b \\
    c &amp;amp; d
    \end{bmatrix}
    \cdot
    \begin{bmatrix}
    x \\
    y
    \end{bmatrix}
    =
    x \cdot
    \begin{bmatrix}
    a \\
    c
    \end{bmatrix}
    +
    y \cdot
    \begin{bmatrix}
    b \\
    d
    \end{bmatrix}
    =
    \begin{bmatrix}
    ax + by \\
    cx + dy
    \end{bmatrix}
    &lt;/span&gt;&lt;/p&gt;
&lt;h2 id="矩阵乘矩阵"&gt;矩阵乘矩阵&lt;/h2&gt;
&lt;p&gt;向量乘矩阵，表示的是对该向量应用矩阵所描述的线性变化，那么，如果要对这个向量做多次变换：&lt;/p&gt;
&lt;p&gt;先进行一个变换：&lt;/p&gt;
&lt;p&gt;&lt;span class="math display"&gt;
    \begin{bmatrix}
    a_1 &amp;amp; b_1 \\
    c_1 &amp;amp; d_1
    \end{bmatrix}
    \begin{bmatrix}
    x \\ y
    \end{bmatrix}
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;再进行第二个变换：&lt;/p&gt;
&lt;p&gt;&lt;span class="math display"&gt;
    \begin{bmatrix}
    a_2 &amp;amp; b_2 \\
    c_2 &amp;amp; d_2
    \end{bmatrix}
    (
    \begin{bmatrix}
    a_1 &amp;amp; b_1 \\
    c_1 &amp;amp; d_1
    \end{bmatrix}
    \begin{bmatrix}
    x \\ y
    \end{bmatrix}
    )
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;而这个“多次变换”的过程，可以复合起来，看作一个操作，那么就可以写成：&lt;/p&gt;
&lt;p&gt;&lt;span class="math display"&gt;
    \begin{bmatrix}
    a_3 &amp;amp; b_3 \\
    c_3 &amp;amp; d_3
    \end{bmatrix}
    \begin{bmatrix}
    x \\ y
    \end{bmatrix}
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;于是，把两个式子的 &lt;span class="math inline"&gt;\begin{bmatrix} x \\ y \end{bmatrix}&lt;/span&gt;删掉，就得到了&lt;strong&gt;矩阵乘法&lt;/strong&gt;，它的含义就是：复合两个线性变换，计算方法：&lt;/p&gt;
&lt;p&gt;&lt;span class="math display"&gt;
    \begin{bmatrix}
    a &amp;amp; b \\
    c &amp;amp; d
    \end{bmatrix}
    \begin{bmatrix}
    e &amp;amp; f \\
    g &amp;amp; h    
    \end{bmatrix}
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;首先计算应用左边变换后的第一个基向量：&lt;/p&gt;
&lt;p&gt;&lt;span class="math display"&gt;
    \begin{bmatrix}
    a &amp;amp; b \\
    c &amp;amp; d
    \end{bmatrix}\cdot
    \begin{bmatrix}
    e \\ g
    \end{bmatrix}
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;得到的就是最终结果的第一个基向量。同样的，对右边的基向量进行操作，得到第二个基向量：&lt;/p&gt;
&lt;p&gt;&lt;span class="math display"&gt;
    \begin{bmatrix}
    a &amp;amp; b \\
    c &amp;amp; d
    \end{bmatrix}\cdot
    \begin{bmatrix}
    f \\ h
    \end{bmatrix}
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;所以&lt;/p&gt;
&lt;p&gt;&lt;span class="math display"&gt;
    \begin{bmatrix}
    a &amp;amp; b \\
    c &amp;amp; d
    \end{bmatrix}
    \begin{bmatrix}
    e &amp;amp; f \\
    g &amp;amp; h    
    \end{bmatrix}
    =
    \begin{bmatrix}
    ae+bg &amp;amp; af+bh \\
    ce+dg &amp;amp; cf+dh
    \end{bmatrix}
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;注意&lt;/strong&gt;：&lt;span class="math inline"&gt;M_1 M_2\ne M_2 M_1&lt;/span&gt;&lt;/p&gt;
&lt;h2 id="矩阵和线性方程组"&gt;矩阵和线性方程组&lt;/h2&gt;
&lt;p&gt;矩阵可以用来表示线性方程组，把所有的系数写起来，叫做&lt;strong&gt;系数矩阵&lt;/strong&gt;，把后面的常数项也写进来，叫做&lt;strong&gt;增广矩阵&lt;/strong&gt;。 &lt;span class="math display"&gt;
    \begin{cases}
    ax+by=e \\
    cx+dy=f
    \end{cases}
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;可以写成：&lt;/p&gt;
&lt;p&gt;&lt;span class="math display"&gt;
    \begin{bmatrix}
    a &amp;amp; b &amp;amp; e \\
    c &amp;amp; d &amp;amp; f
    \end{bmatrix}
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;而如果把未知数提出来，写成向量的形式，那么：&lt;/p&gt;
&lt;p&gt;&lt;span class="math display"&gt;
    \begin{bmatrix}
    a &amp;amp; b \\
    c &amp;amp; d
    \end{bmatrix}
    \begin{bmatrix}
    x \\
    y
    \end{bmatrix}
    =
    \begin{bmatrix}
    e \\
    f
    \end{bmatrix}
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;可以写成&lt;span class="math inline"&gt;A\vec x=\vec v&lt;/span&gt;就意味着：对向量&lt;span class="math inline"&gt;\vec {xy}&lt;/span&gt;所在的空间进行一个变换，使得变换后的该向量落在新的&lt;span class="math inline"&gt;\vec {ef}&lt;/span&gt;重合。&lt;/p&gt;
&lt;p&gt;判断这样的解是否存在可以用到行列式，如果&lt;span class="math inline"&gt;det(x)=0&lt;/span&gt;就意味这个空间被“压缩到更低的维度”。&lt;/p&gt;
&lt;h2 id="矩阵的逆"&gt;矩阵的逆&lt;/h2&gt;
&lt;p&gt;矩阵的逆写作&lt;span class="math inline"&gt;A^{-1}&lt;/span&gt;，意思是进行这个矩阵所描述的线性变换的逆向变换，于是&lt;span class="math inline"&gt;A^{-1}A&lt;/span&gt;就是“什么也不做”。&lt;/p&gt;
&lt;h2 id="秩rank"&gt;秩(&lt;code&gt;Rank&lt;/code&gt;)&lt;/h2&gt;
&lt;p&gt;秩代表变换后空间的维数，也就是列空间的维数。对于一个向量&lt;span class="math inline"&gt;\vec V&lt;/span&gt;，应用变换&lt;span class="math inline"&gt;A&lt;/span&gt;所得到的所有可能的向量的集合称为&lt;strong&gt;&lt;span class="math inline"&gt;A&lt;/span&gt;的列空间&lt;/strong&gt;。秩与列数相等，称为&lt;strong&gt;满秩&lt;/strong&gt;。&lt;/p&gt;
&lt;p&gt;对于一个变换，总是有一些向量在变换过后位于原点，例如&lt;span class="math inline"&gt;\begin{bmatrix} 0 \\ 0 \end{bmatrix}&lt;/span&gt;总是变化后位于原点，无论是什么变换。而对于非满秩的变换，总有一个直线或者一个面或者其他什么东西被“压缩”到原点位置，这些倒霉向量的集合成为&lt;strong&gt;核&lt;/strong&gt;或者&lt;strong&gt;零空间&lt;/strong&gt;&lt;/p&gt;
&lt;br/&gt;
&lt;!--%%REF%%--&gt;
&lt;br/&gt;
&lt;script async="" crossorigin="anonymous" data-category="Announcements" data-category-id="DIC_kwDOJ7Ymy84CX4eg" data-emit-metadata="0" data-input-position="top" data-lang="zh-CN" data-loading="lazy" data-mapping="title" data-reactions-enabled="1" data-repo="izfsk-ium/izfsk-ium.github.io" data-repo-id="R_kgDOJ7Ymyw" data-strict="0" data-theme="preferred_color_scheme" src="https://giscus.app/client.js"&gt;
&lt;/script&gt;
&lt;/main&gt;
&lt;footer&gt;
&lt;p class="signoff"&gt;
&lt;div class="metadata"&gt;
&lt;p class="date"&gt;&lt;time datetime="2023-04-21"&gt;创建日期：2023-04-21&lt;/time&gt;&lt;/p&gt;
&lt;p class="lastmodify"&gt;&lt;time&gt;最后编译：2023-08-10&lt;/time&gt;&lt;/p&gt;
&lt;p class="lastmodify" id="counter-span"&gt;访问次数：&lt;/p&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;/footer&gt;
&lt;script&gt;
    /* These script should run after page load */
    document.querySelectorAll('code.sourceCode').forEach(
      i =&gt; i.insertAdjacentHTML('beforeend', '&lt;div class="copy"&gt;复制&lt;/div&gt;')
    );
    document.querySelectorAll('div.copy').forEach(
      i =&gt; i.addEventListener(
        'click',
        () =&gt; {
          navigator.clipboard.writeText(i.parentElement.innerText.replace('复制', ''));
          i.innerText = '成功';
          setTimeout(() =&gt; {
            i.innerText = '复制';
          }, 1000);
        }
      )
    );

    if (location.href.includes("127.0.0.1:8080")) {
      document.getElementById("counter-span").innerHTML = "[[development mode]]";
    } else {
      const uuid = document.getElementById("article-uuid").innerText;
      const target = document.getElementById("counter-span");
      const last = localStorage.getItem("lastVisit-" + uuid);
      const shouldIncrease = last === null || new Date().getTime() - parseInt(last) &gt;= (1000 * 60 * 15);

      fetch(shouldIncrease ? ("https://counter.izfsk.top/counter/" + uuid) : ("https://counter.izfsk.top/readOnly/" + uuid))
        .then(r =&gt; r.text())
        .then(d =&gt; {
          if (!d.startsWith("Too"))
            document.getElementById("counter-span").innerText = "访问次数：" + d.toString();
          else
            document.getElementById("counter-span").innerHTML = "";
        });

      localStorage.setItem("lastVisit-" + uuid, new Date().getTime());
    }
  &lt;/script&gt;
&lt;script async="" data-website-id="2a1146ab-fa82-4a84-a04f-30e5967357c3" src="https://analytics.umami.is/script.js"&gt;&lt;/script&gt;
&lt;/body&gt;</content:encoded>
      <guid isPermaLink="false">45479e53-d727-48f5-8946-657556b4110c</guid>
      <pubDate>Fri, 21 Apr 2023 00:00:00 +0800</pubDate>
    </item>
    <item>
      <title>基础光线追踪</title>
      <link>https://blog.izfsk.top/articles/基础光线追踪.html</link>
      <description>基础光线追踪</description>
      <content:encoded>&lt;body&gt;
&lt;progress id="content_progress" value="0"&gt;&lt;/progress&gt;
&lt;button id="back-to-top"&gt;
    回页顶
  &lt;/button&gt;
&lt;header&gt;
&lt;small id="article-uuid" style="display: none !important;"&gt;3d0d8a7b-1966-435e-98dd-b4c59ffd581f&lt;/small&gt;
&lt;h1 class="title"&gt;基础光线追踪&lt;/h1&gt;
&lt;!-- Subtitle --&gt;
&lt;h3 class="subtitle"&gt; &lt;/h3&gt;
&lt;/header&gt;
&lt;nav id="TOC" role="doc-toc"&gt;
&lt;strong&gt;文章归类: &lt;a href="/pages/category.html#学习"&gt;学习&lt;/a&gt; &lt;/strong&gt;
&lt;input id="contents" type="checkbox"/&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#光线追踪" id="toc-光线追踪"&gt;光线追踪&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#光路表示" id="toc-光路表示"&gt;光路表示&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#球的表示" id="toc-球的表示"&gt;球的表示&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#方程组" id="toc-方程组"&gt;方程组&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#reference"&gt;参考链接&lt;/a&gt;&lt;/li&gt;
&lt;li&gt; &lt;/li&gt;
&lt;li class="tools"&gt;
&lt;span id="backtomain"&gt;
&lt;svg class="bi bi-house" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M8.707 1.5a1 1 0 0 0-1.414 0L.646 8.146a.5.5 0 0 0 .708.708L2 8.207V13.5A1.5 1.5 0 0 0 3.5 15h9a1.5 1.5 0 0 0 1.5-1.5V8.207l.646.647a.5.5 0 0 0 .708-.708L13 5.793V2.5a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v1.293L8.707 1.5ZM13 7.207V13.5a.5.5 0 0 1-.5.5h-9a.5.5 0 0 1-.5-.5V7.207l5-5 5 5Z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="readingmode"&gt;
&lt;svg class="bi bi-book" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M1 2.828c.885-.37 2.154-.769 3.388-.893 1.33-.134 2.458.063 3.112.752v9.746c-.935-.53-2.12-.603-3.213-.493-1.18.12-2.37.461-3.287.811V2.828zm7.5-.141c.654-.689 1.782-.886 3.112-.752 1.234.124 2.503.523 3.388.893v9.923c-.918-.35-2.107-.692-3.287-.81-1.094-.111-2.278-.039-3.213.492V2.687zM8 1.783C7.015.936 5.587.81 4.287.94c-1.514.153-3.042.672-3.994 1.105A.5.5 0 0 0 0 2.5v11a.5.5 0 0 0 .707.455c.882-.4 2.303-.881 3.68-1.02 1.409-.142 2.59.087 3.223.877a.5.5 0 0 0 .78 0c.633-.79 1.814-1.019 3.222-.877 1.378.139 2.8.62 3.681 1.02A.5.5 0 0 0 16 13.5v-11a.5.5 0 0 0-.293-.455c-.952-.433-2.48-.952-3.994-1.105C10.413.809 8.985.936 8 1.783z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="larger"&gt; &lt;/span&gt;
&lt;span id="smaller"&gt;&lt;/span&gt;
&lt;span id="switchfont"&gt;
&lt;svg class="bi bi-fonts" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M12.258 3h-8.51l-.083 2.46h.479c.26-1.544.758-1.783 2.693-1.845l.424-.013v7.827c0 .663-.144.82-1.3.923v.52h4.082v-.52c-1.162-.103-1.306-.26-1.306-.923V3.602l.431.013c1.934.062 2.434.301 2.693 1.846h.479L12.258 3z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="backtotop"&gt;
&lt;svg class="bi bi-arrow-bar-up" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M8 10a.5.5 0 0 0 .5-.5V3.707l2.146 2.147a.5.5 0 0 0 .708-.708l-3-3a.5.5 0 0 0-.708 0l-3 3a.5.5 0 1 0 .708.708L7.5 3.707V9.5a.5.5 0 0 0 .5.5zm-7 2.5a.5.5 0 0 1 .5-.5h13a.5.5 0 0 1 0 1h-13a.5.5 0 0 1-.5-.5z" fill-rule="evenodd"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/nav&gt;
&lt;main&gt;
&lt;h1 id="光线追踪"&gt;光线追踪&lt;/h1&gt;
&lt;p&gt;如图所示&lt;/p&gt;
&lt;figure&gt;
&lt;img alt="图示" src="./assets/viewport.png.png"/&gt;
&lt;figcaption aria-hidden="true"&gt;图示&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;摄像机位于坐标系原点，设为&lt;span class="math inline"&gt;O&lt;/span&gt;，方框则为 Viewport．设&lt;span class="math inline"&gt;V_w=V_h=d=1&lt;/span&gt;单位长度时，视角&lt;span class="math inline"&gt;FOV=53^o&lt;/span&gt;.要从&lt;span class="math inline"&gt;O&lt;/span&gt;进行光线追踪，就是从原点发出一条射线(实际的光线是从物体反射到摄影机，而不是从摄影机发射出去)，穿过 Viewport 直达物体. 光线追踪的算法如下：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;❶Place the camera and the viewport as desired
For each pixel on the canvas
❷Determine which square on the viewport corresponds to this pixel
❸Determine the color seen through that square
❹Paint the pixel with that color&lt;/code&gt;&lt;/pre&gt;
&lt;ol type="1"&gt;
&lt;li&gt;放置摄像机(camera)和(viewport)&lt;/li&gt;
&lt;li&gt;对于画布(canvas)上的每一个点:
    &lt;ul&gt;
&lt;li&gt;找出 Viewport 上对应的那一个点&lt;/li&gt;
&lt;li&gt;找出对应的颜色&lt;/li&gt;
&lt;li&gt;在画布上画出那个点&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;h1 id="光路表示"&gt;光路表示&lt;/h1&gt;
&lt;p&gt;给定原点&lt;span class="math inline"&gt;O&lt;/span&gt;，&lt;span class="math inline"&gt;\vec {VO}&lt;/span&gt; 为光线的方向，设为&lt;span class="math inline"&gt;\vec D&lt;/span&gt;，那么该光线上的任意一点&lt;span class="math inline"&gt;P&lt;/span&gt;可以这样表示：&lt;span class="math inline"&gt;P=O+t\vec D&lt;/span&gt;&lt;/p&gt;
&lt;h1 id="球的表示"&gt;球的表示&lt;/h1&gt;
&lt;p&gt;为了简单起见，设空间中的物体为球，即：与一固定点&lt;span class="math inline"&gt;C&lt;/span&gt;距离为&lt;span class="math inline"&gt;r&lt;/span&gt;的所有点&lt;span class="math inline"&gt;P&lt;/span&gt;的集合，即向量&lt;span class="math inline"&gt;\vec {PC}&lt;/span&gt;的长度为&lt;span class="math inline"&gt;r&lt;/span&gt;.&lt;/p&gt;
&lt;p&gt;&lt;span class="math display"&gt;
    |\vec {PC}|=r
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;又&lt;/p&gt;
&lt;p&gt;&lt;span class="math display"&gt;
    \vec {PC} \cdot \vec {PC} = r^2
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;所以得到方程组，也就是光线和球的交点：&lt;/p&gt;
&lt;p&gt;&lt;span class="math display"&gt;
    \begin{cases}
    \vec {PC} \cdot \vec {PC} = r^2 \\
    P = O+t \vec D
    \end{cases}
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;其中：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;span class="math inline"&gt;O&lt;/span&gt;为原点&lt;/li&gt;
&lt;li&gt;&lt;span class="math inline"&gt;r&lt;/span&gt;为半径&lt;/li&gt;
&lt;li&gt;&lt;span class="math inline"&gt;C&lt;/span&gt;为圆心&lt;/li&gt;
&lt;li&gt;&lt;span class="math inline"&gt;\vec D=\vec {VO}&lt;/span&gt;即光线的方向&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;所以要求的就是&lt;span class="math inline"&gt;t&lt;/span&gt;.&lt;/p&gt;
&lt;h1 id="方程组"&gt;方程组&lt;/h1&gt;
&lt;p&gt;把二式代入一式：&lt;/p&gt;
&lt;p&gt;&lt;span class="math display"&gt;
    \langle O + t\vec{D} - C, O + t\vec{D} - C \rangle = r^2 =
    &lt;/span&gt; &lt;span class="math display"&gt;
    (\vec{CO}+t\cdot\vec{D})\cdot \vec{CO}+(\vec{CO}+t\cdot\vec{D})\cdot t\cdot \vec{D} =
    &lt;/span&gt; &lt;span class="math display"&gt;
    \vec{CO}^2+2\cdot\cdot t \cdot \vec{D}+t \cdot \vec{D}^2 = r^2
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;也就是二次方程：&lt;/p&gt;
&lt;p&gt;&lt;span class="math display"&gt;
    t^2 \cdot \vec{D}^2 + 2 \cdot t \cdot (\vec{CO} \cdot \vec{D}) + \vec{CO}^2 - r^2 = 0
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;按照&lt;span class="math inline"&gt;\Delta&lt;/span&gt;分类讨论：&lt;/p&gt;
&lt;p&gt;&lt;span class="math display"&gt;
    \Delta = [2(\vec{CO} \cdot \vec{D})]^2 - 4t^2(\vec{CO}^2-r^2)
    &lt;/span&gt;&lt;/p&gt;
&lt;figure&gt;
&lt;img alt="分类讨论" src="./assets/solutions.png"/&gt;
&lt;figcaption aria-hidden="true"&gt;分类讨论&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;参考：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://www.gabrielgambetta.com/computer-graphics-from-scratch/02-basic-raytracing.html"&gt;Basic Raytracing&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;br/&gt;
&lt;!--%%REF%%--&gt;
&lt;br/&gt;
&lt;script async="" crossorigin="anonymous" data-category="Announcements" data-category-id="DIC_kwDOJ7Ymy84CX4eg" data-emit-metadata="0" data-input-position="top" data-lang="zh-CN" data-loading="lazy" data-mapping="title" data-reactions-enabled="1" data-repo="izfsk-ium/izfsk-ium.github.io" data-repo-id="R_kgDOJ7Ymyw" data-strict="0" data-theme="preferred_color_scheme" src="https://giscus.app/client.js"&gt;
&lt;/script&gt;
&lt;/main&gt;
&lt;footer&gt;
&lt;p class="signoff"&gt;
&lt;div class="metadata"&gt;
&lt;p class="date"&gt;&lt;time datetime="2023-04-25"&gt;创建日期：2023-04-25&lt;/time&gt;&lt;/p&gt;
&lt;p class="lastmodify"&gt;&lt;time&gt;最后编译：2023-08-10&lt;/time&gt;&lt;/p&gt;
&lt;p class="lastmodify" id="counter-span"&gt;访问次数：&lt;/p&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;/footer&gt;
&lt;script&gt;
    /* These script should run after page load */
    document.querySelectorAll('code.sourceCode').forEach(
      i =&gt; i.insertAdjacentHTML('beforeend', '&lt;div class="copy"&gt;复制&lt;/div&gt;')
    );
    document.querySelectorAll('div.copy').forEach(
      i =&gt; i.addEventListener(
        'click',
        () =&gt; {
          navigator.clipboard.writeText(i.parentElement.innerText.replace('复制', ''));
          i.innerText = '成功';
          setTimeout(() =&gt; {
            i.innerText = '复制';
          }, 1000);
        }
      )
    );

    if (location.href.includes("127.0.0.1:8080")) {
      document.getElementById("counter-span").innerHTML = "[[development mode]]";
    } else {
      const uuid = document.getElementById("article-uuid").innerText;
      const target = document.getElementById("counter-span");
      const last = localStorage.getItem("lastVisit-" + uuid);
      const shouldIncrease = last === null || new Date().getTime() - parseInt(last) &gt;= (1000 * 60 * 15);

      fetch(shouldIncrease ? ("https://counter.izfsk.top/counter/" + uuid) : ("https://counter.izfsk.top/readOnly/" + uuid))
        .then(r =&gt; r.text())
        .then(d =&gt; {
          if (!d.startsWith("Too"))
            document.getElementById("counter-span").innerText = "访问次数：" + d.toString();
          else
            document.getElementById("counter-span").innerHTML = "";
        });

      localStorage.setItem("lastVisit-" + uuid, new Date().getTime());
    }
  &lt;/script&gt;
&lt;script async="" data-website-id="2a1146ab-fa82-4a84-a04f-30e5967357c3" src="https://analytics.umami.is/script.js"&gt;&lt;/script&gt;
&lt;/body&gt;</content:encoded>
      <guid isPermaLink="false">3d0d8a7b-1966-435e-98dd-b4c59ffd581f</guid>
      <pubDate>Tue, 25 Apr 2023 00:00:00 +0800</pubDate>
    </item>
    <item>
      <title>Getx速查表</title>
      <link>https://blog.izfsk.top/articles/Getx速查表.html</link>
      <description>Getx速查表</description>
      <content:encoded>&lt;body&gt;
&lt;progress id="content_progress" value="0"&gt;&lt;/progress&gt;
&lt;button id="back-to-top"&gt;
    回页顶
  &lt;/button&gt;
&lt;header&gt;
&lt;small id="article-uuid" style="display: none !important;"&gt;7f58b9f5-d420-4722-8d41-6191a9453397&lt;/small&gt;
&lt;h1 class="title"&gt;Getx速查表&lt;/h1&gt;
&lt;!-- Subtitle --&gt;
&lt;h3 class="subtitle"&gt; &lt;/h3&gt;
&lt;/header&gt;
&lt;nav id="TOC" role="doc-toc"&gt;
&lt;strong&gt;文章归类: &lt;a href="/pages/category.html#备忘"&gt;备忘&lt;/a&gt; &lt;/strong&gt;
&lt;input id="contents" type="checkbox"/&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#安装" id="toc-安装"&gt;安装&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#路由" id="toc-路由"&gt;路由&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#简单路由" id="toc-简单路由"&gt;简单路由&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#命名路由" id="toc-命名路由"&gt;命名路由&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#snakebar-和-dialog" id="toc-snakebar-和-dialog"&gt;Snakebar 和 Dialog&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#bottomsheet" id="toc-bottomsheet"&gt;BottomSheet&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#状态管理" id="toc-状态管理"&gt;状态管理&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#常用模式" id="toc-常用模式"&gt;常用模式&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#workers" id="toc-workers"&gt;Workers&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#statemixin" id="toc-statemixin"&gt;StateMixin&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#依赖管理" id="toc-依赖管理"&gt;依赖管理&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#何时初始化" id="toc-何时初始化"&gt;何时初始化&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#细节" id="toc-细节"&gt;细节&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#bindings" id="toc-bindings"&gt;Bindings&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#参考" id="toc-参考"&gt;参考&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#reference"&gt;参考链接&lt;/a&gt;&lt;/li&gt;
&lt;li&gt; &lt;/li&gt;
&lt;li class="tools"&gt;
&lt;span id="backtomain"&gt;
&lt;svg class="bi bi-house" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M8.707 1.5a1 1 0 0 0-1.414 0L.646 8.146a.5.5 0 0 0 .708.708L2 8.207V13.5A1.5 1.5 0 0 0 3.5 15h9a1.5 1.5 0 0 0 1.5-1.5V8.207l.646.647a.5.5 0 0 0 .708-.708L13 5.793V2.5a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v1.293L8.707 1.5ZM13 7.207V13.5a.5.5 0 0 1-.5.5h-9a.5.5 0 0 1-.5-.5V7.207l5-5 5 5Z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="readingmode"&gt;
&lt;svg class="bi bi-book" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M1 2.828c.885-.37 2.154-.769 3.388-.893 1.33-.134 2.458.063 3.112.752v9.746c-.935-.53-2.12-.603-3.213-.493-1.18.12-2.37.461-3.287.811V2.828zm7.5-.141c.654-.689 1.782-.886 3.112-.752 1.234.124 2.503.523 3.388.893v9.923c-.918-.35-2.107-.692-3.287-.81-1.094-.111-2.278-.039-3.213.492V2.687zM8 1.783C7.015.936 5.587.81 4.287.94c-1.514.153-3.042.672-3.994 1.105A.5.5 0 0 0 0 2.5v11a.5.5 0 0 0 .707.455c.882-.4 2.303-.881 3.68-1.02 1.409-.142 2.59.087 3.223.877a.5.5 0 0 0 .78 0c.633-.79 1.814-1.019 3.222-.877 1.378.139 2.8.62 3.681 1.02A.5.5 0 0 0 16 13.5v-11a.5.5 0 0 0-.293-.455c-.952-.433-2.48-.952-3.994-1.105C10.413.809 8.985.936 8 1.783z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="larger"&gt; &lt;/span&gt;
&lt;span id="smaller"&gt;&lt;/span&gt;
&lt;span id="switchfont"&gt;
&lt;svg class="bi bi-fonts" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M12.258 3h-8.51l-.083 2.46h.479c.26-1.544.758-1.783 2.693-1.845l.424-.013v7.827c0 .663-.144.82-1.3.923v.52h4.082v-.52c-1.162-.103-1.306-.26-1.306-.923V3.602l.431.013c1.934.062 2.434.301 2.693 1.846h.479L12.258 3z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="backtotop"&gt;
&lt;svg class="bi bi-arrow-bar-up" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M8 10a.5.5 0 0 0 .5-.5V3.707l2.146 2.147a.5.5 0 0 0 .708-.708l-3-3a.5.5 0 0 0-.708 0l-3 3a.5.5 0 1 0 .708.708L7.5 3.707V9.5a.5.5 0 0 0 .5.5zm-7 2.5a.5.5 0 0 1 .5-.5h13a.5.5 0 0 1 0 1h-13a.5.5 0 0 1-.5-.5z" fill-rule="evenodd"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/nav&gt;
&lt;main&gt;
&lt;h2 id="安装"&gt;安装&lt;/h2&gt;
&lt;p&gt;在 &lt;code&gt;pubspec.yaml&lt;/code&gt; 中添加：&lt;/p&gt;
&lt;div class="sourceCode" id="cb1"&gt;&lt;pre class="sourceCode dart"&gt;&lt;code class="sourceCode dart"&gt;&lt;span id="cb1-1"&gt;&lt;a aria-hidden="true" href="#cb1-1" tabindex="-1"&gt;&lt;/a&gt;dependencies&lt;span class="op"&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-2"&gt;&lt;a aria-hidden="true" href="#cb1-2" tabindex="-1"&gt;&lt;/a&gt;  &lt;span class="kw"&gt;get&lt;/span&gt;&lt;span class="op"&gt;:&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;注意不用添加版本号。然后在文件中可以使用 &lt;code&gt;import 'package:get/get.dart';&lt;/code&gt; 引入。&lt;/p&gt;
&lt;h2 id="路由"&gt;路由&lt;/h2&gt;
&lt;p&gt;所有的路由都不需要传入 &lt;code&gt;BuildContext&lt;/code&gt;。&lt;/p&gt;
&lt;h3 id="简单路由"&gt;简单路由&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;导航到新的页面：&lt;code&gt;Get.to(()=&amp;gt;NextScreen());&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;返回到之前的页面，也包括关闭 &lt;code&gt;snackbars&lt;/code&gt;，&lt;code&gt;dialogs&lt;/code&gt; 和 &lt;code&gt;bottomsheets&lt;/code&gt; 等元素：&lt;code&gt;Get.back();&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;导航到新的页面，不能返回：&lt;code&gt;Get.off(()=&amp;gt;NextScreen());&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;导航到新的页面，把之前的东西统统关掉：&lt;code&gt;Get.offAll(()=&amp;gt;NextScreen());&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;路由也可以传输数据，像这样获取页面数据：&lt;/p&gt;
&lt;div class="sourceCode" id="cb2"&gt;&lt;pre class="sourceCode dart"&gt;&lt;code class="sourceCode dart"&gt;&lt;span id="cb2-1"&gt;&lt;a aria-hidden="true" href="#cb2-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="at"&gt;final&lt;/span&gt; data &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="at"&gt;await&lt;/span&gt; Get&lt;span class="op"&gt;.&lt;/span&gt;to(Payment());&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;对应的页面这样返回数据：&lt;/p&gt;
&lt;div class="sourceCode" id="cb3"&gt;&lt;pre class="sourceCode dart"&gt;&lt;code class="sourceCode dart"&gt;&lt;span id="cb3-1"&gt;&lt;a aria-hidden="true" href="#cb3-1" tabindex="-1"&gt;&lt;/a&gt;Get&lt;span class="op"&gt;.&lt;/span&gt;back(result&lt;span class="op"&gt;:&lt;/span&gt; &lt;span class="st"&gt;'success'&lt;/span&gt;);&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id="命名路由"&gt;命名路由&lt;/h3&gt;
&lt;p&gt;首先需要定义路由：&lt;/p&gt;
&lt;div class="sourceCode" id="cb4"&gt;&lt;pre class="sourceCode dart"&gt;&lt;code class="sourceCode dart"&gt;&lt;span id="cb4-1"&gt;&lt;a aria-hidden="true" href="#cb4-1" tabindex="-1"&gt;&lt;/a&gt;GetMaterialApp(&lt;/span&gt;
&lt;span id="cb4-2"&gt;&lt;a aria-hidden="true" href="#cb4-2" tabindex="-1"&gt;&lt;/a&gt;      initialRoute&lt;span class="op"&gt;:&lt;/span&gt; &lt;span class="st"&gt;'/'&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb4-3"&gt;&lt;a aria-hidden="true" href="#cb4-3" tabindex="-1"&gt;&lt;/a&gt;      unknownRoute&lt;span class="op"&gt;:&lt;/span&gt; GetPage(name&lt;span class="op"&gt;:&lt;/span&gt; &lt;span class="st"&gt;'/notfound'&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt; page&lt;span class="op"&gt;:&lt;/span&gt; () &lt;span class="op"&gt;=&amp;gt;&lt;/span&gt; UnknownRoutePage())&lt;span class="op"&gt;,&lt;/span&gt;     &lt;span class="co"&gt;// 错误路由&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb4-4"&gt;&lt;a aria-hidden="true" href="#cb4-4" tabindex="-1"&gt;&lt;/a&gt;      getPages&lt;span class="op"&gt;:&lt;/span&gt; [&lt;/span&gt;
&lt;span id="cb4-5"&gt;&lt;a aria-hidden="true" href="#cb4-5" tabindex="-1"&gt;&lt;/a&gt;        GetPage(name&lt;span class="op"&gt;:&lt;/span&gt; &lt;span class="st"&gt;'/'&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt; page&lt;span class="op"&gt;:&lt;/span&gt; () &lt;span class="op"&gt;=&amp;gt;&lt;/span&gt; MyHomePage())&lt;span class="op"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb4-6"&gt;&lt;a aria-hidden="true" href="#cb4-6" tabindex="-1"&gt;&lt;/a&gt;        GetPage(name&lt;span class="op"&gt;:&lt;/span&gt; &lt;span class="st"&gt;'/second'&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt; page&lt;span class="op"&gt;:&lt;/span&gt; () &lt;span class="op"&gt;=&amp;gt;&lt;/span&gt; Second())&lt;span class="op"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb4-7"&gt;&lt;a aria-hidden="true" href="#cb4-7" tabindex="-1"&gt;&lt;/a&gt;        GetPage(&lt;/span&gt;
&lt;span id="cb4-8"&gt;&lt;a aria-hidden="true" href="#cb4-8" tabindex="-1"&gt;&lt;/a&gt;            name&lt;span class="op"&gt;:&lt;/span&gt; &lt;span class="st"&gt;'/profile/:user'&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt;     &lt;span class="co"&gt;// :user 是一个参数&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb4-9"&gt;&lt;a aria-hidden="true" href="#cb4-9" tabindex="-1"&gt;&lt;/a&gt;            page&lt;span class="op"&gt;:&lt;/span&gt; () &lt;span class="op"&gt;=&amp;gt;&lt;/span&gt; UserProfile()&lt;span class="op"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb4-10"&gt;&lt;a aria-hidden="true" href="#cb4-10" tabindex="-1"&gt;&lt;/a&gt;        )&lt;span class="op"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb4-11"&gt;&lt;a aria-hidden="true" href="#cb4-11" tabindex="-1"&gt;&lt;/a&gt;        GetPage(&lt;/span&gt;
&lt;span id="cb4-12"&gt;&lt;a aria-hidden="true" href="#cb4-12" tabindex="-1"&gt;&lt;/a&gt;          name&lt;span class="op"&gt;:&lt;/span&gt; &lt;span class="st"&gt;'/third'&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb4-13"&gt;&lt;a aria-hidden="true" href="#cb4-13" tabindex="-1"&gt;&lt;/a&gt;          page&lt;span class="op"&gt;:&lt;/span&gt; () &lt;span class="op"&gt;=&amp;gt;&lt;/span&gt; Third()&lt;span class="op"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb4-14"&gt;&lt;a aria-hidden="true" href="#cb4-14" tabindex="-1"&gt;&lt;/a&gt;          transition&lt;span class="op"&gt;:&lt;/span&gt; Transition&lt;span class="op"&gt;.&lt;/span&gt;zoom  &lt;span class="co"&gt;// 动画效果&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb4-15"&gt;&lt;a aria-hidden="true" href="#cb4-15" tabindex="-1"&gt;&lt;/a&gt;        )&lt;span class="op"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb4-16"&gt;&lt;a aria-hidden="true" href="#cb4-16" tabindex="-1"&gt;&lt;/a&gt;      ]&lt;span class="op"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb4-17"&gt;&lt;a aria-hidden="true" href="#cb4-17" tabindex="-1"&gt;&lt;/a&gt;    )&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;使用方法还是类似无名路由：&lt;/p&gt;
&lt;div class="sourceCode" id="cb5"&gt;&lt;pre class="sourceCode dart"&gt;&lt;code class="sourceCode dart"&gt;&lt;span id="cb5-1"&gt;&lt;a aria-hidden="true" href="#cb5-1" tabindex="-1"&gt;&lt;/a&gt;Get&lt;span class="op"&gt;.&lt;/span&gt;toNamed(&lt;span class="st"&gt;"/NextScreen"&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt; arguments&lt;span class="op"&gt;:&lt;/span&gt; &lt;span class="st"&gt;'Something...'&lt;/span&gt;);&lt;/span&gt;
&lt;span id="cb5-2"&gt;&lt;a aria-hidden="true" href="#cb5-2" tabindex="-1"&gt;&lt;/a&gt;Get&lt;span class="op"&gt;.&lt;/span&gt;offNamed(&lt;span class="st"&gt;"/NextScreen"&lt;/span&gt;);&lt;/span&gt;
&lt;span id="cb5-3"&gt;&lt;a aria-hidden="true" href="#cb5-3" tabindex="-1"&gt;&lt;/a&gt;Get&lt;span class="op"&gt;.&lt;/span&gt;offAllNamed(&lt;span class="st"&gt;"/NextScreen"&lt;/span&gt;);&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;可以看到给路由加参数也是可以的，在对应的页面的控制器或类中使用 &lt;code&gt;Get.arguments&lt;/code&gt; 就可以获取到。除此以外还可以使用类似 Web URL 的方法传递 &lt;code&gt;arguments&lt;/code&gt;:&lt;code&gt;Get.toNamed("/profile/34954?flag=true&amp;amp;country=italy");&lt;/code&gt;。获取它们是这样：&lt;/p&gt;
&lt;div class="sourceCode" id="cb6"&gt;&lt;pre class="sourceCode dart"&gt;&lt;code class="sourceCode dart"&gt;&lt;span id="cb6-1"&gt;&lt;a aria-hidden="true" href="#cb6-1" tabindex="-1"&gt;&lt;/a&gt;print(Get&lt;span class="op"&gt;.&lt;/span&gt;parameters[&lt;span class="st"&gt;'user'&lt;/span&gt;]);&lt;/span&gt;
&lt;span id="cb6-2"&gt;&lt;a aria-hidden="true" href="#cb6-2" tabindex="-1"&gt;&lt;/a&gt;print(Get&lt;span class="op"&gt;.&lt;/span&gt;parameters[&lt;span class="st"&gt;'flag'&lt;/span&gt;]);&lt;/span&gt;
&lt;span id="cb6-3"&gt;&lt;a aria-hidden="true" href="#cb6-3" tabindex="-1"&gt;&lt;/a&gt;print(Get&lt;span class="op"&gt;.&lt;/span&gt;parameters[&lt;span class="st"&gt;'country'&lt;/span&gt;]);&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;还可以给路由加上 &lt;code&gt;Middleware&lt;/code&gt;:&lt;/p&gt;
&lt;div class="sourceCode" id="cb7"&gt;&lt;pre class="sourceCode dart"&gt;&lt;code class="sourceCode dart"&gt;&lt;span id="cb7-1"&gt;&lt;a aria-hidden="true" href="#cb7-1" tabindex="-1"&gt;&lt;/a&gt;GetMaterialApp(&lt;/span&gt;
&lt;span id="cb7-2"&gt;&lt;a aria-hidden="true" href="#cb7-2" tabindex="-1"&gt;&lt;/a&gt;  routingCallback&lt;span class="op"&gt;:&lt;/span&gt; (routing) {&lt;/span&gt;
&lt;span id="cb7-3"&gt;&lt;a aria-hidden="true" href="#cb7-3" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="cf"&gt;if&lt;/span&gt;(routing&lt;span class="op"&gt;.&lt;/span&gt;current &lt;span class="op"&gt;==&lt;/span&gt; &lt;span class="st"&gt;'/second'&lt;/span&gt;){&lt;/span&gt;
&lt;span id="cb7-4"&gt;&lt;a aria-hidden="true" href="#cb7-4" tabindex="-1"&gt;&lt;/a&gt;      openAds();&lt;/span&gt;
&lt;span id="cb7-5"&gt;&lt;a aria-hidden="true" href="#cb7-5" tabindex="-1"&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id="cb7-6"&gt;&lt;a aria-hidden="true" href="#cb7-6" tabindex="-1"&gt;&lt;/a&gt;  }&lt;/span&gt;
&lt;span id="cb7-7"&gt;&lt;a aria-hidden="true" href="#cb7-7" tabindex="-1"&gt;&lt;/a&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id="snakebar-和-dialog"&gt;Snakebar 和 Dialog&lt;/h3&gt;
&lt;div class="sourceCode" id="cb8"&gt;&lt;pre class="sourceCode dart"&gt;&lt;code class="sourceCode dart"&gt;&lt;span id="cb8-1"&gt;&lt;a aria-hidden="true" href="#cb8-1" tabindex="-1"&gt;&lt;/a&gt;Get&lt;span class="op"&gt;.&lt;/span&gt;snackbar(&lt;/span&gt;
&lt;span id="cb8-2"&gt;&lt;a aria-hidden="true" href="#cb8-2" tabindex="-1"&gt;&lt;/a&gt;  &lt;span class="st"&gt;"Hey i'm a Get SnackBar!"&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt; &lt;span class="co"&gt;// title&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb8-3"&gt;&lt;a aria-hidden="true" href="#cb8-3" tabindex="-1"&gt;&lt;/a&gt;  &lt;span class="st"&gt;"SnackBar without context, without boilerplate, without Scaffold!"&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt; &lt;span class="co"&gt;// message&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb8-4"&gt;&lt;a aria-hidden="true" href="#cb8-4" tabindex="-1"&gt;&lt;/a&gt;  icon&lt;span class="op"&gt;:&lt;/span&gt; Icon(Icons&lt;span class="op"&gt;.&lt;/span&gt;alarm)&lt;span class="op"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb8-5"&gt;&lt;a aria-hidden="true" href="#cb8-5" tabindex="-1"&gt;&lt;/a&gt;  shouldIconPulse&lt;span class="op"&gt;:&lt;/span&gt; &lt;span class="cn"&gt;true&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb8-6"&gt;&lt;a aria-hidden="true" href="#cb8-6" tabindex="-1"&gt;&lt;/a&gt;  onTap&lt;span class="op"&gt;:&lt;/span&gt;(){}&lt;span class="op"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb8-7"&gt;&lt;a aria-hidden="true" href="#cb8-7" tabindex="-1"&gt;&lt;/a&gt;  barBlur&lt;span class="op"&gt;:&lt;/span&gt; &lt;span class="dv"&gt;20&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb8-8"&gt;&lt;a aria-hidden="true" href="#cb8-8" tabindex="-1"&gt;&lt;/a&gt;  isDismissible&lt;span class="op"&gt;:&lt;/span&gt; &lt;span class="cn"&gt;true&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb8-9"&gt;&lt;a aria-hidden="true" href="#cb8-9" tabindex="-1"&gt;&lt;/a&gt;  duration&lt;span class="op"&gt;:&lt;/span&gt; Duration(seconds&lt;span class="op"&gt;:&lt;/span&gt; &lt;span class="dv"&gt;3&lt;/span&gt;)&lt;span class="op"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb8-10"&gt;&lt;a aria-hidden="true" href="#cb8-10" tabindex="-1"&gt;&lt;/a&gt;);&lt;/span&gt;
&lt;span id="cb8-11"&gt;&lt;a aria-hidden="true" href="#cb8-11" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb8-12"&gt;&lt;a aria-hidden="true" href="#cb8-12" tabindex="-1"&gt;&lt;/a&gt;Get&lt;span class="op"&gt;.&lt;/span&gt;defaultDialog(&lt;/span&gt;
&lt;span id="cb8-13"&gt;&lt;a aria-hidden="true" href="#cb8-13" tabindex="-1"&gt;&lt;/a&gt;  onConfirm&lt;span class="op"&gt;:&lt;/span&gt; () &lt;span class="op"&gt;=&amp;gt;&lt;/span&gt; print(&lt;span class="st"&gt;"Ok"&lt;/span&gt;)&lt;span class="op"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb8-14"&gt;&lt;a aria-hidden="true" href="#cb8-14" tabindex="-1"&gt;&lt;/a&gt;  middleText&lt;span class="op"&gt;:&lt;/span&gt; &lt;span class="st"&gt;"Dialog made in 3 lines of code"&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb8-15"&gt;&lt;a aria-hidden="true" href="#cb8-15" tabindex="-1"&gt;&lt;/a&gt;);&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;无需 &lt;code&gt;BuildContext&lt;/code&gt;。&lt;/p&gt;
&lt;h3 id="bottomsheet"&gt;BottomSheet&lt;/h3&gt;
&lt;p&gt;BottomSheet 就是在页面底部从下往上弹出的那个菜单一样的东西：&lt;/p&gt;
&lt;div class="sourceCode" id="cb9"&gt;&lt;pre class="sourceCode dart"&gt;&lt;code class="sourceCode dart"&gt;&lt;span id="cb9-1"&gt;&lt;a aria-hidden="true" href="#cb9-1" tabindex="-1"&gt;&lt;/a&gt;Get&lt;span class="op"&gt;.&lt;/span&gt;bottomSheet(&lt;/span&gt;
&lt;span id="cb9-2"&gt;&lt;a aria-hidden="true" href="#cb9-2" tabindex="-1"&gt;&lt;/a&gt;  Container(&lt;/span&gt;
&lt;span id="cb9-3"&gt;&lt;a aria-hidden="true" href="#cb9-3" tabindex="-1"&gt;&lt;/a&gt;    child&lt;span class="op"&gt;:&lt;/span&gt; Wrap(&lt;/span&gt;
&lt;span id="cb9-4"&gt;&lt;a aria-hidden="true" href="#cb9-4" tabindex="-1"&gt;&lt;/a&gt;      children&lt;span class="op"&gt;:&lt;/span&gt; &lt;span class="op"&gt;&amp;lt;&lt;/span&gt;Widget&lt;span class="op"&gt;&amp;gt;&lt;/span&gt;[&lt;/span&gt;
&lt;span id="cb9-5"&gt;&lt;a aria-hidden="true" href="#cb9-5" tabindex="-1"&gt;&lt;/a&gt;        ListTile(&lt;/span&gt;
&lt;span id="cb9-6"&gt;&lt;a aria-hidden="true" href="#cb9-6" tabindex="-1"&gt;&lt;/a&gt;          leading&lt;span class="op"&gt;:&lt;/span&gt; Icon(Icons&lt;span class="op"&gt;.&lt;/span&gt;music_note)&lt;span class="op"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb9-7"&gt;&lt;a aria-hidden="true" href="#cb9-7" tabindex="-1"&gt;&lt;/a&gt;          title&lt;span class="op"&gt;:&lt;/span&gt; Text(&lt;span class="st"&gt;'Music'&lt;/span&gt;)&lt;span class="op"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb9-8"&gt;&lt;a aria-hidden="true" href="#cb9-8" tabindex="-1"&gt;&lt;/a&gt;          onTap&lt;span class="op"&gt;:&lt;/span&gt; () {}&lt;/span&gt;
&lt;span id="cb9-9"&gt;&lt;a aria-hidden="true" href="#cb9-9" tabindex="-1"&gt;&lt;/a&gt;        )&lt;span class="op"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb9-10"&gt;&lt;a aria-hidden="true" href="#cb9-10" tabindex="-1"&gt;&lt;/a&gt;        ListTile(&lt;/span&gt;
&lt;span id="cb9-11"&gt;&lt;a aria-hidden="true" href="#cb9-11" tabindex="-1"&gt;&lt;/a&gt;          leading&lt;span class="op"&gt;:&lt;/span&gt; Icon(Icons&lt;span class="op"&gt;.&lt;/span&gt;videocam)&lt;span class="op"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb9-12"&gt;&lt;a aria-hidden="true" href="#cb9-12" tabindex="-1"&gt;&lt;/a&gt;          title&lt;span class="op"&gt;:&lt;/span&gt; Text(&lt;span class="st"&gt;'Video'&lt;/span&gt;)&lt;span class="op"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb9-13"&gt;&lt;a aria-hidden="true" href="#cb9-13" tabindex="-1"&gt;&lt;/a&gt;          onTap&lt;span class="op"&gt;:&lt;/span&gt; () {}&lt;span class="op"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb9-14"&gt;&lt;a aria-hidden="true" href="#cb9-14" tabindex="-1"&gt;&lt;/a&gt;        )&lt;span class="op"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb9-15"&gt;&lt;a aria-hidden="true" href="#cb9-15" tabindex="-1"&gt;&lt;/a&gt;      ]&lt;span class="op"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb9-16"&gt;&lt;a aria-hidden="true" href="#cb9-16" tabindex="-1"&gt;&lt;/a&gt;    )&lt;span class="op"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb9-17"&gt;&lt;a aria-hidden="true" href="#cb9-17" tabindex="-1"&gt;&lt;/a&gt;  )&lt;/span&gt;
&lt;span id="cb9-18"&gt;&lt;a aria-hidden="true" href="#cb9-18" tabindex="-1"&gt;&lt;/a&gt;);&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id="状态管理"&gt;状态管理&lt;/h2&gt;
&lt;p&gt;有了 &lt;code&gt;Getx&lt;/code&gt;，再也不需要使用 &lt;code&gt;StatefulWidget&lt;/code&gt; 了。&lt;/p&gt;
&lt;h3 id="常用模式"&gt;常用模式&lt;/h3&gt;
&lt;p&gt;一个通常的模式是这样的：一个页面对应一个控制器(&lt;code&gt;controller&lt;/code&gt;)，这个控制器扩展了 &lt;code&gt;GetxController&lt;/code&gt;。在一个 Controller 类中，一个 &lt;code&gt;Obs&lt;/code&gt; 会&lt;strong&gt;自动更新&lt;/strong&gt;订阅了它的组建，其他不是 &lt;code&gt;Obs&lt;/code&gt; 的数据必须在修改它们的方法中使用 &lt;code&gt;update();&lt;/code&gt; 才行。&lt;/p&gt;
&lt;p&gt;对于响应式的变量，有特殊的类型来处理：&lt;/p&gt;
&lt;div class="sourceCode" id="cb10"&gt;&lt;pre class="sourceCode dart"&gt;&lt;code class="sourceCode dart"&gt;&lt;span id="cb10-1"&gt;&lt;a aria-hidden="true" href="#cb10-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="at"&gt;final&lt;/span&gt; name &lt;span class="op"&gt;=&lt;/span&gt; RxString(&lt;span class="st"&gt;''&lt;/span&gt;);&lt;/span&gt;
&lt;span id="cb10-2"&gt;&lt;a aria-hidden="true" href="#cb10-2" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="at"&gt;final&lt;/span&gt; isLogged &lt;span class="op"&gt;=&lt;/span&gt; RxBool(&lt;span class="cn"&gt;false&lt;/span&gt;);&lt;/span&gt;
&lt;span id="cb10-3"&gt;&lt;a aria-hidden="true" href="#cb10-3" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="at"&gt;final&lt;/span&gt; count &lt;span class="op"&gt;=&lt;/span&gt; RxInt(&lt;span class="dv"&gt;0&lt;/span&gt;);&lt;/span&gt;
&lt;span id="cb10-4"&gt;&lt;a aria-hidden="true" href="#cb10-4" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="at"&gt;final&lt;/span&gt; balance &lt;span class="op"&gt;=&lt;/span&gt; RxDouble(&lt;span class="dv"&gt;0&lt;/span&gt;&lt;span class="fl"&gt;.0&lt;/span&gt;);&lt;/span&gt;
&lt;span id="cb10-5"&gt;&lt;a aria-hidden="true" href="#cb10-5" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="at"&gt;final&lt;/span&gt; items &lt;span class="op"&gt;=&lt;/span&gt; RxList&lt;span class="op"&gt;&amp;lt;&lt;/span&gt;&lt;span class="dt"&gt;String&lt;/span&gt;&lt;span class="op"&gt;&amp;gt;&lt;/span&gt;([]);&lt;/span&gt;
&lt;span id="cb10-6"&gt;&lt;a aria-hidden="true" href="#cb10-6" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="at"&gt;final&lt;/span&gt; myMap &lt;span class="op"&gt;=&lt;/span&gt; RxMap&lt;span class="op"&gt;&amp;lt;&lt;/span&gt;&lt;span class="dt"&gt;String&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt; &lt;span class="dt"&gt;int&lt;/span&gt;&lt;span class="op"&gt;&amp;gt;&lt;/span&gt;({});&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;当然，要获取它们的实际值就需要 &lt;code&gt;xxx.value&lt;/code&gt; 了。&lt;/p&gt;
&lt;p&gt;如何使用：&lt;/p&gt;
&lt;div class="sourceCode" id="cb11"&gt;&lt;pre class="sourceCode dart"&gt;&lt;code class="sourceCode dart"&gt;&lt;span id="cb11-1"&gt;&lt;a aria-hidden="true" href="#cb11-1" tabindex="-1"&gt;&lt;/a&gt;GetX&lt;span class="op"&gt;&amp;lt;&lt;/span&gt;Controller&lt;span class="op"&gt;&amp;gt;&lt;/span&gt;(&lt;/span&gt;
&lt;span id="cb11-2"&gt;&lt;a aria-hidden="true" href="#cb11-2" tabindex="-1"&gt;&lt;/a&gt;  builder&lt;span class="op"&gt;:&lt;/span&gt; (controller) {&lt;/span&gt;
&lt;span id="cb11-3"&gt;&lt;a aria-hidden="true" href="#cb11-3" tabindex="-1"&gt;&lt;/a&gt;    print(&lt;span class="st"&gt;"count 2 rebuild"&lt;/span&gt;);&lt;/span&gt;
&lt;span id="cb11-4"&gt;&lt;a aria-hidden="true" href="#cb11-4" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="kw"&gt;return&lt;/span&gt; Text(&lt;span class="st"&gt;'${controller.count2.value}'&lt;/span&gt;);&lt;/span&gt;
&lt;span id="cb11-5"&gt;&lt;a aria-hidden="true" href="#cb11-5" tabindex="-1"&gt;&lt;/a&gt;  }&lt;span class="op"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb11-6"&gt;&lt;a aria-hidden="true" href="#cb11-6" tabindex="-1"&gt;&lt;/a&gt;)&lt;span class="op"&gt;,&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;注意事项：如果要在控制器里面初始化什么东西（网络连接，文件，数据库），&lt;strong&gt;不要使用类初始化函数&lt;/strong&gt;，而是使用 &lt;code&gt;onInit()&lt;/code&gt;。同样的，使用 &lt;code&gt;onClose()&lt;/code&gt; 而不是 &lt;code&gt;dispose&lt;/code&gt;。&lt;/p&gt;
&lt;h3 id="workers"&gt;Workers&lt;/h3&gt;
&lt;p&gt;当特定事件在某个值上发生时的 callback：&lt;/p&gt;
&lt;div class="sourceCode" id="cb12"&gt;&lt;pre class="sourceCode dart"&gt;&lt;code class="sourceCode dart"&gt;&lt;span id="cb12-1"&gt;&lt;a aria-hidden="true" href="#cb12-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="co"&gt;/// Called every time `count1` changes.&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb12-2"&gt;&lt;a aria-hidden="true" href="#cb12-2" tabindex="-1"&gt;&lt;/a&gt;ever(count1&lt;span class="op"&gt;,&lt;/span&gt; (_) &lt;span class="op"&gt;=&amp;gt;&lt;/span&gt; print(&lt;span class="st"&gt;"$_ has been changed"&lt;/span&gt;));&lt;/span&gt;
&lt;span id="cb12-3"&gt;&lt;a aria-hidden="true" href="#cb12-3" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb12-4"&gt;&lt;a aria-hidden="true" href="#cb12-4" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="co"&gt;/// Called only first time the variable $_ is changed&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb12-5"&gt;&lt;a aria-hidden="true" href="#cb12-5" tabindex="-1"&gt;&lt;/a&gt;once(count1&lt;span class="op"&gt;,&lt;/span&gt; (_) &lt;span class="op"&gt;=&amp;gt;&lt;/span&gt; print(&lt;span class="st"&gt;"$_ was changed once"&lt;/span&gt;));&lt;/span&gt;
&lt;span id="cb12-6"&gt;&lt;a aria-hidden="true" href="#cb12-6" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb12-7"&gt;&lt;a aria-hidden="true" href="#cb12-7" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="co"&gt;/// Anti DDos - Called every time the user stops typing for 1 second, for example.&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb12-8"&gt;&lt;a aria-hidden="true" href="#cb12-8" tabindex="-1"&gt;&lt;/a&gt;debounce(count1&lt;span class="op"&gt;,&lt;/span&gt; (_) &lt;span class="op"&gt;=&amp;gt;&lt;/span&gt; print(&lt;span class="st"&gt;"debouce$_"&lt;/span&gt;)&lt;span class="op"&gt;,&lt;/span&gt; time&lt;span class="op"&gt;:&lt;/span&gt; Duration(seconds&lt;span class="op"&gt;:&lt;/span&gt; &lt;span class="dv"&gt;1&lt;/span&gt;));&lt;/span&gt;
&lt;span id="cb12-9"&gt;&lt;a aria-hidden="true" href="#cb12-9" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb12-10"&gt;&lt;a aria-hidden="true" href="#cb12-10" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="co"&gt;/// Ignore all changes within 1 second.&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb12-11"&gt;&lt;a aria-hidden="true" href="#cb12-11" tabindex="-1"&gt;&lt;/a&gt;interval(count1&lt;span class="op"&gt;,&lt;/span&gt; (_) &lt;span class="op"&gt;=&amp;gt;&lt;/span&gt; print(&lt;span class="st"&gt;"interval $_"&lt;/span&gt;)&lt;span class="op"&gt;,&lt;/span&gt; time&lt;span class="op"&gt;:&lt;/span&gt; Duration(seconds&lt;span class="op"&gt;:&lt;/span&gt; &lt;span class="dv"&gt;1&lt;/span&gt;));&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id="statemixin"&gt;StateMixin&lt;/h3&gt;
&lt;div class="sourceCode" id="cb13"&gt;&lt;pre class="sourceCode dart"&gt;&lt;code class="sourceCode dart"&gt;&lt;span id="cb13-1"&gt;&lt;a aria-hidden="true" href="#cb13-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;class&lt;/span&gt; DataType {&lt;/span&gt;
&lt;span id="cb13-2"&gt;&lt;a aria-hidden="true" href="#cb13-2" tabindex="-1"&gt;&lt;/a&gt;  &lt;span class="at"&gt;final&lt;/span&gt; &lt;span class="dt"&gt;String&lt;/span&gt; name;&lt;/span&gt;
&lt;span id="cb13-3"&gt;&lt;a aria-hidden="true" href="#cb13-3" tabindex="-1"&gt;&lt;/a&gt;  &lt;span class="at"&gt;final&lt;/span&gt; &lt;span class="dt"&gt;int&lt;/span&gt; age;&lt;/span&gt;
&lt;span id="cb13-4"&gt;&lt;a aria-hidden="true" href="#cb13-4" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb13-5"&gt;&lt;a aria-hidden="true" href="#cb13-5" tabindex="-1"&gt;&lt;/a&gt;  DataType(&lt;span class="kw"&gt;this&lt;/span&gt;&lt;span class="op"&gt;.&lt;/span&gt;name&lt;span class="op"&gt;,&lt;/span&gt; &lt;span class="kw"&gt;this&lt;/span&gt;&lt;span class="op"&gt;.&lt;/span&gt;age);&lt;/span&gt;
&lt;span id="cb13-6"&gt;&lt;a aria-hidden="true" href="#cb13-6" tabindex="-1"&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id="cb13-7"&gt;&lt;a aria-hidden="true" href="#cb13-7" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb13-8"&gt;&lt;a aria-hidden="true" href="#cb13-8" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;class&lt;/span&gt; Repo {&lt;/span&gt;
&lt;span id="cb13-9"&gt;&lt;a aria-hidden="true" href="#cb13-9" tabindex="-1"&gt;&lt;/a&gt;  &lt;span class="dt"&gt;Future&lt;/span&gt; getData() &lt;span class="at"&gt;async&lt;/span&gt; {&lt;/span&gt;
&lt;span id="cb13-10"&gt;&lt;a aria-hidden="true" href="#cb13-10" tabindex="-1"&gt;&lt;/a&gt;    sleep(Duration(seconds&lt;span class="op"&gt;:&lt;/span&gt; &lt;span class="dv"&gt;1&lt;/span&gt;));&lt;/span&gt;
&lt;span id="cb13-11"&gt;&lt;a aria-hidden="true" href="#cb13-11" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="kw"&gt;return&lt;/span&gt; &lt;span class="st"&gt;"hello!"&lt;/span&gt;;&lt;/span&gt;
&lt;span id="cb13-12"&gt;&lt;a aria-hidden="true" href="#cb13-12" tabindex="-1"&gt;&lt;/a&gt;  }&lt;/span&gt;
&lt;span id="cb13-13"&gt;&lt;a aria-hidden="true" href="#cb13-13" tabindex="-1"&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id="cb13-14"&gt;&lt;a aria-hidden="true" href="#cb13-14" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb13-15"&gt;&lt;a aria-hidden="true" href="#cb13-15" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;class&lt;/span&gt; MyController &lt;span class="kw"&gt;extends&lt;/span&gt; GetxController &lt;span class="kw"&gt;with&lt;/span&gt; StateMixin&lt;span class="op"&gt;&amp;lt;&lt;/span&gt;DataType&lt;span class="op"&gt;&amp;gt;&lt;/span&gt; {&lt;/span&gt;
&lt;span id="cb13-16"&gt;&lt;a aria-hidden="true" href="#cb13-16" tabindex="-1"&gt;&lt;/a&gt;  &lt;span class="at"&gt;final&lt;/span&gt; Repo repository;&lt;/span&gt;
&lt;span id="cb13-17"&gt;&lt;a aria-hidden="true" href="#cb13-17" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb13-18"&gt;&lt;a aria-hidden="true" href="#cb13-18" tabindex="-1"&gt;&lt;/a&gt;  MyController(&lt;span class="kw"&gt;this&lt;/span&gt;&lt;span class="op"&gt;.&lt;/span&gt;repository);&lt;/span&gt;
&lt;span id="cb13-19"&gt;&lt;a aria-hidden="true" href="#cb13-19" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb13-20"&gt;&lt;a aria-hidden="true" href="#cb13-20" tabindex="-1"&gt;&lt;/a&gt;  &lt;span class="kw"&gt;@override&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb13-21"&gt;&lt;a aria-hidden="true" href="#cb13-21" tabindex="-1"&gt;&lt;/a&gt;  &lt;span class="dt"&gt;void&lt;/span&gt; onInit() {&lt;/span&gt;
&lt;span id="cb13-22"&gt;&lt;a aria-hidden="true" href="#cb13-22" tabindex="-1"&gt;&lt;/a&gt;    repository&lt;span class="op"&gt;.&lt;/span&gt;getData()&lt;span class="op"&gt;.&lt;/span&gt;then((resp) {&lt;/span&gt;
&lt;span id="cb13-23"&gt;&lt;a aria-hidden="true" href="#cb13-23" tabindex="-1"&gt;&lt;/a&gt;      change(DataType(&lt;span class="st"&gt;"name"&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt; &lt;span class="dv"&gt;10&lt;/span&gt;)&lt;span class="op"&gt;,&lt;/span&gt; status&lt;span class="op"&gt;:&lt;/span&gt; RxStatus&lt;span class="op"&gt;.&lt;/span&gt;success());&lt;/span&gt;
&lt;span id="cb13-24"&gt;&lt;a aria-hidden="true" href="#cb13-24" tabindex="-1"&gt;&lt;/a&gt;    }&lt;span class="op"&gt;,&lt;/span&gt; onError&lt;span class="op"&gt;:&lt;/span&gt; (err) {&lt;/span&gt;
&lt;span id="cb13-25"&gt;&lt;a aria-hidden="true" href="#cb13-25" tabindex="-1"&gt;&lt;/a&gt;      change(&lt;/span&gt;
&lt;span id="cb13-26"&gt;&lt;a aria-hidden="true" href="#cb13-26" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="cn"&gt;null&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb13-27"&gt;&lt;a aria-hidden="true" href="#cb13-27" tabindex="-1"&gt;&lt;/a&gt;        status&lt;span class="op"&gt;:&lt;/span&gt; RxStatus&lt;span class="op"&gt;.&lt;/span&gt;error(&lt;span class="st"&gt;'Error get data'&lt;/span&gt;)&lt;span class="op"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb13-28"&gt;&lt;a aria-hidden="true" href="#cb13-28" tabindex="-1"&gt;&lt;/a&gt;      );&lt;/span&gt;
&lt;span id="cb13-29"&gt;&lt;a aria-hidden="true" href="#cb13-29" tabindex="-1"&gt;&lt;/a&gt;      &lt;span class="kw"&gt;super&lt;/span&gt;&lt;span class="op"&gt;.&lt;/span&gt;onInit();&lt;/span&gt;
&lt;span id="cb13-30"&gt;&lt;a aria-hidden="true" href="#cb13-30" tabindex="-1"&gt;&lt;/a&gt;    });&lt;/span&gt;
&lt;span id="cb13-31"&gt;&lt;a aria-hidden="true" href="#cb13-31" tabindex="-1"&gt;&lt;/a&gt;  }&lt;/span&gt;
&lt;span id="cb13-32"&gt;&lt;a aria-hidden="true" href="#cb13-32" tabindex="-1"&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id="cb13-33"&gt;&lt;a aria-hidden="true" href="#cb13-33" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb13-34"&gt;&lt;a aria-hidden="true" href="#cb13-34" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;class&lt;/span&gt; MyHomePage &lt;span class="kw"&gt;extends&lt;/span&gt; GetView&lt;span class="op"&gt;&amp;lt;&lt;/span&gt;MyController&lt;span class="op"&gt;&amp;gt;&lt;/span&gt; {&lt;/span&gt;
&lt;span id="cb13-35"&gt;&lt;a aria-hidden="true" href="#cb13-35" tabindex="-1"&gt;&lt;/a&gt;  &lt;span class="at"&gt;const&lt;/span&gt; MyHomePage({&lt;span class="kw"&gt;super&lt;/span&gt;&lt;span class="op"&gt;.&lt;/span&gt;key});&lt;/span&gt;
&lt;span id="cb13-36"&gt;&lt;a aria-hidden="true" href="#cb13-36" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb13-37"&gt;&lt;a aria-hidden="true" href="#cb13-37" tabindex="-1"&gt;&lt;/a&gt;  &lt;span class="kw"&gt;@override&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb13-38"&gt;&lt;a aria-hidden="true" href="#cb13-38" tabindex="-1"&gt;&lt;/a&gt;  Widget build(BuildContext context) {&lt;/span&gt;
&lt;span id="cb13-39"&gt;&lt;a aria-hidden="true" href="#cb13-39" tabindex="-1"&gt;&lt;/a&gt;    Get&lt;span class="op"&gt;.&lt;/span&gt;put(MyController(Repo()));&lt;/span&gt;
&lt;span id="cb13-40"&gt;&lt;a aria-hidden="true" href="#cb13-40" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="kw"&gt;return&lt;/span&gt; Scaffold(&lt;/span&gt;
&lt;span id="cb13-41"&gt;&lt;a aria-hidden="true" href="#cb13-41" tabindex="-1"&gt;&lt;/a&gt;      appBar&lt;span class="op"&gt;:&lt;/span&gt; AppBar()&lt;span class="op"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb13-42"&gt;&lt;a aria-hidden="true" href="#cb13-42" tabindex="-1"&gt;&lt;/a&gt;      body&lt;span class="op"&gt;:&lt;/span&gt; controller&lt;span class="op"&gt;.&lt;/span&gt;obx(&lt;/span&gt;
&lt;span id="cb13-43"&gt;&lt;a aria-hidden="true" href="#cb13-43" tabindex="-1"&gt;&lt;/a&gt;        (state) &lt;span class="op"&gt;=&amp;gt;&lt;/span&gt; Text(state&lt;span class="op"&gt;!.&lt;/span&gt;name)&lt;span class="op"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb13-44"&gt;&lt;a aria-hidden="true" href="#cb13-44" tabindex="-1"&gt;&lt;/a&gt;        onLoading&lt;span class="op"&gt;:&lt;/span&gt; &lt;span class="at"&gt;const&lt;/span&gt; CircularProgressIndicator()&lt;span class="op"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb13-45"&gt;&lt;a aria-hidden="true" href="#cb13-45" tabindex="-1"&gt;&lt;/a&gt;        onError&lt;span class="op"&gt;:&lt;/span&gt; (error) &lt;span class="op"&gt;=&amp;gt;&lt;/span&gt; Text(error&lt;span class="op"&gt;.&lt;/span&gt;toString())&lt;span class="op"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb13-46"&gt;&lt;a aria-hidden="true" href="#cb13-46" tabindex="-1"&gt;&lt;/a&gt;      )&lt;span class="op"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb13-47"&gt;&lt;a aria-hidden="true" href="#cb13-47" tabindex="-1"&gt;&lt;/a&gt;    );&lt;/span&gt;
&lt;span id="cb13-48"&gt;&lt;a aria-hidden="true" href="#cb13-48" tabindex="-1"&gt;&lt;/a&gt;  }&lt;/span&gt;
&lt;span id="cb13-49"&gt;&lt;a aria-hidden="true" href="#cb13-49" tabindex="-1"&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id="依赖管理"&gt;依赖管理&lt;/h2&gt;
&lt;h3 id="何时初始化"&gt;何时初始化&lt;/h3&gt;
&lt;div class="sourceCode" id="cb14"&gt;&lt;pre class="sourceCode dart"&gt;&lt;code class="sourceCode dart"&gt;&lt;span id="cb14-1"&gt;&lt;a aria-hidden="true" href="#cb14-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;class&lt;/span&gt; Controller &lt;span class="kw"&gt;extends&lt;/span&gt; GetxController {&lt;/span&gt;
&lt;span id="cb14-2"&gt;&lt;a aria-hidden="true" href="#cb14-2" tabindex="-1"&gt;&lt;/a&gt;  &lt;span class="at"&gt;static&lt;/span&gt; Controller &lt;span class="kw"&gt;get&lt;/span&gt; to &lt;span class="op"&gt;=&amp;gt;&lt;/span&gt; Get&lt;span class="op"&gt;.&lt;/span&gt;find();&lt;/span&gt;
&lt;span id="cb14-3"&gt;&lt;a aria-hidden="true" href="#cb14-3" tabindex="-1"&gt;&lt;/a&gt;    [&lt;span class="op"&gt;...&lt;/span&gt;]&lt;/span&gt;
&lt;span id="cb14-4"&gt;&lt;a aria-hidden="true" href="#cb14-4" tabindex="-1"&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id="cb14-5"&gt;&lt;a aria-hidden="true" href="#cb14-5" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="co"&gt;// on you view:&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb14-6"&gt;&lt;a aria-hidden="true" href="#cb14-6" tabindex="-1"&gt;&lt;/a&gt;GetBuilder&lt;span class="op"&gt;&amp;lt;&lt;/span&gt;Controller&lt;span class="op"&gt;&amp;gt;&lt;/span&gt;(&lt;/span&gt;
&lt;span id="cb14-7"&gt;&lt;a aria-hidden="true" href="#cb14-7" tabindex="-1"&gt;&lt;/a&gt;  init&lt;span class="op"&gt;:&lt;/span&gt; Controller()&lt;span class="op"&gt;,&lt;/span&gt; &lt;span class="co"&gt;// use it only first time on each controller&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb14-8"&gt;&lt;a aria-hidden="true" href="#cb14-8" tabindex="-1"&gt;&lt;/a&gt;  builder&lt;span class="op"&gt;:&lt;/span&gt; (_) &lt;span class="op"&gt;=&amp;gt;&lt;/span&gt; Text(&lt;/span&gt;
&lt;span id="cb14-9"&gt;&lt;a aria-hidden="true" href="#cb14-9" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="st"&gt;'${Controller.to.counter}'&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt; &lt;span class="co"&gt;//here&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb14-10"&gt;&lt;a aria-hidden="true" href="#cb14-10" tabindex="-1"&gt;&lt;/a&gt;  )&lt;/span&gt;
&lt;span id="cb14-11"&gt;&lt;a aria-hidden="true" href="#cb14-11" tabindex="-1"&gt;&lt;/a&gt;)&lt;span class="op"&gt;,&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id="细节"&gt;细节&lt;/h3&gt;
&lt;p&gt;最常见的插入依赖关系的方式：&lt;code&gt;Get.put&lt;/code&gt; 和 &lt;code&gt;Get.lazyPut&lt;/code&gt;&lt;/p&gt;
&lt;div class="sourceCode" id="cb15"&gt;&lt;pre class="sourceCode dart"&gt;&lt;code class="sourceCode dart"&gt;&lt;span id="cb15-1"&gt;&lt;a aria-hidden="true" href="#cb15-1" tabindex="-1"&gt;&lt;/a&gt;Get&lt;span class="op"&gt;.&lt;/span&gt;put&lt;span class="op"&gt;&amp;lt;&lt;/span&gt;SomeClass&lt;span class="op"&gt;&amp;gt;&lt;/span&gt;(SomeClass());&lt;/span&gt;
&lt;span id="cb15-2"&gt;&lt;a aria-hidden="true" href="#cb15-2" tabindex="-1"&gt;&lt;/a&gt;Get&lt;span class="op"&gt;.&lt;/span&gt;put&lt;span class="op"&gt;&amp;lt;&lt;/span&gt;LoginController&lt;span class="op"&gt;&amp;gt;&lt;/span&gt;(LoginController()&lt;span class="op"&gt;,&lt;/span&gt; permanent&lt;span class="op"&gt;:&lt;/span&gt; &lt;span class="cn"&gt;true&lt;/span&gt;);&lt;/span&gt;
&lt;span id="cb15-3"&gt;&lt;a aria-hidden="true" href="#cb15-3" tabindex="-1"&gt;&lt;/a&gt;Get&lt;span class="op"&gt;.&lt;/span&gt;put&lt;span class="op"&gt;&amp;lt;&lt;/span&gt;ListItemController&lt;span class="op"&gt;&amp;gt;&lt;/span&gt;(ListItemController&lt;span class="op"&gt;,&lt;/span&gt; tag&lt;span class="op"&gt;:&lt;/span&gt; &lt;span class="st"&gt;"some unique string"&lt;/span&gt;);&lt;/span&gt;
&lt;span id="cb15-4"&gt;&lt;a aria-hidden="true" href="#cb15-4" tabindex="-1"&gt;&lt;/a&gt;Get&lt;span class="op"&gt;.&lt;/span&gt;lazyPut&lt;span class="op"&gt;&amp;lt;&lt;/span&gt;Controller&lt;span class="op"&gt;&amp;gt;&lt;/span&gt;( () &lt;span class="op"&gt;=&amp;gt;&lt;/span&gt; Controller() )&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;文档有中文版本。（&lt;a href="https://github.com/jonataslaw/getx/blob/master/documentation/zh_CN/dependency_management.md"&gt;依赖管理&lt;/a&gt;）&lt;/p&gt;
&lt;h3 id="bindings"&gt;Bindings&lt;/h3&gt;
&lt;p&gt;啥时候去 Put 你的 Controller 总是个问题，Bindings 就是解决这个问题的，它将路由、状态管理器和依赖管理器完全集成。首先创建 binding 类：&lt;/p&gt;
&lt;div class="sourceCode" id="cb16"&gt;&lt;pre class="sourceCode dart"&gt;&lt;code class="sourceCode dart"&gt;&lt;span id="cb16-1"&gt;&lt;a aria-hidden="true" href="#cb16-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;class&lt;/span&gt; HomeBinding &lt;span class="kw"&gt;implements&lt;/span&gt; Bindings {&lt;/span&gt;
&lt;span id="cb16-2"&gt;&lt;a aria-hidden="true" href="#cb16-2" tabindex="-1"&gt;&lt;/a&gt;  &lt;span class="kw"&gt;@override&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb16-3"&gt;&lt;a aria-hidden="true" href="#cb16-3" tabindex="-1"&gt;&lt;/a&gt;  &lt;span class="dt"&gt;void&lt;/span&gt; dependencies() {&lt;/span&gt;
&lt;span id="cb16-4"&gt;&lt;a aria-hidden="true" href="#cb16-4" tabindex="-1"&gt;&lt;/a&gt;    Get&lt;span class="op"&gt;.&lt;/span&gt;lazyPut&lt;span class="op"&gt;&amp;lt;&lt;/span&gt;HomeController&lt;span class="op"&gt;&amp;gt;&lt;/span&gt;(() &lt;span class="op"&gt;=&amp;gt;&lt;/span&gt; HomeController());&lt;/span&gt;
&lt;span id="cb16-5"&gt;&lt;a aria-hidden="true" href="#cb16-5" tabindex="-1"&gt;&lt;/a&gt;    Get&lt;span class="op"&gt;.&lt;/span&gt;put&lt;span class="op"&gt;&amp;lt;&lt;/span&gt;Service&lt;span class="op"&gt;&amp;gt;&lt;/span&gt;(()&lt;span class="op"&gt;=&amp;gt;&lt;/span&gt; Api());&lt;/span&gt;
&lt;span id="cb16-6"&gt;&lt;a aria-hidden="true" href="#cb16-6" tabindex="-1"&gt;&lt;/a&gt;  }&lt;/span&gt;
&lt;span id="cb16-7"&gt;&lt;a aria-hidden="true" href="#cb16-7" tabindex="-1"&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;然后在路由中使用它们：&lt;/p&gt;
&lt;div class="sourceCode" id="cb17"&gt;&lt;pre class="sourceCode dart"&gt;&lt;code class="sourceCode dart"&gt;&lt;span id="cb17-1"&gt;&lt;a aria-hidden="true" href="#cb17-1" tabindex="-1"&gt;&lt;/a&gt;GetPage(&lt;/span&gt;
&lt;span id="cb17-2"&gt;&lt;a aria-hidden="true" href="#cb17-2" tabindex="-1"&gt;&lt;/a&gt;    name&lt;span class="op"&gt;:&lt;/span&gt; &lt;span class="st"&gt;'/'&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb17-3"&gt;&lt;a aria-hidden="true" href="#cb17-3" tabindex="-1"&gt;&lt;/a&gt;    page&lt;span class="op"&gt;:&lt;/span&gt; () &lt;span class="op"&gt;=&amp;gt;&lt;/span&gt; HomeView()&lt;span class="op"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb17-4"&gt;&lt;a aria-hidden="true" href="#cb17-4" tabindex="-1"&gt;&lt;/a&gt;    binding&lt;span class="op"&gt;:&lt;/span&gt; HomeBinding()&lt;span class="op"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb17-5"&gt;&lt;a aria-hidden="true" href="#cb17-5" tabindex="-1"&gt;&lt;/a&gt;)&lt;span class="op"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb17-6"&gt;&lt;a aria-hidden="true" href="#cb17-6" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb17-7"&gt;&lt;a aria-hidden="true" href="#cb17-7" tabindex="-1"&gt;&lt;/a&gt;Get&lt;span class="op"&gt;.&lt;/span&gt;to(DetailsView()&lt;span class="op"&gt;,&lt;/span&gt; binding&lt;span class="op"&gt;:&lt;/span&gt; DetailsBinding())&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id="参考"&gt;参考&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://github.com/jonataslaw/getx/tree/master/documentation/zh_CN"&gt;官方中文文档&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://chornthorn.github.io/getx-docs/"&gt;GetX Docs&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://tabpole.github.io/getx/"&gt;GetX Handbook&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;br/&gt;
&lt;!--%%REF%%--&gt;
&lt;br/&gt;
&lt;script async="" crossorigin="anonymous" data-category="Announcements" data-category-id="DIC_kwDOJ7Ymy84CX4eg" data-emit-metadata="0" data-input-position="top" data-lang="zh-CN" data-loading="lazy" data-mapping="title" data-reactions-enabled="1" data-repo="izfsk-ium/izfsk-ium.github.io" data-repo-id="R_kgDOJ7Ymyw" data-strict="0" data-theme="preferred_color_scheme" src="https://giscus.app/client.js"&gt;
&lt;/script&gt;
&lt;/main&gt;
&lt;footer&gt;
&lt;p class="signoff"&gt;
&lt;div class="metadata"&gt;
&lt;p class="date"&gt;&lt;time datetime="2023-06-01"&gt;创建日期：2023-06-01&lt;/time&gt;&lt;/p&gt;
&lt;p class="lastmodify"&gt;&lt;time&gt;最后编译：2023-08-10&lt;/time&gt;&lt;/p&gt;
&lt;p class="lastmodify" id="counter-span"&gt;访问次数：&lt;/p&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;/footer&gt;
&lt;script&gt;
    /* These script should run after page load */
    document.querySelectorAll('code.sourceCode').forEach(
      i =&gt; i.insertAdjacentHTML('beforeend', '&lt;div class="copy"&gt;复制&lt;/div&gt;')
    );
    document.querySelectorAll('div.copy').forEach(
      i =&gt; i.addEventListener(
        'click',
        () =&gt; {
          navigator.clipboard.writeText(i.parentElement.innerText.replace('复制', ''));
          i.innerText = '成功';
          setTimeout(() =&gt; {
            i.innerText = '复制';
          }, 1000);
        }
      )
    );

    if (location.href.includes("127.0.0.1:8080")) {
      document.getElementById("counter-span").innerHTML = "[[development mode]]";
    } else {
      const uuid = document.getElementById("article-uuid").innerText;
      const target = document.getElementById("counter-span");
      const last = localStorage.getItem("lastVisit-" + uuid);
      const shouldIncrease = last === null || new Date().getTime() - parseInt(last) &gt;= (1000 * 60 * 15);

      fetch(shouldIncrease ? ("https://counter.izfsk.top/counter/" + uuid) : ("https://counter.izfsk.top/readOnly/" + uuid))
        .then(r =&gt; r.text())
        .then(d =&gt; {
          if (!d.startsWith("Too"))
            document.getElementById("counter-span").innerText = "访问次数：" + d.toString();
          else
            document.getElementById("counter-span").innerHTML = "";
        });

      localStorage.setItem("lastVisit-" + uuid, new Date().getTime());
    }
  &lt;/script&gt;
&lt;script async="" data-website-id="2a1146ab-fa82-4a84-a04f-30e5967357c3" src="https://analytics.umami.is/script.js"&gt;&lt;/script&gt;
&lt;/body&gt;</content:encoded>
      <guid isPermaLink="false">7f58b9f5-d420-4722-8d41-6191a9453397</guid>
      <pubDate>Thu, 01 Jun 2023 00:00:00 +0800</pubDate>
    </item>
    <item>
      <title>使用 chntpw 修改 Windows 密码</title>
      <link>https://blog.izfsk.top/articles/使用chntpw修改Windows密码.html</link>
      <description>使用 chntpw 修改 Windows 密码</description>
      <content:encoded>&lt;body&gt;
&lt;progress id="content_progress" value="0"&gt;&lt;/progress&gt;
&lt;button id="back-to-top"&gt;
    回页顶
  &lt;/button&gt;
&lt;header&gt;
&lt;small id="article-uuid" style="display: none !important;"&gt;17e1a6a4-4eed-4a8e-94ae-5ed078e75530&lt;/small&gt;
&lt;h1 class="title"&gt;使用 chntpw 修改 Windows 密码&lt;/h1&gt;
&lt;!-- Subtitle --&gt;
&lt;h3 class="subtitle"&gt; &lt;/h3&gt;
&lt;/header&gt;
&lt;nav id="TOC" role="doc-toc"&gt;
&lt;strong&gt;文章归类: &lt;a href="/pages/category.html#备忘录"&gt;备忘录&lt;/a&gt; &lt;/strong&gt;
&lt;input id="contents" type="checkbox"/&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#准备" id="toc-准备"&gt;准备&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#进入系统" id="toc-进入系统"&gt;进入系统&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#挂载硬盘" id="toc-挂载硬盘"&gt;挂载硬盘&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#找到并更改-sam-文件" id="toc-找到并更改-sam-文件"&gt;找到并更改 SAM 文件&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#建议和提示" id="toc-建议和提示"&gt;建议和提示&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#参考" id="toc-参考"&gt;参考&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#reference"&gt;参考链接&lt;/a&gt;&lt;/li&gt;
&lt;li&gt; &lt;/li&gt;
&lt;li class="tools"&gt;
&lt;span id="backtomain"&gt;
&lt;svg class="bi bi-house" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M8.707 1.5a1 1 0 0 0-1.414 0L.646 8.146a.5.5 0 0 0 .708.708L2 8.207V13.5A1.5 1.5 0 0 0 3.5 15h9a1.5 1.5 0 0 0 1.5-1.5V8.207l.646.647a.5.5 0 0 0 .708-.708L13 5.793V2.5a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v1.293L8.707 1.5ZM13 7.207V13.5a.5.5 0 0 1-.5.5h-9a.5.5 0 0 1-.5-.5V7.207l5-5 5 5Z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="readingmode"&gt;
&lt;svg class="bi bi-book" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M1 2.828c.885-.37 2.154-.769 3.388-.893 1.33-.134 2.458.063 3.112.752v9.746c-.935-.53-2.12-.603-3.213-.493-1.18.12-2.37.461-3.287.811V2.828zm7.5-.141c.654-.689 1.782-.886 3.112-.752 1.234.124 2.503.523 3.388.893v9.923c-.918-.35-2.107-.692-3.287-.81-1.094-.111-2.278-.039-3.213.492V2.687zM8 1.783C7.015.936 5.587.81 4.287.94c-1.514.153-3.042.672-3.994 1.105A.5.5 0 0 0 0 2.5v11a.5.5 0 0 0 .707.455c.882-.4 2.303-.881 3.68-1.02 1.409-.142 2.59.087 3.223.877a.5.5 0 0 0 .78 0c.633-.79 1.814-1.019 3.222-.877 1.378.139 2.8.62 3.681 1.02A.5.5 0 0 0 16 13.5v-11a.5.5 0 0 0-.293-.455c-.952-.433-2.48-.952-3.994-1.105C10.413.809 8.985.936 8 1.783z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="larger"&gt; &lt;/span&gt;
&lt;span id="smaller"&gt;&lt;/span&gt;
&lt;span id="switchfont"&gt;
&lt;svg class="bi bi-fonts" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M12.258 3h-8.51l-.083 2.46h.479c.26-1.544.758-1.783 2.693-1.845l.424-.013v7.827c0 .663-.144.82-1.3.923v.52h4.082v-.52c-1.162-.103-1.306-.26-1.306-.923V3.602l.431.013c1.934.062 2.434.301 2.693 1.846h.479L12.258 3z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="backtotop"&gt;
&lt;svg class="bi bi-arrow-bar-up" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M8 10a.5.5 0 0 0 .5-.5V3.707l2.146 2.147a.5.5 0 0 0 .708-.708l-3-3a.5.5 0 0 0-.708 0l-3 3a.5.5 0 1 0 .708.708L7.5 3.707V9.5a.5.5 0 0 0 .5.5zm-7 2.5a.5.5 0 0 1 .5-.5h13a.5.5 0 0 1 0 1h-13a.5.5 0 0 1-.5-.5z" fill-rule="evenodd"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/nav&gt;
&lt;main&gt;
&lt;p&gt;对于上了密码的 Windows 系统，虽然没办法直接登录，但只要没有全盘加密，并且 BIOS 没有上锁，就可以通过引导其他系统来清除密码。&lt;/p&gt;
&lt;h2 id="准备"&gt;准备&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;chntpw&lt;/code&gt; 这个工具大多数常规 Linux 发行版并不会在 Live 系统里面预置。据说 Kail 的 Live CD 里面有自带这个工具，但我从来没用过 Kail。我选择的是专门用来进行系统维护的 &lt;code&gt;SystemRescueCd&lt;/code&gt;。可以在&lt;a href="https://www.system-rescue.org/Download/"&gt;这里&lt;/a&gt;下载其 iso 文件。刻录完成后即可使用。&lt;/p&gt;
&lt;p&gt;实际测试表明，&lt;code&gt;chntpw&lt;/code&gt; 可以更改 Windows 10 家庭普通版的密码。&lt;/p&gt;
&lt;h2 id="进入系统"&gt;进入系统&lt;/h2&gt;
&lt;p&gt;首先需要进 BIOS 修改启动顺序，顺便把安全启动关掉。然后进入系统：&lt;/p&gt;
&lt;figure&gt;
&lt;img alt="成功进入系统" src="./assets/1.png"/&gt;
&lt;figcaption aria-hidden="true"&gt;成功进入系统&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;h2 id="挂载硬盘"&gt;挂载硬盘&lt;/h2&gt;
&lt;p&gt;需要找到的是装有 Windows 根目录(?)的那个硬盘分区，一般的电脑就是最大的那一个。当然，实在拿不准的话就把几个硬盘都挂载上再说。&lt;/p&gt;
&lt;figure&gt;
&lt;img alt="正常情况" src="./assets/2.png"/&gt;
&lt;figcaption aria-hidden="true"&gt;正常情况&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;对于 Windows 7 和 Windows 8.1，大多数情况下就直接挂载成功了，最多自动做一个 fixing 也就继续挂载。但是对于 Windows 10 和 Windows 11，默认情况下系统会保留休眠文件（hiberfile.sys）以供下次快速启动。当然，可以在 Windows 里面用 powercfg 关掉，但咱们这么搞不就是因为不知道密码么（&lt;/p&gt;
&lt;p&gt;解决方案，使用 &lt;code&gt;ntfs-3g&lt;/code&gt; 移除休眠文件即可，但首先需要把自动只读挂载的分区 umount 掉。&lt;/p&gt;
&lt;p&gt;接下来：&lt;/p&gt;
&lt;div class="sourceCode" id="cb1"&gt;&lt;pre class="sourceCode sh"&gt;&lt;code class="sourceCode bash"&gt;&lt;span id="cb1-1"&gt;&lt;a aria-hidden="true" href="#cb1-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="ex"&gt;ntfs-3g&lt;/span&gt; &lt;span class="at"&gt;-o&lt;/span&gt; remove_hiberfile /dev/sdXN /path/to/mount&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;确保是读写挂载：&lt;/p&gt;
&lt;figure&gt;
&lt;img alt="rw挂载" src="./assets/3.webp"/&gt;
&lt;figcaption aria-hidden="true"&gt;rw挂载&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;h2 id="找到并更改-sam-文件"&gt;找到并更改 SAM 文件&lt;/h2&gt;
&lt;p&gt;Windows 的用户数据库位于 &lt;code&gt;c/Windows/System32/config&lt;/code&gt;:&lt;/p&gt;
&lt;figure&gt;
&lt;img alt="SAM文件" src="./assets/4.png"/&gt;
&lt;figcaption aria-hidden="true"&gt;SAM文件&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;接下来使用 &lt;code&gt;chntpw -l SAM&lt;/code&gt; 列出所有用户的资料：&lt;/p&gt;
&lt;figure&gt;
&lt;img alt="列出用户" src="./assets/6.png"/&gt;
&lt;figcaption aria-hidden="true"&gt;列出用户&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;接下来选取用户进入交互编辑模式。使用 RID 而用用户名，因为用户名可能包含空格甚至非 ASCII 字符，tty 下根本打不出来。在键入 RID 注意格式，例如 &lt;code&gt;01f4&lt;/code&gt; 要键入为 &lt;code&gt;0x1f4&lt;/code&gt;：&lt;/p&gt;
&lt;figure&gt;
&lt;img alt="编辑模式" src="./assets/edit.png"/&gt;
&lt;figcaption aria-hidden="true"&gt;编辑模式&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;要清除密码，键入 &lt;code&gt;1&lt;/code&gt; 然后回车即可。操作完毕以后，输入 &lt;code&gt;q&lt;/code&gt; 回车，会提示是否保存，键入 &lt;code&gt;y&lt;/code&gt; 回车确认就完成了。&lt;/p&gt;
&lt;p&gt;接下来回到根目录 &lt;code&gt;sync &amp;amp;&amp;amp; mount /mnt/c&lt;/code&gt; 即可。再次进入 Windows ，密码就消失了。&lt;/p&gt;
&lt;h2 id="建议和提示"&gt;建议和提示&lt;/h2&gt;
&lt;ol type="1"&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;chntpw&lt;/code&gt; 不能从哈希还原出密码，除非是你自己的电脑，直接清除用户密码就是告诉机主自己过来溜门撬锁过。因此要记得备份原来的 SAM 文件以供还原。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;关于 &lt;code&gt;Administrator&lt;/code&gt; 账户：现代 Windows 中 Administrator 账户并不是没有，只是默认被禁用了，这一点 &lt;code&gt;chntpw -l&lt;/code&gt; 可以看得到。除了选择清除已有用户的密码，还可以选择激活这个默认没有密码的账户。在使用 Administrator 进入 Windows 并操作完成后，可以 &lt;code&gt;net user administrator /active:no&lt;/code&gt; 再禁用它。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;无论如何，你总会留下蛛丝马迹，比如审核日志，比如消失的休眠文件，害人之心不可有。&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id="参考"&gt;参考&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://askubuntu.com/questions/145902/unable-to-mount-windows-ntfs-filesystem-due-to-hibernation"&gt;Unable to mount Windows (NTFS) filesystem due to hibernation&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://learn.microsoft.com/zh-cn/windows-hardware/manufacture/desktop/enable-and-disable-the-built-in-administrator-account"&gt;启用和禁用内置管理员帐户&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://manpages.debian.org/bookworm/chntpw/chntpw.8.en.html"&gt;Man page of chntpw&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;br/&gt;
&lt;!--%%REF%%--&gt;
&lt;br/&gt;
&lt;script async="" crossorigin="anonymous" data-category="Announcements" data-category-id="DIC_kwDOJ7Ymy84CX4eg" data-emit-metadata="0" data-input-position="top" data-lang="zh-CN" data-loading="lazy" data-mapping="title" data-reactions-enabled="1" data-repo="izfsk-ium/izfsk-ium.github.io" data-repo-id="R_kgDOJ7Ymyw" data-strict="0" data-theme="preferred_color_scheme" src="https://giscus.app/client.js"&gt;
&lt;/script&gt;
&lt;/main&gt;
&lt;footer&gt;
&lt;p class="signoff"&gt;
&lt;div class="metadata"&gt;
&lt;p class="date"&gt;&lt;time datetime="2023-06-22"&gt;创建日期：2023-06-22&lt;/time&gt;&lt;/p&gt;
&lt;p class="lastmodify"&gt;&lt;time&gt;最后编译：2023-08-10&lt;/time&gt;&lt;/p&gt;
&lt;p class="lastmodify" id="counter-span"&gt;访问次数：&lt;/p&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;/footer&gt;
&lt;script&gt;
    /* These script should run after page load */
    document.querySelectorAll('code.sourceCode').forEach(
      i =&gt; i.insertAdjacentHTML('beforeend', '&lt;div class="copy"&gt;复制&lt;/div&gt;')
    );
    document.querySelectorAll('div.copy').forEach(
      i =&gt; i.addEventListener(
        'click',
        () =&gt; {
          navigator.clipboard.writeText(i.parentElement.innerText.replace('复制', ''));
          i.innerText = '成功';
          setTimeout(() =&gt; {
            i.innerText = '复制';
          }, 1000);
        }
      )
    );

    if (location.href.includes("127.0.0.1:8080")) {
      document.getElementById("counter-span").innerHTML = "[[development mode]]";
    } else {
      const uuid = document.getElementById("article-uuid").innerText;
      const target = document.getElementById("counter-span");
      const last = localStorage.getItem("lastVisit-" + uuid);
      const shouldIncrease = last === null || new Date().getTime() - parseInt(last) &gt;= (1000 * 60 * 15);

      fetch(shouldIncrease ? ("https://counter.izfsk.top/counter/" + uuid) : ("https://counter.izfsk.top/readOnly/" + uuid))
        .then(r =&gt; r.text())
        .then(d =&gt; {
          if (!d.startsWith("Too"))
            document.getElementById("counter-span").innerText = "访问次数：" + d.toString();
          else
            document.getElementById("counter-span").innerHTML = "";
        });

      localStorage.setItem("lastVisit-" + uuid, new Date().getTime());
    }
  &lt;/script&gt;
&lt;script async="" data-website-id="2a1146ab-fa82-4a84-a04f-30e5967357c3" src="https://analytics.umami.is/script.js"&gt;&lt;/script&gt;
&lt;/body&gt;</content:encoded>
      <guid isPermaLink="false">17e1a6a4-4eed-4a8e-94ae-5ed078e75530</guid>
      <pubDate>Thu, 22 Jun 2023 00:00:00 +0800</pubDate>
    </item>
    <item>
      <title>v2ray 结合 cgproxy 全局代理方案</title>
      <link>https://blog.izfsk.top/articles/v2ray-core+cgproxy全局代理方案.html</link>
      <description>v2ray 结合 cgproxy 全局代理方案</description>
      <content:encoded>&lt;body&gt;
&lt;progress id="content_progress" value="0"&gt;&lt;/progress&gt;
&lt;button id="back-to-top"&gt;
    回页顶
  &lt;/button&gt;
&lt;header&gt;
&lt;small id="article-uuid" style="display: none !important;"&gt;d335a295-647a-4f5e-b15b-140178c18782&lt;/small&gt;
&lt;h1 class="title"&gt;v2ray 结合 cgproxy 全局代理方案&lt;/h1&gt;
&lt;!-- Subtitle --&gt;
&lt;h3 class="subtitle"&gt; &lt;/h3&gt;
&lt;/header&gt;
&lt;nav id="TOC" role="doc-toc"&gt;
&lt;strong&gt;文章归类: &lt;a href="/pages/category.html#备忘录"&gt;备忘录&lt;/a&gt; &lt;/strong&gt;
&lt;input id="contents" type="checkbox"/&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#前提准备" id="toc-前提准备"&gt;前提准备&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#确保-cgroup-支持" id="toc-确保-cgroup-支持"&gt;确保 cgroup 支持&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#v2ray" id="toc-v2ray"&gt;v2ray&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#配置文件" id="toc-配置文件"&gt;配置文件&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#安装-cgproxy" id="toc-安装-cgproxy"&gt;安装 cgproxy&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#修改配置文件" id="toc-修改配置文件"&gt;修改配置文件&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#启用" id="toc-启用"&gt;启用&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#其他" id="toc-其他"&gt;其他&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#参考" id="toc-参考"&gt;参考&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#reference"&gt;参考链接&lt;/a&gt;&lt;/li&gt;
&lt;li&gt; &lt;/li&gt;
&lt;li class="tools"&gt;
&lt;span id="backtomain"&gt;
&lt;svg class="bi bi-house" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M8.707 1.5a1 1 0 0 0-1.414 0L.646 8.146a.5.5 0 0 0 .708.708L2 8.207V13.5A1.5 1.5 0 0 0 3.5 15h9a1.5 1.5 0 0 0 1.5-1.5V8.207l.646.647a.5.5 0 0 0 .708-.708L13 5.793V2.5a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v1.293L8.707 1.5ZM13 7.207V13.5a.5.5 0 0 1-.5.5h-9a.5.5 0 0 1-.5-.5V7.207l5-5 5 5Z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="readingmode"&gt;
&lt;svg class="bi bi-book" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M1 2.828c.885-.37 2.154-.769 3.388-.893 1.33-.134 2.458.063 3.112.752v9.746c-.935-.53-2.12-.603-3.213-.493-1.18.12-2.37.461-3.287.811V2.828zm7.5-.141c.654-.689 1.782-.886 3.112-.752 1.234.124 2.503.523 3.388.893v9.923c-.918-.35-2.107-.692-3.287-.81-1.094-.111-2.278-.039-3.213.492V2.687zM8 1.783C7.015.936 5.587.81 4.287.94c-1.514.153-3.042.672-3.994 1.105A.5.5 0 0 0 0 2.5v11a.5.5 0 0 0 .707.455c.882-.4 2.303-.881 3.68-1.02 1.409-.142 2.59.087 3.223.877a.5.5 0 0 0 .78 0c.633-.79 1.814-1.019 3.222-.877 1.378.139 2.8.62 3.681 1.02A.5.5 0 0 0 16 13.5v-11a.5.5 0 0 0-.293-.455c-.952-.433-2.48-.952-3.994-1.105C10.413.809 8.985.936 8 1.783z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="larger"&gt; &lt;/span&gt;
&lt;span id="smaller"&gt;&lt;/span&gt;
&lt;span id="switchfont"&gt;
&lt;svg class="bi bi-fonts" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M12.258 3h-8.51l-.083 2.46h.479c.26-1.544.758-1.783 2.693-1.845l.424-.013v7.827c0 .663-.144.82-1.3.923v.52h4.082v-.52c-1.162-.103-1.306-.26-1.306-.923V3.602l.431.013c1.934.062 2.434.301 2.693 1.846h.479L12.258 3z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="backtotop"&gt;
&lt;svg class="bi bi-arrow-bar-up" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M8 10a.5.5 0 0 0 .5-.5V3.707l2.146 2.147a.5.5 0 0 0 .708-.708l-3-3a.5.5 0 0 0-.708 0l-3 3a.5.5 0 1 0 .708.708L7.5 3.707V9.5a.5.5 0 0 0 .5.5zm-7 2.5a.5.5 0 0 1 .5-.5h13a.5.5 0 0 1 0 1h-13a.5.5 0 0 1-.5-.5z" fill-rule="evenodd"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/nav&gt;
&lt;main&gt;
&lt;p&gt;&lt;code&gt;cgproxy&lt;/code&gt; 是使用 Linux &lt;code&gt;cgroup&lt;/code&gt; 功能实现全局代理的工具。一般在 Linux 上使用代理工具难以设置全局代理，不同的桌面环境，不同的软件行为都不一样，有的读取桌面环境的配置，有的认可环境变量，有的在软件内配置，有的根本不提供代理设置方式。一般对于终端中的程序可以使用 &lt;code&gt;proxychains&lt;/code&gt; 来强制走代理，但这个工具是基于 &lt;code&gt;LD_PRELOAD&lt;/code&gt;，对于静态链接的程序就不行。所以需要一个统一的解决方案。&lt;/p&gt;
&lt;h2 id="前提准备"&gt;前提准备&lt;/h2&gt;
&lt;h3 id="确保-cgroup-支持"&gt;确保 cgroup 支持&lt;/h3&gt;
&lt;p&gt;运行 &lt;code&gt;findmnt -t cgroup2&lt;/code&gt;，如果出现类似&lt;/p&gt;
&lt;pre class="log"&gt;&lt;code&gt;TARGET               SOURCE  FSTYPE  OPTIONS
/sys/fs/cgroup       cgroup2 cgroup2 rw,nosuid,nodev,noexec,relatime
/run/cgproxy/cgroup2 none    cgroup2 rw,relatime&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;则支持。&lt;/p&gt;
&lt;h3 id="v2ray"&gt;v2ray&lt;/h3&gt;
&lt;p&gt;首先需要安装代理工具核心。可以使用发行版提供的版本，也可以使用安装脚本。&lt;code&gt;v2fly&lt;/code&gt; 有提供一个安装脚本。执行即可。&lt;/p&gt;
&lt;div class="sourceCode" id="cb2"&gt;&lt;pre class="sourceCode sh"&gt;&lt;code class="sourceCode bash"&gt;&lt;span id="cb2-1"&gt;&lt;a aria-hidden="true" href="#cb2-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="fu"&gt;bash&lt;/span&gt; &lt;span class="op"&gt;&amp;lt;(&lt;/span&gt;&lt;span class="ex"&gt;curl&lt;/span&gt; &lt;span class="at"&gt;-L&lt;/span&gt; https://raw.githubusercontent.com/v2fly/fhs-install-v2ray/master/install-release.sh&lt;span class="op"&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;当然，访问 &lt;code&gt;githubusercontent&lt;/code&gt; 需要代理……所以你可以使用手机共享网络+分享 vpn 的方式。不过似乎中国的大部分 Android 发行版都不支持(?)&lt;/p&gt;
&lt;p&gt;这个脚本将各个文件安装在如下位置：&lt;/p&gt;
&lt;div class="sourceCode" id="cb3"&gt;&lt;pre class="sourceCode yaml"&gt;&lt;code class="sourceCode yaml"&gt;&lt;span id="cb3-1"&gt;&lt;a aria-hidden="true" href="#cb3-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="fu"&gt;installed&lt;/span&gt;&lt;span class="kw"&gt;:&lt;/span&gt;&lt;span class="at"&gt; /usr/local/bin/v2ray&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb3-2"&gt;&lt;a aria-hidden="true" href="#cb3-2" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="fu"&gt;installed&lt;/span&gt;&lt;span class="kw"&gt;:&lt;/span&gt;&lt;span class="at"&gt; /usr/local/bin/v2ctl&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb3-3"&gt;&lt;a aria-hidden="true" href="#cb3-3" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="fu"&gt;installed&lt;/span&gt;&lt;span class="kw"&gt;:&lt;/span&gt;&lt;span class="at"&gt; /usr/local/share/v2ray/geoip.dat&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb3-4"&gt;&lt;a aria-hidden="true" href="#cb3-4" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="fu"&gt;installed&lt;/span&gt;&lt;span class="kw"&gt;:&lt;/span&gt;&lt;span class="at"&gt; /usr/local/share/v2ray/geosite.dat&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb3-5"&gt;&lt;a aria-hidden="true" href="#cb3-5" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="fu"&gt;installed&lt;/span&gt;&lt;span class="kw"&gt;:&lt;/span&gt;&lt;span class="at"&gt; /usr/local/etc/v2ray/config.json&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb3-6"&gt;&lt;a aria-hidden="true" href="#cb3-6" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="fu"&gt;installed&lt;/span&gt;&lt;span class="kw"&gt;:&lt;/span&gt;&lt;span class="at"&gt; /var/log/v2ray/&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb3-7"&gt;&lt;a aria-hidden="true" href="#cb3-7" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="fu"&gt;installed&lt;/span&gt;&lt;span class="kw"&gt;:&lt;/span&gt;&lt;span class="at"&gt; /var/log/v2ray/access.log&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb3-8"&gt;&lt;a aria-hidden="true" href="#cb3-8" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="fu"&gt;installed&lt;/span&gt;&lt;span class="kw"&gt;:&lt;/span&gt;&lt;span class="at"&gt; /var/log/v2ray/error.log&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb3-9"&gt;&lt;a aria-hidden="true" href="#cb3-9" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="fu"&gt;installed&lt;/span&gt;&lt;span class="kw"&gt;:&lt;/span&gt;&lt;span class="at"&gt; /etc/systemd/system/v2ray.service&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb3-10"&gt;&lt;a aria-hidden="true" href="#cb3-10" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="fu"&gt;installed&lt;/span&gt;&lt;span class="kw"&gt;:&lt;/span&gt;&lt;span class="at"&gt; /etc/systemd/system/v2ray@.service&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;值得注意的是配置文件路径：&lt;code&gt;/usr/local/etc/v2ray/config.json&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;接下来启用和运行 &lt;code&gt;systemd&lt;/code&gt; 单元即可：&lt;/p&gt;
&lt;div class="sourceCode" id="cb4"&gt;&lt;pre class="sourceCode sh"&gt;&lt;code class="sourceCode bash"&gt;&lt;span id="cb4-1"&gt;&lt;a aria-hidden="true" href="#cb4-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="fu"&gt;sudo&lt;/span&gt; systemctl enable &lt;span class="at"&gt;--now&lt;/span&gt; v2ray&lt;/span&gt;
&lt;span id="cb4-2"&gt;&lt;a aria-hidden="true" href="#cb4-2" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="fu"&gt;sudo&lt;/span&gt; systemctl start v2ray&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id="配置文件"&gt;配置文件&lt;/h3&gt;
&lt;p&gt;当然是你自己搞到配置文件。无论如何，你需要得到一个完整的 json 配置文件来替换 &lt;code&gt;/usr/local/etc/v2ray/config.json&lt;/code&gt;，关于如何从订阅链接或者从各种链接转换就不展开说明了。&lt;/p&gt;
&lt;p&gt;其中一个办法是从手机导入，在 v2rayNG 中导出配置到剪贴板再复制到文件，然后复制到电脑上。&lt;/p&gt;
&lt;h3 id="安装-cgproxy"&gt;安装 cgproxy&lt;/h3&gt;
&lt;p&gt;首先，你的 Linux 发行版不能太旧。不然都不支持 cgroup v2。&lt;/p&gt;
&lt;p&gt;在编译安装之前需要各种工具和相关的库：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;cmake&lt;/code&gt;, &lt;code&gt;gcc&lt;/code&gt;, &lt;code&gt;g++&lt;/code&gt; 等编译工具：对于 Debian 系列的发行版，是&lt;code&gt;sudo apt-get install build-essential&lt;/code&gt;；对于 openSUSE，是 &lt;code&gt;zypper install -t pattern devel_basis&lt;/code&gt;。&lt;code&gt;cmake&lt;/code&gt; 可能不在里面，再额外安装一下就行。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;bpftool&lt;/code&gt;, &lt;code&gt;libbpf-devel&lt;/code&gt;, &lt;code&gt;nlohmann_json-devel&lt;/code&gt;：&lt;code&gt;cgproxy&lt;/code&gt; 的依赖。对于 openSUSE，软件包就是前面的名字，安装即可。对于其他发行版，请查阅文档。&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;接下来编译安装：&lt;/p&gt;
&lt;div class="sourceCode" id="cb5"&gt;&lt;pre class="sourceCode sh"&gt;&lt;code class="sourceCode bash"&gt;&lt;span id="cb5-1"&gt;&lt;a aria-hidden="true" href="#cb5-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="fu"&gt;git&lt;/span&gt; clone https://github.com/springzfx/cgproxy&lt;/span&gt;
&lt;span id="cb5-2"&gt;&lt;a aria-hidden="true" href="#cb5-2" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="bu"&gt;cd&lt;/span&gt; cgproxy &lt;span class="kw"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="fu"&gt;mkdir&lt;/span&gt; build&lt;/span&gt;
&lt;span id="cb5-3"&gt;&lt;a aria-hidden="true" href="#cb5-3" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="bu"&gt;cd&lt;/span&gt; build&lt;/span&gt;
&lt;span id="cb5-4"&gt;&lt;a aria-hidden="true" href="#cb5-4" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="co"&gt;# generate&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb5-5"&gt;&lt;a aria-hidden="true" href="#cb5-5" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="fu"&gt;cmake&lt;/span&gt; &lt;span class="at"&gt;-DCMAKE_BUILD_TYPE&lt;/span&gt;&lt;span class="op"&gt;=&lt;/span&gt;Release &lt;span class="dt"&gt;\&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb5-6"&gt;&lt;a aria-hidden="true" href="#cb5-6" tabindex="-1"&gt;&lt;/a&gt;      &lt;span class="at"&gt;-DCMAKE_INSTALL_PREFIX&lt;/span&gt;&lt;span class="op"&gt;=&lt;/span&gt;/usr &lt;span class="dt"&gt;\&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb5-7"&gt;&lt;a aria-hidden="true" href="#cb5-7" tabindex="-1"&gt;&lt;/a&gt;      &lt;span class="at"&gt;-Dbuild_execsnoop_dl&lt;/span&gt;&lt;span class="op"&gt;=&lt;/span&gt;ON &lt;span class="dt"&gt;\&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb5-8"&gt;&lt;a aria-hidden="true" href="#cb5-8" tabindex="-1"&gt;&lt;/a&gt;      &lt;span class="at"&gt;-Dbuild_static&lt;/span&gt;&lt;span class="op"&gt;=&lt;/span&gt;OFF &lt;span class="dt"&gt;\&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb5-9"&gt;&lt;a aria-hidden="true" href="#cb5-9" tabindex="-1"&gt;&lt;/a&gt;      ..&lt;/span&gt;
&lt;span id="cb5-10"&gt;&lt;a aria-hidden="true" href="#cb5-10" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="co"&gt;# compile&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb5-11"&gt;&lt;a aria-hidden="true" href="#cb5-11" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="fu"&gt;make&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;如果 &lt;code&gt;cmake&lt;/code&gt; 报错，就按照错误找缺失的包安装。如果 &lt;code&gt;make&lt;/code&gt; 报错，可能是 &lt;code&gt;bpftool&lt;/code&gt; 没有安装。&lt;/p&gt;
&lt;p&gt;接下来 &lt;code&gt;sudo make install&lt;/code&gt; 安装到系统。并启用 &lt;code&gt;systemd&lt;/code&gt; 单元：&lt;/p&gt;
&lt;div class="sourceCode" id="cb6"&gt;&lt;pre class="sourceCode sh"&gt;&lt;code class="sourceCode bash"&gt;&lt;span id="cb6-1"&gt;&lt;a aria-hidden="true" href="#cb6-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="fu"&gt;sudo&lt;/span&gt; systemctl enable &lt;span class="at"&gt;--now&lt;/span&gt; cgproxy.service&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;如果一切顺利，则会提示&lt;/p&gt;
&lt;pre class="log"&gt;&lt;code&gt;Created symlink /etc/systemd/system/multi-user.target.wants/cgproxy.service → /usr/lib/systemd/system/cgproxy.service.&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id="修改配置文件"&gt;修改配置文件&lt;/h2&gt;
&lt;p&gt;首先确保你的 &lt;code&gt;v2ray&lt;/code&gt; 核心运行良好，请启动它并自行寻找一个方式验证。一般来讲配置的默认入站地址有 &lt;code&gt;socks://127.0.0.1:10808&lt;/code&gt;，所以可以在火狐中设置一下代理。总之确保目前的 &lt;code&gt;v2ray&lt;/code&gt; 配置无误。&lt;/p&gt;
&lt;p&gt;&lt;code&gt;cgproxy&lt;/code&gt; 的运行机制可以理解成这样：所有程序网路请求都会被它“拦截”并转发到 &lt;code&gt;v2ray&lt;/code&gt;，但转发的协议不是 &lt;code&gt;http&lt;/code&gt; 或者 &lt;code&gt;socks&lt;/code&gt; 而是 &lt;code&gt;dokodemo-door&lt;/code&gt;。所以你需要额外在自己的 &lt;code&gt;v2ray&lt;/code&gt; 配置文件里面加入 &lt;code&gt;dokodemo-door&lt;/code&gt; 的透明代理监听入站。&lt;/p&gt;
&lt;p&gt;假设原来的配置是这样：&lt;/p&gt;
&lt;div class="sourceCode" id="cb8"&gt;&lt;pre class="sourceCode json"&gt;&lt;code class="sourceCode json"&gt;&lt;span id="cb8-1"&gt;&lt;a aria-hidden="true" href="#cb8-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="fu"&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb8-2"&gt;&lt;a aria-hidden="true" href="#cb8-2" tabindex="-1"&gt;&lt;/a&gt;  &lt;span class="dt"&gt;"dns"&lt;/span&gt;&lt;span class="fu"&gt;:&lt;/span&gt; &lt;span class="fu"&gt;{&lt;/span&gt;&lt;span class="er"&gt;...&lt;/span&gt;&lt;span class="fu"&gt;},&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb8-3"&gt;&lt;a aria-hidden="true" href="#cb8-3" tabindex="-1"&gt;&lt;/a&gt;  &lt;span class="dt"&gt;"inbounds"&lt;/span&gt;&lt;span class="fu"&gt;:&lt;/span&gt; &lt;span class="ot"&gt;[&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb8-4"&gt;&lt;a aria-hidden="true" href="#cb8-4" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="fu"&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb8-5"&gt;&lt;a aria-hidden="true" href="#cb8-5" tabindex="-1"&gt;&lt;/a&gt;      &lt;span class="dt"&gt;"listen"&lt;/span&gt;&lt;span class="fu"&gt;:&lt;/span&gt; &lt;span class="st"&gt;"127.0.0.1"&lt;/span&gt;&lt;span class="fu"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb8-6"&gt;&lt;a aria-hidden="true" href="#cb8-6" tabindex="-1"&gt;&lt;/a&gt;      &lt;span class="dt"&gt;"port"&lt;/span&gt;&lt;span class="fu"&gt;:&lt;/span&gt; &lt;span class="dv"&gt;10808&lt;/span&gt;&lt;span class="fu"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb8-7"&gt;&lt;a aria-hidden="true" href="#cb8-7" tabindex="-1"&gt;&lt;/a&gt;      &lt;span class="dt"&gt;"protocol"&lt;/span&gt;&lt;span class="fu"&gt;:&lt;/span&gt; &lt;span class="st"&gt;"socks"&lt;/span&gt;&lt;span class="fu"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb8-8"&gt;&lt;a aria-hidden="true" href="#cb8-8" tabindex="-1"&gt;&lt;/a&gt;      &lt;span class="dt"&gt;"settings"&lt;/span&gt;&lt;span class="fu"&gt;:&lt;/span&gt; &lt;span class="fu"&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb8-9"&gt;&lt;a aria-hidden="true" href="#cb8-9" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="er"&gt;...&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb8-10"&gt;&lt;a aria-hidden="true" href="#cb8-10" tabindex="-1"&gt;&lt;/a&gt;      &lt;span class="fu"&gt;},&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb8-11"&gt;&lt;a aria-hidden="true" href="#cb8-11" tabindex="-1"&gt;&lt;/a&gt;      &lt;span class="dt"&gt;"sniffing"&lt;/span&gt;&lt;span class="fu"&gt;:&lt;/span&gt; &lt;span class="fu"&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb8-12"&gt;&lt;a aria-hidden="true" href="#cb8-12" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="er"&gt;...&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb8-13"&gt;&lt;a aria-hidden="true" href="#cb8-13" tabindex="-1"&gt;&lt;/a&gt;      &lt;span class="fu"&gt;},&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb8-14"&gt;&lt;a aria-hidden="true" href="#cb8-14" tabindex="-1"&gt;&lt;/a&gt;      &lt;span class="dt"&gt;"tag"&lt;/span&gt;&lt;span class="fu"&gt;:&lt;/span&gt; &lt;span class="st"&gt;"socks"&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb8-15"&gt;&lt;a aria-hidden="true" href="#cb8-15" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="fu"&gt;}&lt;/span&gt;&lt;span class="ot"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb8-16"&gt;&lt;a aria-hidden="true" href="#cb8-16" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="fu"&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb8-17"&gt;&lt;a aria-hidden="true" href="#cb8-17" tabindex="-1"&gt;&lt;/a&gt;      &lt;span class="dt"&gt;"listen"&lt;/span&gt;&lt;span class="fu"&gt;:&lt;/span&gt; &lt;span class="st"&gt;"127.0.0.1"&lt;/span&gt;&lt;span class="fu"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb8-18"&gt;&lt;a aria-hidden="true" href="#cb8-18" tabindex="-1"&gt;&lt;/a&gt;      &lt;span class="dt"&gt;"port"&lt;/span&gt;&lt;span class="fu"&gt;:&lt;/span&gt; &lt;span class="dv"&gt;10809&lt;/span&gt;&lt;span class="fu"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb8-19"&gt;&lt;a aria-hidden="true" href="#cb8-19" tabindex="-1"&gt;&lt;/a&gt;      &lt;span class="dt"&gt;"protocol"&lt;/span&gt;&lt;span class="fu"&gt;:&lt;/span&gt; &lt;span class="st"&gt;"http"&lt;/span&gt;&lt;span class="fu"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb8-20"&gt;&lt;a aria-hidden="true" href="#cb8-20" tabindex="-1"&gt;&lt;/a&gt;      &lt;span class="dt"&gt;"settings"&lt;/span&gt;&lt;span class="fu"&gt;:&lt;/span&gt; &lt;span class="fu"&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb8-21"&gt;&lt;a aria-hidden="true" href="#cb8-21" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="er"&gt;...&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb8-22"&gt;&lt;a aria-hidden="true" href="#cb8-22" tabindex="-1"&gt;&lt;/a&gt;      &lt;span class="fu"&gt;},&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb8-23"&gt;&lt;a aria-hidden="true" href="#cb8-23" tabindex="-1"&gt;&lt;/a&gt;      &lt;span class="dt"&gt;"tag"&lt;/span&gt;&lt;span class="fu"&gt;:&lt;/span&gt; &lt;span class="st"&gt;"http"&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb8-24"&gt;&lt;a aria-hidden="true" href="#cb8-24" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="fu"&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb8-25"&gt;&lt;a aria-hidden="true" href="#cb8-25" tabindex="-1"&gt;&lt;/a&gt;  &lt;span class="ot"&gt;]&lt;/span&gt;&lt;span class="fu"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb8-26"&gt;&lt;a aria-hidden="true" href="#cb8-26" tabindex="-1"&gt;&lt;/a&gt;  &lt;span class="dt"&gt;"log"&lt;/span&gt;&lt;span class="fu"&gt;:&lt;/span&gt; &lt;span class="fu"&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb8-27"&gt;&lt;a aria-hidden="true" href="#cb8-27" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="dt"&gt;"loglevel"&lt;/span&gt;&lt;span class="fu"&gt;:&lt;/span&gt; &lt;span class="st"&gt;"warning"&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb8-28"&gt;&lt;a aria-hidden="true" href="#cb8-28" tabindex="-1"&gt;&lt;/a&gt;  &lt;span class="fu"&gt;},&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb8-29"&gt;&lt;a aria-hidden="true" href="#cb8-29" tabindex="-1"&gt;&lt;/a&gt;  &lt;span class="dt"&gt;"outbounds"&lt;/span&gt;&lt;span class="fu"&gt;:&lt;/span&gt; &lt;span class="ot"&gt;[&lt;/span&gt;&lt;span class="er"&gt;...&lt;/span&gt;&lt;span class="ot"&gt;]&lt;/span&gt;&lt;span class="fu"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb8-30"&gt;&lt;a aria-hidden="true" href="#cb8-30" tabindex="-1"&gt;&lt;/a&gt;  &lt;span class="dt"&gt;"routing"&lt;/span&gt;&lt;span class="fu"&gt;:&lt;/span&gt; &lt;span class="fu"&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb8-31"&gt;&lt;a aria-hidden="true" href="#cb8-31" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="er"&gt;...&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb8-32"&gt;&lt;a aria-hidden="true" href="#cb8-32" tabindex="-1"&gt;&lt;/a&gt;  &lt;span class="fu"&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb8-33"&gt;&lt;a aria-hidden="true" href="#cb8-33" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="fu"&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;可以看见 &lt;code&gt;inbounds&lt;/code&gt; 区域里面有两个入站设定，现在把第三个添加到 &lt;code&gt;inbounds&lt;/code&gt; 里面：&lt;/p&gt;
&lt;div class="sourceCode" id="cb9"&gt;&lt;pre class="sourceCode json"&gt;&lt;code class="sourceCode json"&gt;&lt;span id="cb9-1"&gt;&lt;a aria-hidden="true" href="#cb9-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="fu"&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb9-2"&gt;&lt;a aria-hidden="true" href="#cb9-2" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="dt"&gt;"tag"&lt;/span&gt;&lt;span class="fu"&gt;:&lt;/span&gt; &lt;span class="st"&gt;"transparent"&lt;/span&gt;&lt;span class="fu"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb9-3"&gt;&lt;a aria-hidden="true" href="#cb9-3" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="dt"&gt;"port"&lt;/span&gt;&lt;span class="fu"&gt;:&lt;/span&gt; &lt;span class="dv"&gt;12345&lt;/span&gt;&lt;span class="fu"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb9-4"&gt;&lt;a aria-hidden="true" href="#cb9-4" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="dt"&gt;"protocol"&lt;/span&gt;&lt;span class="fu"&gt;:&lt;/span&gt; &lt;span class="st"&gt;"dokodemo-door"&lt;/span&gt;&lt;span class="fu"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb9-5"&gt;&lt;a aria-hidden="true" href="#cb9-5" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="dt"&gt;"settings"&lt;/span&gt;&lt;span class="fu"&gt;:&lt;/span&gt; &lt;span class="fu"&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb9-6"&gt;&lt;a aria-hidden="true" href="#cb9-6" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="dt"&gt;"network"&lt;/span&gt;&lt;span class="fu"&gt;:&lt;/span&gt; &lt;span class="st"&gt;"tcp,udp"&lt;/span&gt;&lt;span class="fu"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb9-7"&gt;&lt;a aria-hidden="true" href="#cb9-7" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="dt"&gt;"followRedirect"&lt;/span&gt;&lt;span class="fu"&gt;:&lt;/span&gt; &lt;span class="kw"&gt;true&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb9-8"&gt;&lt;a aria-hidden="true" href="#cb9-8" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="fu"&gt;},&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb9-9"&gt;&lt;a aria-hidden="true" href="#cb9-9" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="dt"&gt;"sniffing"&lt;/span&gt;&lt;span class="fu"&gt;:&lt;/span&gt; &lt;span class="fu"&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb9-10"&gt;&lt;a aria-hidden="true" href="#cb9-10" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="dt"&gt;"enabled"&lt;/span&gt;&lt;span class="fu"&gt;:&lt;/span&gt; &lt;span class="kw"&gt;true&lt;/span&gt;&lt;span class="fu"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb9-11"&gt;&lt;a aria-hidden="true" href="#cb9-11" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="dt"&gt;"destOverride"&lt;/span&gt;&lt;span class="fu"&gt;:&lt;/span&gt; &lt;span class="ot"&gt;[&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb9-12"&gt;&lt;a aria-hidden="true" href="#cb9-12" tabindex="-1"&gt;&lt;/a&gt;            &lt;span class="st"&gt;"http"&lt;/span&gt;&lt;span class="ot"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb9-13"&gt;&lt;a aria-hidden="true" href="#cb9-13" tabindex="-1"&gt;&lt;/a&gt;            &lt;span class="st"&gt;"tls"&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb9-14"&gt;&lt;a aria-hidden="true" href="#cb9-14" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="ot"&gt;]&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb9-15"&gt;&lt;a aria-hidden="true" href="#cb9-15" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="fu"&gt;},&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb9-16"&gt;&lt;a aria-hidden="true" href="#cb9-16" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="dt"&gt;"streamSettings"&lt;/span&gt;&lt;span class="fu"&gt;:&lt;/span&gt; &lt;span class="fu"&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb9-17"&gt;&lt;a aria-hidden="true" href="#cb9-17" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="dt"&gt;"sockopt"&lt;/span&gt;&lt;span class="fu"&gt;:&lt;/span&gt; &lt;span class="fu"&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb9-18"&gt;&lt;a aria-hidden="true" href="#cb9-18" tabindex="-1"&gt;&lt;/a&gt;            &lt;span class="dt"&gt;"tproxy"&lt;/span&gt;&lt;span class="fu"&gt;:&lt;/span&gt; &lt;span class="st"&gt;"tproxy"&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb9-19"&gt;&lt;a aria-hidden="true" href="#cb9-19" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="fu"&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb9-20"&gt;&lt;a aria-hidden="true" href="#cb9-20" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="fu"&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb9-21"&gt;&lt;a aria-hidden="true" href="#cb9-21" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="fu"&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;便于查错，你可以使用 &lt;code&gt;vscode&lt;/code&gt; 等工具打开配置文件修改和添加内容。&lt;strong&gt;以防万一，注意备份你的配置&lt;/strong&gt;。&lt;/p&gt;
&lt;p&gt;这里设置的 &lt;code&gt;dokodemo-door&lt;/code&gt; 监听端口是 &lt;code&gt;12345&lt;/code&gt; 端口。修改完毕后保存，然后测试：&lt;/p&gt;
&lt;div class="sourceCode" id="cb10"&gt;&lt;pre class="sourceCode sh"&gt;&lt;code class="sourceCode bash"&gt;&lt;span id="cb10-1"&gt;&lt;a aria-hidden="true" href="#cb10-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="ex"&gt;v2ray&lt;/span&gt; test &lt;span class="at"&gt;-c&lt;/span&gt; /usr/local/etc/v2ray/config.json&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;如果没有问题：&lt;/p&gt;
&lt;pre class="log"&gt;&lt;code&gt;V2Ray 5.7.0 (V2Fly, a community-driven edition of V2Ray.) Custom (go1.20.4 linux/amd64)
A unified platform for anti-censorship.
Configuration OK.&lt;/code&gt;&lt;/pre&gt;
&lt;del&gt;
    那就是没有问题
    &lt;/del&gt;
&lt;p&gt;接下来重启 &lt;code&gt;v2ray&lt;/code&gt; 服务：&lt;/p&gt;
&lt;div class="sourceCode" id="cb12"&gt;&lt;pre class="sourceCode sh"&gt;&lt;code class="sourceCode bash"&gt;&lt;span id="cb12-1"&gt;&lt;a aria-hidden="true" href="#cb12-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="fu"&gt;sudo&lt;/span&gt; systemctl restart v2ray&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;现在开始修改 &lt;code&gt;cgproxy&lt;/code&gt; 的配置文件，其位于 &lt;code&gt;/etc/cgproxy/config.json&lt;/code&gt;。&lt;/p&gt;
&lt;p&gt;默认情况下：&lt;/p&gt;
&lt;div class="sourceCode" id="cb13"&gt;&lt;pre class="sourceCode json"&gt;&lt;code class="sourceCode json"&gt;&lt;span id="cb13-1"&gt;&lt;a aria-hidden="true" href="#cb13-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="fu"&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb13-2"&gt;&lt;a aria-hidden="true" href="#cb13-2" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="dt"&gt;"port"&lt;/span&gt;&lt;span class="fu"&gt;:&lt;/span&gt; &lt;span class="dv"&gt;12345&lt;/span&gt;&lt;span class="fu"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb13-3"&gt;&lt;a aria-hidden="true" href="#cb13-3" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="dt"&gt;"program_noproxy"&lt;/span&gt;&lt;span class="fu"&gt;:&lt;/span&gt; &lt;span class="ot"&gt;[&lt;/span&gt;&lt;span class="st"&gt;"v2ray"&lt;/span&gt;&lt;span class="ot"&gt;,&lt;/span&gt; &lt;span class="st"&gt;"qv2ray"&lt;/span&gt;&lt;span class="ot"&gt;]&lt;/span&gt;&lt;span class="fu"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb13-4"&gt;&lt;a aria-hidden="true" href="#cb13-4" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="dt"&gt;"program_proxy"&lt;/span&gt;&lt;span class="fu"&gt;:&lt;/span&gt; &lt;span class="ot"&gt;[]&lt;/span&gt;&lt;span class="fu"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb13-5"&gt;&lt;a aria-hidden="true" href="#cb13-5" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="dt"&gt;"cgroup_noproxy"&lt;/span&gt;&lt;span class="fu"&gt;:&lt;/span&gt; &lt;span class="ot"&gt;[&lt;/span&gt;&lt;span class="st"&gt;"/system.slice/v2ray.service"&lt;/span&gt;&lt;span class="ot"&gt;]&lt;/span&gt;&lt;span class="fu"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb13-6"&gt;&lt;a aria-hidden="true" href="#cb13-6" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="dt"&gt;"cgroup_proxy"&lt;/span&gt;&lt;span class="fu"&gt;:&lt;/span&gt; &lt;span class="ot"&gt;[]&lt;/span&gt;&lt;span class="fu"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb13-7"&gt;&lt;a aria-hidden="true" href="#cb13-7" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="dt"&gt;"enable_gateway"&lt;/span&gt;&lt;span class="fu"&gt;:&lt;/span&gt; &lt;span class="kw"&gt;false&lt;/span&gt;&lt;span class="fu"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb13-8"&gt;&lt;a aria-hidden="true" href="#cb13-8" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="dt"&gt;"enable_dns"&lt;/span&gt;&lt;span class="fu"&gt;:&lt;/span&gt; &lt;span class="kw"&gt;true&lt;/span&gt;&lt;span class="fu"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb13-9"&gt;&lt;a aria-hidden="true" href="#cb13-9" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="dt"&gt;"enable_udp"&lt;/span&gt;&lt;span class="fu"&gt;:&lt;/span&gt; &lt;span class="kw"&gt;true&lt;/span&gt;&lt;span class="fu"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb13-10"&gt;&lt;a aria-hidden="true" href="#cb13-10" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="dt"&gt;"enable_tcp"&lt;/span&gt;&lt;span class="fu"&gt;:&lt;/span&gt; &lt;span class="kw"&gt;true&lt;/span&gt;&lt;span class="fu"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb13-11"&gt;&lt;a aria-hidden="true" href="#cb13-11" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="dt"&gt;"enable_ipv4"&lt;/span&gt;&lt;span class="fu"&gt;:&lt;/span&gt; &lt;span class="kw"&gt;true&lt;/span&gt;&lt;span class="fu"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb13-12"&gt;&lt;a aria-hidden="true" href="#cb13-12" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="dt"&gt;"enable_ipv6"&lt;/span&gt;&lt;span class="fu"&gt;:&lt;/span&gt; &lt;span class="kw"&gt;true&lt;/span&gt;&lt;span class="fu"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb13-13"&gt;&lt;a aria-hidden="true" href="#cb13-13" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="dt"&gt;"table"&lt;/span&gt;&lt;span class="fu"&gt;:&lt;/span&gt; &lt;span class="dv"&gt;10007&lt;/span&gt;&lt;span class="fu"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb13-14"&gt;&lt;a aria-hidden="true" href="#cb13-14" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="dt"&gt;"fwmark"&lt;/span&gt;&lt;span class="fu"&gt;:&lt;/span&gt; &lt;span class="dv"&gt;39283&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb13-15"&gt;&lt;a aria-hidden="true" href="#cb13-15" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="fu"&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;就已经够用。其中 &lt;code&gt;port&lt;/code&gt; 就是之前新增的 &lt;code&gt;dokodemo-door&lt;/code&gt; 监听端口，而 &lt;code&gt;program_noproxy&lt;/code&gt; 是不进行代理的程序名称。&lt;code&gt;v2ray&lt;/code&gt; 当然要排除在外，不然就是循环代理了。&lt;/p&gt;
&lt;p&gt;保存配置文件。&lt;/p&gt;
&lt;h2 id="启用"&gt;启用&lt;/h2&gt;
&lt;p&gt;确认都配置好了以后，&lt;code&gt;sudo systemctl restart cgproxy.service&lt;/code&gt; 启动服务，使用以下命令测试：&lt;/p&gt;
&lt;div class="sourceCode" id="cb14"&gt;&lt;pre class="sourceCode sh"&gt;&lt;code class="sourceCode bash"&gt;&lt;span id="cb14-1"&gt;&lt;a aria-hidden="true" href="#cb14-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="ex"&gt;cgproxy&lt;/span&gt; curl &lt;span class="at"&gt;-vI&lt;/span&gt; https://www.google.com&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;注意，先取消之前设置的代理。(清除环境变量，设置等)。如果没有任何问题，就可以稳定运行了。&lt;/p&gt;
&lt;h2 id="其他"&gt;其他&lt;/h2&gt;
&lt;p&gt;要查看 &lt;code&gt;v2ray&lt;/code&gt; 的日志：&lt;/p&gt;
&lt;div class="sourceCode" id="cb15"&gt;&lt;pre class="sourceCode sh"&gt;&lt;code class="sourceCode bash"&gt;&lt;span id="cb15-1"&gt;&lt;a aria-hidden="true" href="#cb15-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="fu"&gt;sudo&lt;/span&gt; journalctl &lt;span class="at"&gt;-u&lt;/span&gt; v2ray &lt;span class="at"&gt;--follow&lt;/span&gt; &lt;span class="at"&gt;--output&lt;/span&gt; cat&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;要停止 &lt;code&gt;cgproxy&lt;/code&gt;:&lt;/p&gt;
&lt;div class="sourceCode" id="cb16"&gt;&lt;pre class="sourceCode sh"&gt;&lt;code class="sourceCode bash"&gt;&lt;span id="cb16-1"&gt;&lt;a aria-hidden="true" href="#cb16-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="fu"&gt;sudo&lt;/span&gt; systemctl disable &lt;span class="at"&gt;--now&lt;/span&gt; cgproxy.service&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;strong&gt;注意&lt;/strong&gt;：&lt;strong&gt;必须&lt;/strong&gt;使用 &lt;code&gt;sudo systemctl disable --now cgproxy.service&lt;/code&gt; 来关闭服务，否则下一次启动可能会失效！&lt;/p&gt;
&lt;h2 id="参考"&gt;参考&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://github.com/v2fly/v2ray-core"&gt;v2fly/v2ray-core&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://github.com/springzfx/cgproxy"&gt;springzfx/cgproxy&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://docs.kernel.org/admin-guide/cgroup-v2.html"&gt;Control Group v2&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;br/&gt;
&lt;!--%%REF%%--&gt;
&lt;br/&gt;
&lt;script async="" crossorigin="anonymous" data-category="Announcements" data-category-id="DIC_kwDOJ7Ymy84CX4eg" data-emit-metadata="0" data-input-position="top" data-lang="zh-CN" data-loading="lazy" data-mapping="title" data-reactions-enabled="1" data-repo="izfsk-ium/izfsk-ium.github.io" data-repo-id="R_kgDOJ7Ymyw" data-strict="0" data-theme="preferred_color_scheme" src="https://giscus.app/client.js"&gt;
&lt;/script&gt;
&lt;/main&gt;
&lt;footer&gt;
&lt;p class="signoff"&gt;
&lt;div class="metadata"&gt;
&lt;p class="date"&gt;&lt;time datetime="2023-06-25"&gt;创建日期：2023-06-25&lt;/time&gt;&lt;/p&gt;
&lt;p class="lastmodify"&gt;&lt;time&gt;最后编译：2023-08-10&lt;/time&gt;&lt;/p&gt;
&lt;p class="lastmodify" id="counter-span"&gt;访问次数：&lt;/p&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;/footer&gt;
&lt;script&gt;
    /* These script should run after page load */
    document.querySelectorAll('code.sourceCode').forEach(
      i =&gt; i.insertAdjacentHTML('beforeend', '&lt;div class="copy"&gt;复制&lt;/div&gt;')
    );
    document.querySelectorAll('div.copy').forEach(
      i =&gt; i.addEventListener(
        'click',
        () =&gt; {
          navigator.clipboard.writeText(i.parentElement.innerText.replace('复制', ''));
          i.innerText = '成功';
          setTimeout(() =&gt; {
            i.innerText = '复制';
          }, 1000);
        }
      )
    );

    if (location.href.includes("127.0.0.1:8080")) {
      document.getElementById("counter-span").innerHTML = "[[development mode]]";
    } else {
      const uuid = document.getElementById("article-uuid").innerText;
      const target = document.getElementById("counter-span");
      const last = localStorage.getItem("lastVisit-" + uuid);
      const shouldIncrease = last === null || new Date().getTime() - parseInt(last) &gt;= (1000 * 60 * 15);

      fetch(shouldIncrease ? ("https://counter.izfsk.top/counter/" + uuid) : ("https://counter.izfsk.top/readOnly/" + uuid))
        .then(r =&gt; r.text())
        .then(d =&gt; {
          if (!d.startsWith("Too"))
            document.getElementById("counter-span").innerText = "访问次数：" + d.toString();
          else
            document.getElementById("counter-span").innerHTML = "";
        });

      localStorage.setItem("lastVisit-" + uuid, new Date().getTime());
    }
  &lt;/script&gt;
&lt;script async="" data-website-id="2a1146ab-fa82-4a84-a04f-30e5967357c3" src="https://analytics.umami.is/script.js"&gt;&lt;/script&gt;
&lt;/body&gt;</content:encoded>
      <guid isPermaLink="false">d335a295-647a-4f5e-b15b-140178c18782</guid>
      <pubDate>Sun, 25 Jun 2023 00:00:00 +0800</pubDate>
    </item>
    <item>
      <title>给 flutter 设置代理</title>
      <link>https://blog.izfsk.top/articles/给flutter设置代理.html</link>
      <description>给 flutter 设置代理</description>
      <content:encoded>&lt;body&gt;
&lt;progress id="content_progress" value="0"&gt;&lt;/progress&gt;
&lt;button id="back-to-top"&gt;
    回页顶
  &lt;/button&gt;
&lt;header&gt;
&lt;small id="article-uuid" style="display: none !important;"&gt;79ef49e0-db49-4547-bfbf-78b6a511e91d&lt;/small&gt;
&lt;h1 class="title"&gt;给 flutter 设置代理&lt;/h1&gt;
&lt;!-- Subtitle --&gt;
&lt;h3 class="subtitle"&gt; &lt;/h3&gt;
&lt;/header&gt;
&lt;nav id="TOC" role="doc-toc"&gt;
&lt;strong&gt;文章归类: &lt;a href="/pages/category.html#备忘录"&gt;备忘录&lt;/a&gt; &lt;/strong&gt;
&lt;input id="contents" type="checkbox"/&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#dart-镜像站点" id="toc-dart-镜像站点"&gt;Dart 镜像站点&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#编译时-gradle-代理" id="toc-编译时-gradle-代理"&gt;编译时 gradle 代理&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#参考" id="toc-参考"&gt;参考&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#reference"&gt;参考链接&lt;/a&gt;&lt;/li&gt;
&lt;li&gt; &lt;/li&gt;
&lt;li class="tools"&gt;
&lt;span id="backtomain"&gt;
&lt;svg class="bi bi-house" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M8.707 1.5a1 1 0 0 0-1.414 0L.646 8.146a.5.5 0 0 0 .708.708L2 8.207V13.5A1.5 1.5 0 0 0 3.5 15h9a1.5 1.5 0 0 0 1.5-1.5V8.207l.646.647a.5.5 0 0 0 .708-.708L13 5.793V2.5a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v1.293L8.707 1.5ZM13 7.207V13.5a.5.5 0 0 1-.5.5h-9a.5.5 0 0 1-.5-.5V7.207l5-5 5 5Z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="readingmode"&gt;
&lt;svg class="bi bi-book" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M1 2.828c.885-.37 2.154-.769 3.388-.893 1.33-.134 2.458.063 3.112.752v9.746c-.935-.53-2.12-.603-3.213-.493-1.18.12-2.37.461-3.287.811V2.828zm7.5-.141c.654-.689 1.782-.886 3.112-.752 1.234.124 2.503.523 3.388.893v9.923c-.918-.35-2.107-.692-3.287-.81-1.094-.111-2.278-.039-3.213.492V2.687zM8 1.783C7.015.936 5.587.81 4.287.94c-1.514.153-3.042.672-3.994 1.105A.5.5 0 0 0 0 2.5v11a.5.5 0 0 0 .707.455c.882-.4 2.303-.881 3.68-1.02 1.409-.142 2.59.087 3.223.877a.5.5 0 0 0 .78 0c.633-.79 1.814-1.019 3.222-.877 1.378.139 2.8.62 3.681 1.02A.5.5 0 0 0 16 13.5v-11a.5.5 0 0 0-.293-.455c-.952-.433-2.48-.952-3.994-1.105C10.413.809 8.985.936 8 1.783z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="larger"&gt; &lt;/span&gt;
&lt;span id="smaller"&gt;&lt;/span&gt;
&lt;span id="switchfont"&gt;
&lt;svg class="bi bi-fonts" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M12.258 3h-8.51l-.083 2.46h.479c.26-1.544.758-1.783 2.693-1.845l.424-.013v7.827c0 .663-.144.82-1.3.923v.52h4.082v-.52c-1.162-.103-1.306-.26-1.306-.923V3.602l.431.013c1.934.062 2.434.301 2.693 1.846h.479L12.258 3z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="backtotop"&gt;
&lt;svg class="bi bi-arrow-bar-up" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M8 10a.5.5 0 0 0 .5-.5V3.707l2.146 2.147a.5.5 0 0 0 .708-.708l-3-3a.5.5 0 0 0-.708 0l-3 3a.5.5 0 1 0 .708.708L7.5 3.707V9.5a.5.5 0 0 0 .5.5zm-7 2.5a.5.5 0 0 1 .5-.5h13a.5.5 0 0 1 0 1h-13a.5.5 0 0 1-.5-.5z" fill-rule="evenodd"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/nav&gt;
&lt;main&gt;
&lt;h2 id="dart-镜像站点"&gt;Dart 镜像站点&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;flutter&lt;/code&gt; 会读取两个环境变量作为镜像站点的地址：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;PUB_HOSTED_URL&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;FLUTTER_STORAGE_BASE_URL&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;在 &lt;code&gt;.bashrc&lt;/code&gt; 或者 &lt;code&gt;.zshrc&lt;/code&gt; 添加：&lt;/p&gt;
&lt;div class="sourceCode" id="cb1"&gt;&lt;pre class="sourceCode sh"&gt;&lt;code class="sourceCode bash"&gt;&lt;span id="cb1-1"&gt;&lt;a aria-hidden="true" href="#cb1-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="bu"&gt;export&lt;/span&gt; &lt;span class="va"&gt;FLUTTER_STORAGE_BASE_URL&lt;/span&gt;&lt;span class="op"&gt;=&lt;/span&gt;&lt;span class="st"&gt;"https://mirrors.tuna.tsinghua.edu.cn/flutter"&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-2"&gt;&lt;a aria-hidden="true" href="#cb1-2" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="bu"&gt;export&lt;/span&gt; &lt;span class="va"&gt;PUB_HOSTED_URL&lt;/span&gt;&lt;span class="op"&gt;=&lt;/span&gt;&lt;span class="st"&gt;"https://mirrors.tuna.tsinghua.edu.cn/dart-pub"&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id="编译时-gradle-代理"&gt;编译时 gradle 代理&lt;/h2&gt;
&lt;p&gt;当然也可以选择镜像仓库地址，但似乎很难配置正确，而 &lt;code&gt;flutter build apk&lt;/code&gt; 又不吃 &lt;code&gt;proxychans&lt;/code&gt; 和环境变量，但 &lt;code&gt;gradle&lt;/code&gt; 可以配置全局的代理设置：&lt;/p&gt;
&lt;p&gt;更改（或者创建）文件 &lt;code&gt;~/.gradle/gradle.properties&lt;/code&gt;，并添加：&lt;/p&gt;
&lt;div class="sourceCode" id="cb2"&gt;&lt;pre class="sourceCode sh"&gt;&lt;code class="sourceCode bash"&gt;&lt;span id="cb2-1"&gt;&lt;a aria-hidden="true" href="#cb2-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="ex"&gt;systemProp.http.proxyHost=127.0.0.1&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-2"&gt;&lt;a aria-hidden="true" href="#cb2-2" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="ex"&gt;systemProp.https.proxyPort=10809&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-3"&gt;&lt;a aria-hidden="true" href="#cb2-3" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="ex"&gt;systemProp.https.proxyHost=127.0.0.1&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-4"&gt;&lt;a aria-hidden="true" href="#cb2-4" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="ex"&gt;systemProp.http.proxyPort=10809&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;即可。&lt;/p&gt;
&lt;h2 id="参考"&gt;参考&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://stackoverflow.com/questions/55393142/flutter-build-is-still-using-an-obsolete-proxy-address"&gt;Flutter build is still using an obsolete proxy address&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://mirrors.tuna.tsinghua.edu.cn/help/flutter/"&gt;清华大学开源软件镜像站 | Flutter 镜像安装帮助&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;br/&gt;
&lt;!--%%REF%%--&gt;
&lt;br/&gt;
&lt;script async="" crossorigin="anonymous" data-category="Announcements" data-category-id="DIC_kwDOJ7Ymy84CX4eg" data-emit-metadata="0" data-input-position="top" data-lang="zh-CN" data-loading="lazy" data-mapping="title" data-reactions-enabled="1" data-repo="izfsk-ium/izfsk-ium.github.io" data-repo-id="R_kgDOJ7Ymyw" data-strict="0" data-theme="preferred_color_scheme" src="https://giscus.app/client.js"&gt;
&lt;/script&gt;
&lt;/main&gt;
&lt;footer&gt;
&lt;p class="signoff"&gt;
&lt;div class="metadata"&gt;
&lt;p class="date"&gt;&lt;time datetime="2023-06-28"&gt;创建日期：2023-06-28&lt;/time&gt;&lt;/p&gt;
&lt;p class="lastmodify"&gt;&lt;time&gt;最后编译：2023-08-10&lt;/time&gt;&lt;/p&gt;
&lt;p class="lastmodify" id="counter-span"&gt;访问次数：&lt;/p&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;/footer&gt;
&lt;script&gt;
    /* These script should run after page load */
    document.querySelectorAll('code.sourceCode').forEach(
      i =&gt; i.insertAdjacentHTML('beforeend', '&lt;div class="copy"&gt;复制&lt;/div&gt;')
    );
    document.querySelectorAll('div.copy').forEach(
      i =&gt; i.addEventListener(
        'click',
        () =&gt; {
          navigator.clipboard.writeText(i.parentElement.innerText.replace('复制', ''));
          i.innerText = '成功';
          setTimeout(() =&gt; {
            i.innerText = '复制';
          }, 1000);
        }
      )
    );

    if (location.href.includes("127.0.0.1:8080")) {
      document.getElementById("counter-span").innerHTML = "[[development mode]]";
    } else {
      const uuid = document.getElementById("article-uuid").innerText;
      const target = document.getElementById("counter-span");
      const last = localStorage.getItem("lastVisit-" + uuid);
      const shouldIncrease = last === null || new Date().getTime() - parseInt(last) &gt;= (1000 * 60 * 15);

      fetch(shouldIncrease ? ("https://counter.izfsk.top/counter/" + uuid) : ("https://counter.izfsk.top/readOnly/" + uuid))
        .then(r =&gt; r.text())
        .then(d =&gt; {
          if (!d.startsWith("Too"))
            document.getElementById("counter-span").innerText = "访问次数：" + d.toString();
          else
            document.getElementById("counter-span").innerHTML = "";
        });

      localStorage.setItem("lastVisit-" + uuid, new Date().getTime());
    }
  &lt;/script&gt;
&lt;script async="" data-website-id="2a1146ab-fa82-4a84-a04f-30e5967357c3" src="https://analytics.umami.is/script.js"&gt;&lt;/script&gt;
&lt;/body&gt;</content:encoded>
      <guid isPermaLink="false">79ef49e0-db49-4547-bfbf-78b6a511e91d</guid>
      <pubDate>Wed, 28 Jun 2023 00:00:00 +0800</pubDate>
    </item>
    <item>
      <title>使用 systemd 进行资源分配</title>
      <link>https://blog.izfsk.top/articles/Resource-managenent-using-systemd.html</link>
      <description>使用 systemd 进行资源分配</description>
      <content:encoded>&lt;body&gt;
&lt;progress id="content_progress" value="0"&gt;&lt;/progress&gt;
&lt;button id="back-to-top"&gt;
    回页顶
  &lt;/button&gt;
&lt;header&gt;
&lt;small id="article-uuid" style="display: none !important;"&gt;03566ccc-fb0d-4ff6-b67f-5e0a53204d4b&lt;/small&gt;
&lt;h1 class="title"&gt;使用 systemd 进行资源分配&lt;/h1&gt;
&lt;!-- Subtitle --&gt;
&lt;h3 class="subtitle"&gt; &lt;/h3&gt;
&lt;/header&gt;
&lt;nav id="TOC" role="doc-toc"&gt;
&lt;strong&gt;文章归类: &lt;a href="/pages/category.html#学习"&gt;学习&lt;/a&gt; &lt;/strong&gt;
&lt;input id="contents" type="checkbox"/&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#并不只是进程" id="toc-并不只是进程"&gt;并不只是“进程”&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#能控制些啥" id="toc-能控制些啥"&gt;能控制些啥&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#cpu" id="toc-cpu"&gt;CPU&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#内存" id="toc-内存"&gt;内存&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#网络" id="toc-网络"&gt;网络&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#怎么控制" id="toc-怎么控制"&gt;怎么控制&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#通过-systemd-run" id="toc-通过-systemd-run"&gt;通过 &lt;code&gt;systemd-run&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#通过-cgroupfs" id="toc-通过-cgroupfs"&gt;通过 &lt;code&gt;cgroupfs&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#通过-systemctl-set-property" id="toc-通过-systemctl-set-property"&gt;通过 &lt;code&gt;systemctl set-property&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#用户单元配置文件" id="toc-用户单元配置文件"&gt;用户单元配置文件&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#其他提示" id="toc-其他提示"&gt;其他提示&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#参考" id="toc-参考"&gt;参考&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#reference"&gt;参考链接&lt;/a&gt;&lt;/li&gt;
&lt;li&gt; &lt;/li&gt;
&lt;li class="tools"&gt;
&lt;span id="backtomain"&gt;
&lt;svg class="bi bi-house" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M8.707 1.5a1 1 0 0 0-1.414 0L.646 8.146a.5.5 0 0 0 .708.708L2 8.207V13.5A1.5 1.5 0 0 0 3.5 15h9a1.5 1.5 0 0 0 1.5-1.5V8.207l.646.647a.5.5 0 0 0 .708-.708L13 5.793V2.5a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v1.293L8.707 1.5ZM13 7.207V13.5a.5.5 0 0 1-.5.5h-9a.5.5 0 0 1-.5-.5V7.207l5-5 5 5Z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="readingmode"&gt;
&lt;svg class="bi bi-book" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M1 2.828c.885-.37 2.154-.769 3.388-.893 1.33-.134 2.458.063 3.112.752v9.746c-.935-.53-2.12-.603-3.213-.493-1.18.12-2.37.461-3.287.811V2.828zm7.5-.141c.654-.689 1.782-.886 3.112-.752 1.234.124 2.503.523 3.388.893v9.923c-.918-.35-2.107-.692-3.287-.81-1.094-.111-2.278-.039-3.213.492V2.687zM8 1.783C7.015.936 5.587.81 4.287.94c-1.514.153-3.042.672-3.994 1.105A.5.5 0 0 0 0 2.5v11a.5.5 0 0 0 .707.455c.882-.4 2.303-.881 3.68-1.02 1.409-.142 2.59.087 3.223.877a.5.5 0 0 0 .78 0c.633-.79 1.814-1.019 3.222-.877 1.378.139 2.8.62 3.681 1.02A.5.5 0 0 0 16 13.5v-11a.5.5 0 0 0-.293-.455c-.952-.433-2.48-.952-3.994-1.105C10.413.809 8.985.936 8 1.783z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="larger"&gt; &lt;/span&gt;
&lt;span id="smaller"&gt;&lt;/span&gt;
&lt;span id="switchfont"&gt;
&lt;svg class="bi bi-fonts" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M12.258 3h-8.51l-.083 2.46h.479c.26-1.544.758-1.783 2.693-1.845l.424-.013v7.827c0 .663-.144.82-1.3.923v.52h4.082v-.52c-1.162-.103-1.306-.26-1.306-.923V3.602l.431.013c1.934.062 2.434.301 2.693 1.846h.479L12.258 3z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="backtotop"&gt;
&lt;svg class="bi bi-arrow-bar-up" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M8 10a.5.5 0 0 0 .5-.5V3.707l2.146 2.147a.5.5 0 0 0 .708-.708l-3-3a.5.5 0 0 0-.708 0l-3 3a.5.5 0 1 0 .708.708L7.5 3.707V9.5a.5.5 0 0 0 .5.5zm-7 2.5a.5.5 0 0 1 .5-.5h13a.5.5 0 0 1 0 1h-13a.5.5 0 0 1-.5-.5z" fill-rule="evenodd"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/nav&gt;
&lt;main&gt;
&lt;p&gt;&lt;code&gt;systemd&lt;/code&gt; 是大多数 Linux 发行版的事实规范，不管大家喜不喜欢都要用它。这篇文章希望解决的问题是“精确的管理和控制进程/应用的各项资源”。&lt;/p&gt;
&lt;h2 id="并不只是进程"&gt;并不只是“进程”&lt;/h2&gt;
&lt;p&gt;对于 &lt;code&gt;systemd&lt;/code&gt; 来讲，这样的细分不够，还需要有某种把若干相关的进程组织起来的抽象。&lt;code&gt;systemd&lt;/code&gt; 里面主要有三种单元（&lt;code&gt;Unit&lt;/code&gt;）类型：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;.service&lt;/code&gt;：服务是 &lt;code&gt;systemd&lt;/code&gt; 依据磁盘上的配置文件自己启动的东西。一般使用 &lt;code&gt;systemctl start/stop&lt;/code&gt; 操纵的就是这类“服务”。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;.scope&lt;/code&gt;：不由配置文件启动的一组进程。只能以编程方式声明和启动。比如说使用 &lt;code&gt;fork&lt;/code&gt; 调用出来的子进程。比如说，在 &lt;code&gt;konsole&lt;/code&gt; 里面运行 &lt;code&gt;htop&lt;/code&gt;，那么这个进程就会出现在某个 &lt;code&gt;scope&lt;/code&gt; 里面。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;.slice&lt;/code&gt;：&lt;code&gt;slice&lt;/code&gt; 和 &lt;code&gt;cgroup&lt;/code&gt; 密切相关，每一个 &lt;code&gt;cgroup&lt;/code&gt; 都是一个 &lt;code&gt;slice&lt;/code&gt;，每个 &lt;code&gt;slice&lt;/code&gt; 都可以有自己的子 &lt;code&gt;slice&lt;/code&gt;。一个 &lt;code&gt;slice&lt;/code&gt; 里面包含若干进程和/或子 &lt;code&gt;slice&lt;/code&gt;。&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;code&gt;systemd&lt;/code&gt; 自己有预先定义若干 &lt;code&gt;slice&lt;/code&gt;，分别是 &lt;code&gt;system.slice&lt;/code&gt;，&lt;code&gt;user.slice&lt;/code&gt;，&lt;code&gt;machine.slice&lt;/code&gt;。所有的系统服务都放在 &lt;code&gt;system.slice&lt;/code&gt; 之中，每一个登录的用户会被分配到自己所属的 &lt;code&gt;user.slice&lt;/code&gt; 下的一个子 &lt;code&gt;slice&lt;/code&gt; 之中，&lt;code&gt;machine.slice&lt;/code&gt; 则是给虚拟化服务使用的。&lt;/p&gt;
&lt;p&gt;使用 &lt;code&gt;systemd-cgls&lt;/code&gt; 可以查看机器上的 &lt;code&gt;cgroup&lt;/code&gt; 树，举例来讲：&lt;/p&gt;
&lt;div class="sourceCode" id="cb1"&gt;&lt;pre class="sourceCode numberSource r r numberLines"&gt;&lt;code class="sourceCode r"&gt;&lt;span id="cb1-1"&gt;&lt;a href="#cb1-1"&gt;&lt;/a&gt;Control group &lt;span class="sc"&gt;/&lt;/span&gt;&lt;span class="er"&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-2"&gt;&lt;a href="#cb1-2"&gt;&lt;/a&gt;&lt;span class="sc"&gt;-&lt;/span&gt;.slice&lt;/span&gt;
&lt;span id="cb1-3"&gt;&lt;a href="#cb1-3"&gt;&lt;/a&gt;├─&lt;span class="fu"&gt;user.slice&lt;/span&gt; (&lt;span class="co"&gt;#888)&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-4"&gt;&lt;a href="#cb1-4"&gt;&lt;/a&gt;│ └─user&lt;span class="fl"&gt;-1000.&lt;/span&gt;&lt;span class="fu"&gt;slice&lt;/span&gt; (&lt;span class="co"&gt;#2819)&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-5"&gt;&lt;a href="#cb1-5"&gt;&lt;/a&gt;│   ├─user&lt;span class="sc"&gt;@&lt;/span&gt;&lt;span class="fl"&gt;1000.&lt;/span&gt;service … (&lt;span class="co"&gt;#2899)&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-6"&gt;&lt;a href="#cb1-6"&gt;&lt;/a&gt;│   │ → user.delegate&lt;span class="sc"&gt;:&lt;/span&gt; &lt;span class="dv"&gt;1&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-7"&gt;&lt;a href="#cb1-7"&gt;&lt;/a&gt;│   │ ├─&lt;span class="fu"&gt;session.slice&lt;/span&gt; (&lt;span class="co"&gt;#3129)&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-8"&gt;&lt;a href="#cb1-8"&gt;&lt;/a&gt;│   │ │ └─&lt;span class="fu"&gt;dbus.service&lt;/span&gt; (&lt;span class="co"&gt;#3169)&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-9"&gt;&lt;a href="#cb1-9"&gt;&lt;/a&gt;│   │ │   ├─&lt;span class="dv"&gt;1636&lt;/span&gt; &lt;span class="sc"&gt;/&lt;/span&gt;usr&lt;span class="sc"&gt;/&lt;/span&gt;bin&lt;span class="sc"&gt;/&lt;/span&gt;dbus&lt;span class="sc"&gt;-&lt;/span&gt;daemon &lt;span class="sc"&gt;--&lt;/span&gt;session &lt;span class="sc"&gt;--&lt;/span&gt;&lt;span class="at"&gt;address=&lt;/span&gt;systemd&lt;span class="sc"&gt;:&lt;/span&gt; &lt;span class="sc"&gt;--&lt;/span&gt;nofork &lt;span class="sc"&gt;--&lt;/span&gt;n…&lt;/span&gt;
&lt;span id="cb1-10"&gt;&lt;a href="#cb1-10"&gt;&lt;/a&gt;│   │ │   └─&lt;span class="dv"&gt;3169&lt;/span&gt; &lt;span class="sc"&gt;/&lt;/span&gt;usr&lt;span class="sc"&gt;/&lt;/span&gt;libexec&lt;span class="sc"&gt;/&lt;/span&gt;kf5&lt;span class="sc"&gt;/&lt;/span&gt;kiod5&lt;/span&gt;
&lt;span id="cb1-11"&gt;&lt;a href="#cb1-11"&gt;&lt;/a&gt;│   │ ├─&lt;span class="fu"&gt;background.slice&lt;/span&gt; (&lt;span class="co"&gt;#3204)&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-12"&gt;&lt;a href="#cb1-12"&gt;&lt;/a&gt;│   │ │ └─kde&lt;span class="sc"&gt;-&lt;/span&gt;&lt;span class="fu"&gt;baloo.service&lt;/span&gt; (&lt;span class="co"&gt;#3314)&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-13"&gt;&lt;a href="#cb1-13"&gt;&lt;/a&gt;│   │ │   └─&lt;span class="dv"&gt;1720&lt;/span&gt; &lt;span class="sc"&gt;/&lt;/span&gt;usr&lt;span class="sc"&gt;/&lt;/span&gt;libexec&lt;span class="sc"&gt;/&lt;/span&gt;baloo_file&lt;/span&gt;
&lt;span id="cb1-14"&gt;&lt;a href="#cb1-14"&gt;&lt;/a&gt;│   │ ├─&lt;span class="fu"&gt;app.slice&lt;/span&gt; (&lt;span class="co"&gt;#2979)&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-15"&gt;&lt;a href="#cb1-15"&gt;&lt;/a&gt;│   │ │ ├─app&lt;span class="sc"&gt;-&lt;/span&gt;firefox&lt;span class="sc"&gt;-&lt;/span&gt;&lt;span class="fu"&gt;b09f12b43b3d4b4dbf4098d695489166.scope&lt;/span&gt; (&lt;span class="co"&gt;#5075)&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-16"&gt;&lt;a href="#cb1-16"&gt;&lt;/a&gt;│   │ │ │ ├─ &lt;span class="dv"&gt;2340&lt;/span&gt; &lt;span class="sc"&gt;/&lt;/span&gt;usr&lt;span class="sc"&gt;/&lt;/span&gt;lib64&lt;span class="sc"&gt;/&lt;/span&gt;firefox&lt;span class="sc"&gt;/&lt;/span&gt;firefox &lt;span class="sc"&gt;-&lt;/span&gt;contentproc &lt;span class="sc"&gt;-&lt;/span&gt;childID &lt;span class="dv"&gt;264&lt;/span&gt; &lt;span class="sc"&gt;-&lt;/span&gt;isForBr…&lt;/span&gt;
&lt;span id="cb1-17"&gt;&lt;a href="#cb1-17"&gt;&lt;/a&gt;│   │ │ │ ├─ &lt;span class="dv"&gt;4026&lt;/span&gt; &lt;span class="sc"&gt;/&lt;/span&gt;usr&lt;span class="sc"&gt;/&lt;/span&gt;lib64&lt;span class="sc"&gt;/&lt;/span&gt;firefox&lt;span class="sc"&gt;/&lt;/span&gt;firefox&lt;/span&gt;
&lt;span id="cb1-18"&gt;&lt;a href="#cb1-18"&gt;&lt;/a&gt;│   │ │ │ ├─ &lt;span class="dv"&gt;4112&lt;/span&gt; &lt;span class="sc"&gt;/&lt;/span&gt;usr&lt;span class="sc"&gt;/&lt;/span&gt;lib64&lt;span class="sc"&gt;/&lt;/span&gt;firefox&lt;span class="sc"&gt;/&lt;/span&gt;firefox &lt;span class="sc"&gt;-&lt;/span&gt;contentproc &lt;span class="sc"&gt;-&lt;/span&gt;parentBuildID 202306…&lt;/span&gt;
&lt;span id="cb1-19"&gt;&lt;a href="#cb1-19"&gt;&lt;/a&gt;│   │ │ │ ├─ &lt;span class="dv"&gt;4143&lt;/span&gt; &lt;span class="sc"&gt;/&lt;/span&gt;usr&lt;span class="sc"&gt;/&lt;/span&gt;lib64&lt;span class="sc"&gt;/&lt;/span&gt;firefox&lt;span class="sc"&gt;/&lt;/span&gt;firefox &lt;span class="sc"&gt;-&lt;/span&gt;contentproc &lt;span class="sc"&gt;-&lt;/span&gt;childID &lt;span class="dv"&gt;1&lt;/span&gt; &lt;span class="sc"&gt;-&lt;/span&gt;isForBrow…&lt;/span&gt;
&lt;span id="cb1-20"&gt;&lt;a href="#cb1-20"&gt;&lt;/a&gt;│   │ │ │ ├─ &lt;span class="dv"&gt;4175&lt;/span&gt; &lt;span class="sc"&gt;/&lt;/span&gt;usr&lt;span class="sc"&gt;/&lt;/span&gt;lib64&lt;span class="sc"&gt;/&lt;/span&gt;firefox&lt;span class="sc"&gt;/&lt;/span&gt;firefox &lt;span class="sc"&gt;-&lt;/span&gt;contentproc &lt;span class="sc"&gt;-&lt;/span&gt;childID &lt;span class="dv"&gt;2&lt;/span&gt; &lt;span class="sc"&gt;-&lt;/span&gt;isForBrow…&lt;/span&gt;
&lt;span id="cb1-21"&gt;&lt;a href="#cb1-21"&gt;&lt;/a&gt;│   │ │ │ ├─ &lt;span class="dv"&gt;4264&lt;/span&gt; &lt;span class="sc"&gt;/&lt;/span&gt;usr&lt;span class="sc"&gt;/&lt;/span&gt;bin&lt;span class="sc"&gt;/&lt;/span&gt;plasma&lt;span class="sc"&gt;-&lt;/span&gt;browser&lt;span class="sc"&gt;-&lt;/span&gt;integration&lt;span class="sc"&gt;-&lt;/span&gt;host &lt;span class="sc"&gt;/&lt;/span&gt;usr&lt;span class="sc"&gt;/&lt;/span&gt;lib64&lt;span class="sc"&gt;/&lt;/span&gt;mozilla&lt;span class="sc"&gt;/&lt;/span&gt;n…&lt;/span&gt;
&lt;span id="cb1-22"&gt;&lt;a href="#cb1-22"&gt;&lt;/a&gt;│   │ │ │ ├─&lt;span class="dv"&gt;19214&lt;/span&gt; &lt;span class="sc"&gt;/&lt;/span&gt;usr&lt;span class="sc"&gt;/&lt;/span&gt;lib64&lt;span class="sc"&gt;/&lt;/span&gt;firefox&lt;span class="sc"&gt;/&lt;/span&gt;firefox &lt;span class="sc"&gt;-&lt;/span&gt;contentproc &lt;span class="sc"&gt;-&lt;/span&gt;childID &lt;span class="dv"&gt;330&lt;/span&gt; &lt;span class="sc"&gt;-&lt;/span&gt;isForBr…&lt;/span&gt;
&lt;span id="cb1-23"&gt;&lt;a href="#cb1-23"&gt;&lt;/a&gt;│   │ │ │ └─&lt;span class="dv"&gt;30710&lt;/span&gt; &lt;span class="sc"&gt;/&lt;/span&gt;usr&lt;span class="sc"&gt;/&lt;/span&gt;libexec&lt;span class="sc"&gt;/&lt;/span&gt;kf5&lt;span class="sc"&gt;/&lt;/span&gt;kio_http_cache_cleaner&lt;/span&gt;
&lt;span id="cb1-24"&gt;&lt;a href="#cb1-24"&gt;&lt;/a&gt;│   │ └─&lt;span class="fu"&gt;init.scope&lt;/span&gt; (&lt;span class="co"&gt;#2939)&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-25"&gt;&lt;a href="#cb1-25"&gt;&lt;/a&gt;│   │   ├─&lt;span class="dv"&gt;1608&lt;/span&gt; &lt;span class="sc"&gt;/&lt;/span&gt;usr&lt;span class="sc"&gt;/&lt;/span&gt;lib&lt;span class="sc"&gt;/&lt;/span&gt;systemd&lt;span class="sc"&gt;/&lt;/span&gt;systemd &lt;span class="sc"&gt;--&lt;/span&gt;user&lt;/span&gt;
&lt;span id="cb1-26"&gt;&lt;a href="#cb1-26"&gt;&lt;/a&gt;│   │   └─&lt;span class="dv"&gt;1609&lt;/span&gt; (sd&lt;span class="sc"&gt;-&lt;/span&gt;pam)&lt;/span&gt;
&lt;span id="cb1-27"&gt;&lt;a href="#cb1-27"&gt;&lt;/a&gt;│   └─session&lt;span class="fl"&gt;-3.&lt;/span&gt;&lt;span class="fu"&gt;scope&lt;/span&gt; (&lt;span class="co"&gt;#3089)&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-28"&gt;&lt;a href="#cb1-28"&gt;&lt;/a&gt;│     → user.invocation_id&lt;span class="sc"&gt;:&lt;/span&gt; 73cac7153fd44d02b76ea50f1a559f7c&lt;/span&gt;
&lt;span id="cb1-29"&gt;&lt;a href="#cb1-29"&gt;&lt;/a&gt;│     └─&lt;span class="dv"&gt;9421&lt;/span&gt; scdaemon &lt;span class="sc"&gt;--&lt;/span&gt;multi&lt;span class="sc"&gt;-&lt;/span&gt;server&lt;/span&gt;
&lt;span id="cb1-30"&gt;&lt;a href="#cb1-30"&gt;&lt;/a&gt;├─&lt;span class="fu"&gt;init.scope&lt;/span&gt; (&lt;span class="co"&gt;#19)&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-31"&gt;&lt;a href="#cb1-31"&gt;&lt;/a&gt;│ └─&lt;span class="dv"&gt;1&lt;/span&gt; &lt;span class="sc"&gt;/&lt;/span&gt;usr&lt;span class="sc"&gt;/&lt;/span&gt;lib&lt;span class="sc"&gt;/&lt;/span&gt;systemd&lt;span class="sc"&gt;/&lt;/span&gt;systemd &lt;span class="sc"&gt;--&lt;/span&gt;switched&lt;span class="sc"&gt;-&lt;/span&gt;root &lt;span class="sc"&gt;--&lt;/span&gt;system &lt;span class="sc"&gt;--&lt;/span&gt;&lt;span class="at"&gt;deserialize=&lt;/span&gt;&lt;span class="dv"&gt;39&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-32"&gt;&lt;a href="#cb1-32"&gt;&lt;/a&gt;└─&lt;span class="fu"&gt;system.slice&lt;/span&gt; (&lt;span class="co"&gt;#54)&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-33"&gt;&lt;a href="#cb1-33"&gt;&lt;/a&gt;  ├─&lt;span class="fu"&gt;cron.service&lt;/span&gt; (&lt;span class="co"&gt;#2210)&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-34"&gt;&lt;a href="#cb1-34"&gt;&lt;/a&gt;  │ → user.invocation_id&lt;span class="sc"&gt;:&lt;/span&gt; d3c7344407014f80b4201d10bb4be93a&lt;/span&gt;
&lt;span id="cb1-35"&gt;&lt;a href="#cb1-35"&gt;&lt;/a&gt;  │ └─&lt;span class="dv"&gt;1563&lt;/span&gt; &lt;span class="sc"&gt;/&lt;/span&gt;usr&lt;span class="sc"&gt;/&lt;/span&gt;sbin&lt;span class="sc"&gt;/&lt;/span&gt;cron &lt;span class="sc"&gt;-&lt;/span&gt;n&lt;/span&gt;
&lt;span id="cb1-36"&gt;&lt;a href="#cb1-36"&gt;&lt;/a&gt;  ├─display&lt;span class="sc"&gt;-&lt;/span&gt;&lt;span class="fu"&gt;manager.service&lt;/span&gt; (&lt;span class="co"&gt;#2142)&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-37"&gt;&lt;a href="#cb1-37"&gt;&lt;/a&gt;  │ → user.invocation_id&lt;span class="sc"&gt;:&lt;/span&gt; 35ed91d9971249c4a6c654e1cdf383f4&lt;/span&gt;
&lt;span id="cb1-38"&gt;&lt;a href="#cb1-38"&gt;&lt;/a&gt;  │ ├─&lt;span class="dv"&gt;1410&lt;/span&gt; &lt;span class="sc"&gt;/&lt;/span&gt;usr&lt;span class="sc"&gt;/&lt;/span&gt;bin&lt;span class="sc"&gt;/&lt;/span&gt;sddm&lt;/span&gt;
&lt;span id="cb1-39"&gt;&lt;a href="#cb1-39"&gt;&lt;/a&gt;  │ └─&lt;span class="dv"&gt;1412&lt;/span&gt; &lt;span class="sc"&gt;/&lt;/span&gt;usr&lt;span class="sc"&gt;/&lt;/span&gt;bin&lt;span class="sc"&gt;/&lt;/span&gt;Xorg.bin &lt;span class="sc"&gt;-&lt;/span&gt;nolisten tcp &lt;span class="sc"&gt;-&lt;/span&gt;auth &lt;span class="sc"&gt;/&lt;/span&gt;run&lt;span class="sc"&gt;/&lt;/span&gt;sddm&lt;span class="sc"&gt;/&lt;/span&gt;{&lt;span class="fl"&gt;05446e81&lt;/span&gt;&lt;span class="dv"&gt;-5704&lt;/span&gt;&lt;span class="sc"&gt;-&lt;/span&gt;45ac&lt;span class="sc"&gt;-&lt;/span&gt;…&lt;/span&gt;
&lt;span id="cb1-40"&gt;&lt;a href="#cb1-40"&gt;&lt;/a&gt;  └─systemd&lt;span class="sc"&gt;-&lt;/span&gt;&lt;span class="fu"&gt;logind.service&lt;/span&gt; (&lt;span class="co"&gt;#1989)&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-41"&gt;&lt;a href="#cb1-41"&gt;&lt;/a&gt;    → user.invocation_id&lt;span class="sc"&gt;:&lt;/span&gt; 3dc53b6e8c274294b617383903571d5f&lt;/span&gt;
&lt;span id="cb1-42"&gt;&lt;a href="#cb1-42"&gt;&lt;/a&gt;    └─&lt;span class="dv"&gt;1294&lt;/span&gt; &lt;span class="sc"&gt;/&lt;/span&gt;usr&lt;span class="sc"&gt;/&lt;/span&gt;lib&lt;span class="sc"&gt;/&lt;/span&gt;systemd&lt;span class="sc"&gt;/&lt;/span&gt;systemd&lt;span class="sc"&gt;-&lt;/span&gt;logind&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;（以上的内容有删减。）&lt;/p&gt;
&lt;p&gt;你可以看到，对于系统服务，例如 &lt;code&gt;cron&lt;/code&gt;，是运行在 &lt;code&gt;system.slice&lt;/code&gt; 里面的，而对于用户进程，比如火狐浏览器(app-firefox-b09f12b43b3d4b4dbf4098d695489166.scope)，则是被放置在 &lt;code&gt;user/user-1000/app.slice&lt;/code&gt; 中。其中包含所有火狐的内容进程和其他进程。其他的进程类似。实际上很多应用并不是包含一个进程，像火狐，或者 Chrome 之类的应用都可以在 &lt;code&gt;app.slice&lt;/code&gt; 里面找到对应的 &lt;code&gt;scope&lt;/code&gt;。&lt;/p&gt;
&lt;p&gt;其实 &lt;code&gt;systemd&lt;/code&gt; 有一个桌面环境规范，定义了常在桌面环境中见到的 &lt;code&gt;slice&lt;/code&gt;，来应用程序分配不同的优先级。所有单元都应根据其用途被放入：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;session.slice&lt;/code&gt;： 只包含运行用户图形会话所需的进程。&lt;/li&gt;
&lt;li&gt;&lt;code&gt;app.slice&lt;/code&gt;： 包含用户正在运行的所有普通应用程序&lt;/li&gt;
&lt;li&gt;&lt;code&gt;background.slice&lt;/code&gt;： 适用于低优先级的后台任务&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;所以，像 KDE 的文件索引程序 &lt;code&gt;baloo&lt;/code&gt; 就会被放在 &lt;code&gt;background.slice&lt;/code&gt; 里面。&lt;/p&gt;
&lt;h2 id="能控制些啥"&gt;能控制些啥&lt;/h2&gt;
&lt;h3 id="cpu"&gt;CPU&lt;/h3&gt;
&lt;p&gt;对于 CPU 的控制，主要使用 &lt;code&gt;CPUQuota&lt;/code&gt;，&lt;code&gt;CPUWeight&lt;/code&gt;。&lt;/p&gt;
&lt;p&gt;&lt;code&gt;CPUQuota&lt;/code&gt; 控制的是单元在最大时应获得多少 CPU 时间，也就是严格的 CPU 资源的使用上限，接收一个百分比值，例如 &lt;code&gt;CPUQuota=85%&lt;/code&gt;，对于多核 CPU，这个百分比可以超过 100%，有多少个核心就可以达到多少，比如对于 16 核心的 CPU，最大可以是 &lt;code&gt;CPUQuota=1600%&lt;/code&gt; 。&lt;/p&gt;
&lt;p&gt;&lt;code&gt;CPUWeight&lt;/code&gt; 替换了原来的 &lt;code&gt;CPUShare&lt;/code&gt;，用来设置相对使用时间（相对权重），其值是一个整数，允许的范围是 1 到 10000 。&lt;/p&gt;
&lt;p&gt;实例：&lt;/p&gt;
&lt;div class="sourceCode" id="cb2"&gt;&lt;pre class="sourceCode sh"&gt;&lt;code class="sourceCode bash"&gt;&lt;span id="cb2-1"&gt;&lt;a aria-hidden="true" href="#cb2-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="co"&gt;# 增加 CPU 负载&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-2"&gt;&lt;a aria-hidden="true" href="#cb2-2" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="ex"&gt;stress-ng&lt;/span&gt; &lt;span class="at"&gt;-c&lt;/span&gt; 16&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;动态改变 &lt;code&gt;user.slice&lt;/code&gt;：&lt;/p&gt;
&lt;figure&gt;
&lt;img alt="给出不同的 CPUQuota" src="./assets/Screenshot_002_20230630.png"/&gt;
&lt;figcaption aria-hidden="true"&gt;给出不同的 CPUQuota&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;figure&gt;
&lt;img alt="得到不同的结果" src="./assets/Screenshot_001_20230630.png"/&gt;
&lt;figcaption aria-hidden="true"&gt;得到不同的结果&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;h3 id="内存"&gt;内存&lt;/h3&gt;
&lt;p&gt;对于内存的使用控制，主要采用 &lt;code&gt;MemoryHigh&lt;/code&gt; 和 &lt;code&gt;MemoryMax&lt;/code&gt;。&lt;/p&gt;
&lt;p&gt;两者都接收整数值作为大小（bytes），也可以输入（K，G，M，T）的单位和百分比，用于表示最多占用机器多少比例内存。其中，&lt;code&gt;MemoryHigh&lt;/code&gt; 是主要的控制机制，是对目标最大可用内存的“软限制”，目标&lt;strong&gt;可能&lt;/strong&gt;短暂的超过内存限制但其超出部分会被旋即回收。而 &lt;code&gt;MemoryMax&lt;/code&gt; 是绝对硬限制，进程超出就会出发 &lt;code&gt;OOM&lt;/code&gt; 被当即处决。实践中结合两者使用，软硬兼施。&lt;/p&gt;
&lt;p&gt;实例：&lt;/p&gt;
&lt;div class="sourceCode" id="cb3"&gt;&lt;pre class="sourceCode sh"&gt;&lt;code class="sourceCode bash"&gt;&lt;span id="cb3-1"&gt;&lt;a aria-hidden="true" href="#cb3-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="co"&gt;# 生成进程&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb3-2"&gt;&lt;a aria-hidden="true" href="#cb3-2" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="ex"&gt;systemd-run&lt;/span&gt; &lt;span class="at"&gt;--slice&lt;/span&gt;&lt;span class="op"&gt;=&lt;/span&gt;stress.slice  &lt;span class="at"&gt;--user&lt;/span&gt; stress-ng &lt;span class="at"&gt;--vm&lt;/span&gt; 8 &lt;span class="at"&gt;--vm-bytes&lt;/span&gt; 256M&lt;/span&gt;
&lt;span id="cb3-3"&gt;&lt;a aria-hidden="true" href="#cb3-3" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="co"&gt;# Running as unit: run-u8748.service&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb3-4"&gt;&lt;a aria-hidden="true" href="#cb3-4" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb3-5"&gt;&lt;a aria-hidden="true" href="#cb3-5" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="co"&gt;# 更改内存控制&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb3-6"&gt;&lt;a aria-hidden="true" href="#cb3-6" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="ex"&gt;systemctl&lt;/span&gt; &lt;span class="at"&gt;--user&lt;/span&gt; set-property &lt;span class="st"&gt;'stress.slice'&lt;/span&gt;  MemoryMax=10000&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;结果是 &lt;code&gt;stress-ng&lt;/code&gt; 被 OOM 杀死：&lt;/p&gt;
&lt;figure&gt;
&lt;img alt="OOM" src="./assets/oom.png"/&gt;
&lt;figcaption aria-hidden="true"&gt;OOM&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;对于启用的 SWAP 的系统，还有一个 &lt;code&gt;MemorySwapMax&lt;/code&gt; 可以进行控制。这是一个绝对限制。&lt;/p&gt;
&lt;h3 id="网络"&gt;网络&lt;/h3&gt;
&lt;p&gt;使用 &lt;code&gt;IPAddressAllow&lt;/code&gt; 和 &lt;code&gt;IPAddressDeny&lt;/code&gt; 来控制目标的联网。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;当被检查的IP地址与 IPAddressAllow 列表中的条目相匹配时，访问被授予。IPAddressAllow 列表中的条目时，允许访问。&lt;/li&gt;
&lt;li&gt;否则，当检查的IP地址与 IPAddressDeny 列表中的条目相匹配时，将拒绝访问。IPAddressDeny 列表中的条目时，访问被拒绝。&lt;/li&gt;
&lt;li&gt;否则，允许访问。&lt;/li&gt;
&lt;/ul&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class="header"&gt;
&lt;th&gt;名称&lt;/th&gt;
&lt;th&gt;定义&lt;/th&gt;
&lt;th&gt;含义&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class="odd"&gt;
&lt;td&gt;any&lt;/td&gt;
&lt;td&gt;&lt;code&gt;0.0.0.0/0 ::/0&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;所有网络地址&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="even"&gt;
&lt;td&gt;localhost&lt;/td&gt;
&lt;td&gt;&lt;code&gt;0.0.0.0/0 ::/0&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;本地回环&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;例如，要禁止联网：&lt;code&gt;systemctl set-property user.slice IPAddressDeny=any&lt;/code&gt;。&lt;/p&gt;
&lt;p&gt;除了上面提到的，cgroup 还可以控制 IO，块设备访问等等，参见：&lt;a href="https://manpages.ubuntu.com/manpages/impish/man5/systemd.resource-control.5.html"&gt;systemd.resource-control&lt;/a&gt;&lt;/p&gt;
&lt;h2 id="怎么控制"&gt;怎么控制&lt;/h2&gt;
&lt;figure&gt;
&lt;img alt="如何查看" src="./assets/code.webp"/&gt;
&lt;figcaption aria-hidden="true"&gt;如何查看&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;h3 id="通过-systemd-run"&gt;通过 &lt;code&gt;systemd-run&lt;/code&gt;&lt;/h3&gt;
&lt;p&gt;创建一个临时控制组群：&lt;/p&gt;
&lt;p&gt;&lt;code&gt;systemd-run --unit=&amp;lt;name&amp;gt; --slice=&amp;lt;name&amp;gt;.slice &amp;lt;command&amp;gt;&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;其中： &lt;code&gt;--unit=&amp;lt;name&amp;gt;&lt;/code&gt; 选项为单元取一个名称。如果未指定 &lt;code&gt;--unit&lt;/code&gt;，则会自动生成名称。&lt;code&gt;--slice=&amp;lt;name&amp;gt;.slice&lt;/code&gt; 选项使单元成为指定片段的成员。默认情况下，服务和范围作为 systemslice 的成员创建。&lt;/p&gt;
&lt;p&gt;成功后将会提示： &lt;code&gt;Running as unit &amp;lt;name&amp;gt;.service&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;适用情况：想要一次性运行一个临时的任务，直接给出限制。例如：&lt;/p&gt;
&lt;div class="sourceCode" id="cb4"&gt;&lt;pre class="sourceCode sh"&gt;&lt;code class="sourceCode bash"&gt;&lt;span id="cb4-1"&gt;&lt;a aria-hidden="true" href="#cb4-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="co"&gt;# 在 Linux 上玩 Minecraft，限制 Java 最多可以获取的内存大小 8192MB&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb4-2"&gt;&lt;a aria-hidden="true" href="#cb4-2" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="ex"&gt;systemd-run&lt;/span&gt; &lt;span class="at"&gt;--scope&lt;/span&gt; &lt;span class="at"&gt;--user&lt;/span&gt; &lt;span class="at"&gt;-p&lt;/span&gt; MemoryMax=8192M &lt;span class="at"&gt;-p&lt;/span&gt; MemoryHigh=8192M java &lt;span class="at"&gt;-jar&lt;/span&gt; minecraft.jar&lt;/span&gt;
&lt;span id="cb4-3"&gt;&lt;a aria-hidden="true" href="#cb4-3" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb4-4"&gt;&lt;a aria-hidden="true" href="#cb4-4" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="co"&gt;# 不紧不慢的更新数据库&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb4-5"&gt;&lt;a aria-hidden="true" href="#cb4-5" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="ex"&gt;systemd-run&lt;/span&gt; &lt;span class="at"&gt;-p&lt;/span&gt; IOWeight=10 updatedb&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;适用情况：运行一个临时的任务，但想要把它放在某个特定的组里便于统一管理：&lt;/p&gt;
&lt;div class="sourceCode" id="cb5"&gt;&lt;pre class="sourceCode sh"&gt;&lt;code class="sourceCode bash"&gt;&lt;span id="cb5-1"&gt;&lt;a aria-hidden="true" href="#cb5-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="co"&gt;# 将一个任务放在已有的 slice 里面&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb5-2"&gt;&lt;a aria-hidden="true" href="#cb5-2" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="ex"&gt;systemd-run&lt;/span&gt; &lt;span class="at"&gt;--user&lt;/span&gt; &lt;span class="at"&gt;--slice&lt;/span&gt;&lt;span class="op"&gt;=&lt;/span&gt;app.slice &lt;span class="at"&gt;--scope&lt;/span&gt; htop &lt;/span&gt;
&lt;span id="cb5-3"&gt;&lt;a aria-hidden="true" href="#cb5-3" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb5-4"&gt;&lt;a aria-hidden="true" href="#cb5-4" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="co"&gt;# 将任务放进一个新的 slice 里面（默认位于 user-uid.slice 之下）&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb5-5"&gt;&lt;a aria-hidden="true" href="#cb5-5" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="ex"&gt;systemd-run&lt;/span&gt; &lt;span class="at"&gt;--user&lt;/span&gt; &lt;span class="at"&gt;--slice&lt;/span&gt;&lt;span class="op"&gt;=&lt;/span&gt;noNetwork.slice &lt;span class="at"&gt;--scope&lt;/span&gt; some-application&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id="通过-cgroupfs"&gt;通过 &lt;code&gt;cgroupfs&lt;/code&gt;&lt;/h3&gt;
&lt;p&gt;位于 &lt;code&gt;/sys/fs/cgroup/&lt;/code&gt; 的伪文件系统可用于手动查看和配置 cgroup。要查看某个进程所属的 cgroup，请运行 &lt;code&gt;cat proc/&amp;lt;PID&amp;gt;/cgroup&lt;/code&gt; 命令。&lt;/p&gt;
&lt;p&gt;适用情况：想要手动调整某个 slice：&lt;/p&gt;
&lt;div class="sourceCode" id="cb6"&gt;&lt;pre class="sourceCode sh"&gt;&lt;code class="sourceCode bash"&gt;&lt;span id="cb6-1"&gt;&lt;a aria-hidden="true" href="#cb6-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="co"&gt;# 比如要调节火狐，首先过滤出它到底是在哪一个 slice 里面：&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb6-2"&gt;&lt;a aria-hidden="true" href="#cb6-2" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="fu"&gt;ps&lt;/span&gt; &lt;span class="at"&gt;-aux&lt;/span&gt; &lt;span class="kw"&gt;|&lt;/span&gt; &lt;span class="fu"&gt;grep&lt;/span&gt; firefox &lt;/span&gt;
&lt;span id="cb6-3"&gt;&lt;a aria-hidden="true" href="#cb6-3" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="ex"&gt;systemctl&lt;/span&gt; status pid&lt;/span&gt;
&lt;span id="cb6-4"&gt;&lt;a aria-hidden="true" href="#cb6-4" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="co"&gt;# CGroup: /user.slice/user-1000.slice/user@1000.service&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb6-5"&gt;&lt;a aria-hidden="true" href="#cb6-5" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="co"&gt;# 接下来到指定的目录：&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb6-6"&gt;&lt;a aria-hidden="true" href="#cb6-6" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="bu"&gt;cd&lt;/span&gt; /sys/fs/cgroup/user.slice/user-1000.slice/user@1000.service/app.slice/app-firefox-b09f12b43b3d4b4dbf4098d695489166.scope&lt;/span&gt;
&lt;span id="cb6-7"&gt;&lt;a aria-hidden="true" href="#cb6-7" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="co"&gt;# 查看这个组里面包含的进程 PID&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb6-8"&gt;&lt;a aria-hidden="true" href="#cb6-8" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="fu"&gt;cat&lt;/span&gt; cgroup.procs&lt;/span&gt;
&lt;span id="cb6-9"&gt;&lt;a aria-hidden="true" href="#cb6-9" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="co"&gt;# 接下来就可以进行调节了&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id="通过-systemctl-set-property"&gt;通过 &lt;code&gt;systemctl set-property&lt;/code&gt;&lt;/h3&gt;
&lt;p&gt;这是最方便的方法。&lt;/p&gt;
&lt;p&gt;还是以调节火狐为例，首先从 &lt;code&gt;systemd-cgls&lt;/code&gt; 里面找出其组名称：&lt;/p&gt;
&lt;div class="sourceCode" id="cb7"&gt;&lt;pre class="sourceCode sh"&gt;&lt;code class="sourceCode bash"&gt;&lt;span id="cb7-1"&gt;&lt;a aria-hidden="true" href="#cb7-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="ex"&gt;systemctl&lt;/span&gt; &lt;span class="at"&gt;--user&lt;/span&gt; set-property &lt;span class="st"&gt;'app-firefox-b09f12b43b3d4b4dbf4098d695489166.scope'&lt;/span&gt; CPUQuota=100%  &lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;对于使用 &lt;code&gt;systemd-run&lt;/code&gt; 创建的任务单元（返回 &lt;code&gt;Running as unit &amp;lt;name&amp;gt;.service&lt;/code&gt; 的），以及&lt;code&gt;systemd-cgls&lt;/code&gt; 列出的大部分内容，无论是 slice，service 还是 scope 都可以这样管理，很方便。&lt;strong&gt;注意：必须添加 &lt;code&gt;--user&lt;/code&gt; 选项，否则找不到对应的单元!&lt;/strong&gt;&lt;/p&gt;
&lt;h3 id="用户单元配置文件"&gt;用户单元配置文件&lt;/h3&gt;
&lt;p&gt;对于想要持久化的配置，可以使用 systemd 单元配置文件。其路径一般位于 &lt;code&gt;~/.config/systemd/user&lt;/code&gt;，示例如下：&lt;/p&gt;
&lt;p&gt;新建文件 &lt;code&gt;limitMemory.slice&lt;/code&gt;&lt;/p&gt;
&lt;div class="sourceCode" id="cb8"&gt;&lt;pre class="sourceCode ini"&gt;&lt;code class="sourceCode ini"&gt;&lt;span id="cb8-1"&gt;&lt;a aria-hidden="true" href="#cb8-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;[Slice]&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb8-2"&gt;&lt;a aria-hidden="true" href="#cb8-2" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="dt"&gt;MemoryHigh&lt;/span&gt;&lt;span class="ot"&gt;=&lt;/span&gt;&lt;span class="st"&gt;8192M&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb8-3"&gt;&lt;a aria-hidden="true" href="#cb8-3" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="dt"&gt;MemoryMax&lt;/span&gt;&lt;span class="ot"&gt;=&lt;/span&gt;&lt;span class="st"&gt;8092M&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;然后运行 &lt;code&gt;systemctl --user daemon-reload&lt;/code&gt; 接下来对于想要限制内存的应用程序这样运行：&lt;/p&gt;
&lt;div class="sourceCode" id="cb9"&gt;&lt;pre class="sourceCode sh"&gt;&lt;code class="sourceCode bash"&gt;&lt;span id="cb9-1"&gt;&lt;a aria-hidden="true" href="#cb9-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="ex"&gt;systemd-run&lt;/span&gt; &lt;span class="at"&gt;--user&lt;/span&gt; &lt;span class="at"&gt;--slice&lt;/span&gt;&lt;span class="op"&gt;=&lt;/span&gt;limitMemory.slice chromium&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;或者写 service 也可以：&lt;/p&gt;
&lt;div class="sourceCode" id="cb10"&gt;&lt;pre class="sourceCode ini"&gt;&lt;code class="sourceCode ini"&gt;&lt;span id="cb10-1"&gt;&lt;a aria-hidden="true" href="#cb10-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;[Unit]&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb10-2"&gt;&lt;a aria-hidden="true" href="#cb10-2" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="dt"&gt;Description&lt;/span&gt;&lt;span class="ot"&gt;=&lt;/span&gt;&lt;span class="st"&gt;Minecraft Game&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb10-3"&gt;&lt;a aria-hidden="true" href="#cb10-3" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb10-4"&gt;&lt;a aria-hidden="true" href="#cb10-4" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;[Service]&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb10-5"&gt;&lt;a aria-hidden="true" href="#cb10-5" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="dt"&gt;WorkingDirectory&lt;/span&gt;&lt;span class="ot"&gt;=&lt;/span&gt;&lt;span class="st"&gt;/run/media/izfsk/Data/Games&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb10-6"&gt;&lt;a aria-hidden="true" href="#cb10-6" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="dt"&gt;Environment&lt;/span&gt;&lt;span class="ot"&gt;=&lt;/span&gt;&lt;span class="st"&gt;"__NV_PRIME_RENDER_OFFLOAD=1"&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb10-7"&gt;&lt;a aria-hidden="true" href="#cb10-7" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="dt"&gt;Environment&lt;/span&gt;&lt;span class="ot"&gt;=&lt;/span&gt;&lt;span class="st"&gt;"__GLX_VENDOR_LIBRARY_NAME=nvidia"&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb10-8"&gt;&lt;a aria-hidden="true" href="#cb10-8" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb10-9"&gt;&lt;a aria-hidden="true" href="#cb10-9" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="dt"&gt;ExecStart&lt;/span&gt;&lt;span class="ot"&gt;=&lt;/span&gt;&lt;span class="st"&gt;java -jar /run/media/izfsk/Data/Games/minecraft.jar&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb10-10"&gt;&lt;a aria-hidden="true" href="#cb10-10" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="dt"&gt;ExecStop&lt;/span&gt;&lt;span class="ot"&gt;=&lt;/span&gt;&lt;span class="st"&gt;killall java&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb10-11"&gt;&lt;a aria-hidden="true" href="#cb10-11" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb10-12"&gt;&lt;a aria-hidden="true" href="#cb10-12" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="dt"&gt;MemoryMax&lt;/span&gt;&lt;span class="ot"&gt;=&lt;/span&gt;&lt;span class="st"&gt;9000M&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;接下来&lt;/p&gt;
&lt;div class="sourceCode" id="cb11"&gt;&lt;pre class="sourceCode sh"&gt;&lt;code class="sourceCode bash"&gt;&lt;span id="cb11-1"&gt;&lt;a aria-hidden="true" href="#cb11-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="ex"&gt;systemctl&lt;/span&gt; &lt;span class="at"&gt;--user&lt;/span&gt; daemon-reload&lt;/span&gt;
&lt;span id="cb11-2"&gt;&lt;a aria-hidden="true" href="#cb11-2" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="ex"&gt;systemctl&lt;/span&gt; &lt;span class="at"&gt;--user&lt;/span&gt; start minecraft&lt;/span&gt;
&lt;span id="cb11-3"&gt;&lt;a aria-hidden="true" href="#cb11-3" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="co"&gt;# 查看日志&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb11-4"&gt;&lt;a aria-hidden="true" href="#cb11-4" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="ex"&gt;journalctl&lt;/span&gt; &lt;span class="at"&gt;--user&lt;/span&gt; &lt;span class="at"&gt;-u&lt;/span&gt; minecraft &lt;span class="at"&gt;--follow&lt;/span&gt; &lt;span class="at"&gt;--output&lt;/span&gt; cat&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id="其他提示"&gt;其他提示&lt;/h2&gt;
&lt;ol type="1"&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;slice&lt;/code&gt; 的命名规则：把 - 符号当作路径分隔符。例如 &lt;code&gt;foo-bar-baz.slice&lt;/code&gt; 应该理解成 &lt;code&gt;foo/bar/baz.slice&lt;/code&gt;。systemd 会把特殊字符 escape （ &lt;code&gt;systemd-escape&lt;/code&gt; ）来避免出现 - 符号。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;不要在 &lt;code&gt;systemd&lt;/code&gt; 管理的任意 &lt;code&gt;cgroup&lt;/code&gt; 下面创建自己的 &lt;code&gt;cgroup&lt;/code&gt;，即没有设置 &lt;code&gt;Delegate=&lt;/code&gt;的 &lt;code&gt;cgroup&lt;/code&gt;。不要在根 &lt;code&gt;cgroup&lt;/code&gt; 下面创建自己的 &lt;code&gt;cgroup&lt;/code&gt;。“如果你直接在 &lt;code&gt;cgroup&lt;/code&gt; 根目录下创建 &lt;code&gt;cgroup&lt;/code&gt;，那么你所做的一切都是自找麻烦。”（Seriously, if you create cgroups directly in the cgroup root, then all you do is ask for trouble.）。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;不要对 &lt;code&gt;systemd&lt;/code&gt; 创建的 &lt;code&gt;cgroup&lt;/code&gt; 的任何属性进行写入。&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id="参考"&gt;参考&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://docs.kernel.org/admin-guide/cgroup-v2.html"&gt;Control Group v2&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://www.freedesktop.org/software/systemd/man/systemd-run.html"&gt;Systemd-run&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://manpages.ubuntu.com/manpages/impish/man5/systemd.resource-control.5.html"&gt;systemd.resource-control&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://systemd.io/CGROUP_DELEGATION/"&gt;CGROUP_DELEGATION&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/9/html/managing_monitoring_and_updating_the_kernel/assembly_using-systemd-to-manage-resources-used-by-applications_managing-monitoring-and-updating-the-kernel"&gt;使用 systemd 管理应用程序使用的资源&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;br/&gt;
&lt;!--%%REF%%--&gt;
&lt;br/&gt;
&lt;script async="" crossorigin="anonymous" data-category="Announcements" data-category-id="DIC_kwDOJ7Ymy84CX4eg" data-emit-metadata="0" data-input-position="top" data-lang="zh-CN" data-loading="lazy" data-mapping="title" data-reactions-enabled="1" data-repo="izfsk-ium/izfsk-ium.github.io" data-repo-id="R_kgDOJ7Ymyw" data-strict="0" data-theme="preferred_color_scheme" src="https://giscus.app/client.js"&gt;
&lt;/script&gt;
&lt;/main&gt;
&lt;footer&gt;
&lt;p class="signoff"&gt;
&lt;div class="metadata"&gt;
&lt;p class="date"&gt;&lt;time datetime="2023-07-01"&gt;创建日期：2023-07-01&lt;/time&gt;&lt;/p&gt;
&lt;p class="lastmodify"&gt;&lt;time&gt;最后编译：2023-08-10&lt;/time&gt;&lt;/p&gt;
&lt;p class="lastmodify" id="counter-span"&gt;访问次数：&lt;/p&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;/footer&gt;
&lt;script&gt;
    /* These script should run after page load */
    document.querySelectorAll('code.sourceCode').forEach(
      i =&gt; i.insertAdjacentHTML('beforeend', '&lt;div class="copy"&gt;复制&lt;/div&gt;')
    );
    document.querySelectorAll('div.copy').forEach(
      i =&gt; i.addEventListener(
        'click',
        () =&gt; {
          navigator.clipboard.writeText(i.parentElement.innerText.replace('复制', ''));
          i.innerText = '成功';
          setTimeout(() =&gt; {
            i.innerText = '复制';
          }, 1000);
        }
      )
    );

    if (location.href.includes("127.0.0.1:8080")) {
      document.getElementById("counter-span").innerHTML = "[[development mode]]";
    } else {
      const uuid = document.getElementById("article-uuid").innerText;
      const target = document.getElementById("counter-span");
      const last = localStorage.getItem("lastVisit-" + uuid);
      const shouldIncrease = last === null || new Date().getTime() - parseInt(last) &gt;= (1000 * 60 * 15);

      fetch(shouldIncrease ? ("https://counter.izfsk.top/counter/" + uuid) : ("https://counter.izfsk.top/readOnly/" + uuid))
        .then(r =&gt; r.text())
        .then(d =&gt; {
          if (!d.startsWith("Too"))
            document.getElementById("counter-span").innerText = "访问次数：" + d.toString();
          else
            document.getElementById("counter-span").innerHTML = "";
        });

      localStorage.setItem("lastVisit-" + uuid, new Date().getTime());
    }
  &lt;/script&gt;
&lt;script async="" data-website-id="2a1146ab-fa82-4a84-a04f-30e5967357c3" src="https://analytics.umami.is/script.js"&gt;&lt;/script&gt;
&lt;/body&gt;</content:encoded>
      <guid isPermaLink="false">03566ccc-fb0d-4ff6-b67f-5e0a53204d4b</guid>
      <pubDate>Sat, 01 Jul 2023 00:00:00 +0800</pubDate>
    </item>
    <item>
      <title>在虚拟机中安装 Windows95</title>
      <link>https://blog.izfsk.top/articles/install-Windows95-in-oracle-virtual-box.html</link>
      <description>在虚拟机中安装 Windows95</description>
      <content:encoded>&lt;body&gt;
&lt;progress id="content_progress" value="0"&gt;&lt;/progress&gt;
&lt;button id="back-to-top"&gt;
    回页顶
  &lt;/button&gt;
&lt;header&gt;
&lt;small id="article-uuid" style="display: none !important;"&gt;5725ea26-0d1f-e95b-4611-5e40d236f79f&lt;/small&gt;
&lt;h1 class="title"&gt;在虚拟机中安装 Windows95&lt;/h1&gt;
&lt;!-- Subtitle --&gt;
&lt;h3 class="subtitle"&gt; &lt;/h3&gt;
&lt;/header&gt;
&lt;nav id="TOC" role="doc-toc"&gt;
&lt;strong&gt;文章归类: &lt;a href="/pages/category.html#考古"&gt;考古&lt;/a&gt; &lt;/strong&gt;
&lt;input id="contents" type="checkbox"/&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#转换安装镜像" id="toc-转换安装镜像"&gt;转换安装镜像&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#创建虚拟机" id="toc-创建虚拟机"&gt;创建虚拟机&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#安装系统" id="toc-安装系统"&gt;安装系统&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#安装-windows95" id="toc-安装-windows95"&gt;安装 Windows95&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#解决-2.1ghz-问题" id="toc-解决-2.1ghz-问题"&gt;解决 2.1GHz 问题&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#文件复制问题" id="toc-文件复制问题"&gt;文件复制问题&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#reference"&gt;参考链接&lt;/a&gt;&lt;/li&gt;
&lt;li&gt; &lt;/li&gt;
&lt;li class="tools"&gt;
&lt;span id="backtomain"&gt;
&lt;svg class="bi bi-house" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M8.707 1.5a1 1 0 0 0-1.414 0L.646 8.146a.5.5 0 0 0 .708.708L2 8.207V13.5A1.5 1.5 0 0 0 3.5 15h9a1.5 1.5 0 0 0 1.5-1.5V8.207l.646.647a.5.5 0 0 0 .708-.708L13 5.793V2.5a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v1.293L8.707 1.5ZM13 7.207V13.5a.5.5 0 0 1-.5.5h-9a.5.5 0 0 1-.5-.5V7.207l5-5 5 5Z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="readingmode"&gt;
&lt;svg class="bi bi-book" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M1 2.828c.885-.37 2.154-.769 3.388-.893 1.33-.134 2.458.063 3.112.752v9.746c-.935-.53-2.12-.603-3.213-.493-1.18.12-2.37.461-3.287.811V2.828zm7.5-.141c.654-.689 1.782-.886 3.112-.752 1.234.124 2.503.523 3.388.893v9.923c-.918-.35-2.107-.692-3.287-.81-1.094-.111-2.278-.039-3.213.492V2.687zM8 1.783C7.015.936 5.587.81 4.287.94c-1.514.153-3.042.672-3.994 1.105A.5.5 0 0 0 0 2.5v11a.5.5 0 0 0 .707.455c.882-.4 2.303-.881 3.68-1.02 1.409-.142 2.59.087 3.223.877a.5.5 0 0 0 .78 0c.633-.79 1.814-1.019 3.222-.877 1.378.139 2.8.62 3.681 1.02A.5.5 0 0 0 16 13.5v-11a.5.5 0 0 0-.293-.455c-.952-.433-2.48-.952-3.994-1.105C10.413.809 8.985.936 8 1.783z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="larger"&gt; &lt;/span&gt;
&lt;span id="smaller"&gt;&lt;/span&gt;
&lt;span id="switchfont"&gt;
&lt;svg class="bi bi-fonts" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M12.258 3h-8.51l-.083 2.46h.479c.26-1.544.758-1.783 2.693-1.845l.424-.013v7.827c0 .663-.144.82-1.3.923v.52h4.082v-.52c-1.162-.103-1.306-.26-1.306-.923V3.602l.431.013c1.934.062 2.434.301 2.693 1.846h.479L12.258 3z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="backtotop"&gt;
&lt;svg class="bi bi-arrow-bar-up" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M8 10a.5.5 0 0 0 .5-.5V3.707l2.146 2.147a.5.5 0 0 0 .708-.708l-3-3a.5.5 0 0 0-.708 0l-3 3a.5.5 0 1 0 .708.708L7.5 3.707V9.5a.5.5 0 0 0 .5.5zm-7 2.5a.5.5 0 0 1 .5-.5h13a.5.5 0 0 1 0 1h-13a.5.5 0 0 1-.5-.5z" fill-rule="evenodd"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/nav&gt;
&lt;main&gt;
&lt;p&gt;我想要安装 FreeDOS 来考古，以及安装 Windows95 和 Borland C++ 游玩。安装 FreeDOS 和普通操作系统有些不同，以下做一个记录。&lt;/p&gt;
&lt;div class="note red"&gt;
&lt;table&gt;
&lt;tbody&gt;
&lt;tr class="odd"&gt;
&lt;td&gt;ℹ️ 如果你要参考，请&lt;strong&gt;完整的阅读完这篇文章&lt;/strong&gt;！&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;h2 id="转换安装镜像"&gt;转换安装镜像&lt;/h2&gt;
&lt;p&gt;首先你需要一个&lt;a href="https://www.ibiblio.org/pub/micro/pc-stuff/freedos/files/distributions/1.3/official/FD13-FullUSB.zip"&gt;安装镜像文件&lt;/a&gt;，这是一个 ZIP 压缩包，而不是期望的 ISO 镜像。 解压以后，会有一个 img 文件，同样无法直接挂载使用。这玩意实际上是一个完整的磁盘镜像文件。VirtualBox 提供了对应的工具转换其为 VDI 格式：&lt;/p&gt;
&lt;div class="sourceCode" id="cb1"&gt;&lt;pre class="sourceCode sh"&gt;&lt;code class="sourceCode bash"&gt;&lt;span id="cb1-1"&gt;&lt;a aria-hidden="true" href="#cb1-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="ex"&gt;$&lt;/span&gt; VBoxManage convertfromraw &lt;span class="at"&gt;--format&lt;/span&gt; VDI &lt;span class="pp"&gt;[&lt;/span&gt;&lt;span class="ss"&gt;filename&lt;/span&gt;&lt;span class="pp"&gt;]&lt;/span&gt;.img &lt;span class="pp"&gt;[&lt;/span&gt;&lt;span class="ss"&gt;filename&lt;/span&gt;&lt;span class="pp"&gt;]&lt;/span&gt;.vdi&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;然后就会得到一个可用的 VDI 镜像了。&lt;/p&gt;
&lt;h2 id="创建虚拟机"&gt;创建虚拟机&lt;/h2&gt;
&lt;p&gt;按照一半流程创建虚拟机，但注意&lt;strong&gt;不要添加任何磁盘&lt;/strong&gt;：&lt;/p&gt;
&lt;figure&gt;
&lt;img alt="创建虚拟机" src="./assets/%E5%88%9B%E5%BB%BA%E8%99%9A%E6%8B%9F%E6%9C%BA.jpg"/&gt;
&lt;figcaption aria-hidden="true"&gt;创建虚拟机&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;接下来配置磁盘，打开新建的虚拟机的配置页面：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;在原有的 IDE 控制器上增加一个新的磁盘，选定刚才转换好的 VID 镜像&lt;/li&gt;
&lt;li&gt;新增一个 AHCI 控制器，创建一个新的空 VID 介质&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;最后的配置应该是这样：&lt;/p&gt;
&lt;figure&gt;
&lt;img alt="磁盘配置结果" src="./assets/%E9%85%8D%E7%BD%AE%E7%A3%81%E7%9B%98.png"/&gt;
&lt;figcaption aria-hidden="true"&gt;磁盘配置结果&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;然后启动。&lt;/p&gt;
&lt;h2 id="安装系统"&gt;安装系统&lt;/h2&gt;
&lt;p&gt;启动的第一屏是选择语言：&lt;/p&gt;
&lt;figure&gt;
&lt;img alt="选择语言" src="./assets/boot1.png"/&gt;
&lt;figcaption aria-hidden="true"&gt;选择语言&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;接下来一路 Enter 下去，按照它的要求给磁盘分区，然后重新启动。&lt;strong&gt;但是，重启之后又会回到同样的步骤&lt;/strong&gt;。你需要在第一次分区完毕以后，关掉虚拟机，打开虚拟机设置，将 IDE 控制器中的安装镜像 VDI 删除，再重新添加这个 VDI，再重新启动虚拟机。按照原来的方式 Enter 下去，这一次要求分区确认后，会得到不一样的显示界面：&lt;/p&gt;
&lt;figure&gt;
&lt;img alt="不同的界面" src="./assets/boot2.png"/&gt;
&lt;figcaption aria-hidden="true"&gt;不同的界面&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;这就是真正的安装了。选择键盘布局，选择完全安装：&lt;/p&gt;
&lt;figure&gt;
&lt;img alt="选择安装类型" src="./assets/install3.png"/&gt;
&lt;figcaption aria-hidden="true"&gt;选择安装类型&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;安装完毕以后会自动重启，然后&lt;strong&gt;又一次回到安装界面&lt;/strong&gt;，这一次需要做的是在设置中将 IDE 控制器中的安装镜像 VDI 移除。再次启动应该就能看到已经安装好的 FreeDOS 了。&lt;/p&gt;
&lt;figure&gt;
&lt;img alt="安装完毕" src="./assets/ins4.png"/&gt;
&lt;figcaption aria-hidden="true"&gt;安装完毕&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;figure&gt;
&lt;img alt="启动的 FreeDOS" src="./assets/ok4.png"/&gt;
&lt;figcaption aria-hidden="true"&gt;启动的 FreeDOS&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;h2 id="安装-windows95"&gt;安装 Windows95&lt;/h2&gt;
&lt;p&gt;也许 DOS 之于 Windows95 有点类似于「内核」与「桌面环境」的关系？总之，需要单独安装 Windows95。&lt;/p&gt;
&lt;p&gt;首先下载镜像，可以在一些地方找到它，例如&lt;a href="https://winworldpc.com/product/windows-95/osr-2"&gt;这里&lt;/a&gt;。这一次下载下来的应该是 ISO 格式的镜像。先别急着挂载，为了保证速度，建议的方法是解压到磁盘，然后通过 VirtualBox 的工具将磁盘文件作为 ISO 虚拟镜像挂载。无论采用什么方法，挂载的磁盘会出现在 &lt;code&gt;D:\&lt;/code&gt;。挂载完毕后，键入 &lt;code&gt;D:&lt;/code&gt; 进入对应目录，使用 &lt;code&gt;dir&lt;/code&gt; 列出文件，应该能看到 &lt;code&gt;setup.exe&lt;/code&gt;，使用 &lt;code&gt;.\setup.exe&lt;/code&gt; 运行它。如果一切正常，就能够看到安装前的自检：&lt;/p&gt;
&lt;figure&gt;
&lt;img alt="安装前的检查" src="./assets/win95_1.png"/&gt;
&lt;figcaption aria-hidden="true"&gt;安装前的检查&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;&lt;strong&gt;注意：如果它提示遇到 FAT 文件系统错误，不要自动修复，那会搞坏 DOS 系统，检查你的安装介质。&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;然后是图形化的安装界面，并没有什么难度。为了通过喜闻乐见的输入密钥环节，密钥的规律如下：&lt;/p&gt;
&lt;div class="sourceCode" id="cb2"&gt;&lt;pre class="sourceCode go"&gt;&lt;code class="sourceCode go"&gt;&lt;span id="cb2-1"&gt;&lt;a aria-hidden="true" href="#cb2-1" tabindex="-1"&gt;&lt;/a&gt;dddyy&lt;span class="op"&gt;-&lt;/span&gt;OEM&lt;span class="op"&gt;-&lt;/span&gt;xxxxx&lt;span class="op"&gt;-&lt;/span&gt;zzzzz&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;其中：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ddd 是密钥发布天 (范围 001-366)&lt;/li&gt;
&lt;li&gt;yy 是二位数的年份 (范围 95-02)&lt;/li&gt;
&lt;li&gt;xxxxx, 第一个数字必须为零，最后一个数字不能是 0、8 或 9。这些数字加在一起时必须能被 7 整除。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;一个示例：&lt;code&gt;06197-OEM-0014907-15227&lt;/code&gt;&lt;/p&gt;
&lt;figure&gt;
&lt;img alt="安装过程中" src="./assets/win95_2.png"/&gt;
&lt;figcaption aria-hidden="true"&gt;安装过程中&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;在询问是否创建 &lt;em&gt;startup disk&lt;/em&gt; 时，选择否。&lt;/p&gt;
&lt;p&gt;然后就是慢慢的等待并祈祷这玩意不要卡住：&lt;/p&gt;
&lt;figure&gt;
&lt;img alt="薛定谔的安装程序" src="./assets/win95_3.png"/&gt;
&lt;figcaption aria-hidden="true"&gt;薛定谔的安装程序&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;最后安装完毕，重启&lt;/p&gt;
&lt;h2 id="解决-2.1ghz-问题"&gt;解决 2.1GHz 问题&lt;/h2&gt;
&lt;p&gt;再次启动，会遇到这个问题：&lt;/p&gt;
&lt;figure&gt;
&lt;img alt="Windows Protection Error" src="./assets/win95_5.png"/&gt;
&lt;figcaption aria-hidden="true"&gt;Windows Protection Error&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;这是因为 Windows 95 不支持运行速度高于 2.1GHz 的处理器，如果 CPU 以 2.1 GHz 或更快的速度运行，网络驱动程序接口规范 (NDIS) 驱动程序中的时序校准代码会导致除以零。以 2.1 GHz 或更低速度运行的 CPU 不会出现此问题。&lt;/p&gt;
&lt;p&gt;为了解决这个问题，需要进行人工 patch。在&lt;a href="https://archive.org/details/fix-95-cpu-v3-final"&gt;此处&lt;/a&gt;下载 patch，解压其中的 ISO 作为引导，继续启动：&lt;/p&gt;
&lt;figure&gt;
&lt;img alt="Patch" src="./assets/hspd.png"/&gt;
&lt;figcaption aria-hidden="true"&gt;Patch&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;然后按照提示操作就行：&lt;/p&gt;
&lt;figure&gt;
&lt;img alt="完成" src="./assets/patchok.png"/&gt;
&lt;figcaption aria-hidden="true"&gt;完成&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;再次重启，如果还是不行，说明&lt;strong&gt;内存给多了&lt;/strong&gt;，降到 256MB 以下。&lt;/p&gt;
&lt;h2 id="文件复制问题"&gt;文件复制问题&lt;/h2&gt;
&lt;p&gt;再次开机，但别忘了还没装玩呢（&lt;/p&gt;
&lt;figure&gt;
&lt;img alt="复制文件" src="./assets/win95_6.png"/&gt;
&lt;figcaption aria-hidden="true"&gt;复制文件&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;然而，安装介质中是&lt;strong&gt;没有&lt;/strong&gt;这些文件的，而如果你鬼迷心窍的点击的取消，那系统就会死机，只能重启，这样做意味着文件系统损坏，然后 ScanDisk 会自作聪明的移除所有受到波及的文件，然后……就只能重新安装整个系统了。&lt;/p&gt;
&lt;figure&gt;
&lt;img alt="重装吧…" src="./assets/badluck.png"/&gt;
&lt;figcaption aria-hidden="true"&gt;重装吧…&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;是的，你甚至连桌面都没看到，系统就自己把自己搞坏了。所以在虚拟机玩的时候，一定要&lt;strong&gt;步步为营，做好快照&lt;/strong&gt;。&lt;/p&gt;
&lt;p&gt;为了能够正常的进入系统，需要做的就是：Skip。跳过所有找不到的文件。实际上它们就在 ISO 中的某个 CAB 文档中，但 Windows 就是会告诉你：找不到。最后我进入了安全模式：&lt;/p&gt;
&lt;figure&gt;
&lt;img alt="安全模式" src="./assets/savemode.png"/&gt;
&lt;figcaption aria-hidden="true"&gt;安全模式&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;br/&gt;
&lt;h2&gt;参考链接&lt;/h2&gt;
&lt;ul id="reference"&gt;
&lt;li&gt;&lt;a href="https://superuser.com/questions/554862/" target="_blank"&gt;&lt;strong&gt;How to convert .img to usable VirtualBox format&lt;/strong&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://winworldpc.com/product/windows-95/osr-2" target="_blank"&gt;&lt;strong&gt;Windows95 镜像下载&lt;/strong&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://archive.org/details/fix-95-cpu-v3-final" target="_blank"&gt;&lt;strong&gt;FIX95CPU_V3_FINAL&lt;/strong&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://msfn.org/board/topic/141402-windows-95-21ghz-cpu-limit-broken/" target="_blank"&gt;&lt;strong&gt;Windows 95 2.1GHz CPU Limit BROKEN!&lt;/strong&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://web.archive.org/web/20040302015309/http://support.microsoft.com/?id=312108" target="_blank"&gt;&lt;strong&gt;While initializing device NDIS: Windows protection error&lt;/strong&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://www.streetinfo.lu/computing/sysadmin/windows/win95_missing.html" target="_blank"&gt;&lt;strong&gt;Missing VXD and DLL files on Windows 95&lt;/strong&gt;&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;br/&gt;
&lt;script async="" crossorigin="anonymous" data-category="Announcements" data-category-id="DIC_kwDOJ7Ymy84CX4eg" data-emit-metadata="0" data-input-position="top" data-lang="zh-CN" data-loading="lazy" data-mapping="title" data-reactions-enabled="1" data-repo="izfsk-ium/izfsk-ium.github.io" data-repo-id="R_kgDOJ7Ymyw" data-strict="0" data-theme="preferred_color_scheme" src="https://giscus.app/client.js"&gt;
&lt;/script&gt;
&lt;/main&gt;
&lt;footer&gt;
&lt;p class="signoff"&gt;
&lt;div class="metadata"&gt;
&lt;p class="date"&gt;&lt;time datetime="2023-07-20"&gt;创建日期：2023-07-20&lt;/time&gt;&lt;/p&gt;
&lt;p class="lastmodify"&gt;&lt;time&gt;最后编译：2023-08-10&lt;/time&gt;&lt;/p&gt;
&lt;p class="lastmodify" id="counter-span"&gt;访问次数：&lt;/p&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;/footer&gt;
&lt;script&gt;
    /* These script should run after page load */
    document.querySelectorAll('code.sourceCode').forEach(
      i =&gt; i.insertAdjacentHTML('beforeend', '&lt;div class="copy"&gt;复制&lt;/div&gt;')
    );
    document.querySelectorAll('div.copy').forEach(
      i =&gt; i.addEventListener(
        'click',
        () =&gt; {
          navigator.clipboard.writeText(i.parentElement.innerText.replace('复制', ''));
          i.innerText = '成功';
          setTimeout(() =&gt; {
            i.innerText = '复制';
          }, 1000);
        }
      )
    );

    if (location.href.includes("127.0.0.1:8080")) {
      document.getElementById("counter-span").innerHTML = "[[development mode]]";
    } else {
      const uuid = document.getElementById("article-uuid").innerText;
      const target = document.getElementById("counter-span");
      const last = localStorage.getItem("lastVisit-" + uuid);
      const shouldIncrease = last === null || new Date().getTime() - parseInt(last) &gt;= (1000 * 60 * 15);

      fetch(shouldIncrease ? ("https://counter.izfsk.top/counter/" + uuid) : ("https://counter.izfsk.top/readOnly/" + uuid))
        .then(r =&gt; r.text())
        .then(d =&gt; {
          if (!d.startsWith("Too"))
            document.getElementById("counter-span").innerText = "访问次数：" + d.toString();
          else
            document.getElementById("counter-span").innerHTML = "";
        });

      localStorage.setItem("lastVisit-" + uuid, new Date().getTime());
    }
  &lt;/script&gt;
&lt;script async="" data-website-id="2a1146ab-fa82-4a84-a04f-30e5967357c3" src="https://analytics.umami.is/script.js"&gt;&lt;/script&gt;
&lt;/body&gt;</content:encoded>
      <guid isPermaLink="false">5725ea26-0d1f-e95b-4611-5e40d236f79f</guid>
      <pubDate>Thu, 20 Jul 2023 00:00:00 +0800</pubDate>
    </item>
    <item>
      <title>UNIX System V 的安装和设置</title>
      <link>https://blog.izfsk.top/articles/install-unix-system-v.html</link>
      <description>UNIX System V 的安装和设置</description>
      <content:encoded>&lt;body&gt;
&lt;progress id="content_progress" value="0"&gt;&lt;/progress&gt;
&lt;button id="back-to-top"&gt;
    回页顶
  &lt;/button&gt;
&lt;header&gt;
&lt;small id="article-uuid" style="display: none !important;"&gt;ca4147da-03bf-e4cc-3d48-3e7cd2e44295&lt;/small&gt;
&lt;h1 class="title"&gt;UNIX System V 的安装和设置&lt;/h1&gt;
&lt;!-- Subtitle --&gt;
&lt;h3 class="subtitle"&gt; &lt;/h3&gt;
&lt;/header&gt;
&lt;nav id="TOC" role="doc-toc"&gt;
&lt;strong&gt;文章归类: &lt;a href="/pages/category.html#考古"&gt;考古&lt;/a&gt; &lt;/strong&gt;
&lt;input id="contents" type="checkbox"/&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#主系统" id="toc-主系统"&gt;主系统&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#安装软件" id="toc-安装软件"&gt;安装软件&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#reference"&gt;参考链接&lt;/a&gt;&lt;/li&gt;
&lt;li&gt; &lt;/li&gt;
&lt;li class="tools"&gt;
&lt;span id="backtomain"&gt;
&lt;svg class="bi bi-house" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M8.707 1.5a1 1 0 0 0-1.414 0L.646 8.146a.5.5 0 0 0 .708.708L2 8.207V13.5A1.5 1.5 0 0 0 3.5 15h9a1.5 1.5 0 0 0 1.5-1.5V8.207l.646.647a.5.5 0 0 0 .708-.708L13 5.793V2.5a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v1.293L8.707 1.5ZM13 7.207V13.5a.5.5 0 0 1-.5.5h-9a.5.5 0 0 1-.5-.5V7.207l5-5 5 5Z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="readingmode"&gt;
&lt;svg class="bi bi-book" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M1 2.828c.885-.37 2.154-.769 3.388-.893 1.33-.134 2.458.063 3.112.752v9.746c-.935-.53-2.12-.603-3.213-.493-1.18.12-2.37.461-3.287.811V2.828zm7.5-.141c.654-.689 1.782-.886 3.112-.752 1.234.124 2.503.523 3.388.893v9.923c-.918-.35-2.107-.692-3.287-.81-1.094-.111-2.278-.039-3.213.492V2.687zM8 1.783C7.015.936 5.587.81 4.287.94c-1.514.153-3.042.672-3.994 1.105A.5.5 0 0 0 0 2.5v11a.5.5 0 0 0 .707.455c.882-.4 2.303-.881 3.68-1.02 1.409-.142 2.59.087 3.223.877a.5.5 0 0 0 .78 0c.633-.79 1.814-1.019 3.222-.877 1.378.139 2.8.62 3.681 1.02A.5.5 0 0 0 16 13.5v-11a.5.5 0 0 0-.293-.455c-.952-.433-2.48-.952-3.994-1.105C10.413.809 8.985.936 8 1.783z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="larger"&gt; &lt;/span&gt;
&lt;span id="smaller"&gt;&lt;/span&gt;
&lt;span id="switchfont"&gt;
&lt;svg class="bi bi-fonts" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M12.258 3h-8.51l-.083 2.46h.479c.26-1.544.758-1.783 2.693-1.845l.424-.013v7.827c0 .663-.144.82-1.3.923v.52h4.082v-.52c-1.162-.103-1.306-.26-1.306-.923V3.602l.431.013c1.934.062 2.434.301 2.693 1.846h.479L12.258 3z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="backtotop"&gt;
&lt;svg class="bi bi-arrow-bar-up" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M8 10a.5.5 0 0 0 .5-.5V3.707l2.146 2.147a.5.5 0 0 0 .708-.708l-3-3a.5.5 0 0 0-.708 0l-3 3a.5.5 0 1 0 .708.708L7.5 3.707V9.5a.5.5 0 0 0 .5.5zm-7 2.5a.5.5 0 0 1 .5-.5h13a.5.5 0 0 1 0 1h-13a.5.5 0 0 1-.5-.5z" fill-rule="evenodd"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/nav&gt;
&lt;main&gt;
&lt;p&gt;最近考古上瘾，这次打算安装一下 UNIX 的老祖：AT&amp;amp;T System V Unix。&lt;/p&gt;
&lt;h2 id="主系统"&gt;主系统&lt;/h2&gt;
&lt;p&gt;首先是要&lt;a href="./assets/AT%26T%20UNIX%20System%20V%20Release%204%20Version%202.1%20(3.5).7z"&gt;下载安装镜像&lt;/a&gt;。这一次下载下来的是若干张 3.5 英寸软盘镜像。安装就从这些软盘镜像开始。创建一个虚拟机，添加 IDE 硬盘以及 I82078 软驱设备，记得不要调过高的 RAM，然后插入启动，软驱中插入 &lt;code&gt;Base 01 (2.1a).img&lt;/code&gt;，启动：&lt;/p&gt;
&lt;figure&gt;
&lt;img alt="Panic!" src="./assets/panic.png"/&gt;
&lt;figcaption aria-hidden="true"&gt;Panic!&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;然后系统就 Panic 了。原因是所谓的 &lt;a href="http://www.steunebrink.info/bioslim.htm#Contents"&gt;504MB限制&lt;/a&gt;。&lt;/p&gt;
&lt;p&gt;在很久很久以前，至少回溯到 DOS 时代，那时候为了和磁盘交互，系统需要使用 BIOS 中断。也就是调用 &lt;code&gt;INT 13h&lt;/code&gt; 将跳转到计算机 &lt;code&gt;BIOS&lt;/code&gt; 代码中进行低级磁盘服务，该代码将为程序执行基于物理扇区的磁盘读取或写入操作。这就使得操作系统不需要处理各个不同硬盘厂商生存的硬盘，只需要和 BIOS 交互即可。早期的 BIOS 可以寻址 1024 个柱面、256 个磁头和 63 个扇区。按照每个扇区 512 bytes 计算，这也就意味着 512 × (1024 × 256 × 63) = 8455716864 bytes 可以达到 8 GB。这也是理论上的最大限制。&lt;/p&gt;
&lt;p&gt;很快，为了满足人民群众对更大硬盘的向往，IBM 和 Western Digital 又发明了另外一套接口，也就是 (IDE/AT) HD Interface，理论上相当不错：65535 个柱面、16 个磁头和 256 个扇区，乘起来就是 65535 × 16 × 256 × 512 = 137436856320 bytes 相当于约 127.5 GB。&lt;/p&gt;
&lt;p&gt;然而问题在于：&lt;strong&gt;这两套系统并不相互兼容&lt;/strong&gt;，孤独的天才们独立创作，丝毫没有和同行们沟通。为了让两个系统可以合作，只能对使用每个规格中最小的进行寻址！也就是说：&lt;/p&gt;
&lt;p&gt;16 柱面 x 1024 磁头 x 63 扇区 x 512 bytes 每个扇区 = 528,482,304 Bytes = 504 MB&lt;/p&gt;
&lt;p&gt;所以为了安装能够继续下去，最方便的方法就是新建一个新的 VDI，设置大小为 503 MB。&lt;/p&gt;
&lt;figure&gt;
&lt;img alt="安装过程" src="./assets/installsysv.png"/&gt;
&lt;figcaption aria-hidden="true"&gt;安装过程&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;接下来的工作很无聊：按照屏幕上的提示，格式化硬盘，重启，然后挨个把对应的软盘放进去安装。&lt;/p&gt;
&lt;figure&gt;
&lt;img alt="插入一系列软盘" src="./assets/installsysv2.png"/&gt;
&lt;figcaption aria-hidden="true"&gt;插入一系列软盘&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;然后是设置密码，主机名等等。&lt;/p&gt;
&lt;figure&gt;
&lt;img alt="设置密码" src="./assets/setpassword.png"/&gt;
&lt;figcaption aria-hidden="true"&gt;设置密码&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;重启，大功告成。&lt;/p&gt;
&lt;figure&gt;
&lt;img alt="安装完毕" src="./assets/installsysvdone.png"/&gt;
&lt;figcaption aria-hidden="true"&gt;安装完毕&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;h2 id="安装软件"&gt;安装软件&lt;/h2&gt;
&lt;p&gt;这是一个很「干净的系统」，&lt;code&gt;/usr/bin&lt;/code&gt; 目录下只有 255 个程序，相比之下我的电脑上有 2950 个之多。当然，这玩意也是有包管理器的，只不过并没有网络功能，需要依靠软盘安装。键入 &lt;code&gt;pkgadd -d diskette1&lt;/code&gt; 再按照提示将包含软件包的磁碟放入即可安装。&lt;/p&gt;
&lt;figure&gt;
&lt;img alt="安装软件包" src="./assets/systemvinstallpackages.png"/&gt;
&lt;figcaption aria-hidden="true"&gt;安装软件包&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;安装完毕后重启，&lt;strong&gt;如果卡在第一屏一动不动，只有光标闪烁，说明忘记把软件安装软盘弹出软驱。&lt;/strong&gt;。&lt;/p&gt;
&lt;p&gt;但是这些软件包中并没有 C 编译器套件。你可以在&lt;a href="http://www.bitsavers.org/bits/ATT/SYSV_386/SYSV_Rel_4.0_Ver_1.0_386_486_partial.zip"&gt;这里&lt;/a&gt;下载它们。其中包括的 &lt;code&gt;Standard_C_Development_Environment_R5.0&lt;/code&gt; 就是 C 开发环境。&lt;/p&gt;
&lt;figure&gt;
&lt;img alt="安装软盘封面" src="./assets/Standard_C_Development_Environment_R5.0.webp"/&gt;
&lt;figcaption aria-hidden="true"&gt;安装软盘封面&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;接下来需要做的是把 IMD 镜像转换成 IMG 格式。有一个工具 &lt;a href="https://github.com/keirf/Disk-Utilities"&gt;disk-utilities&lt;/a&gt; 可以做到这一点。克隆仓库并编译之。然后使用 &lt;code&gt;disk-analyse input.IMD output.img&lt;/code&gt; 即可。如果遇到 &lt;code&gt;error while loading shared libraries: libdisk.so.0&lt;/code&gt;，更新 LD_PATH 为 &lt;code&gt;LD_LIBRARY_PATH=libdisk disk-analyse/disk-analyse&lt;/code&gt; 即可。方便起见，将转换完毕的文件放在&lt;a href="./assets/Standard_C_Development_Environment_R5.0.7z"&gt;这里&lt;/a&gt;。插入安装：&lt;/p&gt;
&lt;figure&gt;
&lt;img alt="安装 SDCE" src="./assets/install_sdce.png"/&gt;
&lt;figcaption aria-hidden="true"&gt;安装 SDCE&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;安装完毕后，使用 vi 编辑器创建源文件并编译成功。&lt;/p&gt;
&lt;figure&gt;
&lt;img alt="编译" src="./assets/hellosysvunix.png"/&gt;
&lt;figcaption aria-hidden="true"&gt;编译&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;br/&gt;
&lt;h2&gt;参考链接&lt;/h2&gt;
&lt;ul id="reference"&gt;
&lt;li&gt;&lt;a href="https://winworldpc.com/product/att-system-v-unix/2-x" target="_blank"&gt;&lt;strong&gt;AT&amp;amp;T System V Unix 2.x&lt;/strong&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="http://www.steunebrink.info/bioslim.htm#Contents" target="_blank"&gt;&lt;strong&gt;The BIOS IDE Harddisk Limitations&lt;/strong&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://en.wikipedia.org/wiki/INT_13H" target="_blank"&gt;&lt;strong&gt;INT 13H&lt;/strong&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://www.linuxquestions.org/questions/other-*nix-55/using-floppies-in-at-and-t-unix-system-v-release-4-version-2-1-or-docs-link-4175428440/" target="_blank"&gt;&lt;strong&gt;Using floppies in AT&amp;amp;T UNIX System V&lt;/strong&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://retrocomputing.stackexchange.com/questions/7890/how-can-i-use-imagedisk-imd-images-with-virtualbox-winimage-etc" target="_blank"&gt;&lt;strong&gt;How can I use ImageDiskimages with VirtualBox?&lt;/strong&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://github.com/keirf/Disk-Utilities" target="_blank"&gt;&lt;strong&gt;keirf / disk-utilities&lt;/strong&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://www.admin.com/samples/UUCP.pdf" target="_blank"&gt;&lt;strong&gt;About UUCP&lt;/strong&gt;&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;br/&gt;
&lt;script async="" crossorigin="anonymous" data-category="Announcements" data-category-id="DIC_kwDOJ7Ymy84CX4eg" data-emit-metadata="0" data-input-position="top" data-lang="zh-CN" data-loading="lazy" data-mapping="title" data-reactions-enabled="1" data-repo="izfsk-ium/izfsk-ium.github.io" data-repo-id="R_kgDOJ7Ymyw" data-strict="0" data-theme="preferred_color_scheme" src="https://giscus.app/client.js"&gt;
&lt;/script&gt;
&lt;/main&gt;
&lt;footer&gt;
&lt;p class="signoff"&gt;
&lt;div class="metadata"&gt;
&lt;p class="date"&gt;&lt;time datetime="2023-07-22"&gt;创建日期：2023-07-22&lt;/time&gt;&lt;/p&gt;
&lt;p class="lastmodify"&gt;&lt;time&gt;最后编译：2023-08-10&lt;/time&gt;&lt;/p&gt;
&lt;p class="lastmodify" id="counter-span"&gt;访问次数：&lt;/p&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;/footer&gt;
&lt;script&gt;
    /* These script should run after page load */
    document.querySelectorAll('code.sourceCode').forEach(
      i =&gt; i.insertAdjacentHTML('beforeend', '&lt;div class="copy"&gt;复制&lt;/div&gt;')
    );
    document.querySelectorAll('div.copy').forEach(
      i =&gt; i.addEventListener(
        'click',
        () =&gt; {
          navigator.clipboard.writeText(i.parentElement.innerText.replace('复制', ''));
          i.innerText = '成功';
          setTimeout(() =&gt; {
            i.innerText = '复制';
          }, 1000);
        }
      )
    );

    if (location.href.includes("127.0.0.1:8080")) {
      document.getElementById("counter-span").innerHTML = "[[development mode]]";
    } else {
      const uuid = document.getElementById("article-uuid").innerText;
      const target = document.getElementById("counter-span");
      const last = localStorage.getItem("lastVisit-" + uuid);
      const shouldIncrease = last === null || new Date().getTime() - parseInt(last) &gt;= (1000 * 60 * 15);

      fetch(shouldIncrease ? ("https://counter.izfsk.top/counter/" + uuid) : ("https://counter.izfsk.top/readOnly/" + uuid))
        .then(r =&gt; r.text())
        .then(d =&gt; {
          if (!d.startsWith("Too"))
            document.getElementById("counter-span").innerText = "访问次数：" + d.toString();
          else
            document.getElementById("counter-span").innerHTML = "";
        });

      localStorage.setItem("lastVisit-" + uuid, new Date().getTime());
    }
  &lt;/script&gt;
&lt;script async="" data-website-id="2a1146ab-fa82-4a84-a04f-30e5967357c3" src="https://analytics.umami.is/script.js"&gt;&lt;/script&gt;
&lt;/body&gt;</content:encoded>
      <guid isPermaLink="false">ca4147da-03bf-e4cc-3d48-3e7cd2e44295</guid>
      <pubDate>Sat, 22 Jul 2023 00:00:00 +0800</pubDate>
    </item>
    <item>
      <title>创建一个简单的访问计数器</title>
      <link>https://blog.izfsk.top/articles/create-a-simple-webpage-counter.html</link>
      <description>创建一个简单的访问计数器</description>
      <content:encoded>&lt;body&gt;
&lt;progress id="content_progress" value="0"&gt;&lt;/progress&gt;
&lt;button id="back-to-top"&gt;
    回页顶
  &lt;/button&gt;
&lt;header&gt;
&lt;small id="article-uuid" style="display: none !important;"&gt;1edffa3a-8990-4bc9-bb7a-a760909b4a93&lt;/small&gt;
&lt;h1 class="title"&gt;创建一个简单的访问计数器&lt;/h1&gt;
&lt;!-- Subtitle --&gt;
&lt;h3 class="subtitle"&gt; &lt;/h3&gt;
&lt;/header&gt;
&lt;nav id="TOC" role="doc-toc"&gt;
&lt;strong&gt;文章归类: &lt;a href="/pages/category.html#杂项"&gt;杂项&lt;/a&gt; &lt;/strong&gt;
&lt;input id="contents" type="checkbox"/&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#原理" id="toc-原理"&gt;原理&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#源码" id="toc-源码"&gt;源码&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#部署" id="toc-部署"&gt;部署&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#创建-mongodb-数据库" id="toc-创建-mongodb-数据库"&gt;创建 MongoDB 数据库&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#创建-render-项目" id="toc-创建-render-项目"&gt;创建 Render 项目&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#添加前端代码" id="toc-添加前端代码"&gt;添加前端代码&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#reference"&gt;参考链接&lt;/a&gt;&lt;/li&gt;
&lt;li&gt; &lt;/li&gt;
&lt;li class="tools"&gt;
&lt;span id="backtomain"&gt;
&lt;svg class="bi bi-house" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M8.707 1.5a1 1 0 0 0-1.414 0L.646 8.146a.5.5 0 0 0 .708.708L2 8.207V13.5A1.5 1.5 0 0 0 3.5 15h9a1.5 1.5 0 0 0 1.5-1.5V8.207l.646.647a.5.5 0 0 0 .708-.708L13 5.793V2.5a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v1.293L8.707 1.5ZM13 7.207V13.5a.5.5 0 0 1-.5.5h-9a.5.5 0 0 1-.5-.5V7.207l5-5 5 5Z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="readingmode"&gt;
&lt;svg class="bi bi-book" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M1 2.828c.885-.37 2.154-.769 3.388-.893 1.33-.134 2.458.063 3.112.752v9.746c-.935-.53-2.12-.603-3.213-.493-1.18.12-2.37.461-3.287.811V2.828zm7.5-.141c.654-.689 1.782-.886 3.112-.752 1.234.124 2.503.523 3.388.893v9.923c-.918-.35-2.107-.692-3.287-.81-1.094-.111-2.278-.039-3.213.492V2.687zM8 1.783C7.015.936 5.587.81 4.287.94c-1.514.153-3.042.672-3.994 1.105A.5.5 0 0 0 0 2.5v11a.5.5 0 0 0 .707.455c.882-.4 2.303-.881 3.68-1.02 1.409-.142 2.59.087 3.223.877a.5.5 0 0 0 .78 0c.633-.79 1.814-1.019 3.222-.877 1.378.139 2.8.62 3.681 1.02A.5.5 0 0 0 16 13.5v-11a.5.5 0 0 0-.293-.455c-.952-.433-2.48-.952-3.994-1.105C10.413.809 8.985.936 8 1.783z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="larger"&gt; &lt;/span&gt;
&lt;span id="smaller"&gt;&lt;/span&gt;
&lt;span id="switchfont"&gt;
&lt;svg class="bi bi-fonts" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M12.258 3h-8.51l-.083 2.46h.479c.26-1.544.758-1.783 2.693-1.845l.424-.013v7.827c0 .663-.144.82-1.3.923v.52h4.082v-.52c-1.162-.103-1.306-.26-1.306-.923V3.602l.431.013c1.934.062 2.434.301 2.693 1.846h.479L12.258 3z"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;span id="backtotop"&gt;
&lt;svg class="bi bi-arrow-bar-up" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;path d="M8 10a.5.5 0 0 0 .5-.5V3.707l2.146 2.147a.5.5 0 0 0 .708-.708l-3-3a.5.5 0 0 0-.708 0l-3 3a.5.5 0 1 0 .708.708L7.5 3.707V9.5a.5.5 0 0 0 .5.5zm-7 2.5a.5.5 0 0 1 .5-.5h13a.5.5 0 0 1 0 1h-13a.5.5 0 0 1-.5-.5z" fill-rule="evenodd"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/span&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/nav&gt;
&lt;main&gt;
&lt;p&gt;我要为站点添加一个计数器小组件，按惯例，虽然有现成的免费服务，比如&lt;a href="https://moe-counter.glitch.me/"&gt;这个&lt;/a&gt;或者&lt;a href="https://hits.seeyoufarm.com"&gt;这个&lt;/a&gt;，但我还是决定自己造一个。最终我利用一系列可以白嫖的服务构建了一个简单的访问计数器。&lt;/p&gt;
&lt;h2 id="原理"&gt;原理&lt;/h2&gt;
&lt;p&gt;计数器的原理很简单，就是「有访问，则加一」。一个可行的实现就是用 redis 并定期写入到数据库。不过这样一来就需要找到两个（免费的）服务。所以我不使用 redis，直接 操作数据库。经过调查，我发现 MongoDB 有提供免费的 512MB 实例，并且不会有定期清除数据之类恶心人的限制，所以就使用它了。当然，直接在浏览器访问操作数据库是不可能的， 所以我还使用 Render.com 提供的 Web Server 作为中间层，提供一个 api 来给浏览器端调用。其他的诸如 CROS，速率限制就不多赘述了。&lt;/p&gt;
&lt;p&gt;为了安全起见，还会额外请求源仓库的所有文章的 uuid 文件判断请求是否合法。&lt;/p&gt;
&lt;h2 id="源码"&gt;源码&lt;/h2&gt;
&lt;p&gt;源码很少很少，这毕竟不是什么大型服务，而且从网站的访问量来看，基本上不用考虑什么性能问题：&lt;/p&gt;
&lt;div class="sourceCode" id="cb1"&gt;&lt;pre class="sourceCode js"&gt;&lt;code class="sourceCode javascript"&gt;&lt;span id="cb1-1"&gt;&lt;a aria-hidden="true" href="#cb1-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;const&lt;/span&gt; express &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="pp"&gt;require&lt;/span&gt;(&lt;span class="st"&gt;'express'&lt;/span&gt;)&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-2"&gt;&lt;a aria-hidden="true" href="#cb1-2" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;const&lt;/span&gt; cors &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="pp"&gt;require&lt;/span&gt;(&lt;span class="st"&gt;'cors'&lt;/span&gt;)&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-3"&gt;&lt;a aria-hidden="true" href="#cb1-3" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;const&lt;/span&gt; rateLimit &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="pp"&gt;require&lt;/span&gt;(&lt;span class="st"&gt;'express-rate-limit'&lt;/span&gt;)&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-4"&gt;&lt;a aria-hidden="true" href="#cb1-4" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;const&lt;/span&gt; app &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="fu"&gt;express&lt;/span&gt;()&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-5"&gt;&lt;a aria-hidden="true" href="#cb1-5" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;const&lt;/span&gt; port &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="dv"&gt;3000&lt;/span&gt;&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-6"&gt;&lt;a aria-hidden="true" href="#cb1-6" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;const&lt;/span&gt; { MongoClient&lt;span class="op"&gt;,&lt;/span&gt; ServerApiVersion } &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="pp"&gt;require&lt;/span&gt;(&lt;span class="st"&gt;'mongodb'&lt;/span&gt;)&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-7"&gt;&lt;a aria-hidden="true" href="#cb1-7" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb1-8"&gt;&lt;a aria-hidden="true" href="#cb1-8" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;const&lt;/span&gt; uri &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="st"&gt;"mongodb+srv://me:xxxxxx"&lt;/span&gt;&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-9"&gt;&lt;a aria-hidden="true" href="#cb1-9" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb1-10"&gt;&lt;a aria-hidden="true" href="#cb1-10" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;const&lt;/span&gt; client &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="kw"&gt;new&lt;/span&gt; &lt;span class="fu"&gt;MongoClient&lt;/span&gt;(uri&lt;span class="op"&gt;,&lt;/span&gt; {&lt;/span&gt;
&lt;span id="cb1-11"&gt;&lt;a aria-hidden="true" href="#cb1-11" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="dt"&gt;serverApi&lt;/span&gt;&lt;span class="op"&gt;:&lt;/span&gt; {&lt;/span&gt;
&lt;span id="cb1-12"&gt;&lt;a aria-hidden="true" href="#cb1-12" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="dt"&gt;version&lt;/span&gt;&lt;span class="op"&gt;:&lt;/span&gt; ServerApiVersion&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="at"&gt;v1&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-13"&gt;&lt;a aria-hidden="true" href="#cb1-13" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="dt"&gt;strict&lt;/span&gt;&lt;span class="op"&gt;:&lt;/span&gt; &lt;span class="kw"&gt;true&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-14"&gt;&lt;a aria-hidden="true" href="#cb1-14" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="dt"&gt;deprecationErrors&lt;/span&gt;&lt;span class="op"&gt;:&lt;/span&gt; &lt;span class="kw"&gt;true&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-15"&gt;&lt;a aria-hidden="true" href="#cb1-15" tabindex="-1"&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id="cb1-16"&gt;&lt;a aria-hidden="true" href="#cb1-16" tabindex="-1"&gt;&lt;/a&gt;})&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-17"&gt;&lt;a aria-hidden="true" href="#cb1-17" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb1-18"&gt;&lt;a aria-hidden="true" href="#cb1-18" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;const&lt;/span&gt; limiter &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="fu"&gt;rateLimit&lt;/span&gt;({&lt;/span&gt;
&lt;span id="cb1-19"&gt;&lt;a aria-hidden="true" href="#cb1-19" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="dt"&gt;windowMs&lt;/span&gt;&lt;span class="op"&gt;:&lt;/span&gt; &lt;span class="dv"&gt;1&lt;/span&gt; &lt;span class="op"&gt;*&lt;/span&gt; &lt;span class="dv"&gt;60&lt;/span&gt; &lt;span class="op"&gt;*&lt;/span&gt; &lt;span class="dv"&gt;1000&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt; &lt;span class="co"&gt;// 1 minute&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-20"&gt;&lt;a aria-hidden="true" href="#cb1-20" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="dt"&gt;max&lt;/span&gt;&lt;span class="op"&gt;:&lt;/span&gt; &lt;span class="dv"&gt;60&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt; &lt;span class="co"&gt;// Limit each IP to 60 requests per `window` (here, per 15 minutes)&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-21"&gt;&lt;a aria-hidden="true" href="#cb1-21" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="dt"&gt;standardHeaders&lt;/span&gt;&lt;span class="op"&gt;:&lt;/span&gt; &lt;span class="kw"&gt;true&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt; &lt;span class="co"&gt;// Return rate limit info in the `RateLimit-*` headers&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-22"&gt;&lt;a aria-hidden="true" href="#cb1-22" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="dt"&gt;legacyHeaders&lt;/span&gt;&lt;span class="op"&gt;:&lt;/span&gt; &lt;span class="kw"&gt;false&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt; &lt;span class="co"&gt;// Disable the `X-RateLimit-*` headers&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-23"&gt;&lt;a aria-hidden="true" href="#cb1-23" tabindex="-1"&gt;&lt;/a&gt;})&lt;/span&gt;
&lt;span id="cb1-24"&gt;&lt;a aria-hidden="true" href="#cb1-24" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb1-25"&gt;&lt;a aria-hidden="true" href="#cb1-25" tabindex="-1"&gt;&lt;/a&gt;app&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;use&lt;/span&gt;(limiter)&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-26"&gt;&lt;a aria-hidden="true" href="#cb1-26" tabindex="-1"&gt;&lt;/a&gt;app&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;use&lt;/span&gt;(&lt;span class="fu"&gt;cors&lt;/span&gt;({&lt;/span&gt;
&lt;span id="cb1-27"&gt;&lt;a aria-hidden="true" href="#cb1-27" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="dt"&gt;origin&lt;/span&gt;&lt;span class="op"&gt;:&lt;/span&gt; &lt;span class="st"&gt;'*'&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-28"&gt;&lt;a aria-hidden="true" href="#cb1-28" tabindex="-1"&gt;&lt;/a&gt;}))&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-29"&gt;&lt;a aria-hidden="true" href="#cb1-29" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb1-30"&gt;&lt;a aria-hidden="true" href="#cb1-30" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb1-31"&gt;&lt;a aria-hidden="true" href="#cb1-31" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;async&lt;/span&gt; &lt;span class="kw"&gt;function&lt;/span&gt; &lt;span class="fu"&gt;getAllArticleUUIDs&lt;/span&gt;() {&lt;/span&gt;
&lt;span id="cb1-32"&gt;&lt;a aria-hidden="true" href="#cb1-32" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="kw"&gt;const&lt;/span&gt; request &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="cf"&gt;await&lt;/span&gt; &lt;span class="fu"&gt;fetch&lt;/span&gt;(&lt;span class="st"&gt;"https://raw.githubusercontent.com/izfsk-ium/izfsk-ium.github.io/main/dist/articles/uuids.json"&lt;/span&gt;)&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-33"&gt;&lt;a aria-hidden="true" href="#cb1-33" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="cf"&gt;return&lt;/span&gt; &lt;span class="cf"&gt;await&lt;/span&gt; request&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;json&lt;/span&gt;()&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-34"&gt;&lt;a aria-hidden="true" href="#cb1-34" tabindex="-1"&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id="cb1-35"&gt;&lt;a aria-hidden="true" href="#cb1-35" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb1-36"&gt;&lt;a aria-hidden="true" href="#cb1-36" tabindex="-1"&gt;&lt;/a&gt;app&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;get&lt;/span&gt;(&lt;span class="st"&gt;'/readOnly/:uuid'&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt; (req&lt;span class="op"&gt;,&lt;/span&gt; res) &lt;span class="kw"&gt;=&amp;gt;&lt;/span&gt; {&lt;/span&gt;
&lt;span id="cb1-37"&gt;&lt;a aria-hidden="true" href="#cb1-37" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="kw"&gt;async&lt;/span&gt; &lt;span class="kw"&gt;function&lt;/span&gt; &lt;span class="fu"&gt;run&lt;/span&gt;() {&lt;/span&gt;
&lt;span id="cb1-38"&gt;&lt;a aria-hidden="true" href="#cb1-38" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="kw"&gt;const&lt;/span&gt; targetID &lt;span class="op"&gt;=&lt;/span&gt; req&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="at"&gt;params&lt;/span&gt;&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="at"&gt;uuid&lt;/span&gt;&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-39"&gt;&lt;a aria-hidden="true" href="#cb1-39" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb1-40"&gt;&lt;a aria-hidden="true" href="#cb1-40" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="cf"&gt;try&lt;/span&gt; {&lt;/span&gt;
&lt;span id="cb1-41"&gt;&lt;a aria-hidden="true" href="#cb1-41" tabindex="-1"&gt;&lt;/a&gt;            &lt;span class="cf"&gt;await&lt;/span&gt; client&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;connect&lt;/span&gt;()&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-42"&gt;&lt;a aria-hidden="true" href="#cb1-42" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb1-43"&gt;&lt;a aria-hidden="true" href="#cb1-43" tabindex="-1"&gt;&lt;/a&gt;            &lt;span class="kw"&gt;const&lt;/span&gt; result &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="cf"&gt;await&lt;/span&gt; client&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;db&lt;/span&gt;(&lt;span class="st"&gt;"count"&lt;/span&gt;)&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;collection&lt;/span&gt;(&lt;span class="st"&gt;"count"&lt;/span&gt;)&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;findOne&lt;/span&gt;({ &lt;span class="st"&gt;"url"&lt;/span&gt;&lt;span class="op"&gt;:&lt;/span&gt; targetID })&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-44"&gt;&lt;a aria-hidden="true" href="#cb1-44" tabindex="-1"&gt;&lt;/a&gt;            &lt;span class="cf"&gt;if&lt;/span&gt; (result &lt;span class="op"&gt;===&lt;/span&gt; &lt;span class="kw"&gt;null&lt;/span&gt;) {&lt;/span&gt;
&lt;span id="cb1-45"&gt;&lt;a aria-hidden="true" href="#cb1-45" tabindex="-1"&gt;&lt;/a&gt;                res&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;send&lt;/span&gt;(&lt;span class="st"&gt;"0"&lt;/span&gt;)&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-46"&gt;&lt;a aria-hidden="true" href="#cb1-46" tabindex="-1"&gt;&lt;/a&gt;            } &lt;span class="cf"&gt;else&lt;/span&gt; {&lt;/span&gt;
&lt;span id="cb1-47"&gt;&lt;a aria-hidden="true" href="#cb1-47" tabindex="-1"&gt;&lt;/a&gt;                res&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;send&lt;/span&gt;(result&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="at"&gt;count&lt;/span&gt;&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;toString&lt;/span&gt;())&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-48"&gt;&lt;a aria-hidden="true" href="#cb1-48" tabindex="-1"&gt;&lt;/a&gt;            }&lt;/span&gt;
&lt;span id="cb1-49"&gt;&lt;a aria-hidden="true" href="#cb1-49" tabindex="-1"&gt;&lt;/a&gt;        } &lt;span class="cf"&gt;finally&lt;/span&gt; {&lt;/span&gt;
&lt;span id="cb1-50"&gt;&lt;a aria-hidden="true" href="#cb1-50" tabindex="-1"&gt;&lt;/a&gt;            &lt;span class="cf"&gt;await&lt;/span&gt; client&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;close&lt;/span&gt;()&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-51"&gt;&lt;a aria-hidden="true" href="#cb1-51" tabindex="-1"&gt;&lt;/a&gt;        }&lt;/span&gt;
&lt;span id="cb1-52"&gt;&lt;a aria-hidden="true" href="#cb1-52" tabindex="-1"&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id="cb1-53"&gt;&lt;a aria-hidden="true" href="#cb1-53" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="fu"&gt;run&lt;/span&gt;()&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;catch&lt;/span&gt;(&lt;span class="bu"&gt;console&lt;/span&gt;&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;dir&lt;/span&gt;)&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-54"&gt;&lt;a aria-hidden="true" href="#cb1-54" tabindex="-1"&gt;&lt;/a&gt;})&lt;/span&gt;
&lt;span id="cb1-55"&gt;&lt;a aria-hidden="true" href="#cb1-55" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb1-56"&gt;&lt;a aria-hidden="true" href="#cb1-56" tabindex="-1"&gt;&lt;/a&gt;app&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;get&lt;/span&gt;(&lt;span class="st"&gt;'/counter/:uuid'&lt;/span&gt;&lt;span class="op"&gt;,&lt;/span&gt; (req&lt;span class="op"&gt;,&lt;/span&gt; res) &lt;span class="kw"&gt;=&amp;gt;&lt;/span&gt; {&lt;/span&gt;
&lt;span id="cb1-57"&gt;&lt;a aria-hidden="true" href="#cb1-57" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="kw"&gt;async&lt;/span&gt; &lt;span class="kw"&gt;function&lt;/span&gt; &lt;span class="fu"&gt;run&lt;/span&gt;() {&lt;/span&gt;
&lt;span id="cb1-58"&gt;&lt;a aria-hidden="true" href="#cb1-58" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="kw"&gt;const&lt;/span&gt; targetID &lt;span class="op"&gt;=&lt;/span&gt; req&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="at"&gt;params&lt;/span&gt;&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="at"&gt;uuid&lt;/span&gt;&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-59"&gt;&lt;a aria-hidden="true" href="#cb1-59" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb1-60"&gt;&lt;a aria-hidden="true" href="#cb1-60" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="cf"&gt;try&lt;/span&gt; {&lt;/span&gt;
&lt;span id="cb1-61"&gt;&lt;a aria-hidden="true" href="#cb1-61" tabindex="-1"&gt;&lt;/a&gt;            &lt;span class="cf"&gt;await&lt;/span&gt; client&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;connect&lt;/span&gt;()&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-62"&gt;&lt;a aria-hidden="true" href="#cb1-62" tabindex="-1"&gt;&lt;/a&gt;            &lt;span class="kw"&gt;const&lt;/span&gt; articles &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="cf"&gt;await&lt;/span&gt; &lt;span class="fu"&gt;getAllArticleUUIDs&lt;/span&gt;()&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-63"&gt;&lt;a aria-hidden="true" href="#cb1-63" tabindex="-1"&gt;&lt;/a&gt;            &lt;span class="cf"&gt;if&lt;/span&gt; (articles&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;indexOf&lt;/span&gt;(targetID) &lt;span class="op"&gt;==&lt;/span&gt; &lt;span class="op"&gt;-&lt;/span&gt;&lt;span class="dv"&gt;1&lt;/span&gt;) {&lt;/span&gt;
&lt;span id="cb1-64"&gt;&lt;a aria-hidden="true" href="#cb1-64" tabindex="-1"&gt;&lt;/a&gt;                res&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;send&lt;/span&gt;(&lt;span class="st"&gt;"-1"&lt;/span&gt;)&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-65"&gt;&lt;a aria-hidden="true" href="#cb1-65" tabindex="-1"&gt;&lt;/a&gt;                &lt;span class="cf"&gt;throw&lt;/span&gt; &lt;span class="bu"&gt;Error&lt;/span&gt;(&lt;span class="st"&gt;"No such article : "&lt;/span&gt; &lt;span class="op"&gt;+&lt;/span&gt; targetID&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;toString&lt;/span&gt;())&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-66"&gt;&lt;a aria-hidden="true" href="#cb1-66" tabindex="-1"&gt;&lt;/a&gt;            }&lt;/span&gt;
&lt;span id="cb1-67"&gt;&lt;a aria-hidden="true" href="#cb1-67" tabindex="-1"&gt;&lt;/a&gt;            &lt;span class="kw"&gt;const&lt;/span&gt; result &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="cf"&gt;await&lt;/span&gt; client&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;db&lt;/span&gt;(&lt;span class="st"&gt;"count"&lt;/span&gt;)&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;collection&lt;/span&gt;(&lt;span class="st"&gt;"count"&lt;/span&gt;)&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;findOne&lt;/span&gt;({ &lt;span class="st"&gt;"url"&lt;/span&gt;&lt;span class="op"&gt;:&lt;/span&gt; targetID })&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-68"&gt;&lt;a aria-hidden="true" href="#cb1-68" tabindex="-1"&gt;&lt;/a&gt;            &lt;span class="cf"&gt;if&lt;/span&gt; (result &lt;span class="op"&gt;===&lt;/span&gt; &lt;span class="kw"&gt;null&lt;/span&gt;) {&lt;/span&gt;
&lt;span id="cb1-69"&gt;&lt;a aria-hidden="true" href="#cb1-69" tabindex="-1"&gt;&lt;/a&gt;                &lt;span class="co"&gt;// create it&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-70"&gt;&lt;a aria-hidden="true" href="#cb1-70" tabindex="-1"&gt;&lt;/a&gt;                &lt;span class="cf"&gt;await&lt;/span&gt; client&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;db&lt;/span&gt;(&lt;span class="st"&gt;"count"&lt;/span&gt;)&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;collection&lt;/span&gt;(&lt;span class="st"&gt;"count"&lt;/span&gt;)&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;insertOne&lt;/span&gt;({ &lt;span class="st"&gt;"url"&lt;/span&gt;&lt;span class="op"&gt;:&lt;/span&gt; targetID&lt;span class="op"&gt;,&lt;/span&gt; &lt;span class="st"&gt;"count"&lt;/span&gt;&lt;span class="op"&gt;:&lt;/span&gt; &lt;span class="dv"&gt;1&lt;/span&gt; })&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-71"&gt;&lt;a aria-hidden="true" href="#cb1-71" tabindex="-1"&gt;&lt;/a&gt;                res&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;send&lt;/span&gt;(&lt;span class="st"&gt;"0"&lt;/span&gt;)&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-72"&gt;&lt;a aria-hidden="true" href="#cb1-72" tabindex="-1"&gt;&lt;/a&gt;            } &lt;span class="cf"&gt;else&lt;/span&gt; {&lt;/span&gt;
&lt;span id="cb1-73"&gt;&lt;a aria-hidden="true" href="#cb1-73" tabindex="-1"&gt;&lt;/a&gt;                &lt;span class="co"&gt;// increase it&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-74"&gt;&lt;a aria-hidden="true" href="#cb1-74" tabindex="-1"&gt;&lt;/a&gt;                &lt;span class="cf"&gt;await&lt;/span&gt; client&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;db&lt;/span&gt;(&lt;span class="st"&gt;"count"&lt;/span&gt;)&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;collection&lt;/span&gt;(&lt;span class="st"&gt;"count"&lt;/span&gt;)&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;updateOne&lt;/span&gt;(&lt;/span&gt;
&lt;span id="cb1-75"&gt;&lt;a aria-hidden="true" href="#cb1-75" tabindex="-1"&gt;&lt;/a&gt;                    { &lt;span class="st"&gt;"_id"&lt;/span&gt;&lt;span class="op"&gt;:&lt;/span&gt; result&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="at"&gt;_id&lt;/span&gt; }&lt;span class="op"&gt;,&lt;/span&gt; &lt;span class="co"&gt;// Filter&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-76"&gt;&lt;a aria-hidden="true" href="#cb1-76" tabindex="-1"&gt;&lt;/a&gt;                    { &lt;span class="dt"&gt;$set&lt;/span&gt;&lt;span class="op"&gt;:&lt;/span&gt; { &lt;span class="st"&gt;"count"&lt;/span&gt;&lt;span class="op"&gt;:&lt;/span&gt; result&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="at"&gt;count&lt;/span&gt; &lt;span class="op"&gt;+&lt;/span&gt; &lt;span class="dv"&gt;1&lt;/span&gt; } }&lt;span class="op"&gt;,&lt;/span&gt; &lt;span class="co"&gt;// Update&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-77"&gt;&lt;a aria-hidden="true" href="#cb1-77" tabindex="-1"&gt;&lt;/a&gt;                    { &lt;span class="dt"&gt;upsert&lt;/span&gt;&lt;span class="op"&gt;:&lt;/span&gt; &lt;span class="kw"&gt;true&lt;/span&gt; }&lt;/span&gt;
&lt;span id="cb1-78"&gt;&lt;a aria-hidden="true" href="#cb1-78" tabindex="-1"&gt;&lt;/a&gt;                )&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-79"&gt;&lt;a aria-hidden="true" href="#cb1-79" tabindex="-1"&gt;&lt;/a&gt;                res&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;send&lt;/span&gt;(result&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="at"&gt;count&lt;/span&gt;&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;toString&lt;/span&gt;())&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-80"&gt;&lt;a aria-hidden="true" href="#cb1-80" tabindex="-1"&gt;&lt;/a&gt;            }&lt;/span&gt;
&lt;span id="cb1-81"&gt;&lt;a aria-hidden="true" href="#cb1-81" tabindex="-1"&gt;&lt;/a&gt;        } &lt;span class="cf"&gt;finally&lt;/span&gt; {&lt;/span&gt;
&lt;span id="cb1-82"&gt;&lt;a aria-hidden="true" href="#cb1-82" tabindex="-1"&gt;&lt;/a&gt;            &lt;span class="cf"&gt;await&lt;/span&gt; client&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;close&lt;/span&gt;()&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-83"&gt;&lt;a aria-hidden="true" href="#cb1-83" tabindex="-1"&gt;&lt;/a&gt;        }&lt;/span&gt;
&lt;span id="cb1-84"&gt;&lt;a aria-hidden="true" href="#cb1-84" tabindex="-1"&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id="cb1-85"&gt;&lt;a aria-hidden="true" href="#cb1-85" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="fu"&gt;run&lt;/span&gt;()&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;catch&lt;/span&gt;(&lt;span class="bu"&gt;console&lt;/span&gt;&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;dir&lt;/span&gt;)&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-86"&gt;&lt;a aria-hidden="true" href="#cb1-86" tabindex="-1"&gt;&lt;/a&gt;})&lt;/span&gt;
&lt;span id="cb1-87"&gt;&lt;a aria-hidden="true" href="#cb1-87" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb1-88"&gt;&lt;a aria-hidden="true" href="#cb1-88" tabindex="-1"&gt;&lt;/a&gt;app&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;listen&lt;/span&gt;(port&lt;span class="op"&gt;,&lt;/span&gt; () &lt;span class="kw"&gt;=&amp;gt;&lt;/span&gt; {&lt;/span&gt;
&lt;span id="cb1-89"&gt;&lt;a aria-hidden="true" href="#cb1-89" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="bu"&gt;console&lt;/span&gt;&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;log&lt;/span&gt;(&lt;span class="vs"&gt;`Counter app start in -&amp;gt; &lt;/span&gt;&lt;span class="sc"&gt;${&lt;/span&gt;port&lt;span class="sc"&gt;}&lt;/span&gt;&lt;span class="vs"&gt;`&lt;/span&gt;)&lt;/span&gt;
&lt;span id="cb1-90"&gt;&lt;a aria-hidden="true" href="#cb1-90" tabindex="-1"&gt;&lt;/a&gt;})&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id="部署"&gt;部署&lt;/h2&gt;
&lt;h3 id="创建-mongodb-数据库"&gt;创建 MongoDB 数据库&lt;/h3&gt;
&lt;p&gt;这没什么好说的，注册，新建等等有向导，无须过多阐述。要注意的是等会儿为数据库添加允许访问的 IP。在面板左侧 Security -&amp;gt; Network Access 里面，添加 Render 的 Static Outbound IP Addresses。&lt;/p&gt;
&lt;figure&gt;
&lt;img alt="Static Outbound IP Addresses" src="https://render.com/static/c3e7a39e5b97189dfc2414433d3be597/285d6/static-ip-connect.webp"/&gt;
&lt;figcaption aria-hidden="true"&gt;Static Outbound IP Addresses&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;figure&gt;
&lt;img alt="Network Access" src="./assets/mongodb-ipsettings.webp"/&gt;
&lt;figcaption aria-hidden="true"&gt;Network Access&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;h3 id="创建-render-项目"&gt;创建 Render 项目&lt;/h3&gt;
&lt;p&gt;先在 GitHub 创建一个私有仓库，给 Render 使用。&lt;strong&gt;由于在这里 mongodb 的连接字符串是写死在代码里的，所以一定要设置为私有&lt;/strong&gt;。&lt;/p&gt;
&lt;p&gt;新建一个 Web Server，把对应的仓库导入进去，填写相应的信息即可。如果愿意的话，在 Cloudflare 里面添加一个子域名绑定也是不错的选择。 Render 为免费用户提供的 Web Server 服务主要的限制是：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;免费实例类型上的 Web 服务将在 15 分钟不活动后自动停止运行。当收到新的免费服务请求时，Render 会再次启动它，以便可以处理该请求。这意味着有时候请求会花费很长时间，乃至会超时。&lt;/li&gt;
&lt;li&gt;免费实例类型允许您帐户中的所有免费 Web 服务每月有 750 小时（相当于 31.25 天）的运行时间，并且每个免费服务有 100 GB 的出口带宽。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;对于第一个问题，可以使用多种多样的方法「保活」，比如在 VPS 上写一个 cron 任务自动 curl，又比如再设置一个 WebServer，每隔一段时间相互访问，当然这样做似乎不是很厚道的样子XD。&lt;/p&gt;
&lt;h3 id="添加前端代码"&gt;添加前端代码&lt;/h3&gt;
&lt;p&gt;你可能注意到每篇文章最下面的计数器了（如果没有那说明服务器寄了或者重启超时），实现如下：&lt;/p&gt;
&lt;div class="sourceCode" id="cb2"&gt;&lt;pre class="sourceCode js"&gt;&lt;code class="sourceCode javascript"&gt;&lt;span id="cb2-1"&gt;&lt;a aria-hidden="true" href="#cb2-1" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="cf"&gt;if&lt;/span&gt; (location&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="at"&gt;href&lt;/span&gt;&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;includes&lt;/span&gt;(&lt;span class="st"&gt;"127.0.0.1:8080"&lt;/span&gt;)) {&lt;/span&gt;
&lt;span id="cb2-2"&gt;&lt;a aria-hidden="true" href="#cb2-2" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="bu"&gt;document&lt;/span&gt;&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;getElementById&lt;/span&gt;(&lt;span class="st"&gt;"counter-span"&lt;/span&gt;)&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="at"&gt;innerHTML&lt;/span&gt; &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="st"&gt;"[[development mode]]"&lt;/span&gt;&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-3"&gt;&lt;a aria-hidden="true" href="#cb2-3" tabindex="-1"&gt;&lt;/a&gt;} &lt;span class="cf"&gt;else&lt;/span&gt; {&lt;/span&gt;
&lt;span id="cb2-4"&gt;&lt;a aria-hidden="true" href="#cb2-4" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="kw"&gt;const&lt;/span&gt; uuid &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="bu"&gt;document&lt;/span&gt;&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;getElementById&lt;/span&gt;(&lt;span class="st"&gt;"article-uuid"&lt;/span&gt;)&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="at"&gt;innerText&lt;/span&gt;&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-5"&gt;&lt;a aria-hidden="true" href="#cb2-5" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="kw"&gt;const&lt;/span&gt; target &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="bu"&gt;document&lt;/span&gt;&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;getElementById&lt;/span&gt;(&lt;span class="st"&gt;"counter-span"&lt;/span&gt;)&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-6"&gt;&lt;a aria-hidden="true" href="#cb2-6" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="kw"&gt;const&lt;/span&gt; last &lt;span class="op"&gt;=&lt;/span&gt; localStorage&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;getItem&lt;/span&gt;(&lt;span class="st"&gt;"lastVisit-"&lt;/span&gt; &lt;span class="op"&gt;+&lt;/span&gt; uuid)&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-7"&gt;&lt;a aria-hidden="true" href="#cb2-7" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="kw"&gt;const&lt;/span&gt; shouldIncrease &lt;span class="op"&gt;=&lt;/span&gt; last &lt;span class="op"&gt;===&lt;/span&gt; &lt;span class="kw"&gt;null&lt;/span&gt; &lt;span class="op"&gt;||&lt;/span&gt; &lt;span class="kw"&gt;new&lt;/span&gt; &lt;span class="bu"&gt;Date&lt;/span&gt;()&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;getTime&lt;/span&gt;() &lt;span class="op"&gt;-&lt;/span&gt; &lt;span class="pp"&gt;parseInt&lt;/span&gt;(last) &lt;span class="op"&gt;&amp;gt;=&lt;/span&gt; (&lt;span class="dv"&gt;1000&lt;/span&gt; &lt;span class="op"&gt;*&lt;/span&gt; &lt;span class="dv"&gt;60&lt;/span&gt; &lt;span class="op"&gt;*&lt;/span&gt; &lt;span class="dv"&gt;15&lt;/span&gt;)&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-8"&gt;&lt;a aria-hidden="true" href="#cb2-8" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb2-9"&gt;&lt;a aria-hidden="true" href="#cb2-9" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb2-10"&gt;&lt;a aria-hidden="true" href="#cb2-10" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="fu"&gt;fetch&lt;/span&gt;(shouldIncrease &lt;span class="op"&gt;?&lt;/span&gt; (&lt;span class="st"&gt;"https://counter.izfsk.top/counter/"&lt;/span&gt; &lt;span class="op"&gt;+&lt;/span&gt; uuid) &lt;span class="op"&gt;:&lt;/span&gt; (&lt;span class="st"&gt;"https://counter.izfsk.top/readOnly/"&lt;/span&gt; &lt;span class="op"&gt;+&lt;/span&gt; uuid))&lt;/span&gt;
&lt;span id="cb2-11"&gt;&lt;a aria-hidden="true" href="#cb2-11" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;then&lt;/span&gt;(r &lt;span class="kw"&gt;=&amp;gt;&lt;/span&gt; r&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;text&lt;/span&gt;())&lt;/span&gt;
&lt;span id="cb2-12"&gt;&lt;a aria-hidden="true" href="#cb2-12" tabindex="-1"&gt;&lt;/a&gt;    &lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;then&lt;/span&gt;(d &lt;span class="kw"&gt;=&amp;gt;&lt;/span&gt; {&lt;/span&gt;
&lt;span id="cb2-13"&gt;&lt;a aria-hidden="true" href="#cb2-13" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="cf"&gt;if&lt;/span&gt; (&lt;span class="op"&gt;!&lt;/span&gt;d&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;startsWith&lt;/span&gt;(&lt;span class="st"&gt;"Too"&lt;/span&gt;))&lt;/span&gt;
&lt;span id="cb2-14"&gt;&lt;a aria-hidden="true" href="#cb2-14" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="bu"&gt;document&lt;/span&gt;&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;getElementById&lt;/span&gt;(&lt;span class="st"&gt;"counter-span"&lt;/span&gt;)&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="at"&gt;innerText&lt;/span&gt; &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="st"&gt;"访问次数："&lt;/span&gt; &lt;span class="op"&gt;+&lt;/span&gt; d&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;toString&lt;/span&gt;()&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-15"&gt;&lt;a aria-hidden="true" href="#cb2-15" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="cf"&gt;else&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-16"&gt;&lt;a aria-hidden="true" href="#cb2-16" tabindex="-1"&gt;&lt;/a&gt;        &lt;span class="bu"&gt;document&lt;/span&gt;&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;getElementById&lt;/span&gt;(&lt;span class="st"&gt;"counter-span"&lt;/span&gt;)&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="at"&gt;innerHTML&lt;/span&gt; &lt;span class="op"&gt;=&lt;/span&gt; &lt;span class="st"&gt;""&lt;/span&gt;&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-17"&gt;&lt;a aria-hidden="true" href="#cb2-17" tabindex="-1"&gt;&lt;/a&gt;    })&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-18"&gt;&lt;a aria-hidden="true" href="#cb2-18" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb2-19"&gt;&lt;a aria-hidden="true" href="#cb2-19" tabindex="-1"&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id="cb2-20"&gt;&lt;a aria-hidden="true" href="#cb2-20" tabindex="-1"&gt;&lt;/a&gt;    localStorage&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;setItem&lt;/span&gt;(&lt;span class="st"&gt;"lastVisit-"&lt;/span&gt; &lt;span class="op"&gt;+&lt;/span&gt; uuid&lt;span class="op"&gt;,&lt;/span&gt; &lt;span class="kw"&gt;new&lt;/span&gt; &lt;span class="bu"&gt;Date&lt;/span&gt;()&lt;span class="op"&gt;.&lt;/span&gt;&lt;span class="fu"&gt;getTime&lt;/span&gt;())&lt;span class="op"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-21"&gt;&lt;a aria-hidden="true" href="#cb2-21" tabindex="-1"&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;br/&gt;
&lt;h2&gt;参考链接&lt;/h2&gt;
&lt;ul id="reference"&gt;
&lt;li&gt;&lt;a href="https://cloud.mongodb.com/" target="_blank"&gt;&lt;strong&gt;MongoDB 数据库&lt;/strong&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://render.com/docs/node-version" target="_blank"&gt;&lt;strong&gt;Render.com Node 文档&lt;/strong&gt;&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;br/&gt;
&lt;script async="" crossorigin="anonymous" data-category="Announcements" data-category-id="DIC_kwDOJ7Ymy84CX4eg" data-emit-metadata="0" data-input-position="top" data-lang="zh-CN" data-loading="lazy" data-mapping="title" data-reactions-enabled="1" data-repo="izfsk-ium/izfsk-ium.github.io" data-repo-id="R_kgDOJ7Ymyw" data-strict="0" data-theme="preferred_color_scheme" src="https://giscus.app/client.js"&gt;
&lt;/script&gt;
&lt;/main&gt;
&lt;footer&gt;
&lt;p class="signoff"&gt;
&lt;div class="metadata"&gt;
&lt;p class="date"&gt;&lt;time datetime="2023-08-07"&gt;创建日期：2023-08-07&lt;/time&gt;&lt;/p&gt;
&lt;p class="lastmodify"&gt;&lt;time&gt;最后编译：2023-08-10&lt;/time&gt;&lt;/p&gt;
&lt;p class="lastmodify" id="counter-span"&gt;访问次数：&lt;/p&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;/footer&gt;
&lt;script&gt;
    /* These script should run after page load */
    document.querySelectorAll('code.sourceCode').forEach(
      i =&gt; i.insertAdjacentHTML('beforeend', '&lt;div class="copy"&gt;复制&lt;/div&gt;')
    );
    document.querySelectorAll('div.copy').forEach(
      i =&gt; i.addEventListener(
        'click',
        () =&gt; {
          navigator.clipboard.writeText(i.parentElement.innerText.replace('复制', ''));
          i.innerText = '成功';
          setTimeout(() =&gt; {
            i.innerText = '复制';
          }, 1000);
        }
      )
    );

    if (location.href.includes("127.0.0.1:8080")) {
      document.getElementById("counter-span").innerHTML = "[[development mode]]";
    } else {
      const uuid = document.getElementById("article-uuid").innerText;
      const target = document.getElementById("counter-span");
      const last = localStorage.getItem("lastVisit-" + uuid);
      const shouldIncrease = last === null || new Date().getTime() - parseInt(last) &gt;= (1000 * 60 * 15);

      fetch(shouldIncrease ? ("https://counter.izfsk.top/counter/" + uuid) : ("https://counter.izfsk.top/readOnly/" + uuid))
        .then(r =&gt; r.text())
        .then(d =&gt; {
          if (!d.startsWith("Too"))
            document.getElementById("counter-span").innerText = "访问次数：" + d.toString();
          else
            document.getElementById("counter-span").innerHTML = "";
        });

      localStorage.setItem("lastVisit-" + uuid, new Date().getTime());
    }
  &lt;/script&gt;
&lt;script async="" data-website-id="2a1146ab-fa82-4a84-a04f-30e5967357c3" src="https://analytics.umami.is/script.js"&gt;&lt;/script&gt;
&lt;/body&gt;</content:encoded>
      <guid isPermaLink="false">1edffa3a-8990-4bc9-bb7a-a760909b4a93</guid>
      <pubDate>Mon, 07 Aug 2023 00:00:00 +0800</pubDate>
    </item>
  </channel>
</rss>
