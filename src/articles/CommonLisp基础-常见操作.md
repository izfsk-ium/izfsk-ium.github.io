---
uuid: "704f2611-4448-4f94-a4c1-7b797aad7a43"
title: CommonLispåŸºç¡€-å¸¸è§æ“ä½œ
date: 2023-01-20
category: å­¦ä¹ 
---

æœ¬æ–‡è®°å½• CommonLisp çš„ä¸€äº›å¸¸è§æ“ä½œï¼Œè®°ä½ï¼Œ**[UIOP](https://quickdocs.org/uiop) æ˜¯ä½ çš„å¥½æœ‹å‹**ï¼

# å­—ç¬¦ä¸²æ“ä½œ

é¦–å…ˆï¼Œåœ¨ CommonLisp ä¸­ï¼Œå­—ç¬¦ä¸²æ—¢æ˜¯ array ä¹Ÿæ˜¯ sequenceã€‚æ‰€ä»¥ï¼Œé€‚ç”¨äºå®ƒä»¬çš„æ“ä½œä¹Ÿé€‚ç”¨äºå­—ç¬¦ä¸²ã€‚å› æ­¤å¯ä»¥ä½¿ç”¨ç›¸åº”çš„æ“ä½œï¼š

```lisp
(length "Hello!") ;; 6
(elt "Hello!" 0) ;; #\h
(remove #\a "alpha") ;; "lph"
(count-if #'digit-char-p "Hello!114514") ;; 6
```

å› æ­¤ï¼Œå­—ç¬¦ä¸²çš„æ‹¼æ¥ï¼š

```lisp
 (concatenate 'string "hello" " " "world") ;; "hello world"
```

å…¶ä»– String ç±»å‹ä¸“æœ‰çš„æ“ä½œï¼š

## åˆ›å»ºå­—ç¬¦ä¸²

ä½¿ç”¨åŒå¼•å·åˆ›å»ºå­—ç¬¦ä¸²ï¼Œé™¤æ­¤ä»¥å¤–ï¼Œä½¿ç”¨ `format nil` è¿”å›ä¸€ä¸ªæ–°çš„å­—ç¬¦ä¸²ï¼Œä½¿ç”¨ `make-string` åˆ›å»ºä¸€ä¸ªç»™å®šé•¿åº¦çš„å­—ç¬¦ä¸²ï¼Œå¦‚æœéœ€è¦ä»ä¸€ä¸ªå­—ç¬¦ä¸²åˆ›å»ºå­—ç¬¦ï¼Œä½¿ç”¨ `coerce`ï¼Œåä¹‹ä½¿ç”¨ `string`ï¼š

```lisp
(string "Hello world")
(format nil "Hello!") ;; "Hello!"
(coerce "a") ;; #\a
(make-string 3 :initial-element #\a) ;; "aaa" 
```

## å­—ç¬¦ä¸²åˆ‡ç‰‡

ä½¿ç”¨ `subseq` æ¥è·å–å­—ç¬¦ä¸²åˆ‡ç‰‡ï¼Œæ ¼å¼ä¸ºï¼š`(subseq string start end)` ï¼š

```lisp
(subseq "hello!" 2 4) ;; "ll"
```

## è·å–å•ä¸ªå­—ç¬¦

é™¤äº† `elt` ä»¥å¤–ä¹Ÿå¯ä»¥ä½¿ç”¨ `char` ï¼Œ`schar`æ¥è·å–å­—ç¬¦ä¸²çš„å•ä¸ªå­—ç¬¦ï¼Œç»“åˆ `setf` æ¥åšåˆ°ç±»ä¼¼ `target[0] = 'A'` è¿™æ ·çš„æ›¿æ¢ï¼š

```lisp
(char "ä½ å¥½" 0) ;; #\U4F60
(setf (char *some-string* 6) #\a)
```

## è·å–å­—ç¬¦çš„ç ä½

æ¯ä¸€ä¸ªå­—ç¬¦éƒ½æœ‰ä¸€ä¸ªæ•°å­—å’Œå®ƒå¯¹åº”ï¼Œå…·ä½“çš„æ•°å­—ä¸å®ç°ç›¸å…³ï¼Œä¸€èˆ¬å°±æ˜¯ Unicode ã€‚`code-char` å’Œ `char-code` ç±»ä¼¼äº Python ä¸­çš„ `chr` å’Œ `ord` å‡½æ•°ï¼š

```lisp
(code-char 124) ;; #\|
(char-code #\å’Œ) ;; 21644
```

## æ›´æ”¹å­—ç¬¦ä¸²

### ç§»é™¤å’Œæ›¿æ¢

åºåˆ—ç±»å‹çš„æ ‡å‡†æ“ä½œï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ“ä½œå¯¹å­—ç¬¦ä¸²è¿›è¡Œï¼š

```lisp
(remove #\0 :start 2 "0000001") ;; "001"
(substitute #\a #\b "aaaabbb") ;; "aaaaaaa"
```

### å­—ç¬¦ä¸²æ‹¼æ¥

ä½¿ç”¨ `concatenate` æ¥æ‹¼æ¥å­—ç¬¦ä¸²ï¼Œ**éœ€è¦æä¾›ç»“æœç±»å‹ `string`**ï¼š

```lisp
(concatenate 'string "hello" "world") ;; "helloworld"
```

å¦‚æœä½ æœ‰ `UIOP` ï¼Œä½¿ç”¨ `uiop:strcat` äº¦å¯ï¼Œé™¤æ­¤ä»¥å¤–ï¼Œä¸è¦å¿˜è®° `format` å¯ä»¥ç”¨æ¥åº”å¯¹å¤æ‚çš„æ‹¼æ¥å’Œæ ¼å¼åŒ–æ“ä½œã€‚

## å¤§å°å†™

```lisp
* (string-upcase "cool")    ;; "COOL"
* (string-upcase "Cool")    ;; "COOL"
* (string-downcase "COOL")    ;; "cool"
* (string-downcase "Cool")    ;;"cool"
* (string-capitalize "cool")    ;;"Cool"
* (string-capitalize "cool example")    ;;"Cool Example"
```

æ‰€æœ‰è¿™äº›å‡½æ•°æ¥æ”¶ `:start` å’Œ `:end` å‚æ•°æŒ‡ç¤ºå¼€å§‹å’Œç»“æŸçš„ä½ç½®ã€‚

**æ³¨æ„**ï¼š`STRING-UPCASE`, `STRING-DOWNCASE` å’Œ `STRING-CAPITALIZE` ä¸ä¼šä¿®æ”¹åŸæ¥çš„å­—ç¬¦ä¸²ã€‚ä½†æ˜¯ï¼Œå¦‚æœå­—ç¬¦ä¸²ä¸­æ²¡æœ‰å­—ç¬¦éœ€è¦è½¬æ¢ï¼Œåˆ™ç»“æœå¯èƒ½æ˜¯å­—ç¬¦ä¸²æˆ–å…¶å‰¯æœ¬ï¼Œç”±å®ç°è‡ªè¡Œå†³å®šã€‚

## å»é™¤ç©ºæ ¼

```lisp
* (string-trim " " " trim me ")    ;; "trim me"
* (string-trim " et" " trim me ")    ;; "rim m"
* (string-left-trim " et" " trim me ")    ;; "rim me "
* (string-right-trim " et" " trim me ")    ;; " trim m"
* (string-right-trim '(#\Space #\e #\t) " trim me ")    ;; " trim m"
```

## å¯»æ‰¾å’Œæœç´¢

åœ¨ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­å¯»æ‰¾ç‰¹å®šå­—ç¬¦å’Œåœ¨åºåˆ—ä¸­å¯»æ‰¾å…ƒç´ ç±»ä¼¼ã€‚ä½¿ç”¨ `find` `find-if` å’Œ `position`  å’Œ `position-if` æ¥è¾¾åˆ°ç›®æ ‡ï¼Œè¦å¯»æ‰¾å­—ç¬¦ä¸²ï¼Œä½¿ç”¨ `search`ï¼š

```lisp
(find #\e "Hello world!") ;; #\e
(find-if #'digit-char-p "Hello 1000!") ;; #\1
(position #\a "Hello alpha!") ;; 6
(search "we" "If we can't be free we can at least be cheap")    ;; 3
(search "FREE" "If we can't be free we can at least be cheap" :test #'char-equal)    ;; 15
```

## ç±»å‹è½¬æ¢

- string -> integer
  
    ä½¿ç”¨ `parse-integer` æ¥è½¬æ¢ï¼Œä½¿ç”¨ `junk-allowed` æ¥å…è®¸åƒåœ¾ï¼š
  
  ```lisp
  (parse-integer "100 is very good" :junk-allowed t)    ;; 100
  (parse-integer (prompt-read "Rating") :junk-allowed t)    ;; è·å–ç”¨æˆ·è¾“å…¥ï¼Œè½¬æ¢æ•°å­—
  ```

- string -> float
  
    å¾ˆé—æ†¾ï¼Œæ²¡æœ‰å†…ç½®çš„æ–¹æ³•ã€‚å¤–éƒ¨å‡½æ•°åº“ [parse-float](https://github.com/soemraws/parse-float) å¯ä»¥åšåˆ°è¿™ä¸€ç‚¹. å®ƒä¸ä½¿ç”¨ `read-from-string` æ‰€ä»¥å¯ä»¥å®‰å…¨ä½¿ç”¨ã€‚

- number -> string
  
    ä½¿ç”¨ `write-to-string` æ¥è½¬æ¢ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥ä½¿ç”¨ `format`ï¼š
  
  ```lisp
  * (write-to-string 250)    ;; "250"
  * (write-to-string 250.02)    ;; "250.02"
  * (write-to-string 250 :base 5)    ;;"2000"
  * (write-to-string (/ 1 3))    ;;"1/3"
  ```

## å­—ç¬¦ä¸²åˆ‡åˆ†

å¾ˆé—æ†¾ï¼Œè¿˜æ˜¯æ²¡æœ‰ï¼Œä¸è¿‡ `uiop` ä¸­æä¾›äº†è§£å†³æ–¹æ¡ˆï¼š

```lisp
 (uiop:split-string "hello world" :separator " ") ;; ("hello", "world")
```

# è¾“å…¥è¾“å‡º

ä½¿ç”¨ `read-line` æ¥ä»æ ‡å‡†è¾“å…¥è¯»å–ï¼Œä½¿ç”¨ `write-line` æ¥è¾“å‡ºã€‚é™¤æ­¤ä»¥å¤–ï¼Œè¿˜å¯ä»¥ä½¿ç”¨ `print` æ¥æ‰“å°ï¼Œ`format` æ¥æ‰§è¡Œå¤æ‚çš„æ ¼å¼åŒ–ï¼š

| å½¢å¼         | æè¿°          | ä¸¾ä¾‹                      |
| ---------- | ----------- | ----------------------- |
| read-line  | è¯»å–ä¸€è¡Œ        | `(read-line)`           |
| read-char  | è¯»å–ä¸€ä¸ªå­—ç¬¦ï¼Œå¤šä½™ä¸¢å¼ƒ | `(read-char)`           |
| write-line | è¾“å‡ºä¸€è¡Œï¼Œè‡ªåŠ¨æ¢è¡Œ   | `(write-line "Hello!")` |

æ²¡æœ‰æ ‡å‡†çš„ `prompt` ä¹‹ç±»çš„å‡½æ•°ï¼Œä½ å¯ä»¥å®šä¹‰ä¸€ä¸ªï¼š

```lisp
(defun prompt-read (prompt)
Â Â Â Â (format *query-io* "~a: " prompt)
Â Â Â Â Â Â Â Â (force-output *query-io*)
Â Â Â Â Â Â Â Â (read-line *query-io*))
```

## `format`

ç±»ä¼¼äº `C` ä¸­çš„ `printf`ï¼Œ`format` æ˜¯ä¸€ä¸ªå¼ºå¤§çš„æ ¼å¼åŒ–å·¥å…·ã€‚å®ƒæ¥å—ä¸¤ä¸ªå¿…è¦å‚æ•°ï¼šä¸€ä¸ªç”¨äºè¾“å‡ºçš„ç›®çš„åœ°,å¦ä¸€ä¸ªå«æœ‰å­—é¢æ–‡æœ¬å’ŒåµŒå…¥æŒ‡ä»¤çš„æ§åˆ¶å­—ç¬¦ä¸²ï¼Œç´§éšå…¶åçš„æ˜¯ä¸€ç³»åˆ—æ ¼å¼åŒ–å‚æ•°ã€‚ç¬¬ä¸€ä¸ªè¾“å‡ºç›®çš„åœ°æ˜¯ `T`ã€`NIL`ã€ä¸€ä¸ªæµæˆ–ä¸€ä¸ªå¸¦æœ‰å¡«å……æŒ‡é’ˆçš„å­—ç¬¦ä¸²ã€‚å¦‚æœè¾“å‡ºå¯¹è±¡æ˜¯ `T`ï¼Œé‚£ä¹ˆå°±è¾“å‡ºåˆ°æ ‡å‡†è¾“å‡ºï¼Œä¹Ÿå°±æ˜¯ `*STANDARD-OUTPUT*`ï¼Œå¦‚æœæ˜¯ `NIL`ï¼Œç›´æ¥è¿”å›å­—ç¬¦ä¸²ã€‚æ§åˆ¶å­—ç¬¦ä¸²çš„ä½œç”¨ç±»ä¼¼äº C ä¸­ `printf` æ ¼å¼å­—ç¬¦ä¸²çš„ä½œç”¨ï¼Œæœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªç”¨æ¥æè¿°æ ¼å¼çš„è¯­è¨€ã€‚<del>è¿™å°±å¯¼è‡´äº†å¾ˆå®¹æ˜“å†™å‡ºç±»ä¼¼åŠ¨ç‰©ååˆå™ªéŸ³ä¸€èˆ¬æ— æ³•ç†è§£çš„ä¸œè¥¿</del>ã€‚

ä¸ C ä¸åŒï¼Œ**æ‰€æœ‰çš„æ ¼å¼æŒ‡ä»¤ä»¥ `~` å¼€å¤´ï¼Œè€Œä¸æ˜¯ä»¥ `%` å¼€å¤´**ï¼ŒæŒ‡ä»¤ä¸åŒºåˆ†å¤§å°å†™ã€‚~ä¹‹åçš„æ˜¯å•ä¸ªè‹±æ–‡å­—ç¬¦çš„æŒ‡ä»¤ï¼Œä»¥åŠä¸€ä¸ªå¯èƒ½çš„å‰ç¼€ï¼Œè¿™ä¸ªå‰ç¼€å¯ä»¥æ˜¯å¤šä¸ªå­—ç¬¦ï¼Œä½¿ç”¨é€—å·åˆ†å‰²ã€‚

å¸¸è§æŒ‡ä»¤åˆ—è¡¨ï¼š

- `~a`ï¼šæ¶ˆè€—ä¸€ä¸ªæ ¼å¼åŒ–å‚æ•°ï¼Œè½¬æ¢æˆ<del>å®ƒè®¤ä¸ºäººç±»å¯è¯»</del>çš„å½¢å¼ã€‚ä¾‹å¦‚ï¼š
  
  ```lisp
  (format t "~A ~A ~A ~A" '() 100 #'oddp "Hello!")
  ;; NIL 100 #<FUNCTION ODDP> Hello!
  (format t "~A ~A ~A ~A" nil (list 1 2 3) pi #\ğŸ’—)
  ;; NIL (1 2 3) 3.141592653589793d0 ğŸ’—
  ```

- `~s`ï¼šå’Œ `~a` æ•ˆæœç±»ä¼¼ï¼Œä½†å°†è¾“å‡ºç”Ÿæˆä¸ºå¯è¢« `READ` è¯»å›æ¥çš„å½¢å¼ï¼š
  
  ```lisp
  (format t "~S ~S ~S ~S" nil "Hello!" pi #\ğŸ’—)
  ;; NIL "Hello!" 3.141592653589793d0 #\GROWING_HEART
  ```

- `~%` å’Œ `~&`ï¼šäº§ç”Ÿæ–°è¡Œã€‚`~%` æ€»æ˜¯äº§ç”Ÿä¸€ä¸ªæ¢è¡Œ,è€Œ `~&` åªåœ¨å½“å‰æ²¡æœ‰ä½äºä¸€è¡Œå¼€å§‹å¤„æ—¶æ‰äº§ç”Ÿæ¢è¡Œã€‚å¯ä»¥æ·»åŠ å‰ç½®å‚æ•°æŒ‡å®šè¦äº§ç”Ÿçš„æ¢è¡Œçš„æ•°é‡ã€‚ä¾‹å¦‚ï¼š` (format t "~5&")` å°†ä¼šäº§ç”Ÿ 5 ä¸ªç©ºè¡Œã€‚

- `~~`ï¼šäº§ç”Ÿæ³¢æµªçº¿ï¼Œåœ¨ä¹‹å‰ä½¿ç”¨æ•°å­—æ§åˆ¶äº§ç”Ÿå¤šå°‘ä¸ªæ³¢æµªçº¿ã€‚

- `~c`ï¼šå­—ç¬¦ã€‚

    æ‰“å°å•ä¸ªå­—ç¬¦ï¼Œå¯ä»¥ä½¿ç”¨æ§åˆ¶å­—ç¬¦æ¥æ§åˆ¶ç‰¹æ®Šå­—ç¬¦çš„å±•å¼€æ–¹å¼ï¼š

    - ç›´æ¥ä½¿ç”¨æ‰“å°å­—ç¬¦æœ¬èº«ï¼š`(format nil "~c" #\SPACE) -> ä¸€ä¸ªç©ºæ ¼`
    - ä½¿ç”¨ `:` ä¿®æ”¹ç¬¦å·æ‰“å°ç‰¹æ®Šå­—ç¬¦çš„åç§°ï¼š`(format nil "~:c" #\SPACE) -> Space`
    - ä½¿ç”¨ `@` ä¿®æ”¹ç¬¦å·æ‰“å°å­—ç¬¦çš„ lisp è¡¨ç¤ºæ–¹å¼ï¼š`(format nil "~@c" #\SPACE) -> #\SPACE`
    - `:` å’Œ `@` å¯ä»¥æ··åˆä½¿ç”¨ï¼Œå¹¶éæ‰€æœ‰çš„ Lisp éƒ½å®ç°äº† `~C` æŒ‡ä»¤çš„è¿™ä¸ªæ–¹é¢ã€‚

- `~d`ï¼Œ`~x`ï¼Œ`~o` å’Œ `~b`ï¼šæ•´æ•°è¾“å‡ºã€‚

  `~d`ï¼šæ·»åŠ  `:` åœ¨åƒä½æ•°å­—ä¹‹é—´æ·»åŠ é€—å·ï¼›ç”°é—´ `@` æ€»æ˜¯æ˜¾ç¤ºæ­£è´Ÿå·ï¼Œç¬¬ä¸€ä¸ªå‰ç½®å‚æ•°å¯ä»¥æŒ‡å®šè¾“å‡ºçš„æœ€å°å®½åº¦,ç¬¬äºŒä¸ªå‚æ•°å¯ä»¥æŒ‡å®šä¸€ä¸ªç”¨ä½œå ä½ç¬¦çš„å­—ç¬¦ï¼Œç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯ç»™ `:` ä½œä¸ºåˆ†å‰²ç¬¦å·çš„ç¬¦å·ï¼Œç¬¬å››ä¸ªå‚æ•°æ˜¯ `:` åˆ†å‰²ä¸‹æ¯ä¸€ç»„æ•°å­—çš„æ•°é‡ã€‚ä¸¾ä¾‹ï¼š

    ```lisp
    (format nil "~16,'_,'-,2:@d" 114514)
    "_______+11-45-14"
    ```
  
  å‚æ•°æ˜¯ `16,'_,'-,2:@`ï¼Œå››ä¸ªå‚æ•°åˆ†åˆ«æ˜¯ `16`ï¼Œ`'_`ï¼Œ`'-`ï¼Œ`2`ï¼Œä»¥åŠå¼€å…³ `:` å’Œ `@`ã€‚

  å¦å¤–ä¸‰ä¸ª `~x` `~o` å’Œ `~b` å’Œ `~d` ç±»ä¼¼ï¼Œä½†è¾“å‡ºåˆ†åˆ«æ˜¯ 16 è¿›åˆ¶ï¼Œ8 è¿›åˆ¶å’Œ 2 è¿›åˆ¶ï¼š

    ```lisp
    (format nil "~16,'_,'-,2:@b" 114514)
    "+1-10-11-11-11-01-01-00-10"
    ```

- `~r`ï¼šæ›´åŠ å¤æ‚çš„æ•´æ•°æ§åˆ¶ã€‚
  
  `~r` å¯ä»¥è¾“å‡ºä¸º 2-36 è¿›åˆ¶ï¼Œç¬¬ä¸€ä¸ªå‚æ•°å³ä¸ºè¾“å‡ºè¿›åˆ¶æ•°ã€‚å…¶ä»–å‚æ•°å’Œä¹‹å‰ç›¸åŒï¼Œå¦å¤–ï¼Œåœ¨æ²¡æœ‰ç¬¬ä¸€ä¸ªå‚æ•°æ—¶ï¼Œæ‹¼å†™æˆè‹±æ–‡å•è¯ï¼ŒæŒ‰ç…§é€‰é¡¹çš„ä¸åŒï¼Œè¿˜å¯ä»¥æ‹¼å†™æˆç½—é©¬æ•°å­—ã€‚

  ```lisp
  (format nil "~36,8,'-:@r" 1000)
  "-----+RS"
  (format nil "~@r" 1514)
  "MDXIV"
  (format nil "~:@r" 1514)
  "MDXIIII"
  (format nil "~:r" 1514)
  "one thousand five hundred fourteenth"
  (format nil "~r" 1145141919810)
  "one trillion one hundred forty-five billion one hundred forty-one million nine hundred nineteen thousand eight hundred ten"
  ```

- `~f` å’Œ `~e`ï¼šæµ®ç‚¹æ•°
  
  `~f`ï¼šä½¿ç”¨è®¡ç®—æœºç§‘å­¦è®°æ•°æ³•ï¼Œåè¿›åˆ¶è¾“å‡ºï¼Œç¬¬äºŒä¸ªå‚æ•°æ§åˆ¶åœ¨åè¿›åˆ¶å°æ•°ç‚¹ä¹‹åæ‰“å°çš„æ•°ä½ä¸ªæ•°ã€‚`@` é€‰é¡¹å¼€å¯æ­£è´Ÿå·ã€‚

  ```lisp
  (format nil "~,5@f" pi)
  "+3.14159"
  ```

  `~e` å’Œ `~f` ç±»ä¼¼ï¼Œä½†æ˜¯è¾“å‡ºæ•°å­—æ—¶æ€»æ˜¯ä½¿ç”¨ç§‘å­¦è®¡æ•°æ³•ã€‚

é™¤æ­¤ä»¥å¤–ï¼Œè¿˜æœ‰è‹±è¯­æŒ‡ä»¤ï¼Œç”Ÿæˆå¸¦æœ‰æ­£ç¡®å¤æ•°åŒ–å•è¯çš„æ¶ˆæ¯ã€‚ä½¿ç”¨ `~p` å³å¯ï¼Œå¦‚æœå¯¹åº”çš„å‚æ•°å¤§äº 1 ï¼Œè¾“å‡ºä¸€ä¸ª `s`ï¼Œæ‰€ä»¥ï¼Œç±»ä¼¼è¿™æ ·çš„ Python ä»£ç ï¼š

```python
f"Total {number} {'element' if number == 1 else 'elements'}"
'Total 45 elements'
```

å¯ä»¥æ˜¯ï¼š

```lisp
(format nil "Total ~d element~p" 14 14)
"Total 14 elements"
```

å¯ä»¥å¼€å¯ `:` å’Œ `@`ï¼Œè®©å®ƒé‡æ–°å¤„ç†å‰ä¸€ä¸ªæ ¼å¼åŒ–å‚æ•°ï¼Œä»¥åŠè‡ªåŠ¨æ·»åŠ å•è¯çš„å¤æ•°ï¼š

```lisp
(format nil "~r file~:p" 1) â†’ "one file"
(format nil "~r famil~:@p" 0) â†’ "zero families"
```

å¯¹äºå¤§å°å†™ï¼Œå¯ä»¥ä½¿ç”¨ `~( ~)` å¤„ç†ï¼Œå®ƒæ¥æ”¶ `@`ï¼Œ`:` å¼€å…³ï¼š

```lisp
(format nil "~(~a~)" "tHe Quick BROWN foX")   ; => "the quick brown fox"
(format nil "~@(~a~)" "tHe Quick BROWN foX")  ; => "The quick brown fox"
(format nil "~:(~a~)" "tHe Quick BROWN foX")  ; => "The Quick Brown Fox"
```

ä»¥åŠæ›´åŠ å¤æ‚çš„æ¡ä»¶æ ¼å¼åŒ–ï¼Œè¿­ä»£æ ¼å¼åŒ–å’Œè·³è·ƒæ ¼å¼åŒ–ã€‚è¿˜èƒ½å¤Ÿç”Ÿæˆè¡¨æ ¼ã€‚<del>å¸Œæœ›ä¸è¦ç”¨åˆ°å®ƒä»¬</del>

# æ–‡ä»¶

å’Œå¾ˆå¤šå…¶ä»–ç¼–ç¨‹è¯­è¨€ä¸€æ ·ï¼ŒCommonLisp ä¹Ÿç”¨ã€Œæµã€æ¥è¡¨ç¤ºè¾“å…¥å’Œè¾“å‡ºã€‚è€Œæƒ³ `format` å’Œ `read` è¿™æ ·çš„å‡½æ•°ï¼Œå…¶ä½œç”¨å¯¹è±¡ä¹Ÿæ˜¯ä¸€ä¸ªæµã€‚è¯»å–å’Œå†™å…¥æ–‡ä»¶ï¼Œéœ€è¦å‡ ä¸ªå‡½æ•°ï¼š
`open`ï¼Œ`make-pathname` ç­‰ã€‚

`make-pathname` åˆ¶é€ å‡ºåˆæ³•çš„æ–‡ä»¶è·¯å¾„åç§°ï¼Œå®ƒåªæ¥æ”¶å…³é”®è¯å‚æ•°ï¼Œæœ‰å…­ä¸ªï¼š`host`ã€`device`ã€`directory`ã€`name`ã€`type` åŠ `version`ï¼Œè¿”å›ä¸€ä¸ªè·¯å¾„åç§°ï¼š

```lisp
(make-pathname :directory "/home/izfsk/" :name "file")
;; #P"//home/izfsk//file"
```

æ¥ä¸‹æ¥æ˜¯æ‰“å¼€æ–‡ä»¶ï¼Œä½¿ç”¨ `open` å‡½æ•°ã€‚è¿™ä¸ªå‡½æ•°å¾ˆå¤æ‚ï¼Œå®ƒæ¥å—ä¸€ä¸ªè·¯å¾„åå’Œå¤§é‡å…³é”®å­—å‚æ•°ï¼Œå¼€å¯æˆåŠŸæ—¶è¿”å›æŒ‡å‘æ–‡ä»¶çš„æµã€‚å¸¸è§çš„å…³é”®è¯å‚æ•°æœ‰ `:direction`ï¼Œå†³å®šæ˜¯å†™å…¥æµè¿˜æ˜¯è¯»å–æµï¼Œé€‰é¡¹æœ‰
`:input`ï¼Œ`:output`ï¼Œ`:io`ï¼Œè¿˜èƒ½å¤ŸæŒ‡å®šæ–‡ä»¶å­˜åœ¨æ—¶æ˜¯å¦è¦†ç›–ï¼Œä½¿ç”¨ `:if-exist` å‚æ•°ï¼Œä½¿ç”¨ `:supersede` è¦†ç›–ã€‚æ‰“å¼€ä»¥åï¼Œä½ å°±å¯ä»¥ä½¿ç”¨ `format` ç­‰å‡½æ•°å†™å…¥è¯»å–äº†ã€‚åœ¨æœ€åè¦è®°å¾—ä½¿ç”¨ `close` å…³é—­æµã€‚ä¸¾ä¾‹ï¼š

```lisp
(let ((target-file-stream
        (open (make-pathname :directory "/home/izfsk" :name "file")
              :direction :output
              :if-exists :supersede)))
  (format target-file-stream "Hello!")
  (close target-file-stream))
```

å°±åƒ Python æœ‰ä¸Šä¸‹æ–‡ç®¡ç†å™¨ï¼Œä½¿å¾—ä½ å¯ä»¥å†™å‡º `with open(file) as fp` ä¸€æ ·ï¼Œ CommonLisp ä¹Ÿæœ‰ä¸€ä¸ªå®å¸®åŠ©ä½ ç®¡ç†æµï¼Œä½¿ç”¨ `with-open-file` å¯ä»¥ç®¡ç†ï¼Œç”¨å®ƒé‡å†™ä¸Šé¢çš„ä¾‹å­ï¼š

```lisp
(with-open-file (target-file "/home/izfsk/file"
                             :direction :output
                             :if-exists :supersede
                             :if-does-not-exist :create)
  (format target-file "Hello!"))
```

è¯»å–ç¤ºä¾‹ï¼š

```lisp
(let ((in (open "/some/file/name.txt")))
  (format t "~a~%" (read-line in))
  (close in))
```

# å‚è€ƒ

- [Common Lisp: Format](https://www.alexeyshmalko.com/20210927132804/)
- [Practical Common Lisp -- 14. Files and File I/O](https://gigamonkeys.com/book/files-and-file-io.html)
- [The Common Lisp Cookbook â€“ Files and Directories](https://lispcookbook.github.io/cl-cookbook/files.html#writing-content-to-a-file)